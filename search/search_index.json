{"config":{"lang":["en"],"separator":"[\\s\\-\\.]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"Home","text":"<p>\u535a\u5ba2</p> <ul> <li>heyuhhh</li> </ul> <p>Question</p> <ul> <li>sos dp - Sum-Over-Subsets dp \u5b50\u96c6\u6c42\u548cdp\uff1f</li> <li>FMT\uff08\u5feb\u901f\u83ab\u6bd4\u4e4c\u65af\u53d8\u6362\uff09\uff0cFWT\uff08\u5feb\u901f\u6c83\u5c14\u4ec0\u53d8\u6362\uff09  \\(\\sum\\limits_{j\\oplus k=i} A_j\\times B_k\\) <ul> <li>\u6a21\u677f\u9898\uff0c\\(c_i = \\max\\limits_{j+k=i}\\{a_j+a_k\\}\\)\uff0ccf2600\uff0cfwt + \u9898\u89e3</li> <li>Fast Zeta Transform (FZT)</li> </ul> </li> <li>dp \u600e\u4e48\u8f6c\u5316\u4e3a\u6570\u5b66\u63cf\u8ff0</li> </ul> <p>\u7b26\u53f7 &amp; \u7ea6\u5b9a</p> <ul> <li>mask \u63a9\u7801\uff0c\u901a\u5e38\u51fa\u73b0\u5728 n \u4f4d\u8868\u793a\u7684\u5e42\u96c6\u4e2d (\\(mask \\le n-1\\))</li> </ul>"},{"location":"oiwiki/ST%E8%A1%A8/","title":"ST\u8868","text":""},{"location":"oiwiki/ST%E8%A1%A8/#1st","title":"1\uff0cST\u8868","text":"<p>\u7528\u4e8e\u8ba1\u7b97\u53ef\u91cd\u590d\u8d21\u732e\u64cd\u4f5c\u7684\u533a\u95f4\u95ee\u9898\uff0c\u65f6\u7a7a\u590d\u6742\u5ea6\u4e3a \\(O(n\\times log_{n})\\) </p> <p>\uff08\u53ef\u91cd\u590d\u8d21\u732e\u64cd\u4f5c\uff1a\\(max,~min,~gcd~...~\\)\uff09</p> <p>\u53ef\u80fd\u5176\u4ed6\u7b97\u6cd5\u4e00\u8d77\u51fa\u73b0\u7684\u7b97\u6cd5\uff1a\u4e8c\u5206\uff08\u82e5\u533a\u95f4\u957f\u5ea6\u6ee1\u8db3\u5355\u8c03\u6027\uff0c\u5219\u4e8c\u5206\u533a\u95f4\u957f\u5ea6 \\(len=0..n-1\\)\uff09</p> <p>ACM\u96c6\u8bad\u961f21\u7ea7\u65e5\u5e38\u8bad\u7ec3--ST\u8868 - Virtual Judge (csgrandeur.cn)</p>"},{"location":"oiwiki/ST%E8%A1%A8/#e-a_n-a_lrexist-ilrforall-jlra_imida_j","title":"E\uff0c\u7ed9\u5b9a\u5e8f\u5217 \\(\\{a_n\\}\\)\uff0c\u6c42\u6240\u6709\u6ee1\u8db3\u5982\u4e0b\u6761\u4ef6\u7684\u6700\u957f\u533a\u95f4 \\(a_{l..r}\\)\uff1a\\(\\exist i=l..r,~\\forall j=l..r,~a_i~\\mid~a_j\\)","text":"<p>\uff08\u5373\u533a\u95f4\u5185\u5b58\u5728\u4e00\u4e2a\u6570\uff0c\u80fd\u6574\u9664\u8be5\u533a\u95f4\u7684\u6240\u6709\u6570\uff09</p> <p>\uff08tips\uff1a\u533a\u95f4\u53ef\u4ee5\u770b\u6210\u662f\u4e00\u4e2a\u6570\u5bf9 \\((l,~r),~l\\le r\\)\uff0c\u6ee1\u8db3\u6761\u4ef6\u7684\u6570\u5bf9\u6709 \\(\\frac{n\\times(n+1)}{2}\\)\uff09</p> <p>\u6709\u4e24\u79cd\u505a\u6cd5\uff1a 1\uff09\u8bb0\\(L_i\\) \u4e3a \\(a_i\\) \u80fd\u6574\u9664\u5230\u6700\u5de6\u8fb9\u7684\u4f4d\u7f6e\uff0c\u5373 \\(a_i\\mid a_{L_i..i},~a_i\\nmid a_{L_i-1}\\)\uff0c \\(R_i\\) \u540c\u7406</p> <p>\u679a\u4e3e \\(i=1..n\\) \u5c06 \\(R_i-L_i\\) \u53d6max\u5373\u53ef</p> <p>\\(L_i\\) \u7684\u8ba1\u7b97\uff1a \u8fb9\u754c\uff1a\\(L_1=1,~R_n=n\\)</p> <p>\u9012\u63a8\uff1a\u5bf9\u4e8e \\(i\\ge 2\\)\uff0c\u5f00\u59cb\u65f6\uff0c\\(L_i\\) \u81f3\u5c11\u4e3a \\(i\\)\uff08\u56e0\u4e3a \\(a_i\\mid a_i\\)\uff09\uff0c\u7f6e \\(ans=i\\)</p> <p>\u82e5 \\(a_{i}\\mid a_{ans-1}\\)\uff0c\u5219 \\(a_{i}\\mid a_{L_{ans-1}..ans-1}\\)\uff0c\u6b64\u65f6 \\(L_{i}\\) \u81f3\u5c11\u4e3a \\(_{L_{ans-1}}\\)\uff0c\u7f6e \\(ans=L_{ans-1}\\)</p> <p>\u9012\u5f52\u5982\u4e0a\u8fc7\u7a0b</p> <p>\\(R_i\\) \u7684\u8ba1\u7b97\u540c\u7406</p> <pre><code>for(int i=1; i&lt;=n; ++i){\nint ans;\nfor(ans=i; ans&gt;1 &amp;&amp; !(a[ans-1] % a[i]); ans=l[ans-1]);\nl[i] = ans;\n}\nfor(int i=n; i&gt;=1; --i){\nint ans;\nfor(ans=i; ans&lt;n &amp;&amp; !(a[ans+1] % a[i]); ans=r[ans+1]);\nr[i] = ans;\n}\n</code></pre> <p>2\uff09\u89c2\u5bdf\u5230\u4e00\u4e2a\u6027\u8d28\uff1a \u201c\u6700\u5c0f\u503c \u7b49\u4e8e \u6700\u5927\u516c\u7ea6\u6570\u201d\uff08\\(min=gcd\\)\uff09\u7684\u533a\u95f4\u662f\u53ef\u80fd\u7684\u6700\u4f18\u89e3</p> <p>\u7528ST\u8868\u7ef4\u62a4 \\(min\\) \u548c \\(gcd\\)\uff0c</p> <p>\u4e8c\u5206\u533a\u95f4\u957f\u5ea6\uff08\\(0..n-1\\)\uff09\uff0c\u5e76\u679a\u4e3e\u51fa\u8be5\u957f\u5ea6\u4e0b\u6ee1\u8db3\u6761\u4ef6\u7684\u6240\u6709\u533a\u95f4\uff0c\u590d\u6742\u5ea6\uff1a \\(O(n\\log_n)\\)</p> <pre><code>#include&lt;iostream&gt;\nusing namespace std;\nint gcd(int a, int b){ return !b ? a : gcd(b, a % b); }\nconst int N = 3e5+3;\nint f[N][23], g[N][23], lg[N], n;\nvoid init(){\nfor(int i=2; i&lt;=n; ++i) lg[i] = lg[i/2] + 1;\nfor(int j=1; j&lt;23; ++j){\nfor(int i=1; i+(1&lt;&lt;j)-1&lt;=n; ++i){\nf[i][j] = min(f[i][j-1], f[i+(1&lt;&lt;j-1)][j-1]);\ng[i][j] = gcd(g[i][j-1], g[i+(1&lt;&lt;j-1)][j-1]);\n}\n}\n}\nbool get(int lb, int ub){\nint k = lg[ub-lb+1];\n//  printf(\" %d %d \", max(f[lb][k], f[ub-(1&lt;&lt;k)+1][k]), gcd(g[lb][k], g[ub-(1&lt;&lt;k)+1][k]));\nreturn min(f[lb][k], f[ub-(1&lt;&lt;k)+1][k]) == gcd(g[lb][k], g[ub-(1&lt;&lt;k)+1][k]);\n}\nint ans[N], cnt;\nsigned main(){\nscanf(\"%d\", &amp;n);\nfor(int i=1; i&lt;=n; ++i) scanf(\"%d\", &amp;f[i][0]), g[i][0] = f[i][0];\ninit();\nint lb, ub, mid;\nfor(lb=0, ub=n-1; mid=lb+ub&gt;&gt;1, lb&lt;=ub; ){\nint idx = 0;\n//      printf(\" %d:\", mid);\nfor(int i=1; i+mid&lt;=n; ++i) if(get(i, i+mid)) ans[ ++ idx] = i;\n//      puts(\"\");\nif(idx){\nlb = mid + 1;\ncnt = idx;\n}else ub = mid - 1;\n}\ncout &lt;&lt; cnt &lt;&lt; ' ' &lt;&lt; mid &lt;&lt; '\\n';\nfor(int i=1; i&lt;=cnt; ++i) cout &lt;&lt; ans[i] &lt;&lt; ' ';\n}\n</code></pre>"},{"location":"oiwiki/ST%E8%A1%A8/#f","title":"F\uff0c","text":""},{"location":"oiwiki/base/","title":"Base","text":""},{"location":"oiwiki/base/#1","title":"1\u3001\u4e8c\u5206\u6cd5","text":"<pre><code>const int N = 1e5+3;\nint a[N];\nint binarySearch(int lb, int ub, int key){\nint ret = -1;\nint mid;\nwhile(lb &lt;= ub){\nmid = lb + (ub - lb &gt;&gt; 1);\nif(a[mid] &lt; key) lb = mid + 1;\nelse if(a[mid] &gt; key) ub = mid - 1;\nelse{\nret = mid;\nbreak;\n}\n}\nreturn ret;\n}\n</code></pre> <ul> <li>\u6700\u5927\u503c\u6700\u5c0f\u5316\u3001\u6700\u5c0f\u503c\u6700\u5927\u5316</li> </ul> <ul> <li>\u4e8c\u5206\u7b54\u6848</li> </ul> <p>P1873 [COCI 2011/2012 #5] EKO / \u780d\u6811(luogu.com.cn)</p> <pre><code>#include&lt;iostream&gt;\nusing namespace std;\nconst int N = 1e6+3;\nint n, m, mx;\nint a[N];\nbool check(int k){\nlong long sum = 0;\nfor(int i=1; i&lt;=n; i++) sum += max(0, a[i] - k);\nreturn sum &gt;= m;\n}\nint find(int lb, int ub){\nwhile(lb + 1 &lt; ub){\nint mid = lb + ub &gt;&gt; 1;\nif(check(mid)) lb = mid;\nelse ub = mid;\n}\nreturn lb;\n}\nint main(){\ncin &gt;&gt; n &gt;&gt; m;\nfor(int i=1; i&lt;=n; i++) cin &gt;&gt; a[i], mx = max(mx, a[i]);\ncout &lt;&lt; find(1, mx + 1) &lt;&lt; '\\n';\n}\n</code></pre> <p></p> <ul> <li>\u603b\u7ed3</li> </ul> <p>1\uff09\\(while(lb&lt;=ub)\\)\uff1a\u95ed\u533a\u95f4\uff0c\u533a\u95f4\u81f3\u5c11\u4e00\u4e2a\u6570\uff08\u533a\u95f4\u7a7a\u65f6\u7ed3\u675f\uff09</p> <p>2\uff09\\(while(lb~&lt;~ub)\\)\uff1a\u5de6\u95ed\u53f3\u5f00\u533a\u95f4\uff0c\u533a\u95f4\u81f3\u5c112\u4e2a\u6570\uff08\u5269\u4e0b1\u4e2a\u6570\u65f6\u7ed3\u675f\uff09</p> <p>3\uff09\\(while(lb+1&lt;ub)\\)\uff1a\u533a\u95f4\u81f3\u5c113\u4e2a\u6570\uff08\u5269\u4e0b2\u4e2a\u6570\u65f6\u7ed3\u675f\uff09</p> <p>\u7814\u7a76\u4e00\u4e0b \u60c5\u51b5 2) \u7684\u5206\u7c7b\uff0c\u53ef\u4ee5\u63a8\u51fa 3\uff09 \u7684\u5206\u7c7b\u65b9\u6cd5\uff01 \uff08\u6700\u7ec8\u7248\u672c\u662f\u60c5\u51b5 3\uff09\uff09</p> <pre><code>int a[N];\nint l, r, target;\nint f(){\n// \u5de6\u95ed\u53f3\u5f00\uff0c\u5347\u5e8f\uff0c\u53f3\u8fb9\u754c\uff08\u8f93\u51fa\u4e0e lb \u76f8\u5173\uff09 \nint lb = l, ub = r+1;\nwhile(lb &lt; ub){\nint mid = lb+ub&gt;&gt;1;\n// \u539f\u59cb\u7ed3\u6784 \nif(a[mid] == target) lb = mid + 1;\nelse if(a[mid] &lt; target) lb = mid + 1;\nelse if(a[mid] &gt; target) ub = mid;\n// \u5347\u5e8f\uff0c\u53f3\u8fb9\u754c \nif(a[mid] &lt;= target) lb = mid + 1;\nelse ub = mid;\n// \u964d\u5e8f\uff0c\u53f3\u8fb9\u754c \nif(a[mid] &gt;= target) lb = mid + 1;\nelse ub = mid;\n}\n//  lb = mid+1  =&gt;  mid = lb-1\nreturn lb-1;\n}\nint g(){\n// \u5de6\u95ed\u53f3\u5f00\uff0c\u5347\u5e8f\uff0c\u5de6\u8fb9\u754c \uff08\u8f93\u51fa\u4e0e ub \u76f8\u5173\uff09\nint lb = l, ub = r+1;\nwhile(lb &lt; ub){\nint mid = lb+ub&gt;&gt;1;\n// \u539f\u59cb\u7ed3\u6784 \nif(a[mid] == target) ub = mid;\nelse if(a[mid] &lt; target) lb = mid + 1;\nelse if(a[mid] &gt; target) ub = mid;\n// \u5347\u5e8f\uff0c\u5de6\u8fb9\u754c \nif(a[mid] &gt;= target) ub = mid;\nelse lb = mid + 1;\n// \u964d\u5e8f\uff0c\u5de6\u8fb9\u754c \nif(a[mid] &lt;= target) ub = mid;\nelse lb = mid + 1;\n}\nreturn lb;\n}\n</code></pre> <pre><code>int l, r, target;\nvoid f(){\n// \u5347\u5e8f\uff0c\u53f3\u8fb9\u754c \nif(a[mid] &lt;= target) lb = mid + 1;\nelse ub = mid;\n// \u964d\u5e8f\uff0c\u53f3\u8fb9\u754c\uff08\u5e38\u7528\uff09\nif(a[mid] &gt;= target) lb = mid + 1;\nelse ub = mid;\n// \u5347\u5e8f\uff0c\u5de6\u8fb9\u754c\uff08\u5e38\u7528\uff09\nif(a[mid] &lt; target) lb = mid + 1;\nelse ub = mid;\n// \u964d\u5e8f\uff0c\u5de6\u8fb9\u754c \nif(a[mid] &gt; target) lb = mid + 1;\nelse ub = mid;\n}\n</code></pre> <p>\uff08\u4e8c\u5206\u901a\u5e38\u6709\u4e00\u4e2a\u8f93\u5165 \\(k\\)\uff0c \u4e00\u4e2a\u5e7f\u4e49\u4e0a\u7684\u8f93\u51fa \\(mid\\) \uff0c\u5347\u5e8f \u6216 \u964d\u5e8f \u6307\u7684\u662f \\(k\\) \u4e0e \\(mid\\) \u6b63\u76f8\u5173 \u6216 \u8d1f\u76f8\u5173\uff08\u6216\u8005\u903b\u8f91\u4e0a \u6b63\u76f8\u5173 \u6216 \u8d1f\u76f8\u5173\uff09\uff09</p>"},{"location":"oiwiki/base/#2","title":"2\u3001\u4e09\u5206\u6cd5\uff08\u8865\uff09","text":""},{"location":"oiwiki/base/#3","title":"3\u3001\u5206\u6570\u89c4\u5212\uff08\u8865\uff09","text":"<ul> <li>\u4e8c\u5206\u6cd5</li> </ul> <ul> <li> <p>\u6a21\u677f</p> <pre><code>bool check(double mid){\ndouble sum = 0;\nfor(int i=1; i&lt;=n; ++i)\nif(a[i] - mid * b[i] &gt; 0)\nsum += a[i] - mid * b[i];\nreturn sum &gt; 0;\n}\ndouble find(double lb, double ub){\nwhile(lb + 1e-7 &lt; ub){\ndouble mid = (lb + ub) / 2;\nif(check(mid)) lb = mid;\nelse ub = mid;\n}\nreturn lb;\n}\n</code></pre> </li> <li> <p>Dinkelbach\u7b97\u6cd5</p> </li> </ul> <p></p> <ul> <li> <p>\u4f8b\u9898</p> </li> <li> <ul> <li>2976 -- Dropping tests (poj.org)</li> </ul> </li> </ul> <pre><code>#include &lt;cstdio&gt;\n#include &lt;iostream&gt;\n#include &lt;algorithm&gt;\n#define eps 1e-7\nusing namespace std;\nconst int N = 2e3+3;\nint n, m;\ndouble a[N], b[N];\ndouble t[N];\ndouble check(double mid){\nfor(int i=0; i&lt;n; i++) t[i] = a[i] - mid*b[i];\nsort(t, t + n);\ndouble ans = 0;\nfor(int i=m;i&lt;n;i++) ans += t[i];\nreturn ans &gt; 0;\n}\nint main(){\nwhile(~scanf(\"%d%d\", &amp;n, &amp;m)){\nif(n + m == 0) break;\nfor(int i=0; i&lt;n; i++) scanf(\"%lf\",&amp;a[i]);\nfor(int i=0; i&lt;n; i++) scanf(\"%lf\",&amp;b[i]);\ndouble lb = 0.0, ub = 1.0, mid;\nwhile(ub - lb &gt; eps){\nmid = (lb+ub) / 2;\nif(check(mid)) lb = mid;\nelse ub = mid;\n}\nprintf(\"%1.f\\n\", lb *100);\n}\n}\n</code></pre> <ul> <li> <ul> <li></li> </ul> </li> </ul>"},{"location":"oiwiki/cdq/","title":"Cdq","text":"<p>CDQ \u5206\u6cbb\u662f\u4e00\u79cd\u601d\u60f3\u800c\u4e0d\u662f\u5177\u4f53\u7684\u7b97\u6cd5\uff0c\u4e0e \u52a8\u6001\u89c4\u5212 \u7c7b\u4f3c\u3002\u76ee\u524d\u8fd9\u4e2a\u601d\u60f3\u7684\u62d3\u5c55\u5341\u5206\u5e7f\u6cdb\uff0c\u4f9d\u539f\u7406\u4e0e\u5199\u6cd5\u7684\u4e0d\u540c\uff0c\u5927\u81f4\u5206\u4e3a\u4e09\u7c7b\uff1a</p> <p></p>"},{"location":"oiwiki/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/","title":"\u52a8\u6001\u89c4\u5212","text":""},{"location":"oiwiki/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/#1","title":"1\u3001\u52a8\u6001\u89c4\u5212\u57fa\u7840","text":"<ul> <li>\u539f\u7406</li> </ul> <ul> <li> <ul> <li>\u6700\u4f18\u5b50\u7ed3\u6784</li> </ul> </li> <li> <ul> <li>\u65e0\u540e\u6548\u6027</li> </ul> </li> <li> <ul> <li>\u5b50\u95ee\u9898\u91cd\u53e0</li> </ul> </li> <li> <ul> <li>\u52a8\u89c4\u7684\u57fa\u672c\u601d\u8def</li> </ul> </li> <li> <p>\u5e38\u89c1\u95ee\u9898</p> </li> <li> <ul> <li>\u6700\u957f\u516c\u5171\u5b50\u5e8f\u5217 \\(lcs\\) </li> </ul> </li> </ul> <p></p> <pre><code>// \u6734\u7d20\u7b97\u6cd5\nint n, m;\nchar a[N], b[N];\nint f[N][N];\nint dp(){\nfor(int i=1; i&lt;=n; i++)\nfor(int j=1; j&lt;=m; j++)\nif(a[i] == b[j]) f[i][j] = f[i-1][j-1] + 1;\nelse f[i][j] = max(f[i-1][j], f[i][j-1]);\nreturn f[n][m];\n}\n</code></pre> <p>\u66f4\u4f18\u7b97\u6cd5\uff1a\u4f4d\u8fd0\u7b97\u6c42\u6700\u957f\u516c\u5171\u5b50\u5e8f\u5217 - -Wallace- - \u535a\u5ba2\u56ed (cnblogs.com)</p> <ul> <li> <ul> <li>\u6700\u957f\u4e0d\u4e0b\u964d\u5b50\u5e8f\u5217 \\(lis\\)</li> </ul> </li> </ul> <p></p> <pre><code>// \u6734\u7d20\u7b97\u6cd5\nint n;\nint a[N], f[N];\nint dp(){\nint ans = 1;\nf[1] = 1;\nfor(int i=2; i&lt;=n; ++i){\nfor(int j=1; j&lt;i; ++j){\nif(a[i] &gt;= a[j]){\nf[i] = max(f[i], f[j] + 1);\nans = max(ans, f[i]);\n}\n}\n}\nreturn ans;\n}\n</code></pre> <p>Super Jumping! Jumping! Jumping! - HDU 1087 - Virtual Judge (vjudge.net)</p> <p>FatMouse's Speed - HDU 1160 - Virtual Judge (vjudge.net)</p> <p>\u6700\u5c11\u62e6\u622a\u7cfb\u7edf - HDU 1257 - Virtual Judge (vjudge.net)</p> <p>Bridging signals - HDU 1950 - Virtual Judge (vjudge.net)</p>"},{"location":"oiwiki/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/#2","title":"2\uff0c\u8bb0\u5fc6\u5316\u641c\u7d22","text":""},{"location":"oiwiki/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/#3dp","title":"3\uff0c\u80cc\u5305dp","text":"<p>\u6838\u5fc3\uff1a\u9650\u5236 \u548c \u8d21\u732e</p> <ul> <li>1\uff0c01\u80cc\u5305</li> </ul> <p></p> <p></p> <pre><code>int n;\nint A, a[N], B, b[N], f[N];\nint _(){\nfor(int i=1; i&lt;=n; ++i){\nfor(int j=A; j&gt;=a[i]; --j){\n//          \u5f53\u524d\u7684\u9009\u62e9\u53ea\u53d7\u4e0a\u4e00\u4e2a\u7269\u54c1\u5f71\u54cd\uff0c\u6545\u53ef\u6eda\u52a8\u6570\u7ec4\n//            f[i][j] = max(f[i-1][j], f[i-1][j-a[i]]+b[i]);\nf[j] = max(f[j], f[j-a[i]] + b[i]);\n}\n}\ncout &lt;&lt; f[A] &lt;&lt; '\\n';\n}\n</code></pre> <ul> <li>2\uff0c\u5b8c\u5168\u80cc\u5305</li> </ul> <p></p> <p></p> <p>\u6734\u7d20\u72b6\u6001\u8f6c\u79fb\u65b9\u7a0b\uff1a\\(f_{i,j}=\\max_{k=0}^{+\\infty}(f_{i-1,j-k\\times w_i}+v_i\\times k)\\)</p> <p>\u4f18\u5316\u7684\u72b6\u6001\u8f6c\u79fb\u65b9\u7a0b\uff1a\\(f_{i,j}=\\max(f_{i-1,j},f_{i,j-w_i}+v_i)\\)</p> <p></p> <p>P1616 \u75af\u72c2\u7684\u91c7\u836f - \u6d1b\u8c37 | \u8ba1\u7b97\u673a\u79d1\u5b66\u6559\u80b2\u65b0\u751f\u6001 (luogu.com.cn)</p> <pre><code>int n;\nint A, a[N/1000], B, b[N/1000], f[N];\nint _(){\nfor(int i=1; i&lt;=n; ++i){\nfor(int j=a[i]; j&lt;=A; ++j){\n//            f[i][j] = max(f[i-1][j], f[i][j-a[i]]+b[i]);\nf[j] = max(f[j], f[j-a[i]] + b[i]);\n}\n}\ncout &lt;&lt; f[A] &lt;&lt; '\\n';\n}\n</code></pre> <ul> <li>3\uff0c\u591a\u91cd\u80cc\u5305</li> </ul> <p></p> <p></p> <p>\\(f_{i,j}=\\max_{k=0}^{k_i}(f_{i-1,j-k\\times w_i}+v_i\\times k) \\qquad O(W\\sum_{i=1}^nk_i)\\)</p> <ul> <li> <ul> <li>\u4e8c\u8fdb\u5236\u5206\u7ec4\u4f18\u5316</li> </ul> </li> </ul> <p></p> <p></p> <p></p> <p></p> <p>\\(O(W\\sum_{i=1}^n\\log_2k_i)\\)</p> <p>P1776 \u5b9d\u7269\u7b5b\u9009 - \u6d1b\u8c37 | \u8ba1\u7b97\u673a\u79d1\u5b66\u6559\u80b2\u65b0\u751f\u6001 (luogu.com.cn)</p> <pre><code>int idx;\nint A, a[N], B, b[N];\nint f[N];\nint _(int n, int A, int *a, int *b){\nfor(int i=1; i&lt;=n; ++i){\nfor(int j=A; j&gt;=a[i]; --j){\nf[j] = max(f[j], f[j-a[i]]+b[i]);\n}\n}\nreturn f[A];\n}\nvoid solve(){\nint n;\ncin &gt;&gt; n &gt;&gt; A;\nfor(int i=1; i&lt;=n; ++i){\nint aa, bb, kk;\ncin &gt;&gt; bb &gt;&gt; aa &gt;&gt; kk;\nfor(int k=1; k&lt;=kk; k&lt;&lt;=1){\n++ idx, a[idx] = k * aa, b[idx] = k * bb;\nkk -= k;\n}\nif(kk) ++ idx, a[idx] = kk * aa, b[idx] = kk * bb;\n}\ncout &lt;&lt; _(idx, A, a, b);\n}\n</code></pre> <ul> <li>4\uff0c\u6df7\u5408\u80cc\u5305</li> </ul> <p></p> <ul> <li> <ul> <li>\u505a\u6cd51\uff1a</li> </ul> </li> </ul> <pre><code>for (\u5faa\u73af\u7269\u54c1\u79cd\u7c7b) {\nif (\u662f 0 - 1 \u80cc\u5305)\n\u5957\u7528 0 - 1 \u80cc\u5305\u4ee3\u7801;\nelse if (\u662f\u5b8c\u5168\u80cc\u5305)\n\u5957\u7528\u5b8c\u5168\u80cc\u5305\u4ee3\u7801;\nelse if (\u662f\u591a\u91cd\u80cc\u5305)\n\u5957\u7528\u591a\u91cd\u80cc\u5305\u4ee3\u7801;\n}\n</code></pre> <ul> <li> <ul> <li>\u505a\u6cd52\uff1a\u5b8c\u5168\u80cc\u5305\u3001\u591a\u91cd\u80cc\u5305 $\\implies $ 01\u80cc\u5305 + \u4e8c\u8fdb\u5236\u4f18\u5316</li> </ul> </li> </ul> <p>\uff08\u503c\u5f97\u6ce8\u610f\u7684\u7ec6\u8282\uff1a\uff08\u5b8c\u5168\u80cc\u5305\u7684\u60c5\u51b5\u4e2d\uff0c\uff09\u7269\u54c1\u7684\u9650\u5236 \\(aa\u53ef\u80fd=0\\) \uff0c\u8be5\u7269\u54c1\u7684\u201c\u53ef\u5bb9\u7eb3\u4e0a\u754c\u201d \u5e94\u5408\u7406\u8bbe\u7f6e\uff1b\\(aa\\)\u975e0\u65f6\uff0c\u7269\u54c1\u6570\u91cf\u8bbe\u4e3a \\(A/aa\\)\uff08\u7269\u54c1\u6570\u91cf\u7684\u4e0a\u754c\uff09\uff09</p> <pre><code>int n, A, a[N], B, b[N];\nint f[N];\nint _(int n, int A, int *a, int *b){\nfor(int i=1; i&lt;=n; ++i){\nfor(int j=A; j&gt;=a[i]; --j){\nf[j] = max(f[j], f[j-a[i]]+b[i]);\n}\n}\nreturn f[A];\n}\nvoid solve(){\nint idx;\nint t[4], m;\nscanf(\"%d:%d %d:%d %d\", t, t+1, t+2, t+3, &amp;m);\nA = (t[2] - t[0]) * 60 + (t[3] - t[1]);\nfor(int i=1; i&lt;=m; ++i){\nint aa, bb, kk;\ncin &gt;&gt; aa &gt;&gt; bb &gt;&gt; kk;\n//      \u5b8c\u5168 -&gt; \u591a\u91cd  \nkk = !kk ? (!aa ? A/aa : A / aa) : kk;\n//         \u591a\u91cd -&gt; 01\nfor(int k=1; k&lt;=kk; k&lt;&lt;=1){\n++ idx, a[idx] = k * aa, b[idx] = k * bb;\nkk -= k;\n}\nif(kk) ++ idx, a[idx] = kk * aa, b[idx] = kk * bb;;\n}\ncout &lt;&lt; _(idx, A, a, b) &lt;&lt; '\\n';\n}\n</code></pre> <ul> <li> <ul> <li>\u505a\u6cd5\u4e09\uff1a\u5b8c\u5168\u80cc\u5305\\(\\implies\\)\u591a\u91cd\u80cc\u5305\uff0c \u800c 01\u80cc\u5305 \\(\\iff\\) \u591a\u91cd\u80cc\u5305 \uff0c\u4f7f\u7528\u5355\u8c03\u961f\u5217\u4f18\u5316</li> </ul> </li> <li> <p>5\uff0c\u4e8c\u7ef4\u8d39\u7528\u80cc\u5305\uff08\u6c34\u9898\uff09</p> </li> </ul> <p></p> <p>P1855 \u69a8\u53d6kkksc03 - \u6d1b\u8c37 | \u8ba1\u7b97\u673a\u79d1\u5b66\u6559\u80b2\u65b0\u751f\u6001 (luogu.com.cn)</p> <pre><code>int n;\nint A, a[N], B, b[N];\nint f[N][N];\nint _(){\nfor(int i=1; i&lt;=n; ++i)\nfor(int j=A; j&gt;=a[i]; --j)\nfor(int k=B; k&gt;=b[i]; --k)\nf[j][k] = max(f[j][k], f[j - a[i]][k - b[i]] + 1);\nreturn f[A][B];\n}\n</code></pre> <ul> <li>6\uff0c\u5206\u7ec4\u80cc\u5305\uff08\uff09</li> </ul> <p>P1757 \u901a\u5929\u4e4b\u5206\u7ec4\u80cc\u5305 - \u6d1b\u8c37 | \u8ba1\u7b97\u673a\u79d1\u5b66\u6559\u80b2\u65b0\u751f\u6001 (luogu.com.cn)</p> <p>\u662f\u4e2a\u597d\u9898\uff0c\u201c\u79bb\u6563\u8bfb\u53d6\u6570\u636e\u201d\uff0c\u5373 \\(id\\) \u5e76\u975e\u6309\u987a\u5e8f\u7ed9\u51fa\uff1b\u6ce8\u610f\u5faa\u73af\u987a\u5e8f\uff01\uff01</p> <pre><code>#include&lt;iostream&gt;\nusing namespace std;\n#include&lt;map&gt;\n#include&lt;vector&gt;\nconst int N = 1e3+3;\nstruct nd{ int a, b; };\nmap&lt;int, vector&lt;nd&gt;&gt; bag;\nint A;\nint f[N];\nint _(){\nfor(auto  i: bag)               // \u5faa\u73af\u6bcf\u4e00\u7ec4\nfor(int j=A; j&gt;=0; --j)     // \u5faa\u73af\u80cc\u5305\u5bb9\u91cf\nfor(auto k : i.second)  // \u5faa\u73af\u8be5\u7ec4\u7684\u6bcf\u4e00\u4e2a\u7269\u54c1\nif(k.a &lt;= j){\nf[j] = max(f[j], f[j - k.a] + k.b);\n}\nreturn f[A];\n}\nint main(){\nint n;\ncin &gt;&gt; A &gt;&gt; n;\nfor(int i=1; i&lt;=n; ++i){\nint aa, bb, id;\ncin &gt;&gt; aa &gt;&gt; bb &gt;&gt; id;\nbag[id].push_back({aa, bb});\n}\ncout &lt;&lt; _() &lt;&lt; '\\n';\n}\n</code></pre> <ul> <li>7\uff0c\u4f9d\u8d56\u80cc\u5305</li> </ul> <p></p> <p>\u5c06\u591a\u4e2a\u201c\u4e3b\u4ef6\u201d\u770b\u6210\u591a\u68f5\u6811\uff0c\u679a\u4e3e\u6bcf\u4e00\u68f5\u6811\uff0c\u7136\u540e\u679a\u4e3e\u7ed3\u70b9\u4e4b\u95f4\u7684\u9009\u62e9\u60c5\u51b5\uff0c</p> <p>\u76f8\u5bf9\u4e8e\u4e00\u68f5\u6811\u800c\u8a00\uff0c\u8bb0\u6811\u6839\u4e3a \\(0\\)\uff0c\u5b69\u5b50\u4e3a \\(1\\) \u548c \\(2\\)\uff0c\u53ef\u9009\u62e9\u7684\u6240\u6709\u65b9\u6848\u4e3a\uff1a</p> <p>\\(\\empty,~\\{0\\},~~\\{0,~1\\},~\\{0,~2\\},~\\{0,~1,~2\\}\\)</p> <p>\uff08\u8865\u5145\uff1ainitializer_list\\&lt;T&gt; \u548c lambda \u7684\u51fd\u6570\u5f0f\u7f16\u7a0b\u5f88\u9002\u7528\u4e8e\u72b6\u6001\u8ba1\u7b97\uff01\uff01\uff09</p> <p>P1064 [NOIP2006 \u63d0\u9ad8\u7ec4] \u91d1\u660e\u7684\u9884\u7b97\u65b9\u6848 - \u6d1b\u8c37 | \u8ba1\u7b97\u673a\u79d1\u5b66\u6559\u80b2\u65b0\u751f\u6001 (luogu.com.cn)</p> <pre><code>#include&lt;iostream&gt;\nusing namespace std;\nconst int N = 4e4+3;\n// \u7f16\u53f7\u662f\u79bb\u6563\u7684\uff0c\u5373 \u6709\u7684\u4f4d\u7f6e\u6ca1\u6709\u7269\u54c1\uff01\uff01\uff0c\u5176\u5c5e\u6027\u5747\u4e3a 0 \nint n, A, a[N][3], b[N][3], f[N];    // \uff08\u7531\u4e8e\u6811\u7684\u6df1\u5ea6\u662f2\uff0c\u6240\u4ee5\u76f4\u63a5\u7528\u4e8c\u7ef4\u6570\u7ec4\uff09 \nint main(){\ncin &gt;&gt; A &gt;&gt; n;\nfor(int i=1; i&lt;=n; ++i){\nint aa, bb, t;\ncin &gt;&gt; aa &gt;&gt; bb &gt;&gt; t;\nif(!t) a[i][0] = aa, b[i][0] = bb;\n// \u7f16\u53f7\u4e3a t \u7684\u7269\u54c1\u6709\u7b2c\u4e00\u4e2a\u7a7a\u4f4d \nelse if(!a[t][1]) a[t][1] = aa, b[t][1] = bb;\n// \u7f16\u53f7\u4e3a t \u7684\u7269\u54c1\u6709\u7b2c\u4e8c\u4e2a\u7a7a\u4f4d \nelse if(!a[t][2]) a[t][2] = aa, b[t][2] = bb;\n}\n// \u679a\u4e3e\u6839\u7ed3\u70b9\uff0c\u7136\u540e\u72b6\u6001\u673a \nfor(int i=1; i&lt;=n; ++i){\nfor(int j=A; j&gt;=0; --j){\nauto up = [&amp;f, i, j, a, b](initializer_list&lt;int&gt; l){\nint lmt = 0, val = 0;    // \u9650\u5236 \u548c \u8d21\u732e\nfor(auto t : l) lmt += a[i][t], val += a[i][t] * b[i][t];\nif(j - lmt &gt;= 0) f[j] = max(f[j], f[j - lmt] + val);\n};\nup({0});\nup({0, 1});\nup({0, 2});\nup({0, 1, 2});\n}\n}\ncout &lt;&lt; f[A] &lt;&lt; '\\n';\n}\n</code></pre> <p>\uff08\u8be5\u9898\u4e0e\\(01\\)\u80cc\u5305\u7684\u672c\u8d28\u533a\u522b\u662f\uff1a\\(01\\) \u80cc\u5305\u67092\u79cd\u51b3\u7b56\uff0c\u800c\u8be5\u9898\u4e2d\u67095\u79cd\u51b3\u7b56\uff09</p> <ul> <li>8\uff0c\u6cdb\u5316\u7684\u80cc\u5305</li> </ul> <p></p> <p>CWXU-\u6691\u5047\u96c6\u8bad-\u80cc\u5305DP - Virtual Judge (csgrandeur.cn)</p> <ul> <li> <p>9\uff0c\u6742\u9879</p> </li> <li> <ul> <li>\u5c0f\u4f18\u5316</li> </ul> </li> </ul> <p></p> <ul> <li> <ul> <li>\u80cc\u5305\u7684\u53d8\u79cd</li> </ul> </li> <li> <ul> <li> <ul> <li>1\uff0c\u8f93\u51fa\u65b9\u6848</li> </ul> </li> </ul> </li> </ul> <p></p> <pre><code>// \u56e0\u4e3a\u6700\u540e\u4e00\u4ef6\u7269\u54c1\u5b58\u50a8\u7684\u662f\u6700\u7ec8\u72b6\u6001\uff0c\u6240\u4ee5\u4ece\u6700\u540e\u4e00\u4ef6\u7269\u54c1\u8fdb\u884c\u5faa\u73af\nfor (\u4ece\u6700\u540e\u4e00\u4ef6\u5faa\u73af\u81f3\u7b2c\u4e00\u4ef6) {\nif (g[i][v]) {\n\u9009\u4e86\u7b2c i \u9879\u7269\u54c1;\nv -= \u7b2c i \u9879\u7269\u54c1\u7684\u91cd\u91cf;\n} else {\n\u672a\u9009\u7b2c i \u9879\u7269\u54c1;\n}\n}\n</code></pre> <ul> <li> <ul> <li> <ul> <li>2\uff0c\u6c42\u65b9\u6848\u6570</li> </ul> </li> </ul> </li> </ul> <p></p> <pre><code>// 01 + \u6eda\u52a8\nint n, A, a[N], f[N];\nint _(){\nf[0] = 1;\nfor(int i=1; i&lt;=n; ++i)\nfor(int j=A; j&gt;=a[i]; --j)\nf[j] += f[j - a[i]];\nreturn f[A];\n}\n</code></pre> <p>\u62d3\u5c55\uff1a1742 -- Coins (poj.org)\uff08\u591a\u91cd\u80cc\u5305\uff0c\u7528\u4e8c\u8fdb\u5236\u4f18\u5316\u4f1atle\uff09</p> <ul> <li> <ul> <li> <ul> <li>3\uff0c\u6700\u4f18\u65b9\u6848\u603b\u6570</li> </ul> </li> </ul> </li> </ul> <pre><code>int n, A, a[N], b[N], f[N], g[N];\nint _(){\nmemset(f, -0x3f, sizeof f);\nf[0] = 0;\ng[0] = 1;\nfor(int i=1; i&lt;=n; ++i){\nfor(int j=A; j&gt;=a[i]; --j){\nint tmp = max(f[j], f[j - a[i]] + b[i]);\nint val = 0;\nif(tmp == f[j]) val += g[j];\nif(tmp == f[j - a[i]] + b[i]) val += g[j - a[i]];\nf[j] = tmp;\ng[j] = val;\n}\n}\nint mx = 0;\nfor(int i=0; i&lt;=A; ++i) mx = max(mx, f[i]);\nint ans = 0;\nfor(int i=0; i&lt;=A; ++i) if(f[i] == mx) ans += g[i];\nreturn ans;\n</code></pre> <ul> <li> <ul> <li> <ul> <li>4\uff0c\u80cc\u5305\u7684\u7b2ck\u4f18\u89e3</li> </ul> </li> </ul> </li> </ul> <pre><code>#include&lt;iostream&gt;\n#include&lt;cstring&gt;\nusing namespace std;\nconst int N = 1e3+3;\nint n, A, a[N], b[N], K, f[N][N];\nint G, g[N], H, h[N];\nint _(){\nmemset(f, 0, sizeof f);\nfor(int i=1; i&lt;=n; ++i){\nfor(int j=A; j&gt;=a[i]; --j){\nfor(int k=1; k&lt;=K; ++k)\ng[k] = f[j][k], h[k] = f[j - a[i]][k] + b[i];\ng[K + 1] = h[K + 1] = -1;\nint kk = 1, gg = 1, hh = 1;\nwhile(kk &lt;= K &amp;&amp; (~g[gg] || ~h[hh])){\nf[j][kk] = g[gg] &gt; h[hh] ? g[gg ++ ] : h[hh ++ ];\nif(f[j][kk] != f[j][kk - 1]) ++ kk;\n}\n}\n}\nreturn f[A][K];\n}\nint main(){\nint T;\ncin &gt;&gt; T;\nwhile(T--){\ncin &gt;&gt; n &gt;&gt; A &gt;&gt; K;\nfor(int i=1; i&lt;=n; ++i) cin &gt;&gt; b[i];\nfor(int i=1; i&lt;=n; ++i) cin &gt;&gt; a[i];\ncout &lt;&lt; _() &lt;&lt; '\\n';\n}\n}\n</code></pre>"},{"location":"oiwiki/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/#4dp","title":"4\uff0c\u533a\u95f4dp","text":"<p>#10147. \u300c\u4e00\u672c\u901a 5.1 \u4f8b 1\u300d\u77f3\u5b50\u5408\u5e76 - \u9898\u76ee - LibreOJ (loj.ac)</p> <pre><code>for(int d = 1; d &lt; n; ++d){\nfor(int lb = 1, ub; (ub = lb + d) &lt; 2 * n; ++lb){\nf[lb][ub] = inf;\nf1[lb][ub] = -inf;\nfor(int mid = lb; mid &lt; ub; ++ mid){\nf[lb][ub] = min(f[lb][ub], f[lb][mid] + f[mid + 1][ub] + a[ub] - a[lb - 1]);\nf1[lb][ub] = max(f1[lb][ub], f1[lb][mid] + f1[mid + 1][ub] + a[ub] - a[lb - 1]);\n}\n}\n}\n</code></pre> <ul> <li> <p>\u4e60\u9898\uff1a</p> </li> <li> <ul> <li>\u80fd\u91cf\u9879\u94fe - Vijos</li> </ul> </li> <li> <p>\u77e9\u9635\u53d6\u6570\u6e38\u620f - Vijos</p> </li> <li> <p>P4767 [IOI2000]\u90ae\u5c40 - \u6d1b\u8c37 | \u8ba1\u7b97\u673a\u79d1\u5b66\u6559\u80b2\u65b0\u751f\u6001 (luogu.com.cn)</p> </li> </ul>"},{"location":"oiwiki/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/#5dp","title":"5\uff0c\u6811\u5f62dp","text":"<ul> <li> <p>1\uff0c\u57fa\u7840</p> </li> <li> <ul> <li>P1352 \u6ca1\u6709\u4e0a\u53f8\u7684\u821e\u4f1a - \u6d1b\u8c37 | \u8ba1\u7b97\u673a\u79d1\u5b66\u6559\u80b2\u65b0\u751f\u6001 (luogu.com.cn)</li> </ul> </li> </ul> <p>\u6211\u4eec\u8bbe \\(f_{u,~1/0}\\) \u4ee3\u8868\u4ee5 \\(u\\) \u4e3a\u6839\u7684\u5b50\u6811\u7684\u6700\u4f18\u89e3\uff08\u7b2c\u4e8c\u7ef4\u7684\u503c\u4e3a 0 \u4ee3\u8868  \u4e0d\u53c2\u52a0\u821e\u4f1a\u7684\u60c5\u51b5\uff0c1 \u4ee3\u8868 \\(u\\) \u53c2\u52a0\u821e\u4f1a\u7684\u60c5\u51b5\uff09\u3002</p> <p>\u72b6\u6001\u8f6c\u79fb\uff1a$f_{u,~0} = \\sum\\limits_{(u,~v)\\in E}max{f_{v,0},f_{v,~1}}  \\ f_{u,~1} = \\sum\\limits_{(u,~v)\\in E}f_{v,~0} + w_{(u,~v)} $</p> <pre><code>#include&lt;iostream&gt;\n#include&lt;cstring&gt;\nusing namespace std;\nconst int N = 6e3+3;\nstruct edge{ int v, ne; }e[N];\nint idx, n, h[N];\nvoid addedge(int u, int v){\ne[++ idx] = {v, h[u]}, h[u] = idx;\n}\nint d[N], st[N], f[N][2];\nvoid calc(int u){\nst[u] = true;\nfor(int i=h[u], v; v=e[i].v, ~i; i=e[i].ne){\nif(st[v]) continue;\ncalc(v);\nf[u][0] += max(f[v][0], f[v][1]);\nf[u][1] += f[v][0];\n}\n}\nint main(){\ncin &gt;&gt; n;\nfor(int i=1; i&lt;=n; ++i) cin &gt;&gt; f[i][1];\nidx = 0; memset(h, -1, sizeof h);\nfor(int i=1; i&lt;n; ++i){\nint u, v;\ncin &gt;&gt; v &gt;&gt; u;\nd[v] = true;\naddedge(u, v);\n}\nfor(int i=1; i&lt;=n; ++i){\nif(d[i]) continue;\ncalc(i);\ncout &lt;&lt; max(f[i][0], f[i][1]) &lt;&lt; '\\n';\n}\n}\n</code></pre> <ul> <li> <ul> <li>Computer - HDU 2196 - Virtual Judge (vjudge.net)</li> </ul> </li> </ul> <p>\u9898\u610f\uff1a\u7ed9\u5b9a\u4e00\u68f5\u5e26\u6743\u6811\uff08n\u4e2a\u70b9\uff0cn-1\u6761\u8fb9\uff09\uff0c\u6c42\u6bcf\u4e2a\u7ed3\u70b9\u5230\u53f6\u5b50\u7684\u6700\u957f\u8ddd\u79bb</p> <p>\u72b6\u6001\u8f6c\u79fb\uff1a$f_u = max{f'{(u,~v)}} \\ f' = f_v + w_{(u,~v)} \\quad v\\ne u.father $</p> <p>\uff08 \\(f'_{u,~v)}\\) \u9700\u8981\u8bb0\u5fc6\u5316\uff09</p> <pre><code>#include&lt;iostream&gt;\n#include&lt;cstring&gt;\n#include&lt;algorithm&gt;\nusing namespace std;\nconst int N = 2e4+3;\nstruct edge{ int v, ne, w; }e[N];\nint idx, n, h[N];\nvoid add(int u, int v, int w){\ne[ ++ idx] = {v, h[u], w}, h[u] = idx;\n}\nint f[N];\nint dfs(int u, int p){\nint ans = 0;\nfor(int i=h[u]; i; i=e[i].ne){\nint v = e[i].v, w = e[i].w;\nif(v == p) continue;\nif(!f[i]) f[i] = dfs(v, u) + w;\nans = max(ans, f[i]);\n}\nreturn ans;\n}\nint main(){\nwhile(cin &gt;&gt; n){\nidx = 0;\nmemset(h, 0, sizeof h);\nfor(int i=2; i&lt;=n; ++i){\nint v, w;\ncin &gt;&gt; v &gt;&gt; w;\nadd(i, v, w);\nadd(v, i, w);\n}\nmemset(f, 0, sizeof f);\nfor(int i=1; i&lt;=n; ++i){\ncout &lt;&lt; dfs(i, 0) &lt;&lt; ' ' &lt;&lt; cc &lt;&lt; '\\n';\n}\n}\n}\n</code></pre> <ul> <li> <ul> <li>Strategic Game - HDU 1054 - Virtual Judge (csgrandeur.cn)</li> </ul> </li> </ul> <p>\u9898\u610f\uff1a\u7ed9\u5b9a\u4e00\u68f5\u65e0\u6743\u6811\uff0c\u9009\u51fa x \u4e2a\u70b9\u4f7f\u8fd9\u4e9b\u70b9\u7684\u90bb\u8fb9\u8986\u76d6\u6811\u7684\u8fb9\u96c6 \\(E(G)\\)</p> <p>\u72b6\u6001\u8f6c\u79fb\uff1a$f_{u,~0} = \\sum\\limits_{(u,~v)\\in E}f_{v,~1} \\ f_{u,~1} = \\sum\\limits_{(u,~v)\\in E}min{f_{v,0},f_{v,~1}} + 1 $</p> <pre><code>#include&lt;iostream&gt;\n#include&lt;cstring&gt;\n#include&lt;algorithm&gt;\nusing namespace std;\nconst int N = 3e3+3;\nstruct edge{ int v, ne; }e[N];\nint idx, n, h[N];\nvoid add(int u, int v){\ne[ ++ idx] = {v, h[u]}, h[u] = idx;\n}\nint f[N][2];\nvoid dfs(int u, int p){\nf[u][0] = 0;\nf[u][1] = 1;\nfor(int i=h[u]; ~i; i=e[i].ne){\nint v = e[i].v;\nif(v == p) continue;\ndfs(v, u);\nf[u][0] += f[v][1];\nf[u][1] += min(f[v][0], f[v][1]);\n}\n}\nint main(){\nwhile(~scanf(\"%d\", &amp;n)){\nmemset(h, -1, sizeof h);\nidx = 0;\nfor(int i=1; i&lt;=n; ++i){\nint u, v, cnt;\nscanf(\"%d:(%d)\", &amp;u, &amp;cnt);\nwhile(cnt--) scanf(\"%d\", &amp;v), add(u, v), add(v, u);\n}\nmemset(f, 0, sizeof f);\ndfs(0, -1);\ncout &lt;&lt; min(f[0][0], f[0][1]) &lt;&lt; '\\n';\n}\n}\n</code></pre> <ul> <li> <ul> <li>P3574 [POI2014] FAR-FarmCraft - \u6d1b\u8c37 | \u8ba1\u7b97\u673a\u79d1\u5b66\u6559\u80b2\u65b0\u751f\u6001 (luogu.com.cn)</li> </ul> </li> <li> <p>2\uff0c\u4e66\u4e0a\u80cc\u5305</p> </li> </ul> <p></p> <p>P2014 [CTSC1997] \u9009\u8bfe - \u6d1b\u8c37 | \u8ba1\u7b97\u673a\u79d1\u5b66\u6559\u80b2\u65b0\u751f\u6001 (luogu.com.cn)</p> <p></p> <p></p> <p></p> <p>\uff08\u7b2c\u4e8c\u7ef4\u53ef\u4ee5\u6eda\u52a8\u00a0\u00a0\u00a0\u00a0\uff09</p> <pre><code>#include&lt;iostream&gt;\n#include&lt;cstring&gt;\nusing namespace std;\nconst int N = 3e2+3;\nstruct edge{ int v, ne; }e[N];\nint idx, n, h[N], A, b[N];\nvoid add(int u, int v){\ne[ ++ idx] = {v, h[u]}, h[u] = idx;\n}\nint f[N][N];\nvoid dfs(int u){\nf[u][1] = b[u];\nfor(int _=h[u]; ~_; _=e[_].ne){\nint v = e[_].v;\ndfs(v);\nfor(int i=A; i&gt;=1; --i){\nfor(int j=0; j&lt;i; ++j){\nf[u][i] = max(f[u][i], f[u][i - j] + f[v][j]);\n}\n}\n}\n}\nint main(){\ncin &gt;&gt; n &gt;&gt; A;\nmemset(h, -1, sizeof h);\nidx = 0;\nfor(int i=1; i&lt;=n; ++i){\nint u;\ncin &gt;&gt; u &gt;&gt; b[i];\nadd(u, i);\n}\n++ A;\ndfs(0);\ncout &lt;&lt; f[0][A] &lt;&lt; '\\n';\n}\n</code></pre> <ul> <li> <ul> <li>P4516 [JSOI2018] \u6f5c\u5165\u884c\u52a8 - \u6d1b\u8c37 | \u8ba1\u7b97\u673a\u79d1\u5b66\u6559\u80b2\u65b0\u751f\u6001 (luogu.com.cn)</li> </ul> </li> <li> <ul> <li>P3780 [SDOI2017]\u82f9\u679c\u6811 - \u6d1b\u8c37 | \u8ba1\u7b97\u673a\u79d1\u5b66\u6559\u80b2\u65b0\u751f\u6001 (luogu.com.cn)</li> </ul> </li> <li> <p>3\uff0c\u6362\u6839dp</p> </li> </ul> <p></p> <ul> <li> <ul> <li>P3478 [POI2008] STA-Station - \u6d1b\u8c37 | \u8ba1\u7b97\u673a\u79d1\u5b66\u6559\u80b2\u65b0\u751f\u6001 (luogu.com.cn)</li> </ul> </li> </ul> <pre><code>\n</code></pre> <ul> <li> <ul> <li>Accumulation Degree - POJ 3585 - Virtual Judge (csgrandeur.cn)</li> </ul> </li> <li> <ul> <li>P2986 [USACO10MAR] Great Cow Gathering G - \u6d1b\u8c37 | \u8ba1\u7b97\u673a\u79d1\u5b66\u6559\u80b2\u65b0\u751f\u6001 (luogu.com.cn)</li> </ul> </li> <li> <ul> <li>Problem - 708C - Codeforces</li> </ul> </li> </ul>"},{"location":"oiwiki/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/#6dagdp","title":"6\uff0cDAG\u4e0a\u7684dp","text":"<p>The Tower of Babylon - UVA 437 - Virtual Judge (csgrandeur.cn)</p> <p></p> <p>\u6bcf\u79cd\u7816\u5934\u6309\u6446\u653e\u72b6\u6001\u53ef\u4ee5\u5206\u4e3a3\u79cd\uff0c\u5f00\u4e00\u4e2a\u6570\u7ec4\u6765\u5b58\uff1b\u8003\u8651\u6df1\u641c\u7684\u601d\u60f3\uff0c\u53ef\u4ee5\u6784\u5efa\u4e00\u4e2a\u6709 \\(3\\times n\\) \u68f5\u6811\u7684\u68ee\u6797\uff0c\u6bcf\u6b21\u9012\u5f52\u90fd\u4ece \\(3\\times n\\) \u79cd\u7816\u5934\u91cc\u9009\u957f\u5bbd\u5408\u9002\u7684\u7816\u5934\u4f5c\u4e3a\u5b50\u7ed3\u70b9\u3002\uff08\u53ef\u4ee5\u8bb0\u5fc6\u5316\uff09</p> <pre><code>#include&lt;iostream&gt;\n#include&lt;cstring&gt;\nusing namespace std;\n#define int long long\nconst int N = 33;\nstruct { int a, b, x; }vt[N * 3];\nint n, f[N * 3];\nint dfs(int u){\nif(~f[u]) return f[u];\nf[u] = 0;\nfor(int v=1; v&lt;=n; ++v){\nif(vt[u].a &gt; vt[v].a &amp;&amp; vt[u].b &gt; vt[v].b || vt[u].a &gt; vt[v].b &amp;&amp; vt[u].b &gt; vt[v].a){\nf[u] = max(f[u], dfs(v) + vt[v].x);\n}\n}\nreturn f[u];\n}\nsigned main(){\nint m, test = 0;\nwhile(cin &gt;&gt; m, m){\nn = 0;\nfor(int i=1; i&lt;=m; ++i){\nint a, b, c;\ncin &gt;&gt; a &gt;&gt; b &gt;&gt; c;\nvt[ ++ n] = {a, b, c};\nvt[ ++ n] = {b, c, a};\nvt[ ++ n] = {c, a, b};\n}\nmemset(f, -1, sizeof f);\nint ans = 0;\nfor(int i=1; i&lt;=n; ++i){\nans = max(ans, dfs(i) + vt[i].x);\n}\nprintf(\"Case %lld: maximum height = %lld\\n\", ++ test, ans);\n}\n}\n</code></pre>"},{"location":"oiwiki/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/#7dp","title":"7\uff0c\u72b6\u538bdp","text":"<p>#2153. \u300cSCOI2005\u300d\u4e92\u4e0d\u4fb5\u72af - \u9898\u76ee - LibreOJ (loj.ac)</p> <p></p> <pre><code>#include&lt;iostream&gt;\nusing namespace std;\n#define int long long\nconst int N = 15;\nint n, k, f[N][1&lt;&lt;N][N * N];\nint idx, st[1&lt;&lt;N], d[1&lt;&lt;N];\n// \u6784\u9020\u884c\u5185\u5408\u6cd5\u7684\u72b6\u6001 \nvoid dfs(int s, int num, int cur){\nif(cur &gt;= n) return void(( st[++ idx] = s, d[idx] = num ));\ndfs(s, num, cur + 1);\ndfs(s | 1 &lt;&lt; cur, num + 1, cur + 2);\n}\n// \u8fc7\u6ee4\u76f8\u90bb\u4e24\u884c\u4e0d\u5408\u6cd5\u7684\u72b6\u6001 \nbool fail(int u, int v){\nreturn st[u] &amp; st[v] || st[u] &lt;&lt; 1 &amp; st[v] || st[u] &amp; st[v] &lt;&lt; 1;\n}\nsigned main(){\ncin &gt;&gt; n &gt;&gt; k;\ndfs(0, 0, 0);\nfor(int i=1; i&lt;=n; ++i){\nfor(int u=1; u&lt;=idx; ++u){\nif(i==1){ f[i][u][d[u]] = 1; continue; }\nfor(int l=d[u]; l&lt;=k; ++l){\nfor(int v=1; v&lt;=idx; ++v){\nif(fail(u, v)) continue;\nf[i][u][l] += f[i-1][v][l - d[u]];\n}\n}\n}\n}\nint ans = 0;\nfor(int u=1; u&lt;=idx; ++u) ans += f[n][u][k];\ncout &lt;&lt; ans &lt;&lt; '\\n';\n}\n</code></pre> <ul> <li>#10173. \u300c\u4e00\u672c\u901a 5.4 \u7ec3\u4e60 2\u300d\u70ae\u5175\u9635\u5730 - \u9898\u76ee - LibreOJ (loj.ac)</li> </ul> <pre><code>#include&lt;iostream&gt;\nusing namespace std;\n// m=10\u65f6\uff0c\u6ee1\u8db3\u7b2c\u4e00\u4e2a\u884c\u72b6\u6001\u6761\u4ef6\u7684\u670960\u4e2a\uff0c\u6240\u4ee5\u4e0d\u9700\u8981\u5f001&lt;&lt;10=1024\u5927\u7684\u6570\u7ec4\nint idx, st[60], num[60], a[103];\nint n, m, f[103][60][60];\nint main(){\ncin &gt;&gt; n &gt;&gt; m;\nint mm = 1 &lt;&lt; m;\n//  \u8fc7\u6ee4\u7b2c\u4e00\u79cd\u975e\u6cd5\u7684\u884c\u72b6\u6001\uff0c\u5e76\u4f7f\u7528lowbit\u8ba1\u7b97\u884c\u72b6\u6001\u76841\u7684\u4e2a\u6570\nfor(int i=0; i&lt;mm; ++i){\nif(i&lt;&lt;1&amp;i || i&gt;&gt;1&amp;i) continue;\nif(i&lt;&lt;2&amp;i || i&gt;&gt;2&amp;i) continue;\nst[idx] = i, num[idx] = 0;\nfor(int j=i; j; j-=j&amp;-j) ++ num[idx];\n++ idx;\n}\n//    cout &lt;&lt; idx &lt;&lt; '\\n';\n//    \u8bfb\u5165\u6bcf\u884c\u7684 \u201c\u53ef\u653e\u7f6e\u72b6\u6001\u201da[i]\uff0c\u4ec5\u5f53 st &amp; ~a[i] != 0 \u65f6\uff0cst \u4e0d\u662f a[i]\u7684\u5b50\u96c6 \nfor(int i=1; i&lt;=n; ++i){\na[i] = 0;\nfor(int j=0; j&lt;m; ++j){\nchar c;\ncin &gt;&gt; c;\na[i] = 2 * a[i] | (c == 'P');\n}\n}\nint ans = 0;\n//  \u4e0d\u61c2\u7684\u5730\u65b9\uff1a\u4e3a\u4ec0\u4e48\u4e0d\u9700\u8981\u521d\u59cb\u5316\uff1f\nfor(int i=1; i&lt;=n; ++i){\nfor(int j=0; j&lt;idx; ++j){\nfor(int k=0; k&lt;idx; ++k){\nfor(int l=0; l&lt;idx; ++l){\n// \u8fc7\u6ee4\u7b2c\u4e8c\u79cd\u975e\u6cd5\u7684\u884c\u72b6\u6001 \nif(st[j] &amp; ~a[i]) continue;\nif(st[k] &amp; ~a[i-1]) continue;\nif(st[l] &amp; ~a[i-2]) continue;\n// \u8fc7\u6ee4\u975e\u6cd5\u7684\u884c\u95f4\u72b6\u6001 \nif(st[j] &amp; st[k]) continue;\nif(st[j] &amp; st[l]) continue;\nif(st[l] &amp; st[k]) continue;\nf[i][j][k] = max(f[i][j][k], f[i-1][k][l] + num[j]);\nans = max(ans, f[i][j][k]);\n}\n}\n}\n}\ncout &lt;&lt; ans &lt;&lt; '\\n';\n}\n</code></pre> <p>\u5982\u679c\u95ee\u9898\u6c42\u7684\u662f\u65b9\u6848\u6570\uff0c\u90a3\u4e48\u6838\u5fc3\u4ee3\u7801\u4e3a</p> <pre><code>cin &gt;&gt; n &gt;&gt; m;\nmm = 1 &lt;&lt; m;\nfor(int i=0; i&lt;mm; ++i){\n// \u5217\u5185\u5408\u6cd5\u6761\u4ef61 \nif(i&lt;&lt;1&amp;i || i&gt;&gt;1&amp;i) continue;\nif(i&lt;&lt;2&amp;i || i&gt;&gt;2&amp;i) continue;\nst[idx] = i, num[idx] = 0;\nfor(int j=i; j; j-=j&amp;-j) ++ num[idx];\n++ idx;\n}\nfor(int i=1; i&lt;=n; ++i){\nfor(int j=0; j&lt;m; ++j){\nchar c;\ncin &gt;&gt; c;\na[i] = 2 * a[i] + (c == 'P');\n}\n}\n// \u521d\u59cb\u5316\nfor(int j=0; j&lt;idx; ++j)\nfor(int k=0; k&lt;idx; ++k){\nif(st[j] &amp; ~a[2]) continue;\nif(st[k] &amp; ~a[1]) continue;\nif(st[j] &amp; st[k]) continue;\nf[2][j][k] = 1;\n}\nfor(int i=3; i&lt;=n; ++i){\nfor(int j=0; j&lt;idx; ++j){\n// st[j] \u4ea4 a[i]\u7684\u8865\u96c6 \u975e\u7a7a \nfor(int k=0; k&lt;idx; ++k){\nfor(int l=0; l&lt;idx; ++l){\nif(st[j] &amp; ~a[i]) continue;\nif(st[k] &amp; ~a[i-1]) continue;\nif(st[l] &amp; ~a[i-2]) continue;\nif(st[j] &amp; st[k]) continue;\nif(st[j] &amp; st[l]) continue;\nif(st[k] &amp; st[l]) continue;\nf[i][j][k] = (f[i][j][k] + f[i-1][k][l]);\n}\n}\n}\n}\nint ans = 0;\nfor(int j=0; j&lt;idx; ++j) for(int k=0; k&lt;idx; ++k) ans += f[n][j][k];\ncout &lt;&lt; ans &lt;&lt; '\\n';\n</code></pre> <ul> <li> <p>P1879 [USACO06NOV]Corn Fields G - \u6d1b\u8c37 | \u8ba1\u7b97\u673a\u79d1\u5b66\u6559\u80b2\u65b0\u751f\u6001 (luogu.com.cn)</p> </li> <li> <p>P2051 [AHOI2009] \u4e2d\u56fd\u8c61\u68cb - \u6d1b\u8c37 | \u8ba1\u7b97\u673a\u79d1\u5b66\u6559\u80b2\u65b0\u751f\u6001 (luogu.com.cn)\uff08\u597d\u9898\uff09</p> </li> </ul> <p>\u9898\u610f\uff1a\\(n\\times m\\) \u77e9\u9635\u653e\u7f6e\u4e92\u4e0d\u653b\u51fb\u7684\u70ae\u7684\u65b9\u6848\u6570</p> <p>\uff08\u9519\u8bef\u7684\u72b6\u6001\u5212\u5206\uff1a \\(f_{i,~~j,~~k}\\)  \u8868\u793a \\(i\\times m\\) \u7684\u77e9\u9635\u4e2d \\(\u7b2cj\u5217\\) \u7684\u70ae\u6570\u4e3a \\(k\\) \u7684\u65b9\u6848\uff08\u56e0\u4e3a \\(f_{i,~~j_1,~~k}\\) \u548c \\(f_{i,~~j_2,~k},j_1\\ne j_2\\) \u4f1a\u6709\u4ea4\u96c6\uff09\uff09</p> <p>\u72b6\u6001\u5b9a\u4e49\uff1a\\(f_{i,~j,~k}\\) \u8868\u793a \\(i\\times m\\) \u7684\u77e9\u9635\u4e2d \u6709 \\(j(\\in 0..m)\\) \u5217\u7684\u70ae\u7684\u603b\u6570\u4e3a2\uff0c\u6709 \\(k(\\in 0..m-j)\\) \u5217\u7684\u70ae\u7684\u603b\u6570\u4e3a1\uff0c\u5219 \u6709 \\(l ~:=~ m-j-k\\) \u5217\u7684\u70ae\u7684\u603b\u6570\u4e3a0</p> <p>\u8bbe\u5143\u7ec4\\((x_2,~x_1,~x_0)\\) \uff08\\(\\sum\\limits_{t=0}^2 x_t\\le 2\\)\uff09\u8868\u793a\u5bf9\u4e8e\u67d0\u4e2a \\(i-1\\times m\\) \u77e9\u9635\uff0c\u53d6\u51fa \\(x_t(t=0..2)\\) \u4e2a\u70ae\u6570\u4e3a \\(i\\) \u7684\u5217\uff0c\u7b2c \\(i\\) \u884c\u7684\u8fd9\u4e9b\u5217\u653e\u7f6e\u6070\u597d \\(x_t\\) \u4e2a\u70ae\uff0c\u6b64\u65f6\u70ae\u6570\u4e3a \\(t\\) \u7684\u5217\u6570 \\(-1\\)\uff0c\u70ae\u6570\u4e3a $ t+1$ \u7684\u5217\u6570 \\(+1\\) </p> <p>\u90a3\u4e48\uff0c\\(f_{i,~~j,~~k}\\) \u53ef\u4ee5\u5206\u4e3a6\u7c7b\uff1a\\((0,~0,~0)\u3001(0,~~1,~~0)\u3001(0,~~0,~~1)\u3001(0,~~1,~~1)\u3001(0,~~2,~~0)\u3001(0,~~0,~~2)\\)</p> <p>\u5206\u522b\u5bf9\u5e94 \\(f_{i-1,~j,~k}\u3001f_{i-1,~~j-1,~~k+1}\u3001f_{i-1,~~j,~~k-1}\u3001f_{i-1,~~j-1,~~k}\u3001f_{i-1,~~j-2,~~k+2}\u3001f_{i-1,~~j,~~k-2}\\)</p> <pre><code>#include&lt;iostream&gt;\nusing namespace std;\n#define int long long\nconst int p = 9999973;\nint n, m;\nint f[2][103][103];\nint c(int n){\nreturn n * (n - 1) / 2 % p;\n}\nsigned main(){\ncin &gt;&gt; n &gt;&gt; m;\nf[0][0][0] = 1;\nfor(int i=1; i&lt;=n; ++i){\nfor(int j=0; j&lt;=m; ++j){\nfor(int k=0; j+k&lt;=m; ++k){\nint l = m - j - k;\n#define f0 f[i &amp; 1][j][k]\n#define f1 f[i-1 &amp; 1]\nf0 = f1[j][k];\nif(j-1 &gt;= 0 &amp;&amp; k+1&lt;=m)\nf0 = (f0 + f1[j-1][k+1] * (k + 1) % p) % p;\nif(k-1 &gt;= 0 &amp;&amp; l+1&lt;=m)\nf0 = (f0 + f1[j][k-1] * (l + 1) % p) % p;\nif(j-1 &gt;= 0 &amp;&amp; l+1&lt;=m)\nf0 = (f0 + f1[j-1][k] * k * (l + 1) % p) % p;\nif(j-2 &gt;= 0 &amp;&amp; k+2&lt;=m)\nf0 = (f0 + f1[j-2][k+2] * c(k + 2) % p) % p;\nif(k-2 &gt;= 0 &amp;&amp; l+2&lt;=m)\nf0 = (f0 + f1[j][k-2] * c(l + 2) % p) % p;\n}\n}\n}\nint ans = 0;\nfor(int j=0; j&lt;=m; ++j){\nfor(int k=0; j+k&lt;=m; ++k){\nans = (ans + f[n &amp; 1][j][k]) % p;\n}\n}\ncout &lt;&lt; ans &lt;&lt; '\\n';\n}\n</code></pre> <ul> <li>#2471. \u300c\u4e5d\u7701\u8054\u8003 2018\u300d\u4e00\u53cc\u6728\u68cb - \u9898\u76ee - LibreOJ (loj.ac)</li> </ul>"},{"location":"oiwiki/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/#8dp","title":"8\uff0c\u6570\u4f4ddp\uff08\u5f85\u8865\uff09","text":"<ul> <li>1\uff09Luogu P2602 \u6570\u5b57\u8ba1\u6570</li> </ul> <p>\uff08\u5c5e\u6027\u8ba1\u6570\uff09</p> <p>\u6c42\\([lb,~ub]\\) \u4e2d\u5404\u4f4d\u6570\u5b57\u51fa\u73b0\u7684\u6b21\u6570</p> <p>\u8bb0 \\(f_i\\) \u4e3a\u524d \\(i\\) \u4f4d\u7684\u6240\u6709\u5341\u8fdb\u5236\u6570\u4e2d\uff0c\u5404\u4f4d\u6570\\((0~..~9)\\)\u51fa\u73b0\u7684\u6b21\u6570\uff0c</p> <p>\u6613\u5f97 \\(f_i~=~10^{i-1} + f_{i-1}\\times 10\\)</p> <p>\uff08\u8bb0 \\(a_i(\\le 9)\\) \u4e3a\u7b2c \\(i(i\\ge 1)\\) \u4f4d\u7684\u6570\u5b57\uff1b\u786e\u5b9a \\(a_i\\) \u4e3a\u4efb\u610f\u6570\u65f6\uff0c\u7b2c \\(i\\) \u4f4d\u8d21\u732e\u4e3a\\(10^{i-1}\\)\uff1b\\(a_i=0..9\\) \u65f6\uff0c\u524d\\(i-1\\) \u4f4d \u7684\u8d21\u732e\u4e3a \\(10\\times f_{i-1}\\)\uff09</p> <pre><code>#define int long long\nconst int N = 15;\nint f[N], mi[N];\nvoid init(){\nmi[0] = 1;\nfor(int i=1; i&lt;N; ++i){\nf[i] = 10 * f[i-1] + mi[i-1];\nmi[i] = mi[i-1] * 10;\n}\n}\nint len, a[N], ans[N], ans1[N];\nvoid get(int n, int ans[]){\nint s = n;\nfor(len = 0; n; n /= 10) a[ ++ len] = n % 10;\nfor(int i=len; i&gt;=1; --i){\nfor(int j=0; j&lt;10; ++j) ans[j] += a[i] * f[i-1];\nfor(int j=0; j&lt;a[i]; ++j) ans[j] += mi[i-1];\ns -= a[i] * mi[i-1], ans[a[i]] += s + 1;\nans[0] -= mi[i-1];\n}\n}\n</code></pre> <ul> <li>2\uff09hdu 2089 \u4e0d\u898162</li> </ul> <p>\uff08\u9650\u5236\u8ba1\u6570\uff09</p> <p>\u7edf\u8ba1 \\([lb,~ub]\\) \u5185\u4e0d\u80fd\u6709 \u201c\u5b50\u4e32\u201d \u201c62\u201d\u6216 \u201c4\u201d\u7684\u6570\u7684\u4e2a\u6570</p> <p>\u8be5\u9898\u6d89\u53ca\u5230\u76f8\u90bb\u4f4d\uff0c\u7528\u5982\u4e0b\u65b9\u6cd5\u53ef\u4ee5\u201c\u66b4\u529b\u201d\u89e3\u51b3\uff08\u4f46\u662f\u5e38\u6570\u4e3a \\(100\\)\uff09</p> <pre><code>#define int long long\nconst int N = 15;\nint f[N][10], g[N], mi[N];\nvoid init(){\nf[0][0] = 1; for(int i=1; i&lt;N; ++i){\nint s = 0;\nfor(int j=0; j&lt;10; ++j){\nif(j==4) continue;\nfor(int k=0; k&lt;10; ++k){\nif(k==4) continue;\nif(j==6&amp;&amp;k==2) continue;\nf[i][j] += f[i-1][k];\n}\ns += f[i][j];\n}\ng[i] = s;\n}\n}\nint get(int n){\n//    if(n==-1) return 0;\nint ans = 0;\nint len, a[N] = {};\nfor(len = 0; n; n/=10) a[ ++ len] = n % 10;\nfor(int i=len; i&gt;=1; --i){\nfor(int j=0; j&lt;a[i]; ++j){\nif(j==4 || a[i+1]==6 &amp;&amp; j==2) continue;\nans += f[i][j];\n}\nif(a[i]==4 || a[i+1]==6&amp;&amp;a[i]==2) break;\n}\nreturn ans;\n}\n</code></pre> <p>\u66f4\u4f18\u7b97\u6cd5\uff1a\u6570\u4f4d DP - OI Wiki (oi-wiki.org)</p> <ul> <li>3\uff09SCOI2009 windy \u6570</li> </ul>"},{"location":"oiwiki/%E5%8D%95%E8%B0%83%E6%A0%88%26%E5%8D%95%E8%B0%83%E9%98%9F%E5%88%97/","title":"\u5355\u8c03\u6808&\u5355\u8c03\u961f\u5217","text":"<pre><code>int ans = 0;\nt = 0;\nfor(int i=1; i&lt;=n; ++i){\nif(!a[i]){\nt = 0;\ncontinue;\n}\n// \u521b\u9020\u975e\u4e25\u683c\u5347\u5e8f \nfor(; t &amp;&amp; st[t] &gt; a[i]; -- t);\n// \u4fdd\u8bc1 a_i \u5165\u6808\u540e\uff0c\u4fdd\u6301\u4e25\u683c\u5347\u5e8f \nif((!t || t &amp;&amp; st[t] &lt; a[i])) ++ans, st[ ++ t] = a[i];\n}\n</code></pre> <p>\u4e25\u683c\u964d\u5e8f \\(for(;~t~\\&amp;\\&amp;~f_{st[t]}\\le w;~--t)\\)</p> <p>\u975e\u4e25\u683c\u964d\u5e8f \\(for(;~~t~~\\&amp;\\&amp;~~f_{st[t]} &lt; w;~~--t)\\)</p>"},{"location":"oiwiki/%E5%8D%95%E8%B0%83%E6%A0%88%26%E5%8D%95%E8%B0%83%E9%98%9F%E5%88%97/#a-a_n-displaystyle-sum_i1nmin_jia_ja_ij-i1","title":"A\uff0c\u7ed9\u5b9a\u4e00\u4e2a\u6570\u5217 \\(\\{a_n\\}\\)\uff0c\u6c42 \\(\\displaystyle \\sum_{i=1}^n(\\min_{j&gt;i,~a_j&gt;a_i}\\{j\\}-i+1)\\)","text":"<p>\uff08\u8bbe \\(a_{n+1}=inf\\)\uff09</p> <p>POJ - 3250</p> <pre><code>#include&lt;iostream&gt;\nusing namespace std;\nconst int N = 4e6+3;\nint a[N], n;\nint st[N], t;\nsigned main(){\ncin &gt;&gt; n;\nfor(int i=1; i&lt;=n; ++i) scanf(\"%d\", &amp;a[i]);\nlong long ans = 0;\nt = 0;\nfor(int i=1; i&lt;=n; ++i){\nfor(; t &amp;&amp; st[t] &lt;= a[i]; -- t);\nans += t;\nst[ ++ t] = a[i];\n}\ncout &lt;&lt; ans &lt;&lt; '\\n';\n}\n</code></pre> <pre><code>#include&lt;iostream&gt;\nusing namespace std;\nconst int N = 8e4+3;\nint a[N], n;\nint st[N], t;\nsigned main(){\ncin &gt;&gt; n;\nfor(int i=1; i&lt;=n; ++i) scanf(\"%d\", &amp;a[i]);\nlong long ans = 0;\nt = 0;\nfor(int i=1; i&lt;=n; ++i){\nfor(; t &amp;&amp; a[st[t]] &lt;= a[i]; -- t) ans += abs(st[t] - i) - 1, printf(\" %d %d %d\\n\", st[t], i, abs(st[t] - i) - 1);\nst[ ++ t] = i;\n}\nfor(; t; --t) ans += n - st[t];\ncout &lt;&lt; ans &lt;&lt; '\\n';\n}\n</code></pre>"},{"location":"oiwiki/%E5%8D%95%E8%B0%83%E6%A0%88%26%E5%8D%95%E8%B0%83%E9%98%9F%E5%88%97/#b-a_nb_n-a_i-a_i-j-b_i","title":"B\uff0c\u7ed9\u5b9a \\(\\{a_n\\},~\\{b_n\\}\\)\uff0c\u5176\u4e2d \\(a_i\\) \u5bf9\u4e24\u4fa7\u6700\u8fd1\u4e14 \u503c\u5927\u4e8e \\(a_i\\) \u7684\u4f4d\u7f6e \\(j\\) \u4e0a\u7684\u8d21\u732e\u662f \\(b_i\\)\uff0c\u6c42\u6bcf\u4e2a\u4f4d\u7f6e\u4e0a\u6240\u5f97\u8d21\u732e\u503c\u7684\u6700\u5927\u503c","text":"<p>P1901</p>"},{"location":"oiwiki/%E5%8D%95%E8%B0%83%E6%A0%88%26%E5%8D%95%E8%B0%83%E9%98%9F%E5%88%97/#c","title":"C\uff0c\u6ed1\u52a8\u7a97\u53e3\u6700\u5927\u503c+\u6700\u5c0f\u503c","text":"<p>Sliding Window - POJ 2823 - Virtual Judge (csgrandeur.cn)</p> <p>POJ2823</p> <pre><code>#include&lt;iostream&gt;\nusing namespace std;\nconst int N = 1e6+3;\nint a[N], n;\nint st[N], s, t;\nsigned main(){\nint k;\ncin &gt;&gt; n &gt;&gt; k;\nfor(int i=1; i&lt;=n; ++i) scanf(\"%d\", &amp;a[i]);\ns = 1, t = 0;\nfor(int i=1; i&lt;k; ++i){\nfor(; s&lt;=t &amp;&amp; a[st[t]] &gt;= a[i]; --t);\nst[ ++ t] = i;\n}\nfor(int i=k; i&lt;=n; ++i){\nfor(; s&lt;=t &amp;&amp; a[st[t]] &gt;= a[i]; --t);\nst[ ++ t] = i;\nfor(; st[s] &lt;= i-k; ++s);\nprintf(\"%d \", a[st[s]]);\n}\nputs(\"\");\ns = 1, t = 0;\nfor(int i=1; i&lt;k; ++i){\nfor(; s&lt;=t &amp;&amp; a[st[t]] &lt;= a[i]; --t);\nst[ ++ t] = i;    }\nfor(int i=k; i&lt;=n; ++i){\nfor(; s&lt;=t &amp;&amp; a[st[t]] &lt;= a[i]; --t);\nst[ ++ t] = i;\nfor(; st[s] &lt;= i-k; ++s);\nprintf(\"%d \", a[st[s]]);\n}\nputs(\"\");\n}\n</code></pre>"},{"location":"oiwiki/%E5%8D%95%E8%B0%83%E6%A0%88%26%E5%8D%95%E8%B0%83%E9%98%9F%E5%88%97/#d","title":"D\uff0c","text":"<p>Flowerpot S - \u6d1b\u8c37 P2698 - Virtual Judge (csgrandeur.cn)</p> <p>P2698</p> <pre><code>#include&lt;iostream&gt;\n#include&lt;algorithm&gt;\nusing namespace std;\nconst int N = 1e5+3;\nint n, d;\nstruct nd{\nint x, y;\nbool operator&lt;(nd t){ return x&lt;t.x; }\n}a[N];\nint st[N], s, t;\nint st1[N], s1, t1;\nsigned main(){\ncin &gt;&gt; n &gt;&gt; d;\nfor(int i=1; i&lt;=n; ++i) scanf(\"%d%d\", &amp;a[i].x, &amp;a[i].y);\nsort(a+1, a+n+1);\nint ans = 2e9, L = 1;\ns = 1, t = 0;\ns1 = 1, t1 = 0;\nfor(int i=1; i&lt;=n; ++i){\nfor(; s&lt;=t &amp;&amp; a[st[t]].y &lt; a[i].y; -- t);\nst[ ++ t] = i;\nfor(; s1&lt;=t1 &amp;&amp; a[st1[t1]].y &gt; a[i].y; -- t1);\nst1[ ++ t1] = i;\nwhile(L &lt;= i &amp;&amp; a[st[s]].y - a[st1[s1]].y &gt;= d){\nans = min(ans, a[i].x - a[L].x);\n++ L;\nfor(; s&lt;=t &amp;&amp; st[s] &lt; L; ++s);\nfor(; s1&lt;=t1 &amp;&amp; st1[s1] &lt; L; ++s1);\n}\n}\nif(ans &lt; 2e9) cout &lt;&lt; ans &lt;&lt; '\\n';\nelse puts(\"-1\");\n}\n</code></pre>"},{"location":"oiwiki/%E5%9B%BE%E8%AE%BA/","title":"\u56fe\u8bba","text":""},{"location":"oiwiki/%E5%9B%BE%E8%AE%BA/#1","title":"1\uff0c\u56fe\u8bba\u6982\u5ff5\uff08\u5f85\u8865\uff09","text":"<p>\u56fe\u8bba (Graph theory)\u00a0\u662f\u6570\u5b66\u7684\u4e00\u4e2a\u5206\u652f\uff0c\u56fe\u662f\u56fe\u8bba\u7684\u4e3b\u8981\u7814\u7a76\u5bf9\u8c61\u3002\u56fe (Graph)\u00a0\u662f\u7531\u82e5\u5e72\u7ed9\u5b9a\u7684\u9876\u70b9\u53ca\u8fde\u63a5\u4e24\u9876\u70b9\u7684\u8fb9\u6240\u6784\u6210\u7684\u56fe\u5f62\uff0c\u8fd9\u79cd\u56fe\u5f62\u901a\u5e38\u7528\u6765\u63cf\u8ff0\u67d0\u4e9b\u4e8b\u7269\u4e4b\u95f4\u7684\u67d0\u79cd\u7279\u5b9a\u5173\u7cfb\u3002\u9876\u70b9\u7528\u4e8e\u4ee3\u8868\u4e8b\u7269\uff0c\u8fde\u63a5\u4e24\u9876\u70b9\u7684\u8fb9\u5219\u7528\u4e8e\u8868\u793a\u4e24\u4e2a\u4e8b\u7269\u95f4\u5177\u6709\u8fd9\u79cd\u5173\u7cfb\u3002</p>"},{"location":"oiwiki/%E5%9B%BE%E8%AE%BA/#1_1","title":"1\uff0c\u56fe","text":"<ul> <li> <ul> <li>\u65e0\u5411\u56fe\u3001\u6709\u5411\u56fe\u3001\u6df7\u5408\u56fe\uff1b\u8d4b\u6743\u56fe\u3001\u6b63\u6743\u56fe</li> </ul> </li> </ul> <ul> <li> <ul> <li>\u9636</li> </ul> </li> </ul>"},{"location":"oiwiki/%E5%9B%BE%E8%AE%BA/#2-neighborhood","title":"2\uff0c\u76f8\u90bb\u3001\u90bb\u57df( \\(neighborhood\\) )","text":""},{"location":"oiwiki/%E5%9B%BE%E8%AE%BA/#3","title":"3\uff0c\u5ea6\u6570","text":"<ul> <li> <ul> <li>\u63e1\u624b\u5b9a\u7406/\u56fe\u8bba\u57fa\u672c\u5b9a\u7406  \u53ca\u5176 \u63a8\u8bba</li> </ul> </li> </ul> <ul> <li> <ul> <li>\u5b64\u7acb\u70b9\u3001\u53f6\u8282\u70b9/\u60ac\u6302\u70b9\u3001\u5076\u70b9\u3001\u5947\u70b9\u3001\u652f\u914d\u70b9</li> </ul> </li> </ul> <ul> <li> <ul> <li>\u6700\u5c0f\u5ea6 \\(\\delta_G\\)\u3001\u6700\u5927\u5ea6 \\(\\Delta_G\\)</li> </ul> </li> </ul> <ul> <li> <ul> <li>\u51fa\u5ea6 \\(d^+_v\\) \u3001\u5165\u5ea6 \\(d^-_v\\) </li> </ul> </li> </ul> <ul> <li> <ul> <li>k-\u6b63\u5219\u56fe</li> </ul> </li> </ul> <ul> <li> <ul> <li>\u53ef\u56fe\u5316\u3001\u53ef\u7b80\u5355\u56fe\u5316</li> </ul> </li> </ul>"},{"location":"oiwiki/%E5%9B%BE%E8%AE%BA/#4","title":"4\uff0c\u7b80\u5355\u56fe\u3001\u591a\u91cd\u56fe","text":""},{"location":"oiwiki/%E5%9B%BE%E8%AE%BA/#5-walk-trail-path-circuit-cyclesimplecircuits","title":"5\uff0c\u9014\u5f84 \\(walk\\)\u3001\u8ff9 \\(trail\\)\u3001\u8def\u5f84 \\(path\\)\u3001\u56de\u8def \\(circuit\\)\u3001\u73af/\u5708 \\(cycle/simple~circuits\\)","text":""},{"location":"oiwiki/%E5%9B%BE%E8%AE%BA/#6","title":"6\uff0c\u5b50\u56fe","text":""},{"location":"oiwiki/%E5%9B%BE%E8%AE%BA/#7","title":"7\uff0c","text":""},{"location":"oiwiki/%E5%9B%BE%E8%AE%BA/#2","title":"2\uff0c\u5b58\u50a8","text":"<ul> <li> <p>1\uff0c\u76f4\u63a5\u5b58\u8fb9</p> </li> <li> <ul> <li>\u7a7a\u95f4\uff1a\\(O(m)\\)</li> </ul> </li> <li> <ul> <li>\u67e5\u8be2\u8fb9\uff1a\\(O(m)\\)</li> </ul> </li> <li> <ul> <li>\u904d\u5386\u67d0\u70b9\u7684\u51fa\u8fb9\uff1a\\(O(m)\\)</li> </ul> </li> <li> <ul> <li>\u904d\u5386\u56fe\uff1a\\(O(n\\times m)\\)</li> </ul> </li> </ul> <pre><code>#include&lt;bits/stdc++.h&gt;\nusing namespace std;\nint n, m;\n// \u8fb9\u5c5e\u6027 \nstruct edge{ int u, v, w; };\nvector&lt;edge&gt; e;\n// \u70b9\u5c5e\u6027 \nvector&lt;bool&gt; st;\nbool find(int u, int v){\nfor(int i=1; i&lt;=m; ++i){\nif(e[i].u == u &amp;&amp; e[i].v == v) return true;\n}\nreturn false;\n}\nvoid dfs(int u){\nif(st[u]) return ;\nst[u] = true;\nfor(int i=1; i&lt;=m; ++i){\nif(e[i].u != u) continue;\ndfs(e[i].v);\n}\n}\nsigned main(){\ncin &gt;&gt; n &gt;&gt; m;\ne.resize(m + 1);\nst.resize(n + 1, false);\nfor(int i=1; i&lt;=m; ++i) cin &gt;&gt; e[i].u &gt;&gt; e[i].v;\n}\n</code></pre> <p>\u5206\u6790\uff1a 1\uff0c\u76f4\u63a5\u5b58\u8fb9\u7684\u904d\u5386\u6548\u7387\u4f4e\u4e0b\uff0c\u4e00\u822c\u4e0d\u7528\u4e8e\u904d\u5386\u56fe</p> <p>2\uff0c\u7528\u4e8e Kruskal\uff0c\u5bf9\u8fb9\u6309\u8fb9\u6743\u6392\u5e8f</p> <p></p> <ul> <li>2\uff0c\u90bb\u63a5\u77e9\u9635</li> </ul> <p></p> <ul> <li> <ul> <li>\u7a7a\u95f4\uff1a\\(O(n^2)\\)</li> </ul> </li> <li> <ul> <li>\u67e5\u8be2\u8fb9\uff1a\\(O(1)\\)</li> </ul> </li> <li> <ul> <li>\u904d\u5386\u67d0\u70b9\u7684\u51fa\u8fb9\uff1a\\(O(n)\\)</li> </ul> </li> <li> <ul> <li>\u904d\u5386\u56fe\uff1a\\(O(n^2)\\)</li> </ul> </li> </ul> <pre><code>#include&lt;bits/stdc++.h&gt;\nusing namespace std;\nint n, m;\nvector&lt;bool&gt; st;\nvector&lt;vector&lt;bool&gt; &gt; g;\nbool find(int u, int v){ return g[u][v]; }\nvoid dfs(int u){\nif(st[u]) return ;\nst[u] = true;\nfor(int v=1; v&lt;=n; ++v){\nif(!g[u][v]) continue;\ndfs(v);\n}\n}\nsigned main(){\ncin &gt;&gt; n &gt;&gt; m;\ng.resize(n + 1, vector&lt;bool&gt;(n + 1, false));\nst.resize(n + 1, false);\nfor(int i=1; i&lt;=m; ++i){\nint u, v;\ncin &gt;&gt; u &gt;&gt; v;\ng[u][v] = true;\n}\n}\n</code></pre> <p>\u5206\u6790\uff1a 1\uff0c\u90bb\u63a5\u77e9\u9635\u53ea\u9002\u7528\u4e8e\u65e0\u91cd\u8fb9\uff08\u6216\u53ef\u5ffd\u7565\u91cd\u8fb9\uff09\u7684\u60c5\u51b5</p> <p>2\uff0c\u67e5\u8be2\u8fb9\u9ad8\u6548</p> <p>3\uff0c\u53ea\u9002\u7528\u4e8e\u7a20\u5bc6\u56fe\uff08\u975e\u5e38\u5c11\u7528\uff09</p> <ul> <li>3\uff0c\u90bb\u63a5\u8868</li> </ul> <p></p> <p>\uff08\u5229\u75282\u7ef4\u7684\u52a8\u6001\u6570\u7ec4\u5b58\u8fb9\u7684\u4fe1\u606f\uff09</p> <ul> <li> <ul> <li>\u7a7a\u95f4\uff1a\\(O(m)\\)</li> </ul> </li> <li> <ul> <li>\u67e5\u8be2\u8fb9\uff1a\\(O(log(d^+_{u}))\\) \uff08\u53ef\u4ee5\u4e8b\u5148\u5bf9\u8be5\u70b9\u7684\u51fa\u8fb9\u6392\u5e8f\uff0c \u7136\u540e\u518d\u4e8c\u5206\u67e5\u8be2\uff09</li> </ul> </li> <li> <ul> <li>\u904d\u5386\u51fa\u8fb9\uff1a\\(O(d^+_{u})\\)</li> </ul> </li> <li> <ul> <li>\u904d\u5386\u56fe\uff1a\\(O(n+m)\\)</li> </ul> </li> </ul> <pre><code>#include&lt;bits/stdc++.h&gt;\nusing namespace std;\nint n, m;\nvector&lt;bool&gt; st;\nvector&lt;vector&lt;int&gt; &gt; g;\nbool find(int u, int v){\nfor(int i=0; i&lt;g[u].size(); ++i){\nif(g[u][i] == v) return true;\n}\nreturn false;\n}\nvoid dfs(int u){\nif(st[u]) return ;\nst[u] = true;\nfor(int i=0; i&lt;g[u].size(); ++i){\ndfs(g[u][i]);\n}\n}\nsigned main(){\ncin &gt;&gt; n &gt;&gt; m;\nst.resize(n + 1, false);\ng.resize(n + 1);\nfor(int i=1; i&lt;=m; ++i){\nint u, v;\ncin &gt;&gt; u &gt;&gt; v;\ng[u].push_back(v);\n}\n}\n</code></pre> <p>\u52a0\u5f3a\u7248\uff1a\u652f\u6301\u52a8\u6001 \u5220\u8fb9 \u6216 \u5220\u70b9 \u7684\u90bb\u63a5\u8868</p> <p>1\uff09\u5220\u8fb9\uff08\u65e0\u5411\u8fb9\u6216\u6709\u5411\u8fb9\uff09\uff1a\u5982\u679c\u7a7a\u95f4\u4e0d\u5141\u8bb8\uff0c\u5219\u7528 \\(set\\) \u727a\u7272\u4e00\u70b9\u65f6\u95f4\u6765\u7ef4\u62a4\u51fa\u8fb9\u4fe1\u606f\uff0c\u5426\u5219\u7528\u54c8\u5e0c</p> <p>\uff08\u5982\u679c\u8fb9\u4e0a\u53ea\u7528\u5b58\u51fa\u70b9\u7684\u4fe1\u606f\uff0c\u5c31\u4e0d\u9700\u8981\u91cd\u8f7d\u8fd0\u7b97\u7b26 \\(&lt;\\) \u4e86\uff0c\u5426\u5219\uff08\u9700\u8981\u7528\u5230\u8fb9\u6743\u4fe1\u606f\u7b49\uff09\u5c31\u9700\u8981\u91cd\u8f7d\uff09</p> <p>2\uff09\u5220\u70b9\uff1a\u54c8\u5e0c\u5373\u53ef</p> <pre><code>const int N = 1e5+3;\nint n, m;\nint st[N];\nstruct edge{\nint v, w;\nbool operator&lt;(const edge&amp;t)const{ return v&lt;t.v; }\n};\nvector&lt;set&lt;edge&gt;&gt; e;\nvoid add(int u, int v, int w){\ne[u].insert({v, w});\n}\nvoid erase(int u, int v){\ne[u].erase({v, 0}), e[v].erase({u, 0});\n//  \u54c8\u5e0c\u65b9\u6cd5\u4e5f\u53ef\u4ee5 \n//    st[u][v] = st[v][u] = false;\n}\nvoid erase(int u){\nst[u] = false;\n}\n</code></pre> <p>\u5206\u6790\uff1a</p> <p>1\uff0c\u5b58\u5404\u79cd\u56fe\u90fd\u5f88\u9002\u5408\uff0c\u9664\u975e\u6709\u7279\u6b8a\u9700\u6c42\uff08\u5982\u9700\u8981\u5feb\u901f\u67e5\u8be2\u4e00\u6761\u8fb9\u662f\u5426\u5b58\u5728\uff0c\u4e14\u70b9\u6570\u8f83\u5c11\uff0c\u53ef\u4ee5\u4f7f\u7528\u90bb\u63a5\u77e9\u9635\uff09</p> <p>2\uff0c\u5c24\u5176\u9002\u7528\u4e8e\u9700\u8981\u5bf9\u4e00\u4e2a\u70b9\u7684\u6240\u6709\u51fa\u8fb9\u8fdb\u884c\u6392\u5e8f\u7684\u573a\u5408</p> <ul> <li>4\uff0c\u94fe\u5f0f\u524d\u5411\u661f</li> </ul> <p>\u672c\u8d28\u4e0a\u662f\u7528\u94fe\u8868\u5b9e\u73b0\u7684\u90bb\u63a5\u8868</p> <p>\uff08\u94fe\u8868\u5b58\u8fb9\u7684\u4fe1\u606f\uff09</p> <ul> <li> <ul> <li>\u7a7a\u95f4\uff1a\\(O(m)\\)</li> </ul> </li> <li> <ul> <li>\u67e5\u8be2\u8fb9\uff1a\\(O(d^+_u)\\)</li> </ul> </li> <li> <ul> <li>\u904d\u5386\u67d0\u70b9\u7684\u51fa\u8fb9\uff1a\\(O(d^+_u)\\)</li> </ul> </li> <li> <ul> <li>\u904d\u5386\u56fe\uff1a\\(O(n+m)\\)</li> </ul> </li> </ul> <pre><code>#include&lt;bits/stdc++.h&gt;\nusing namespace std;\n// \u8fd9\u91cc\u7684 n \u7684\u4f5c\u7528\u8c61\u5f81\u6027\u7684\u662f\u544a\u8bc9\u4f60\u6709\u591a\u5c11\u4e2a\u70b9\uff0c\u5f88\u591a\u64cd\u4f5c\u90fd\u4e0d\u9700\u8981\u7528\u5230 n\nint n, m;\n// \u70b9\u5c5e\u6027 \nvector&lt;bool&gt; st;\nvector&lt;int&gt; h;\n// \u8fb9\u5c5e\u6027 \nstruct edge{ int ne, v; };\nvector&lt;edge&gt; e;\nvoid add(int u, int v){\ne.push_back({h[u], v});\nh[u] = e.size() - 1;\n}\nbool find(int u, int v){\nfor(int i=h[u]; i; i=e[i].ne){\nif(e[i].v == v) return true;\n}\nreturn false;\n}\nvoid dfs(int u){\nif(st[u]) return ;\nst[u] = true;\nfor(int i=h[u]; i; i=e[i].ne){\ndfs(e[i].v);\n}\n}\nsigned main(){\ncin &gt;&gt; n &gt;&gt; m;\nst.resize(n + 1, false);\nh.resize(n + 1, 0);\nfor(int i=1; i&lt;=m; ++i){\nint u, v;\ncin &gt;&gt; u &gt;&gt; v;\nadd(u, v);\n}\n}\n</code></pre> <p>\u5206\u6790\uff1a 1\uff0c\u5b58\u5404\u79cd\u56fe\u90fd\u5f88\u9002\u5408\uff0c\u4f46\u4e0d\u80fd\u5feb\u901f\u67e5\u8be2\u4e00\u6761\u8fb9\u662f\u5426\u5b58\u5728\uff0c\u4e5f\u4e0d\u80fd\u65b9\u4fbf\u5730\u5bf9\u4e00\u4e2a\u70b9\u7684\u51fa\u8fb9\u8fdb\u884c\u6392\u5e8f</p> <p>2\uff0c\u4f18\u70b9\u662f\u8fb9\u662f\u5e26\u7f16\u53f7\u7684\uff0c\u6709\u65f6\u4f1a\u975e\u5e38\u6709\u7528\uff0c\u800c\u4e14\u5982\u679c <code>cnt</code> \u7684\u521d\u59cb\u503c\u4e3a\u5947\u6570\uff0c\u5b58\u53cc\u5411\u8fb9\u65f6 <code>i ^ 1</code> \u5373\u662f <code>i</code> \u7684\u53cd\u8fb9\uff08\u5e38\u7528\u4e8e \u7f51\u7edc\u6d41\uff09</p>"},{"location":"oiwiki/%E5%9B%BE%E8%AE%BA/#3dfs","title":"3\uff0cDFS\uff08\u56fe\u8bba\uff09","text":"<p>\u8be5\u7b97\u6cd5\u8bb2\u89e3\u65f6\u5e38\u5e38\u4e0e BFS \u5e76\u5217\uff0c\u4f46\u4e24\u8005\u9664\u4e86\u90fd\u80fd\u904d\u5386\u56fe\u7684\u8fde\u901a\u5757\u4ee5\u5916\uff0c\u7528\u9014\u5b8c\u5168\u4e0d\u540c\uff0c\u5f88\u5c11\u6709\u80fd\u6df7\u7528\u4e24\u79cd\u7b97\u6cd5\u7684\u60c5\u51b5</p> <p></p> <p></p> <ul> <li>\\(dfs\\) \u5e8f\u5217</li> </ul> <p></p> <ul> <li>\u62ec\u53f7\u5e8f\u5217</li> </ul> <p></p> <ul> <li>\u4e00\u822c\u56fe\u4e0a\u7684 \\(dfs\\)</li> </ul> <p>\u5bf9\u4e8e\u975e\u8fde\u901a\u56fe\uff0c\u53ea\u80fd\u8bbf\u95ee\u5230\u8d77\u70b9\u6240\u5728\u7684\u8fde\u901a\u5206\u91cf\u3002</p> <p>\u5bf9\u4e8e\u8fde\u901a\u56fe\uff0cDFS \u5e8f\u5217\u901a\u5e38\u4e0d\u552f\u4e00\u3002</p> <p>\uff08\u6811\u7684 DFS \u5e8f\u5217\u4e5f\u662f\u4e0d\u552f\u4e00\u7684\uff09</p> <p>\u5728 DFS \u8fc7\u7a0b\u4e2d\uff0c\u901a\u8fc7\u8bb0\u5f55\u6bcf\u4e2a\u8282\u70b9\u4ece\u54ea\u4e2a\u70b9\u8bbf\u95ee\u800c\u6765\uff0c\u53ef\u4ee5\u5efa\u7acb\u4e00\u4e2a\u6811\u7ed3\u6784\uff0c\u79f0\u4e3a DFS \u6811\u3002DFS \u6811\u662f\u539f\u56fe\u7684\u4e00\u4e2a\u751f\u6210\u6811</p> <p>DFS \u6811 \u6709\u5f88\u591a\u6027\u8d28\uff0c\u6bd4\u5982\u53ef\u4ee5\u7528\u6765\u6c42 \u5f3a\u8fde\u901a\u5206\u91cf</p> <pre><code>void dfs(int u){\nif(st[u]) return ;\nst[u] = true;\n//    \u6253\u5370 dfs\u5e8f\u5217 \n//    cout &lt;&lt; u &lt;&lt; ' ';\n//    \u6253\u5370\u62ec\u53f7\u5e8f\u5217 \n//    cout &lt;&lt; '(';\nfor(int i=h[u]; i; i=e[i].ne){\ndfs(e[i].v);\n}\n//    cout &lt;&lt; ')';\n}\n</code></pre>"},{"location":"oiwiki/%E5%9B%BE%E8%AE%BA/#4bfs","title":"4\uff0cBFS\uff08\u56fe\u8bba\uff09","text":"<pre><code>int d[N], p[N];\nqueue&lt;int&gt; q;\nvoid bfs(int u){\nwhile(!q.empty()) q.pop();\nq.push(u);\nst[u] = true, d[u] = 0, p[u] = -1;\nwhile(q.size()){\nu = q.front(), q.pop();\nfor(int i=h[u]; i; i=e[i].ne){\nint v = e[i].v;\nif(st[v]) continue;\nq.push(v);\nst[v] = true, d[v] = d[u] + 1, p[v] = u;\n}\n}\n}\nvoid restore(int x){\nvector&lt;int&gt; res;\nfor(int v=x; ~v; v=p[v]) res.push_back(v);\nreverse(res.begin(), res.end());\nfor(int i=0; i&lt;res.size(); ++i) cout &lt;&lt; res[i];\ncout &lt;&lt; '\\n';\n}\n</code></pre> <ul> <li>1\uff0c\\(open-closed\\) \u8868</li> </ul> <ul> <li> <p>2\uff0c\u5728\u6811/\u56fe\u4e0a BFS</p> </li> <li> <ul> <li>BFS \u5e8f\u5217</li> </ul> </li> </ul> <p></p> <ul> <li> <ul> <li>\u4e00\u822c\u56fe\u4e0a\u7684 BFS</li> </ul> </li> </ul> <p></p> <p></p> <ul> <li> <p>3\uff0c\u5e94\u7528</p> </li> <li></li> <li> <p>4\uff0c\u53cc\u7aef\u961f\u5217 BFS\uff08\\(0-1~BFS\\)\uff09</p> </li> <li> <ul> <li>\u4f7f\u7528\u8303\u56f4</li> </ul> </li> </ul> <p></p> <p></p> <p>\uff08\u8fd9\u4e2a\u4f8b\u5b50\u4e0d\u592a\u597d\u7406\u89e3\uff1f\uff09</p> <ul> <li> <ul> <li>\u4f2a\u4ee3\u7801</li> </ul> </li> </ul> <p>\u4e00\u822c\u60c5\u51b5\u4e0b\uff0c\u6211\u4eec\u628a\u6ca1\u6709\u6743\u503c\u7684\u8fb9\u6269\u5c55\u5230\u7684\u70b9\u653e\u5230\u961f\u9996\uff0c\u6709\u6743\u503c\u7684\u8fb9\u6269\u5c55\u5230\u7684\u70b9\u653e\u5230\u961f\u5c3e\u3002\u8fd9\u6837\u5373\u53ef\u4fdd\u8bc1\u50cf\u666e\u901a BFS \u4e00\u6837\u6574\u4e2a\u961f\u5217\u961f\u9996\u5230\u961f\u5c3e\u6743\u503c\u5355\u8c03\u4e0d\u4e0b\u964d</p> <pre><code>while (\u961f\u5217\u4e0d\u4e3a\u7a7a) {\nint u = \u961f\u9996;\n\u5f39\u51fa\u961f\u9996;\nfor (\u679a\u4e3e u \u7684\u90bb\u5c45) {\n\u66f4\u65b0\u6570\u636e\nif (...)\n\u6dfb\u52a0\u5230\u961f\u9996;\nelse\n\u6dfb\u52a0\u5230\u961f\u5c3e;\n}\n}\n</code></pre> <p>Problem - 173B - Codeforces</p> <p></p> <p>\uff08\u8fd9\u9053\u9898\u7684\u6b63\u89e3\u4e0d\u662f \\(0-1BFS\\)\uff0c\u4f46\u4e5f\u53ef\u4ee5\u505a\uff0c\u662f\u633a\u597d\u7684\u6a21\u677f\u9898\uff01\uff09</p> <p>\uff08basilisk\uff09</p> <pre><code>#include&lt;bits/stdc++.h&gt;\nusing namespace std;\nconst int N = 1e3+3;\nchar g[N][N];\nint n, m;\n// \u8fb9\u5316\u4e3a\u70b9 \nint f[N][N][4];\nint dx[] = {0, 0, -1, 1}, dy[] = {1, -1, 0, 0};\ndeque&lt;int&gt; q;\n// \u5165\u961f\u51fd\u6570\u5316\uff0c\u63d0\u9ad8\u53ef\u8bfb\u6027\nvoid front(int x, int y, int dir, int d){\nif(x &lt; 0 || x &gt;= n || y &lt; 0 || y &gt;= m) return ;\nif(f[x][y][dir] &lt;= d) return ;\nf[x][y][dir] = d;\nq.push_front(dir);\nq.push_front(y);\nq.push_front(x);\n}\nvoid back(int x, int y, int dir, int d){\nif(x &lt; 0 || x &gt;= n || y &lt; 0 || y &gt;= m) return ;\nif(f[x][y][dir] &lt;= d) return ;\nf[x][y][dir] = d;\nq.push_back(x);\nq.push_back(y);\nq.push_back(dir);\n}\nint bfs(){\nmemset(f, 0x3f, sizeof f);\nfront(0, 0, 0, 0);\nwhile(q.size()){\nint x = q[0], y = q[1], dir = q[2];\nq.pop_front();\nq.pop_front();\nq.pop_front();\nint d = f[x][y][dir];\nfor(int ndir=0; ndir&lt;4; ++ndir){\nif(ndir == dir){\nint nx = x + dx[dir], ny = y + dy[dir];\nfront(nx, ny, dir, d);\n}else if(g[x][y] == '#'){\nback(x, y, ndir, d+1);\n}\n}\n}\nreturn f[n-1][m-1][0]!=0x3f3f3f3f ? f[n-1][m-1][0] : -1;\n}\nsigned main(){\ncin &gt;&gt; n &gt;&gt; m;\nfor(int i=0; i&lt;n; ++i) cin &gt;&gt; g[i];\ncout &lt;&lt; bfs() &lt;&lt; '\\n';\n}\n</code></pre> <ul> <li>5\uff0c\u4f18\u5148\u961f\u5217BFS</li> </ul> <p>\u3010NOIP2017\u3011\u5976\u916a - \u9898\u76ee - Universal Online Judge (uoj.ac)</p> <p>\u5224\u65ad\u8fde\u901a\u6027\u7684\u95ee\u9898</p> <p>\uff08\u5176\u4ed6\u505a\u6cd5\uff1a\u5e76\u67e5\u96c6\uff0c\u6700\u77ed\u8def\uff0c\u591a\u6e90\\(BFS\\)\uff09</p> <p>\u591a\u6e90BFS\uff1a</p> <pre><code>#include&lt;bits/stdc++.h&gt;\nusing namespace std;\n#define int long long\nconst int N = 1e3+3;\nint n, h, r;\nint x[N], y[N], z[N];\nqueue&lt;int&gt; q;\nbool st[N], goal[N];\nvoid push(int u){ q.push(u), st[u] = true; }\nsigned main(){\nint T;\ncin &gt;&gt; T;\nwhile(T--){\nwhile(q.size()) q.pop();\nmemset(st, 0, sizeof st);\nmemset(goal, 0, sizeof goal);\ncin &gt;&gt; n &gt;&gt; h &gt;&gt; r;\nbool ans = false;\nfor(int i=1; i&lt;=n; ++i){\ncin &gt;&gt; x[i] &gt;&gt; y[i] &gt;&gt; z[i];\nif(z[i] &lt;= r) push(i);\nif(z[i] &gt;= h-r) goal[i] = true;\n}\nwhile(q.size()){\nint u = q.front();\nq.pop();\nif(goal[u]) ans = true;\nfor(int v=1; v&lt;=n; ++v){\nif(st[v]) continue;\n// double \u4f1a\u7206\u7cbe\u5ea6...\nif(sqrt((long double)pow(x[u]-x[v], 2) + pow(y[u]-y[v], 2) + pow(z[u]-z[v], 2)) &gt; (long double)2.0 * r) continue;\npush(v);\n}\n}\nputs(ans ? \"Yes\" : \"No\");\n}\n}\n</code></pre>"},{"location":"oiwiki/%E5%9B%BE%E8%AE%BA/#5","title":"5\uff0c\u6811\u4e0a\u95ee\u9898\uff08\u5f85\u8865\uff09","text":""},{"location":"oiwiki/%E5%9B%BE%E8%AE%BA/#6_1","title":"6\uff0c\u6700\u77ed\u8def","text":"<ul> <li>\u76f8\u5173\u6982\u5ff5</li> </ul> <p>\u8def\u5f84</p> <p>\u6700\u77ed\u8def</p> <p>\u6709\u5411\u56fe\u4e2d\u7684\u6700\u77ed\u8def\u3001\u65e0\u5411\u56fe\u4e2d\u7684\u6700\u77ed\u8def</p> <p>\u5355\u6e90\u6700\u77ed\u8def\u3001\u6bcf\u5bf9\u7ed3\u70b9\u4e4b\u95f4\u7684\u6700\u77ed\u8def</p> <ul> <li>\u6027\u8d28</li> </ul> <p>\u5bf9\u4e8e\u8fb9\u6743\u4e3a\u6b63\u7684\u56fe\uff0c\u4efb\u610f\u4e24\u4e2a\u7ed3\u70b9\u4e4b\u95f4\u7684\u6700\u77ed\u8def\uff0c\u4e0d\u4f1a\u7ecf\u8fc7\u91cd\u590d\u7684\u7ed3\u70b9\u3002</p> <p>\u5bf9\u4e8e\u8fb9\u6743\u4e3a\u6b63\u7684\u56fe\uff0c\u4efb\u610f\u4e24\u4e2a\u7ed3\u70b9\u4e4b\u95f4\u7684\u6700\u77ed\u8def\uff0c\u4e0d\u4f1a\u7ecf\u8fc7\u91cd\u590d\u7684\u8fb9\u3002</p> <p>\u5bf9\u4e8e\u8fb9\u6743\u4e3a\u6b63\u7684\u56fe\uff0c\u4efb\u610f\u4e24\u4e2a\u7ed3\u70b9\u4e4b\u95f4\u7684\u6700\u77ed\u8def\uff0c\u4efb\u610f\u4e00\u6761\u7684\u7ed3\u70b9\u6570\u4e0d\u4f1a\u8d85\u8fc7\u00a0\uff0c\u8fb9\u6570\u4e0d\u4f1a\u8d85\u8fc7\u00a0\u3002</p> <ul> <li>\u8bb0\u53f7</li> </ul> <p></p> <ul> <li>1\uff0c\\(Floyd\\) \u7b97\u6cd5</li> </ul> <p>\u7528\u6765\u6c42\u4efb\u610f\u4e24\u4e2a\u7ed3\u70b9\u4e4b\u95f4\u7684\u6700\u77ed\u8def</p> <p></p> <p>\uff08\u9002\u7528\u4e8e\u4efb\u4f55\u56fe\uff0c\u4e0d\u7ba1\u6709\u5411\u65e0\u5411\uff0c\u8fb9\u6743\u6b63\u8d1f\uff0c\u4f46\u662f\u6700\u77ed\u8def\u5fc5\u987b\u5b58\u5728\uff08\u4e0d\u80fd\u6709\u4e2a\u8d1f\u73af\uff09\uff09</p> <ul> <li> <ul> <li>\u5b9e\u73b0</li> </ul> </li> </ul> <p></p> <p></p> <p></p> <p></p> <p>\u6734\u7d20floyd\uff1a</p> <pre><code>const int N = 1e2+3;\nint g[N][N][N], n;\nvoid floyd(){\nfor(int k=1; k&lt;=n; ++k){\nfor(int x=1; x&lt;=n; ++x){\nfor(int y=1; y&lt;=n; ++y){\ng[k][x][y] = min(g[k-1][x][y], g[k-1][x][k] + g[k-1][k][y]);\n}\n}\n}\n}\n</code></pre> <p>\u6eda\u52a8\u4f18\u5316\uff1a</p> <pre><code>const int N = 4e2+3;\nint g[N][N], n;\nvoid floyd(){\nfor(int k=1; k&lt;=n; ++k){\nfor(int x=1; x&lt;=n; ++x){\nfor(int y=1; y&lt;=n; ++y){\ng[x][y] = min(g[x][y], g[x][k] + g[k][y]);\n}\n}\n}\n}\n</code></pre> <p>\u7ee7\u7eed\u4f18\u5316\uff1a\u77e9\u9635\u4e58\u6cd5\u4f18\u5316\uff1f</p> <ul> <li> <ul> <li>\u5e94\u7528</li> </ul> </li> </ul> <p>1\uff0c\u7ed9\u4e00\u4e2a\u6b63\u6743\u65e0\u5411\u56fe\uff0c\u627e\u4e00\u4e2a\u6700\u5c0f\u6743\u503c\u548c\u7684\u73af</p> <p>\u9996\u5148\u8fd9\u4e00\u5b9a\u662f\u4e00\u4e2a\u7b80\u5355\u73af\uff0c\u60f3\u4e00\u60f3\u8fd9\u4e2a\u73af\u662f\u600e\u4e48\u6784\u6210\u7684</p> <p>\u8003\u8651\u73af\u4e0a\u7f16\u53f7\u6700\u5927\u7684\u7ed3\u70b9 u</p> <p><code>f[u-1][x][y]</code>\u00a0\u548c (u,x), (u,y\uff09\u5171\u540c\u6784\u6210\u4e86\u73af\u3002</p> <p>\u5728 Floyd \u7684\u8fc7\u7a0b\u4e2d\u679a\u4e3e u\uff0c\u8ba1\u7b97\u8fd9\u4e2a\u548c\u7684\u6700\u5c0f\u503c\u5373\u53ef\uff0c\u590d\u6742\u5ea6\uff1a\\(O(n^3)\\)</p> <p>2\uff0c\u5df2\u77e5\u4e00\u4e2a\u6709\u5411\u56fe\u4e2d\u4efb\u610f\u4e24\u70b9\u4e4b\u95f4\u662f\u5426\u6709\u8fde\u8fb9\uff0c\u8981\u6c42\u5224\u65ad\u4efb\u610f\u4e24\u70b9\u662f\u5426\u8fde\u901a</p> <p>\u8be5\u95ee\u9898\u5373\u662f\u6c42 \u56fe\u7684\u4f20\u9012\u95ed\u5305</p> <p></p> <pre><code>// std::bitset&lt;SIZE&gt; f[SIZE];\nfor (k = 1; k &lt;= n; k++)\nfor (i = 1; i &lt;= n; i++)\nif (f[i][k]) f[i] = f[i] | f[k];\n</code></pre> <ul> <li>2\uff0c\\(Bellman-Ford\\) \u7b97\u6cd5\uff08\u53ca\u5176\u4f18\u5316\uff1a\\(SPFA\\) \uff09</li> </ul> <p>\uff08\u4ee5\u4e0b\u7b80\u79f0 \\(BF\\)\uff09</p> <p>Bellman-Ford \u7b97\u6cd5\u662f\u4e00\u79cd\u57fa\u4e8e\u677e\u5f1b\uff08relax\uff09\u64cd\u4f5c\u7684\u6700\u77ed\u8def\u7b97\u6cd5\uff0c\u53ef\u4ee5\u6c42\u51fa\u6709\u8d1f\u6743\u7684\u56fe\u7684\u6700\u77ed\u8def\uff0c\u5e76\u53ef\u4ee5\u5bf9\u6700\u77ed\u8def\u4e0d\u5b58\u5728\u7684\u60c5\u51b5\u8fdb\u884c\u5224\u65ad</p> <p></p> <ul> <li> <ul> <li>\u6d41\u7a0b</li> </ul> </li> </ul> <p></p> <pre><code>const int N = 1e5+3, inf = 0x3f3f3f3f;\nint n, m, f[N];\nstruct edge{ int v, w; };\nvector&lt;edge&gt; e[N];\nbool bellmanford(int s){\nmemset(f, 0x3f, sizeof f);\nbool ans;\nf[s] = 0;\nfor(int i=1; i&lt;=n; ++i){\nans = false;\n// \u7528 f_u \u66f4\u65b0 f_v \uff08\u904d\u5386\u8fb9\u6570\u7ec4\uff09\nfor(int u=1; u&lt;=n; ++u){\nif(f[u] == inf) continue;\nfor(auto ed : e[u]){\nint v = ed.v, w = ed.w;\nif(f[v] &gt; f[u] + w){\nf[v] = f[u] + w;\nans = true;\n}\n}\n}\n// \u65e0\u4efb\u4f55\u4e00\u4e2a\u70b9\u7684\u51fa\u70b9\u53ef\u4ee5\u88ab\u677e\u5f1b \nif(!ans) break;\n}\n// \u7b2c n \u8f6e\u5faa\u73af\u4ecd\u7136\u53ef\u4ee5\u677e\u5f1b\u65f6\u8bf4\u660e s \u70b9\u53ef\u4ee5\u62b5\u8fbe\u4e00\u4e2a\u8d1f\u73af\nreturn ans;\n}\n</code></pre> <p>\u5224\u73af\u7684\u539f\u7406\uff1f\uff1a</p> <p>\u82e5 \\(\\prod\\limits_{i\\in circuit} w_i \\ge 1\\) \uff0c</p> <ul> <li> <ul> <li>\u961f\u5217\u4f18\u5316\uff1a\\(SFPA\\)</li> </ul> </li> </ul> <p><code>Shortest Path Faster Algorithm</code></p> <p></p> <p></p> <p>\\(O(n\\times m)\\) \u4f46\u662f \\(spfa\\) \u901a\u5e38\u8dd1\u5f97\u98de\u5feb\uff08\u5141\u8bb8\u51fa\u73b0\u8d1f\u73af\uff09</p> <pre><code>const int N = 1e5+3, inf = 0x3f3f3f3f;\nint n, m, st[N], f[N], cnt[N];\nstruct edge{ int v, w; };\nvector&lt;edge&gt; e[N];\nqueue&lt;int&gt; q;\nbool push(int u, int v, int w){\nif(f[v] &gt; f[u] + w){\nf[v] = f[u] + w;\ncnt[v] = cnt[u] + 1;\n// \u6700\u77ed\u8def\u7ecf\u8fc7\u7684\u8fb9\u6570 \u4e0d\u5927\u4e8e n-1\uff0c\u5426\u5219\u51fa\u73b0\u8d1f\u73af \nif(cnt[v] &gt;= n) return false;\nif(!st[v]) q.push(v), st[v] = true;\n}\nreturn true;\n}\nbool sqfa(int s){\nmemset(f, 0x3f, sizeof f);\n//    memset(cnt, 0, sizeof cnt);\n//    memset(st, false, sizeof st);\nq.push(s), st[s] = true, f[s] = 0;\nwhile(q.size()){\nint u = q.front();\nq.pop(), st[u] = false;\nfor(auto ed : e[u]){\nif(!push(u, ed.v, ed.w)) return false;\n}\n}\nreturn true;\n}\n</code></pre> <ul> <li> <ul> <li>\"BF\" \u7684\u5176\u4ed6\u4f18\u5316</li> </ul> </li> </ul> <p>\u9664\u4e86\u961f\u5217\u4f18\u5316\uff08SPFA\uff09\u4e4b\u5916\uff0cBellman-Ford \u8fd8\u6709\u5176\u4ed6\u5f62\u5f0f\u7684\u4f18\u5316\uff0c\u8fd9\u4e9b\u4f18\u5316\u5728\u90e8\u5206\u56fe\u4e0a\u6548\u679c\u660e\u663e\uff0c\u4f46\u5728\u67d0\u4e9b\u7279\u6b8a\u56fe\u4e0a\uff0c\u6700\u574f\u590d\u6742\u5ea6\u53ef\u80fd\u8fbe\u5230\u6307\u6570\u7ea7</p> <p>\uff08\u961f\u5217\uff0c\u53cc\u7aef\u961f\u5217\uff0c\u5806\uff0c\u6808\u3002\u3002\uff09</p> <p></p> <p></p> <p></p> <p></p> <p></p> <p>(31 \u6761\u6d88\u606f) \u5982\u4f55\u770b\u5f85 SPFA \u7b97\u6cd5\u5df2\u6b7b\u8fd9\u79cd\u8bf4\u6cd5\uff1f - \u77e5\u4e4e (zhihu.com)</p> <ul> <li>3\uff0c\\(Dijkstra\\) \u7b97\u6cd5</li> </ul> <p>\uff08warning\uff1a\u4ec5\u9002\u7528\u4e8e\u975e\u8d1f\u6743\u56fe\uff1b\\(DJ\\) \u662f\u8f7b\u91cf\u7ea7\u7b97\u6cd5\uff0c\u9664\\(DJ\\) \u4ee5\u5916\u7684\u7b97\u6cd5\u529f\u80fd\u5f3a\u608d\uff0c\u4f46\u6548\u7387\u7565\u5dee\uff09</p> <p></p> <ul> <li> <ul> <li>\u6d41\u7a0b</li> </ul> </li> </ul> <p></p> <p></p> <p></p> <p>\u6734\u7d20\u505a\u6cd5\uff0c\u590d\u6742\u5ea6\uff1a\\(O(n^2+m)=O(n^2)\\)</p> <pre><code>const int N = 1e5+3, inf = 0x3f3f3f3f;\nint n, m, st[N], f[N];\nstruct edge{ int v, w; };\nvector&lt;edge&gt; e[N];\nvoid dijkstra(int s){\nmemset(f, 0x3f, sizeof f);\nf[s] = 0;\nfor(int i=1; i&lt;=n; ++i){\nint u = 0, mind = inf;\nfor(int j=1; j&lt;=n; ++j){\nif(st[j] || f[j] &gt;= mind) continue;\nu = j;\nmind = f[j];\n}\n// \u5c06 u \u653e\u5165 \u96c6\u5408 S \u4e2d \nst[u] = true;\n// \u677e\u5f1b u \u7684\u51fa\u70b9 \nfor(auto ed : e[u]){\nint v = ed.v, w = ed.w;\nf[v] = min(f[v], f[u] + w);\n}\n}\n}\n</code></pre> <p>\u5355\u8c03\u961f\u5217\u4f18\u5316\uff08\u4e0d\u5e26\u4fee\u6539\u7684\u5806\uff09\uff0c\u590d\u6742\u5ea6\uff1a\\(O(m\\log{m})\\le O(n^2\\log{n^2})\\)</p> <p>\uff08\u70b9\u5141\u8bb8\u591a\u6b21\u5165\u5806\uff1b\uff09</p> <pre><code>const int N = 1e5+3, inf = 0x3f3f3f3f;\nint n, m, st[N], f[N];\nstruct edge{ int v, w; };\nvector&lt;edge&gt; e[N];\nstruct nd{\nint u, d;\nbool operator&gt;(const nd&amp;t)const{ return d &gt; t.d; }\n};\npriority_queue&lt;nd, vector&lt;nd&gt;, greater&lt;nd&gt;&gt; q;\nvoid dijkstra(int s){\nmemset(f, 0x3f, sizeof f);\nf[s] = 0;\nq.push({s, 0});\nwhile(q.size()){\nint u = q.top().u;\nq.pop();\nif(st[u]) continue;\nst[u] = true;\nfor(auto ed : e[u]){\nint v = ed.v, w = ed.w;\nif(f[v] &gt; f[u] + w){\nf[v] = f[u] + w;\nq.push({f[v], v});\n}\n}\n}\n}\n</code></pre> <ul> <li>4\uff0c\\(Johnson\\) \u7b97\u6cd5</li> </ul> <p>\u548c\\(floyd\\) \u4e00\u6837\uff0c\u7528\u4e8e\u89e3\u51b3\u65e0\u8d1f\u73af\u56fe\u4e0a\u7684\u4efb\u610f\u4e24\u70b9\u7684\u6700\u77ed\u8def</p> <p>\uff08\u4f46\u662f\u5f88\u53ef\u80fd\u6ca1\u5fc5\u8981\u8ba8\u8bba\uff0c\u6240\u4ee5\u4e0d\u4ecb\u7ecd\uff09</p> <p>\u6700\u77ed\u8def - OI Wiki (oi-wiki.org)</p> <ul> <li>5\uff0c\u5404\u79cd\u7b97\u6cd5\u7684\u6bd4\u8f83</li> </ul> <p></p> <p>\uff08\u8868\u4e2d\u7684 Dijkstra \u7b97\u6cd5\u5728\u8ba1\u7b97\u590d\u6742\u5ea6\u65f6\u5747\u7528 <code>priority_queue</code> \u5b9e\u73b0\uff09</p> <ul> <li>6\uff0c\u8f93\u51fa\u65b9\u6848</li> </ul> <p></p>"},{"location":"oiwiki/%E5%9D%97/","title":"\u5757","text":""},{"location":"oiwiki/%E5%9D%97/#1","title":"1\uff0c\u5206\u5757\u601d\u60f3","text":"<ul> <li>\u533a\u95f4\u548c</li> </ul> <p>#6280. \u6570\u5217\u5206\u5757\u5165\u95e8 4 - \u9898\u76ee - LibreOJ (loj.ac)</p> <p>\u533a\u95f4\u6539\u503c\uff1a\\(O(\\sqrt{n})\\)\uff0c\u533a\u95f4\u67e5\u8be2\uff1a\\(O(\\sqrt{n})\\)</p> <pre><code>int n, a[N];\n// id\u8868\u793a\u5757\u53f7\uff1b add\u3001s \u5206\u522b\u4e3a \u67d0\u4e2a\u5206\u5757 \u7684\u52a0\u6cd5\u61d2\u6807\u8bb0\u3001\u5b9e\u9645\u7684\u548c\nint id[N], len, add[N], s[N];\nvoid init(){\nlen = sqrt(n);\nfor(int i=1; i&lt;=n; ++i) id[i] = (i - 1) / len + 1, s[id[i]] += a[i];\n}\nvoid madd(int lb, int ub, int w){\nif(id[lb] == id[ub]){\nfor(int i=lb; i&lt;=ub; ++i) a[i] += w, s[id[i]] += w;\nreturn ;\n}\nfor(int i=lb; id[i]==id[lb]; ++i) a[i] += w, s[id[i]] += w;\nfor(int i=ub; id[i]==id[ub]; --i) a[i] += w, s[id[i]] += w;\nfor(int i=id[lb]+1; i&lt;id[ub]; ++i) add[i] += w, s[i] += w * len;\n}\n// \u5e26\u53d6\u6a21\u7684\u67e5\u8be2\nint get(int lb, int ub, int P){\nint ans = 0;\nif(id[lb] == id[ub]){\nfor(int i=lb; i&lt;=ub; ++i) ans = (ans + a[i] + add[id[i]]) % P;\nreturn ans;\n}\nfor(int i=lb; id[i]==id[lb]; ++i) ans = (ans + a[i] + add[id[i]]) % P;\nfor(int i=ub; id[i]==id[ub]; --i) ans = (ans + a[i] + add[id[i]]) % P;\nfor(int i=id[lb]+1; i&lt;id[ub]; ++i) ans = (ans + s[i]) % P;\nreturn ans;\n}\n</code></pre> <ul> <li>\u533a\u95f4\u548c2\uff08\u5f85\u8865\uff09</li> </ul> <p></p> <ul> <li>\u5bf9\u67e5\u8be2\u5206\u5757</li> </ul> <p></p> <ul> <li>\u5176\u4ed6\u95ee\u9898</li> </ul> <p></p> <p></p> <p></p> <p>UVA12003 Array Transformer - \u6d1b\u8c37 | \u8ba1\u7b97\u673a\u79d1\u5b66\u6559\u80b2\u65b0\u751f\u6001 (luogu.com.cn)</p> <p>``Dynamic'' Inversion - UVA 11990 - Virtual Judge (csgrandeur.cn)</p>"},{"location":"oiwiki/%E5%9D%97/#2","title":"2\uff0c\u5206\u5757\u6570\u7ec4","text":"<p>\u521d\u59cb\u5316\uff08\u6700\u7b80\u5355\u7684\u7ed3\u6784\uff09</p> <pre><code>int id[N], len;\nvoid init(){\nlen = sqrt(n);\nfor(int i=1; i&lt;=n; ++i) id[i] = (i-1)/len+1\n}\n</code></pre> <p>\u5206\u5757\u6570\u7ec4\u6709\u5f88\u9ad8\u7684\u6269\u5c55\u6027\uff01\uff01</p> <p>\u53ef\u89e3\u51b3\u95ee\u9898\uff08\u76ee\u524d\u603b\u7ed3\u5230\u7684\uff09\uff1a</p> <p>1\uff0c\u533a\u95f4\u52a0\u6cd5\uff1a\\(add[~]\\) \u61d2\u6807\u8bb0\uff0c\u5219\u70b9\u503c\u53ef\u4ee5\u8868\u793a\u4e3a \\(a_i+add_{id[i]]}\\)</p> <p>2\uff0c\u533a\u95f4\u548c\u67e5\u8be2\uff1a\u6bcf\u4e2a\u5757\u6dfb\u52a0\u5b57\u6bb5 \\(s[~]\\)\uff1b\\(a_i\\) \u6216 \\(add_{id[i]}\\)\u66f4\u65b0\uff08\u5373\u70b9\u503c\u66f4\u65b0\uff09\u65f6 \\(s_i\\) \u4e5f\u9700\u8981\u66f4\u65b0</p> <p>3\uff0c\u533a\u95f4\u5927\u4e8ek\u7684\u6570\u76ee\u67e5\u8be2\uff1a\u6dfb\u52a0\u5206\u5757\u526f\u672c \\(vetor&lt;int&gt;r[~]\\)\uff0c\u5757\u5185\u6392\u5e8f\uff0c\u67e5\u8be2\u65f6\u7d2f\u8ba1\u8d21\u732e\uff1b\u70b9\u503c\u66f4\u65b0\u65f6\u9700\u8981\u5bf9\u5757\u5185\u91cd\u65b0\u6392\u5e8f</p> <p>4\uff0c\u533a\u95f4\u4e58\u6cd5\uff1a\\(mul[~]\\) \u61d2\u6807\u8bb0</p> <ul> <li>\u4f8b\u98981\uff1aP2801 \u6559\u4e3b\u7684\u9b54\u6cd5 - \u6d1b\u8c37 | \u8ba1\u7b97\u673a\u79d1\u5b66\u6559\u80b2\u65b0\u751f\u6001 (luogu.com.cn)</li> </ul> <p>\u9898\u610f\uff1a\u533a\u95f4\u52a0\u6cd5 + \u533a\u95f4\u5927\u4e8ek\u7684\u6570\u76ee\u67e5\u8be2</p> <p>\uff08\u9700\u8981\u5f00\\(O2\\) \u4f18\u5316\uff0c\u539f\u56e0\u4e0d\u660e\uff09</p> <pre><code>#include&lt;bits/stdc++.h&gt;\n#define sort(u) sort(begin(u), end(u))\n#define lb(u, w) lower_bound(begin(u), end(u), w)\nusing namespace std;\nconst int N = 1e6+3, M = 1e3+3;\nint n, a[N];\nint id[N], len;\n// \u9488\u5bf9\u67e5\u8be2\u7684\u5206\u5757\u526f\u672c\uff0c\u5757\u5185\u6392\u5e8f\uff08\u6bcf\u4e2a\u5757\u5728\u539f\u6570\u636e\u66f4\u65b0\u540e\u9700\u91cd\u65b0\u6392\u5e8f\uff09\nvector&lt;int&gt; r[M];\n// \u533a\u95f4\u52a0\u6cd5\u61d2\u6807\u8bb0\nint add[M];\nvoid init(){\nlen = sqrt(n);\nfor(int i=1; i&lt;=n; ++i) id[i] = (i-1)/len+1, r[id[i]].push_back(a[i]);\nfor(int i=1; i&lt;=id[n]; ++i) sort(r[i]);\n}\n// \u66f4\u65b0\u5206\u5757\u526f\u672c\nvoid so(int k){\nr[k].clear();\nint lb = (k-1)*len+1, ub = min(k*len, n);\nfor(int i=lb; i&lt;=ub; ++i) r[k].push_back(a[i]);\nsort(r[k]);\n}\nvoid madd(int lb, int ub, int w){\nint x = id[lb], y = id[ub];\nif(x == y){\nfor(int i=lb; i&lt;=ub; ++i) a[i] += w;\nso(x);\nreturn ;\n}\nfor(int i=lb; id[i]==x; ++i) a[i] += w; so(x);\nfor(int i=ub; id[i]==y; --i) a[i] += w; so(y);\nfor(int i=id[lb]+1; i&lt;id[ub]; ++i) add[i] += w;\n}\nint get(int lb, int ub, int w){\nint x = id[lb], y = id[ub];\nint ans = 0;\nif(x == y){\nfor(int i=lb; i&lt;=ub; ++i) ans += (a[i]+add[id[i]] &lt; w);\nreturn ans;\n}\nfor(int i=lb; id[i]==x; ++i) ans += (a[i]+add[id[i]] &lt; w);\nfor(int i=ub; id[i]==y; --i) ans += (a[i]+add[id[i]] &lt; w);\nfor(int i=x+1; i&lt;y; ++i) ans += lb(r[i], w-add[i]) - r[i].begin();\nreturn ans;\n}\nint main(){\nint m;\ncin &gt;&gt; n &gt;&gt; m;\nfor(int i=1; i&lt;=n; ++i) cin &gt;&gt; a[i];\ninit();\nfor(int i=0; i&lt;m; ++i){\nchar op;\nint lb, ub, w;\ncin &gt;&gt; op &gt;&gt; lb &gt;&gt; ub &gt;&gt; w;\nif(op == 'A'){\ncout &lt;&lt; ub-lb+1-get(lb, ub, w) &lt;&lt; '\\n';\n}else{\nmadd(lb, ub, w);\n}\n}\n}\n</code></pre> <ul> <li>\u4f8b\u98982\uff08\u5f85\u8865\uff09</li> </ul> <p></p> <p></p> <p>#130. \u6811\u72b6\u6570\u7ec4 1 \uff1a\u5355\u70b9\u4fee\u6539\uff0c\u533a\u95f4\u67e5\u8be2 - \u9898\u76ee - LibreOJ (loj.ac)</p> <p>#132. \u6811\u72b6\u6570\u7ec4 3 \uff1a\u533a\u95f4\u4fee\u6539\uff0c\u533a\u95f4\u67e5\u8be2 - \u9898\u76ee - LibreOJ (loj.ac)</p> <p>P3373 \u3010\u6a21\u677f\u3011\u7ebf\u6bb5\u6811 2 - \u6d1b\u8c37 | \u8ba1\u7b97\u673a\u79d1\u5b66\u6559\u80b2\u65b0\u751f\u6001 (luogu.com.cn)</p> <p>\uff08\u533a\u95f4\u52a0\uff0c\u533a\u95f4\u4e58\uff0c\u533a\u95f4\u548c\u67e5\u8be2\uff1b\u53e6\u5916\uff0c\u6b64\u9898\u9700\u8981\u75af\u72c2\u5438\u6c27\uff09</p> <pre><code>const int N = 1e5+3, M = 1e3+3;\nint n;\nlong long a[N];\nlong long P;\nint len, id[N];\nlong long add[M], mul[M], s[M];\nvoid init(){\nlen = sqrt(n);\nfor(int i=1; i&lt;=n; ++i){\nid[i] = (i-1)/len+1;\ns[id[i]] = (s[id[i]] + a[i]) % P;\nmul[id[i]] = 1;\n}\n}\nvoid reset(int k) {\nfor(int i=(k-1)*len+1; i&lt;=min(k*len, n); i++)\na[i] = (a[i] * mul[k] + add[k]) % P;\nmul[k] = 1, add[k] = 0;\n}\nvoid madd(int lb, int ub, int w){\nint x = id[lb], y = id[ub];\nif(x == y){\nreset(x);\nfor(int i=lb; i&lt;=ub; ++i) a[i] = (a[i] + w) % P, s[id[i]] = (s[id[i]] + w) % P;\nreturn ;\n}\nreset(x);\ns[id[lb]] = (s[id[lb]] + w * (len * id[lb] - lb + 1)) % P;\nfor(int i=lb; id[i]==x; ++i) a[i] = (a[i] + w) % P;\nreset(y);\ns[id[ub]] = (s[id[ub]] + w * (ub - (len * (id[ub] - 1) + 1) + 1)) % P;\nfor(int i=ub; id[i]==y; --i) a[i] = (a[i] + w) % P;\nfor(int i=x+1; i&lt;y; ++i) add[i] = (add[i] + w) % P, s[i] = (s[i] + w * len ) % P;\n}\nvoid mmul(int lb, int ub, int w){\nint x = id[lb], y = id[ub];\nif(x == y){\nreset(x);\nfor(int i=lb; i&lt;=ub; ++i) s[id[i]] = (s[id[i]] + a[i] * (w-1) % P) % P, a[i] = (a[i] * w) % P;\nreturn ;\n}\nreset(x);\nfor(int i=lb; id[i]==x; ++i) s[id[i]] = (s[id[i]] + a[i] * (w-1)) % P, a[i] = (a[i] * w) % P;\nreset(y);\nfor(int i=ub; id[i]==y; --i) s[id[i]] = (s[id[i]] + a[i] * (w-1)) % P, a[i] = (a[i] * w) % P;\nfor(int i=x+1; i&lt;y; ++i) add[i] = add[i] * w % P, mul[i] = mul[i] * w % P, s[i] = s[i] * w % P;\n}\nlong long get(int lb, int ub){\nint x = id[lb], y = id[ub];\nlong long ans = 0;\nif(x == y){\nfor(int i=lb; i&lt;=ub; ++i) ans = (ans + a[i] * mul[id[i]] + add[id[i]]) % P;\nreturn ans;\n}\nfor(int i=lb; id[i]==x; ++i) ans = (ans + a[i] * mul[id[i]] + add[id[i]]) % P;\nfor(int i=ub; id[i]==y; --i) ans = (ans + a[i] * mul[id[i]] + add[id[i]]) % P;\nfor(int i=x+1; i&lt;y; ++i) ans = (ans + s[i]) % P;\nreturn ans;\n}\n</code></pre> <p>P5048 [Ynoi2019 \u6a21\u62df\u8d5b] Yuno loves sqrt technology III - \u6d1b\u8c37 | \u8ba1\u7b97\u673a\u79d1\u5b66\u6559\u80b2\u65b0\u751f\u6001 (luogu.com.cn)</p> <p>P4168 [Violet]\u84b2\u516c\u82f1 - \u6d1b\u8c37 | \u8ba1\u7b97\u673a\u79d1\u5b66\u6559\u80b2\u65b0\u751f\u6001 (luogu.com.cn)</p> <p>P4135 \u4f5c\u8bd7 - \u6d1b\u8c37 | \u8ba1\u7b97\u673a\u79d1\u5b66\u6559\u80b2\u65b0\u751f\u6001 (luogu.com.cn)</p>"},{"location":"oiwiki/%E5%A0%86/","title":"\u5806","text":""},{"location":"oiwiki/%E5%A0%86/#1","title":"1\uff0c\u5806\u7b80\u4ecb","text":"<ul> <li>\u5206\u7c7b</li> </ul>"},{"location":"oiwiki/%E5%A0%86/#2","title":"2\uff0c\u4e8c\u53c9\u5806","text":"<ul> <li>\u63d2\u5165</li> </ul> <ul> <li>\u5220\u9664</li> </ul> <pre><code>int n, h[N];\nvoid up(int u){\nwhile(u &gt; 1){\nif(h[u / 2] &gt;= h[u]) break;\nswap(h[u], h[u / 2]);\nu /= 2;\n}\n}\nvoid down(int u){\nwhile(2 * u &lt;= n){\nint v = 2 * u;\nif(v + 1 &lt;= n &amp;&amp; h[v] &lt; h[v + 1]) ++ v;\nif(h[u] &gt;= h[v]) break;\nswap(h[u], h[v]);\nu = v;\n}\n}\n</code></pre> <ul> <li>\u5efa\u5806</li> </ul> <pre><code>void init(int n){\n//    O(N*logN), decreasekey\n//    for(int i=1; i&lt;=n; ++i) up(i);\n//  O(N)\nfor(int i=n; i&gt;=1; --i) down(i);\n}\n</code></pre> <ul> <li>\u5bf9\u9876\u5806\uff08\u76f4\u63a5\u7528 \\(priority\\_queue\\) \uff09</li> </ul> <p>\u5927\u6839\u5806\u5b58\u8f83\u5c0f\u503c\uff0c\u5c0f\u6839\u5806\u5b58\u8f83\u5927\u503c</p> <p>\u4e24\u4e2a\u5806\u7684\u5927\u81f4\u5173\u7cfb\uff08\u6700\u53f3\u8fb9\u4e3a\u5806\u9876\uff09\uff1a</p> \\[ \u5927\u6839\u5806\uff1ax_1\\le x_2\\le..\\le x_k \\\\ \u5c0f\u6839\u5806\uff1a x_n\\ge x_{n-1}\\ge..\\ge x_{k+1} \\] <ul> <li> <ul> <li>\u5b9a\u4e49</li> </ul> </li> </ul> <pre><code>priority_queue&lt;int, vector&lt;int&gt;, less&lt;int&gt; &gt; a;\npriority_queue&lt;int, vector&lt;int&gt;, greater&lt;int&gt; &gt; b;\n#define mov(a, b) b.push(a.top()), a.pop()\n</code></pre> <ul> <li> <ul> <li>\u63d2\u5165</li> </ul> </li> </ul> <pre><code>if(a.empty() || n &lt;= a.top()) a.push(n);\nelse b.push(n);\n</code></pre> <ul> <li>\u7ef4\u62a4</li> </ul> <pre><code>if(a.size() &gt; k) mov(a, b);\nelse if(a.size() &lt; k) mov(b, a);\n</code></pre> <p>SP16254 RMID2 - Running Median Again - \u6d1b\u8c37 | \u8ba1\u7b97\u673a\u79d1\u5b66\u6559\u80b2\u65b0\u751f\u6001 (luogu.com.cn)</p> <p>SP15376 RMID - Running Median - \u6d1b\u8c37 | \u8ba1\u7b97\u673a\u79d1\u5b66\u6559\u80b2\u65b0\u751f\u6001 (luogu.com.cn)</p> <p>P1801 \u9ed1\u5323\u5b50 - \u6d1b\u8c37 | \u8ba1\u7b97\u673a\u79d1\u5b66\u6559\u80b2\u65b0\u751f\u6001 (luogu.com.cn)</p>"},{"location":"oiwiki/%E5%A0%86/#3","title":"3\uff0c\u914d\u5bf9\u5806","text":"<p>\u7b80\u5355\u5b9a\u4e49\uff1a</p> <p></p> <p></p> <p>\u901a\u5e38\u6211\u4eec\u4f7f\u7528\u5de6\u513f\u5b50\u53f3\u5144\u5f1f\u8868\u793a\u6cd5\u50a8\u5b58\u4e00\u4e2a\u914d\u5bf9\u5806</p> <p></p> <ul> <li>\u5b58\u50a8</li> </ul> <p>\u5c31\u662f\u666e\u901a\u7684\u5e26\u6743\u591a\u53c9\u6811\u7684\u8868\u793a\u65b9\u5f0f</p> <ul> <li>\u67e5\u8be2\u6700\u5c0f\u503c \\(O(1)\\)</li> </ul> <p>\u8fd4\u56de\u5806\u9996</p> <ul> <li>\u5408\u5e76\uff0c\u63d2\u5165 \\(O(1)\\)</li> </ul> <p>\u76f4\u63a5\u628a\u6839\u8282\u70b9\u6743\u503c\u8f83\u5927\u7684\u90a3\u4e2a\u914d\u5bf9\u5806\u8bbe\u6210\u53e6\u4e00\u4e2a\u7684\u513f\u5b50</p> <p></p> <ul> <li>\u5220\u9664\u6700\u5c0f\u503c \\(O(\\log{n})\\)</li> </ul> <p>\u628a\u513f\u5b50\u4eec \u4ece\u5de6\u5f80\u53f3 \u4e24\u4e24\u914d\u6210\u4e00\u5bf9\uff0c\u7528 <code>merge</code> \u64cd\u4f5c\u628a\u88ab\u914d\u6210\u540c\u4e00\u5bf9\u7684\u4e24\u4e2a\u513f\u5b50\u5408\u5e76\u5230\u4e00\u8d77\uff0c\u518d\u5c06\u65b0\u4ea7\u751f\u7684\u5806 \u4ece\u53f3\u5f80\u5de6 \u66b4\u529b\u5408\u5e76\u5728\u4e00\u8d77</p> <pre><code>struct nd{\n// \u7ed3\u70b9\u6743 \nint x;\n// \u5de6\u5b69\u5b50 \u53f3\u5144\u5f1f \nnd *ch, *br;\n};\nnd* add(nd *u, nd *v){\nif(u == nullptr) return v;\nif(v == nullptr) return u;\nif(u-&gt;x &gt; v-&gt;x) swap(u, v);\n//    \u5c06 v \u5408\u5e76\u5230 u\n//     v\u627f\u63a5u\u7684\u5144\u5f1f \nv-&gt;br = u-&gt;ch;\n//    v\u4f5c\u4e3a u\u7684\u513f\u5b50 \nu-&gt;ch = v;\nreturn u;\n}\nnd* mer(nd *u){\nif(u == nullptr || u-&gt;br == nullptr) return u;\n//    \u6682\u5b58\u6700\u5de6\u8fb9\u7684\u4e24\u4e2a\u5144\u5f1f\uff0c\u7136\u540e\u62c6\u6563 \nnd *v = u-&gt;br, *w = v-&gt;br;\nu-&gt;br = v-&gt;br = nullptr;\nreturn add(add(u, v), mer(w));\n}\nnd *del(nd *u){ return mer(u-&gt;ch); }\n</code></pre> <ul> <li>\u51cf\u5c0f \u4e00\u4e2a\u5143\u7d20\u7684\u503c \\(O(n)\\) \uff08\u5f85\u8865\uff09</li> </ul> <p>\uff08\u8f83\u4e3a\u7e41\u6742\uff09</p>"},{"location":"oiwiki/%E5%A0%86/#4","title":"4\uff0c\u5de6\u504f\u5806\uff08\u5f85\u8865\uff09","text":"<ul> <li>dist</li> </ul> <ul> <li>\u5b9a\u4e49</li> </ul> <ul> <li>\u5408\u5e76</li> </ul> <p>P3377 \u3010\u6a21\u677f\u3011\u5de6\u504f\u6811\uff08\u53ef\u5e76\u5806\uff09 - \u6d1b\u8c37 | \u8ba1\u7b97\u673a\u79d1\u5b66\u6559\u80b2\u65b0\u751f\u6001 (luogu.com.cn)</p> <p>P1456 Monkey King - \u6d1b\u8c37 | \u8ba1\u7b97\u673a\u79d1\u5b66\u6559\u80b2\u65b0\u751f\u6001 (luogu.com.cn)</p> <p>P2713 \u7f57\u9a6c\u6e38\u620f - \u6d1b\u8c37 | \u8ba1\u7b97\u673a\u79d1\u5b66\u6559\u80b2\u65b0\u751f\u6001 (luogu.com.cn)</p> <p>P1552 [APIO2012] \u6d3e\u9063 - \u6d1b\u8c37 | \u8ba1\u7b97\u673a\u79d1\u5b66\u6559\u80b2\u65b0\u751f\u6001 (luogu.com.cn)</p> <p>P3261 [JLOI2015]\u57ce\u6c60\u653b\u5360 - \u6d1b\u8c37 | \u8ba1\u7b97\u673a\u79d1\u5b66\u6559\u80b2\u65b0\u751f\u6001 (luogu.com.cn)</p> <p>P3273 [SCOI2011]\u68d8\u624b\u7684\u64cd\u4f5c - \u6d1b\u8c37 | \u8ba1\u7b97\u673a\u79d1\u5b66\u6559\u80b2\u65b0\u751f\u6001 (luogu.com.cn)</p> <p>P4331 [BalticOI 2004]Sequence \u6570\u5b57\u5e8f\u5217 - \u6d1b\u8c37 | \u8ba1\u7b97\u673a\u79d1\u5b66\u6559\u80b2\u65b0\u751f\u6001 (luogu.com.cn)</p>"},{"location":"oiwiki/%E5%AD%97%E7%AC%A6%E4%B8%B2/","title":"\u5b57\u7b26\u4e32","text":""},{"location":"oiwiki/%E5%AD%97%E7%AC%A6%E4%B8%B2/#1","title":"1\uff0c\u5b57\u7b26\u4e32\u7b80\u4ecb","text":"<p>\u5b57\u7b26\u4e32\uff0c\u5c31\u662f\u7531\u5b57\u7b26\u8fde\u63a5\u800c\u6210\u7684\u5e8f\u5217\u3002</p> <p>\u5e38\u89c1\u7684\u5b57\u7b26\u4e32\u95ee\u9898\u5305\u62ec\u5b57\u7b26\u4e32\u5339\u914d\u95ee\u9898\u3001\u5b50\u4e32\u76f8\u5173\u95ee\u9898\u3001\u524d\u7f00/\u540e\u7f00\u76f8\u5173\u95ee\u9898\u3001\u56de\u6587\u4e32\u76f8\u5173\u95ee\u9898\u3001\u5b50\u5e8f\u5217\u76f8\u5173\u95ee\u9898\u7b49\u3002</p> <ul> <li>\u5b57\u7b26\u96c6</li> </ul> <p></p> <p>\uff08\u5168\u5e8f\u5173\u7cfb\uff1a\u96c6\u5408\\(A\\) \u4e0a\u7684 \u6ee1\u8db3\u5173\u7cfb \\(R\\)\u4e0a \\(&lt;x,~y&gt;\\) \uff0c\\(&lt;y,~x&gt;\\) \u5fc5\u6709\u5176\u4e00 \u7684\u504f\u5e8f\u5173\u7cfb\uff1b</p> <p>\u77e5\u4e4eGjjhgfrrgugv2020\u7684\u56de\u7b54\uff09</p> <ul> <li>\u5b57\u7b26\u4e32</li> </ul> <p></p> <ul> <li>\u5b50\u4e32</li> </ul> <p></p> <ul> <li>\u5b50\u5e8f\u5217</li> </ul> <p></p> <ul> <li>\u540e\u7f00</li> </ul> <p></p> <ul> <li>\u524d\u7f00</li> </ul> <p></p> <ul> <li>\u5b57\u5178\u5e8f</li> </ul> <p></p> <ul> <li>\u56de\u6587\u4e32</li> </ul> <p></p> <ul> <li>\u5b57\u7b26\u4e32\u7684\u5b58\u50a8</li> </ul> <p></p>"},{"location":"oiwiki/%E5%AD%97%E7%AC%A6%E4%B8%B2/#2","title":"2\uff0c\u6807\u51c6\u5e93","text":"<ul> <li>c\u6807\u51c6\u5e93</li> </ul> <p><code>char[]</code>/<code>const char*</code></p> <ul> <li> <ul> <li>\u8bfb\u5199\uff1ascanf(\"%s\", s)\u3001printf(\"%s\", s)\u3001sscanf(const char __source, const char __format, ...)\u3001sprintf(char __stream, const char __format, ...)</li> </ul> </li> <li> <ul> <li>\u5e38\u89c4\uff1a</li> </ul> </li> <li> <p>strlen(const char *str) \u53d6\u957f\u5ea6</p> </li> <li> <p>strcmp(const char str1, const char str2) \u6bd4\u8f83</p> </li> <li> <p>strcpy(char str, const char src)\u3001strncpy(char str, const char src, int cnt)    \u8d4b\u503c</p> </li> <li> <p>strcat(char str1, const char str2) \u5408\u5e76</p> </li> <li> <ul> <li>\u67e5\u8be2\uff1a</li> </ul> </li> <li> <p>strstr(char str1, const char str2) \u82e5 <code>str2</code> \u662f <code>str1</code> \u7684\u5b50\u4e32\uff0c\u5219\u8fd4\u56de <code>str2</code> \u5728 <code>str1</code> \u7684\u9996\u6b21\u51fa\u73b0\u7684\u5730\u5740\uff1b\u5982\u679c <code>str2</code> \u4e0d\u662f <code>str1</code> \u7684\u5b50\u4e32\uff0c\u5219\u8fd4\u56de <code>NULL</code></p> </li> <li> <p><code>strchr(const char *str, int c)</code>\uff1a\u627e\u5230\u5728\u5b57\u7b26\u4e32 <code>str</code> \u4e2d\u7b2c\u4e00\u6b21\u51fa\u73b0\u5b57\u7b26 <code>c</code> \u7684\u4f4d\u7f6e\uff0c\u5e76\u8fd4\u56de\u8fd9\u4e2a\u4f4d\u7f6e\u7684\u5730\u5740\u3002\u5982\u679c\u672a\u627e\u5230\u8be5\u5b57\u7b26\u5219\u8fd4\u56de <code>NULL</code></p> </li> <li> <p><code>strrchr(const char *str, char c)</code>\uff1a\u627e\u5230\u5728\u5b57\u7b26\u4e32\u00a0<code>str</code>\u00a0\u4e2d\u6700\u540e\u4e00\u6b21\u51fa\u73b0\u5b57\u7b26\u00a0<code>c</code>\u00a0\u7684\u4f4d\u7f6e\uff0c\u5e76\u8fd4\u56de\u8fd9\u4e2a\u4f4d\u7f6e\u7684\u5730\u5740\u3002\u5982\u679c\u672a\u627e\u5230\u8be5\u5b57\u7b26\u5219\u8fd4\u56de\u00a0<code>NULL</code>\u3002</p> </li> </ul> <p>ref\uff1a</p> <p>printf, fprintf, sprintf, snprintf, printf_s, fprintf_s, sprintf_s, snprintf_s - cppreference.com</p> <p>scanf, fscanf, sscanf, scanf_s, fscanf_s, sscanf_s - cppreference.com</p> <p>\u7a7a\u7ec8\u6b62\u5b57\u8282\u5b57\u7b26\u4e32 - cppreference.com</p> <ul> <li>c++\u6807\u51c6\u5e93</li> </ul> <p><code>std::string</code></p> <ul> <li>\u91cd\u8f7d\u4e86\u8d4b\u503c\u8fd0\u7b97\u7b26\u00a0<code>+</code>\uff0c\u5f53\u00a0<code>+</code>\u00a0\u4e24\u8fb9\u662f\u00a0<code>string/char/char[]/const char*</code>\u00a0\u7c7b\u578b\u65f6\uff0c\u53ef\u4ee5\u5c06\u8fd9\u4e24\u4e2a\u53d8\u91cf\u8fde\u63a5\uff0c\u8fd4\u56de\u8fde\u63a5\u540e\u7684\u5b57\u7b26\u4e32\uff08<code>string</code>\uff09\u3002</li> <li>\u8d4b\u503c\u8fd0\u7b97\u7b26\u00a0<code>=</code>\u00a0\u53f3\u4fa7\u53ef\u4ee5\u662f\u00a0<code>const string/string/const char*/char*</code>\u3002</li> <li>\u8bbf\u95ee\u8fd0\u7b97\u7b26\u00a0<code>[cur]</code>\u00a0\u8fd4\u56de\u00a0<code>cur</code>\u00a0\u4f4d\u7f6e\u7684\u5f15\u7528\u3002</li> <li>\u8bbf\u95ee\u51fd\u6570\u00a0<code>data()/c_str()</code>\u00a0\u8fd4\u56de\u4e00\u4e2a\u00a0<code>const char*</code>\u00a0\u6307\u9488\uff0c\u5185\u5bb9\u4e0e\u8be5\u00a0<code>string</code>\u00a0\u76f8\u540c\u3002</li> <li>\u5bb9\u91cf\u51fd\u6570\u00a0<code>size()</code>\u00a0\u8fd4\u56de\u5b57\u7b26\u4e32\u5b57\u7b26\u4e2a\u6570\u3002</li> <li><code>find(ch, start = 0)</code>\u00a0\u67e5\u627e\u5e76\u8fd4\u56de\u4ece\u00a0<code>start</code>\u00a0\u5f00\u59cb\u7684\u5b57\u7b26\u00a0<code>ch</code>\u00a0\u7684\u4f4d\u7f6e\uff1b<code>rfind(ch)</code>\u00a0\u4ece\u672b\u5c3e\u5f00\u59cb\uff0c\u67e5\u627e\u5e76\u8fd4\u56de\u7b2c\u4e00\u4e2a\u627e\u5230\u7684\u5b57\u7b26\u00a0<code>ch</code>\u00a0\u7684\u4f4d\u7f6e\uff08\u7686\u4ece\u00a0<code>0</code>\u00a0\u5f00\u59cb\uff09\uff08\u5982\u679c\u67e5\u627e\u4e0d\u5230\uff0c\u8fd4\u56de\u00a0<code>-1</code>\uff09\u3002</li> <li><code>substr(start, len)</code>\u00a0\u53ef\u4ee5\u4ece\u5b57\u7b26\u4e32\u7684\u00a0<code>start</code>\uff08\u4ece\u00a0<code>0</code>\u00a0\u5f00\u59cb\uff09\u622a\u53d6\u4e00\u4e2a\u957f\u5ea6\u4e3a\u00a0<code>len</code>\u00a0\u7684\u5b57\u7b26\u4e32\uff08\u7f3a\u7701\u00a0<code>len</code>\u00a0\u65f6\u4ee3\u7801\u622a\u53d6\u5230\u5b57\u7b26\u4e32\u672b\u5c3e\uff09\u3002</li> <li><code>append(s)</code>\u00a0\u5c06\u00a0<code>s</code>\u00a0\u6dfb\u52a0\u5230\u5b57\u7b26\u4e32\u672b\u5c3e\u3002</li> <li><code>append(s, pos, n)</code>\u00a0\u5c06\u5b57\u7b26\u4e32\u00a0<code>s</code>\u00a0\u4e2d\uff0c\u4ece\u00a0<code>pos</code>\u00a0\u5f00\u59cb\u7684\u00a0<code>n</code>\u00a0\u4e2a\u5b57\u7b26\u8fde\u63a5\u5230\u5f53\u524d\u5b57\u7b26\u4e32\u7ed3\u5c3e\u3002</li> <li><code>replace(pos, n, s)</code>\u00a0\u5220\u9664\u4ece\u00a0<code>pos</code>\u00a0\u5f00\u59cb\u7684\u00a0<code>n</code>\u00a0\u4e2a\u5b57\u7b26\uff0c\u7136\u540e\u5728\u00a0<code>pos</code>\u00a0\u5904\u63d2\u5165\u4e32\u00a0<code>s</code>\u3002</li> <li><code>erase(pos, n)</code>\u00a0\u5220\u9664\u4ece\u00a0<code>pos</code>\u00a0\u5f00\u59cb\u7684\u00a0<code>n</code>\u00a0\u4e2a\u5b57\u7b26\u3002</li> <li><code>insert(pos, s)</code>\u00a0\u5728\u00a0<code>pos</code>\u00a0\u4f4d\u7f6e\u63d2\u5165\u5b57\u7b26\u4e32\u00a0<code>s</code>\u3002</li> <li><code>std::string</code>\u00a0\u91cd\u8f7d\u4e86\u6bd4\u8f83\u903b\u8f91\u8fd0\u7b97\u7b26\uff0c\u590d\u6742\u5ea6\u662f\u00a0\\(\\Theta(N)\\)\u00a0\u7684\u3002</li> </ul> <p>ref\uff1astd::basic_string - cppreference.com</p>"},{"location":"oiwiki/%E5%AD%97%E7%AC%A6%E4%B8%B2/#3","title":"3\uff0c\u5b57\u7b26\u4e32\u5339\u914d","text":"<ul> <li>\u5206\u7c7b</li> <li> <ul> <li>\u5355\u4e32\u5339\u914d\uff1a\u7ed9\u5b9a\u4e00\u4e2a\u6a21\u5f0f\u4e32\u548c\u4e00\u4e2a\u5f85\u5339\u914d\u4e32\uff0c\u627e\u51fa\u524d\u8005\u5728\u540e\u8005\u4e2d\u7684\u6240\u6709\u4f4d\u7f6e\u3002</li> </ul> </li> <li> <ul> <li> <p>\u591a\u4e32\u5339\u914d\uff1a\u7ed9\u5b9a\u591a\u4e2a\u6a21\u5f0f\u4e32\u548c\u4e00\u4e2a\u5f85\u5339\u914d\u4e32\uff0c\u627e\u51fa\u8fd9\u4e9b\u6a21\u5f0f\u4e32\u5728\u540e\u8005\u4e2d\u7684\u6240\u6709\u4f4d\u7f6e\u3002</p> </li> <li> <p>\u51fa\u73b0\u591a\u4e2a\u5f85\u5339\u914d\u4e32\u65f6\uff0c\u5c06\u5b83\u4eec\u76f4\u63a5\u8fde\u8d77\u6765\u4fbf\u53ef\u4f5c\u4e3a\u4e00\u4e2a\u5f85\u5339\u914d\u4e32\u5904\u7406\u3002</p> </li> <li> <p>\u53ef\u4ee5\u76f4\u63a5\u5f53\u505a\u5355\u4e32\u5339\u914d\uff0c\u4f46\u662f\u6548\u7387\u4e0d\u591f\u9ad8\u3002</p> </li> </ul> </li> <li> <ul> <li>\u5176\u4ed6\u7c7b\u578b\uff1a\u4f8b\u5982\u5339\u914d\u4e00\u4e2a\u4e32\u7684\u4efb\u610f\u540e\u7f00\uff0c\u5339\u914d\u591a\u4e2a\u4e32\u7684\u4efb\u610f\u540e\u7f00\u2026\u2026</li> </ul> </li> <li> <p>\u7b97\u6cd5</p> </li> <li> <ul> <li>BF (Brute Force) \u7b97\u6cd5 \\(O(n)\\to O(n\\times m)\\)</li> </ul> </li> </ul> <pre><code>vector&lt;int&gt; ans;\nvoid match(char *s, char *t){\nint n = strlen(s), m = strlen(t);\nfor(int i=0, j; i&lt;=n-m; ++i){\nfor(j=0; j&lt;m; ++j) if(s[i + j] != t[j]) break;\nif(j == m) ans.push_back(i);\n}\n}\n</code></pre> <ul> <li> <ul> <li>\u54c8\u5e0c \\(hash\\)</li> </ul> </li> <li> <ul> <li>\\(kmp\\)</li> </ul> </li> </ul>"},{"location":"oiwiki/%E5%AD%97%E7%AC%A6%E4%B8%B2/#4","title":"4\uff0c\u5b57\u7b26\u4e32\u54c8\u5e0c\uff08\u5f85\u8865\uff09","text":"<ul> <li>hash\u601d\u60f3</li> </ul> <p>Hash \u7684\u6838\u5fc3\u601d\u60f3\u5728\u4e8e\uff0c\u5c06\u8f93\u5165\u6620\u5c04\u5230\u4e00\u4e2a\u503c\u57df\u8f83\u5c0f\u3001\u53ef\u4ee5\u65b9\u4fbf\u6bd4\u8f83\u7684\u8303\u56f4\u3002</p> <p></p> <ul> <li> <ul> <li>Hash \u51fd\u6570\uff1a\u628a\u5b57\u7b26\u4e32\u6620\u5c04\u5230\u6574\u6570\u7684\u51fd\u6570 \\(f\uff1astring \\to int\\) </li> </ul> </li> </ul> <p>\\(f_s ~=~ \\sum\\limits_{i=1}^{|s|}s_i\\times b^{|s|-i} \\pmod{p}\\) \uff08\u591a\u9879\u5f0fhash\u65b9\u6cd5\uff1b\u5e38\u7528\uff09</p> <p>\u5176\u4ed6\u5b9a\u4e49\uff1a\\(f_s ~~=~~ \\sum\\limits_{i=1}^{|s|}s_i\\times b^{i} \\pmod{p}\\) </p> <p></p> <p></p> <ul> <li> <ul> <li>\u54c8\u5e0c\u78b0\u649e\uff1aHash \u51fd\u6570\u503c\u4e00\u6837\u65f6\u539f\u5b57\u7b26\u4e32\u5374\u4e0d\u4e00\u6837\u7684\u73b0\u8c61</li> </ul> </li> <li> <ul> <li>\u76ee\u6807\uff1a\u65f6\u95f4\u590d\u6742\u5ea6\u548c Hash \u7684\u51c6\u786e\u7387\uff08\u6216 \u78b0\u649e\u6982\u7387\uff09</li> </ul> </li> </ul> <p></p> <p>\uff08\u4e0a\u9762\u7684 \\(M\\) \u6307\u7684\u662f \\(p\\)\uff09</p> <ul> <li>\u5b9e\u73b0</li> </ul> <p>\\(f_{s,~-1} = 0 \\\\ f_{s,~i} ~=~ b\\times f_{s,~i-1} + s_i\\) \uff08\u4e0d\u4f1a\u63a8\uff09</p> <pre><code>const int B = 233, P = 1e9+7;\n// \u5355\u6b21\u8ba1\u7b97\u54c8\u5e0c\u503c\uff08\u590d\u6742\u5ea6\u9ad8\uff09\nint h(string s){\nint ans = 0;\nfor(int i=0; i&lt;s.size(); ++i) ans = (1ll * ans * B + s[i]) % P;\nreturn ans;\n}\n</code></pre> <pre><code>#define int long long\nconst int B = 233, P = 1e9+7;\nint f[100003];\nvoid init(string s){\nf[0] = s[0];\nfor(int i=1; i&lt;s.size(); ++i) f[i] = (f[i-1] * B + s[i]) % P;\n}\nint get(int lb, int ub){\nint ans = 1, a = B, n = ub - lb + 1;\nwhile(n){\nif(n &amp; 1) ans = ans * a % P;\na = a * a % P;\nn &gt;&gt;= 1;\n}\nreturn f[ub] - f[lb-1] * ans % P;\n}\nint h(string s){\nint ans = 0;\nfor(int i=0; i&lt;s.size(); ++i) ans = (1ll * ans * B + s[i]) % P;\nreturn ans;\n}\n</code></pre> <ul> <li> <ul> <li>\u9519\u8bef\u7387\uff1a\u82e5\u8fdb\u884c \\(n\\) \u6b21\u6bd4\u8f83\uff0c\u6bcf\u6b21\u9519\u8bef\u7387 \\(\\frac{1}{p}\\)\uff0c\u90a3\u4e48\u603b\u9519\u8bef\u7387\u662f\\(1-(1-\\frac{1}{p})^n\\)\uff0c\u5728\u968f\u673a\u6570\u636e\u4e0b\uff0c\u82e5\\(p=1e9+7\\) \uff0c\\(n=1e6\\)\uff0c\u9519\u8bef\u7387\u7ea6\u4e3a\\(\\frac{1}{1000}\\) \uff0c\u5e76\u4e0d\u662f\u80fd\u591f\u5b8c\u5168\u5ffd\u7565\u4e0d\u8ba1\u7684\u3002\u6240\u4ee5\uff0c\u8fdb\u884c\u5b57\u7b26\u4e32\u54c8\u5e0c\u65f6\uff0c\u7ecf\u5e38\u4f1a\u5bf9\u4e24\u4e2a\u5927\u8d28\u6570\u5206\u522b\u53d6\u6a21\uff0c\u8fd9\u6837\u7684\u8bdd\u54c8\u5e0c\u51fd\u6570\u7684\u503c\u57df\u5c31\u80fd\u6269\u5927\u5230\u4e24\u8005\u4e4b\u79ef\uff0c\u9519\u8bef\u7387\u5c31\u975e\u5e38\u5c0f\u4e86</li> </ul> </li> </ul> <p>Problem - 5685 (hdu.edu.cn)\uff08\u54c8\u5e0c\u51fd\u6570\u4e0d\u540c\uff0c\u4e5f\u53ef\u4ee5\u505a\u7c7b\u4f3c\u7684\u9884\u5904\u7406\uff09</p> <ul> <li> <p>\u5e94\u7528</p> </li> <li> <ul> <li>\u5b57\u7b26\u4e32\u5339\u914d</li> </ul> </li> </ul> <p>\u6c42\u51fa\u6a21\u5f0f\u4e32\u7684\u54c8\u5e0c\u503c\u540e\uff0c\u6c42\u51fa\u6587\u672c\u4e32\u6bcf\u4e2a\u957f\u5ea6\u4e3a\u6a21\u5f0f\u4e32\u957f\u5ea6\u7684\u5b50\u4e32\u7684\u54c8\u5e0c\u503c\uff0c\u5206\u522b\u4e0e\u6a21\u5f0f\u4e32\u7684\u54c8\u5e0c\u503c\u6bd4\u8f83\u5373\u53ef\u3002</p> <ul> <li> <ul> <li>\u5141\u8bb8 \\(k\\) \u6b21\u5931\u914d\u7684\u5b57\u7b26\u4e32\u5339\u914d</li> </ul> </li> <li> <ul> <li>\u6700\u957f\u56de\u6587\u5b50\u4e32</li> </ul> </li> <li> <ul> <li>\u6700\u957f\u516c\u5171\u5b50\u5b57\u7b26\u4e32</li> </ul> </li> <li> <ul> <li>\u786e\u5b9a\u5b57\u7b26\u4e32\u4e2d\u4e0d\u540c\u5b50\u5b57\u7b26\u4e32\u7684\u6570\u91cf</li> </ul> </li> </ul> <p>\u76f8\u5173\u6587\u7ae0\uff1a</p> <p>[\u6559\u7a0b]\u6eda\u52a8\u54c8\u5e0c\u548c8\u4e2a\u6709\u8da3\u7684\u95ee\u9898[\u7f16\u8f91] - Codeforces</p> <p>ACM\u5b57\u7b26\u4e32\u9898\u76ee\u603b\u7ed3_weixin_30416497\u7684\u535a\u5ba2-CSDN\u535a\u5ba2</p>"},{"location":"oiwiki/%E5%AD%97%E7%AC%A6%E4%B8%B2/#5trie","title":"5\uff0c\u5b57\u5178\u6811trie","text":"<p>\u5b57\u5178\u6811\uff0c\u82f1\u6587\u540d trie\u3002\u987e\u540d\u601d\u4e49\uff0c\u5c31\u662f\u4e00\u4e2a\u50cf\u5b57\u5178\u4e00\u6837\u7684\u6811\u3002</p> <p></p> <p>\uff08\u539f\u56fe\uff1atrie1.png (793\u00d7841) (oi-wiki.org)\uff09</p> <p></p> <ul> <li>1\uff0c\u68c0\u7d22\u5b57\u7b26\u4e32</li> </ul> <p></p> <pre><code>const int N =5e5+3;\nstruct trie{\n//  \u5047\u8bbe\u5b57\u7b26\u96c6\u4e3a\u5c0f\u5199\u5b57\u6bcd\nint idx, ne[N][26];\nint st[N];\nvoid ins(char *s, int l){\nint p = 0;\nfor(int i=0; i&lt;l; ++i){\nint e = s[i] - 'a';\nif(!ne[p][e]) ne[p][e] = ++ idx;\np = ne[p][e];\n}\nst[p] = true;\n}\nint find(char *s, int l){\nint p = 0;\nfor(int i=0; i&lt;l; ++i){\nint e = s[i] - 'a';\nif(!ne[p][e]) return false;\np = ne[p][e];\n}\nreturn !st[p] ? false : (st[p]==1 ? st[p] ++ : st[p]);\n}\n};\n</code></pre> <ul> <li> <p>2\uff0c\\(ac\\) \u81ea\u52a8\u673a\uff1atrie \u662f\u00a0AC \u81ea\u52a8\u673a\u00a0\u7684\u4e00\u90e8\u5206\u3002</p> </li> <li> <p>3\uff0c\u7ef4\u62a4\u5f02\u6216\u6781\u503c</p> </li> </ul> <p></p> <p>P4551 \u6700\u957f\u5f02\u6216\u8def\u5f84 - \u6d1b\u8c37 | \u8ba1\u7b97\u673a\u79d1\u5b66\u6559\u80b2\u65b0\u751f\u6001 (luogu.com.cn)</p> <p></p> <p></p> <p>\u95ee\u9898\u53ef\u4ee5\u8f6c\u5316\u4e3a\u6c42\u4efb\u4e00\u4e24\u4e2a\u7ed3\u70b9\u7684\u201c\u5f02\u6216\u6df1\u5ea6\u201d\uff08\u4ece\u6839\u5230\u7ed3\u70b9\u7684\u5f02\u6216\u548c\uff09\uff0c\u6734\u7d20\u7684\u590d\u6742\u5ea6\u4e3a\\(O(\\binom{n}{2})\\)\uff0ctrie+\u8d2a\u5fc3\u4f18\u5316\u540e\u4e3a \\(O(N\\times log N)\\)</p> <p>\uff08\u597d\u9898\uff09</p> <pre><code>#include&lt;iostream&gt;\n#include&lt;cstring&gt;\nusing namespace std;\nconst int N = 1e5+3, LEN = 32;\nstruct trie{\nint idx, ne[N * LEN][2];\nvoid ins(int n){\nint u = 0;\nfor(int i=30; ~i; --i){\nint e = n &gt;&gt; i &amp; 1;\nif(!ne[u][e]) ne[u][e] = ++ idx;\nu = ne[u][e];\n}\n}\nint ans;\nvoid find(int n){\nint ret = 0;\nint u = 0;\nfor(int i=30; ~i; --i){\nint e = n &gt;&gt; i &amp; 1;\nif(ne[u][e ^ 1]){\n// e ^ (e ^ 1) = 1\nret |= 1 &lt;&lt; i;\nu = ne[u][e ^ 1];\n}else u = ne[u][e];\n}\nans = max(ans, ret);\n}\n}tr;\nstruct edge{ int v, ne, w; }e[N&lt;&lt;1];\nint idx, n, h[N];\nvoid add(int u, int v, int w){\ne[ ++ idx] = {v, h[u], w}, h[u] = idx;\n}\n// \u6c42 \u201c\u8fb9\u6743\u5f02\u6216\u524d\u7f00\u201d \uff08\u4ece\u6839\u5230\u6bcf\u4e2a\u7ed3\u70b9\u7684\u8fb9\u6743\u5f02\u6216\u548c\uff09 \nint d[N];\nvoid dfs(int u, int p){\ntr.find(d[u]);\ntr.ins(d[u]);\nfor(int i=h[u]; i; i=e[i].ne){\nint v = e[i].v, w = e[i].w;\nif(v == p) continue;    d[v] = d[u] ^ w;\ndfs(v, u);\n}\n}\nint main(){\ncin &gt;&gt; n;\nidx = 0, memset(h, 0, sizeof h);\nfor(int i=1; i&lt;n; ++i){\nint u, v, w;\ncin &gt;&gt; u &gt;&gt; v &gt;&gt; w;\nadd(u, v, w);\nadd(v, u, w);\n}\ndfs(1, 0);\ncout &lt;&lt; tr.ans &lt;&lt; '\\n';\n}\n</code></pre> <ul> <li>4\uff0c\u7ef4\u62a4\u5f02\u6216\u548c</li> </ul> <p></p> <p></p> <ul> <li> <ul> <li>\u63d2\u5165 &amp; \u5220\u9664</li> </ul> </li> </ul> <p></p> <p></p> <ul> <li> <ul> <li>\u5168\u5c40\u52a0\u4e00</li> </ul> </li> </ul> <p></p> <p></p> <pre><code>const int N = 1e5+3, H = 21;\nstruct trie{\nint idx, ne[N * (H + 1)][2], w[N * (H + 1)], xorv[N * (H + 1)];\nint mknode(){\nne[ ++ idx][0] = ne[idx][1] = w[idx] = xorv[idx] = 0;\nreturn idx;\n}\nint up(int u){\nw[u] = xorv[u] = 0;\nint a = ne[u][0], b = ne[u][1];\nif(a){\nw[u] += w[a];\nxorv[u] ^= xorv[a] &lt;&lt; 1;\n}\nif(b){\nw[u] += w[b];\nxorv[u] ^= (xorv[b] &lt;&lt; 1) | (w[b] &amp; 1);\n}\n//        w[u] \u4ec5\u4fdd\u5b58\u5947\u5076\u6027 \n//        w[u] &amp;= 1;\n}\n// \u589e\u5220\nvoid ins(int u, int n, int dp){\nif(!u) u = mknode();\nif(dp == H) return void(++ w[u]);\nins(ne[u][n &amp; 1], n &gt;&gt; 1, dp + 1);\nup(u);\n}\nint d;\nvoid del(int u, int n, int dp){\nif(dp == H) return void(-- w[u]);\ndel(ne[u][n &amp; 1], n &gt;&gt; 1, dp + 1);\nup(u);\n}\n//  \u5168\u5c40\u52a0\u4e00\nvoid addall(int u){\n//      \nif(ne[u][1]) addall(ne[u][1]);\nswap(ne[u][0], ne[u][1]);\nup(u);\n}\n}tr;\n</code></pre> <ul> <li>5\uff0c01-trie\u5408\u5e76</li> </ul> <p></p> <pre><code>int merge(int a, int b){\nif(!a) return b;\nif(!b) return a;\nw[a] += w[b], xorv[a] ^= xorv[b];\nne[a][0] = merge(ne[a][0], ne[b][0]);\nne[a][1] = merge(ne[a][1], ne[b][1]);\nreturn a;\n}\n</code></pre> <p>P6018 [Ynoi2010] Fusion tree - \u6d1b\u8c37 | \u8ba1\u7b97\u673a\u79d1\u5b66\u6559\u80b2\u65b0\u751f\u6001 (luogu.com.cn)</p> <p>P6623 [\u7701\u9009\u8054\u8003 2020 A \u5377] \u6811 - \u6d1b\u8c37 | \u8ba1\u7b97\u673a\u79d1\u5b66\u6559\u80b2\u65b0\u751f\u6001 (luogu.com.cn)</p> <p>Trie \u6811 \u57fa\u7840\u7ec3\u4e60 - \u9898\u5355 - \u6d1b\u8c37 | \u8ba1\u7b97\u673a\u79d1\u5b66\u6559\u80b2\u65b0\u751f\u6001 (luogu.com.cn)</p> <ul> <li>6\uff0c\u53ef\u6301\u4e45\u5316trie\u6811</li> </ul>"},{"location":"oiwiki/%E5%AD%97%E7%AC%A6%E4%B8%B2/#6kmp","title":"6\uff0ckmp","text":"<pre><code>vector&lt;int&gt; pi;\nvoid kmp(string s){\nint n = s.size();\npi.clear(), pi.resize(n);\npi[0] = 0;\nfor(int i=1; i&lt;n; ++i){\nint j;\nfor(j=pi[i-1]; j &amp;&amp; s[j]!=s[i]; j=pi[j-1]);\npi[i] = s[j]==s[i] ? j+1 : j;\n}\n}\n</code></pre>"},{"location":"oiwiki/%E5%AD%97%E7%AC%A6%E4%B8%B2/#7z","title":"7\uff0cz\u51fd\u6570","text":"<p>\u6734\u7d20\u7248</p> <pre><code>vector&lt;int&gt; z;\nvoid zf(string s){\nint n = s.size();\nz.clear(), z.resize(n);\nz[0] = 0;\nfor(int i=1; i&lt;n; ++i){\nfor(; i+z[i]&lt;n &amp;&amp; s[z[i]]==s[i+z[i]]; ++ z[i]);\n}\n}\n</code></pre> <p>\u7ebf\u6027\u7248</p> <pre><code>void ZF(string s){\ncin &gt;&gt; s;\nint n = s.size();\nz.clear(), z.resize(n);\nz[0] = 0;\nfor(int i=1, lb=0, ub=0; i&lt;n; ++i){\nif(i&lt;=ub &amp;&amp; z[i-lb]&lt;ub-i+1) z[i] = z[i-lb];\nelse{\nz[i] = max(0, ub-i+1);\nfor(; i+z[i]&lt;=n &amp;&amp; s[z[i]]==s[i+z[i]]; ++ z[i]);\n}\nif(ub &lt; i+z[i]-1) lb = i, ub = i+z[i]-1;\n}\n}\n</code></pre>"},{"location":"oiwiki/%E5%AD%97%E7%AC%A6%E4%B8%B2/#8ac","title":"8\uff0cAC\u81ea\u52a8\u673a","text":"<p>\u7528\u4e8e\u89e3\u51b3 \u591a\u6a21\u5f0f\u5339\u914d</p> <p>\\(ac\\) \u81ea\u52a8\u673a \\(=\\) \\(kmp+trie\\)</p> <p></p> <p>P3796 \u3010\u6a21\u677f\u3011AC \u81ea\u52a8\u673a\uff08\u52a0\u5f3a\u7248\uff09 - \u6d1b\u8c37 | \u8ba1\u7b97\u673a\u79d1\u5b66\u6559\u80b2\u65b0\u751f\u6001 (luogu.com.cn)</p> <pre><code>const int N = 153*73, M = 153;\nstring S[M];\nint n, tr[N][26], idx, st[N], q[N], s, t, f[N];\nvoid add(string s, int id){\nint u = 0;\nfor(int i=0, e; e=s[i]-'a', i&lt;s.size(); ++i, u=tr[u][e]){\nif(!tr[u][e]) tr[u][e] = ++ idx;\n}\nst[u] = id;\n}\nvoid ac(){\ns = 1, t = 0;\nfor(int i=0; i&lt;26; ++i) if(tr[0][i]) q[ ++ t] = tr[0][i];\nwhile(s &lt;= t){\nint u = q[s ++ ];\nfor(int i=0; i&lt;26; ++i){\nif(tr[u][i]){\nq[ ++ t] = tr[u][i];\nf[tr[u][i]] = tr[f[u]][i];\n}else tr[u][i] = tr[f[u]][i];\n}\n}\n}\nint tr_ans[N], li_ans[M];\nvoid get(string t){\nfor(int i=0, u=0; u=tr[u][t[i]-'a'], i&lt;t.size(); ++i){\nfor(int j=u; j; j=f[j]){\n++ tr_ans[j];\n}\n}\nint ans = 0;\nfor(int i=1; i&lt;=idx; ++i){\nif(st[i]){\nans = max(ans, tr_ans[i]);\nli_ans[st[i]] = tr_ans[i];\n}\n}\ncout &lt;&lt; ans &lt;&lt; '\\n';\nfor(int i=1; i&lt;=n; ++i){\nif(li_ans[i] == ans){\ncout &lt;&lt; S[i] &lt;&lt; '\\n';\n}\n}\n}\nvoid init(){\nidx = 0, memset(tr, 0, sizeof tr), memset(st, 0, sizeof st);\nmemset(f, 0, sizeof f);\nmemset(tr_ans, 0, sizeof tr_ans);\nmemset(li_ans, 0, sizeof li_ans);\n}\n</code></pre>"},{"location":"oiwiki/%E5%AD%97%E7%AC%A6%E4%B8%B2/#9sa","title":"9\uff0c\u540e\u7f00\u6570\u7ec4sa","text":"<p>\uff08\u5b57\u7b26\u4e32\u5927\u5c0f\u6bd4\u8f83\uff1a</p> <p>\u5148\u5c06\u4e24\u5b57\u7b26\u4e32\u5411\u5de6\u5bf9\u9f50\uff0c\u7136\u540e\u5bf9\u8f83\u5c0f\u7684\u5b57\u7b26\u4e32\u7684\u540e\u51e0\u4f4d\\((\\ge 0)\\) \u4ee5\\(ASCII\\)\u7801 \\(-\\infin\\) \u586b\u8865</p> <p>1\uff0c\u4ece\u5de6\u5230\u53f3\u627e\u5230\u7b2c\u4e00\u4e2a\u4e24\u5b57\u7b26\u4e0d\u540c\u7684\u4f4d\u7f6e\uff0c\u6b64\u5904\\(ASCII\\)\u5c0f\u7684\u4e00\u65b9 \u6570\u503c\u201c\u66f4\u5c0f\u201d</p> <p>2\uff0c\u627e\u4e0d\u5230\u4e0d\u76f8\u540c\u7684\u4f4d\u7f6e\uff0c\u5219\u8868\u660e\u4e24\u5b57\u7b26\u4e32\u76f8\u7b49\uff09</p> <ul> <li>\u7ea6\u5b9a</li> </ul> <p>\u5b57\u7b26\u4e32\u4e0b\u6807\u4ece \\(1\\) \u5f00\u59cb</p> <p>\u6d89\u53ca\u4e24\u4e2a\u6570\u7ec4\uff1a\u7f16\u53f7\u6570 \\(sa[~]\\) \uff0c\u6392\u540d\u6570 \\(rk[~]\\)</p> <p></p> <p>\uff08\\(sa_i\\) \u8868\u793a \u8c01\u7b2c \\(i\\) \u5c0f\uff0c \\(rk_i\\) \u8868\u793a \\(\\mathop{suf}_i\\) \u7b2c\u51e0\u5c0f\uff1b\u4e24\u8005\u5747\u662f\u53cc\u5c04\u51fd\u6570\uff09</p> <p>1\uff09\u500d\u589e</p> <p>\u590d\u6742\u5ea6\uff1a\\(O(n\\log^2{n})\\)</p> <pre><code>const int N = 1e6+3;\nchar s[N];\nint n;\nint sa[N], rk[N&lt;&lt;1], prk[N&lt;&lt;1];\nvoid init(){\nn = strlen(s + 1);\nfor(int i=1; i&lt;=n; ++i) sa[i] = i, rk[i] = s[i];\nfor(int w=1; w&lt;n; w&lt;&lt;=1){\nsort(sa+1, sa+n+1, [w](int a, int b){\nreturn rk[a] != rk[b] ? rk[a] &lt; rk[b] : rk[a+w] &lt; rk[b+w];\n});\nmemcpy(prk, rk, sizeof rk);\nfor(int i=1, p=0; i&lt;=n; ++i){\nif(prk[sa[i]] == prk[sa[i-1]] &amp;&amp; prk[sa[i] + w] == prk[sa[i-1] + w]) rk[sa[i]] = p;\nelse rk[sa[i]] = ++ p;\n}\n}\nfor(int i=1; i&lt;=n; ++i) cout &lt;&lt; sa[i] &lt;&lt; ' ';\ncout &lt;&lt; '\\n';\n}\n</code></pre> <p>2\uff09\u500d\u589e+\u57fa\u6570\u6392\u5e8f\uff1a</p> <p>\u590d\u6742\u5ea6\uff1a\\(O(n\\times \\log n)\\)</p> <pre><code>const int N = 1e6+3;\nint n;\nchar s[N];\nint sa[N], rk[N&lt;&lt;1], prk[N&lt;&lt;1];\nint w[N], sa1[N];\nvoid init(){\nn = strlen(s + 1);\n//  for(int i=1; i&lt;=n; ++i) sa[i] = i, rk[i] = s[i];\nint m = 127;\nfor(int i=1; i&lt;=n; ++i) ++ w[ rk[i]=s[i] ];\nfor(int i=1; i&lt;=m; ++i) w[i] += w[i-1];\nfor(int i=n; i&gt;=1; --i) sa[w[ rk[i] ]--] = i;\nmemcpy(prk+1, rk+1, n * sizeof(int));\nfor(int k=0, i=1; i&lt;=n; ++i){\nif(prk[sa[i]] == prk[sa[i-1]]) rk[sa[i]] = k;\nelse rk[sa[i]] = ++ k;\n}\nm = n;\nfor(int p=1; p&lt;n; p&lt;&lt;=1){\nmemset(w, 0, sizeof w);\nmemcpy(sa1+1, sa+1, n * sizeof(int));\nfor(int i=1; i&lt;=n; ++i) ++ w[ rk[sa1[i]+p] ];\nfor(int i=1; i&lt;=m; ++i) w[i] += w[i-1];\nfor(int i=n; i&gt;=1; --i) sa[w[ rk[sa1[i]+p] ]--] = sa1[i];\nmemset(w, 0, sizeof w);\nmemcpy(sa1+1, sa+1, n * sizeof(int));\nfor(int i=1; i&lt;=n; ++i) ++ w[ rk[sa1[i]] ];\nfor(int i=1; i&lt;=m; ++i) w[i] += w[i-1];\nfor(int i=n; i&gt;=1; --i) sa[w[ rk[sa1[i]] ]--] = sa1[i];\nmemcpy(prk+1, rk+1, n * sizeof(int));\nfor(int k=0, i=1; i&lt;=n; ++i){\nif(prk[sa[i]] == prk[sa[i-1]] &amp;&amp; prk[sa[i]+p] == prk[sa[i-1]+p]) rk[sa[i]] = k;\nelse rk[sa[i]] = ++ k;\n}\n}\nfor(int i=1; i&lt;=n; ++i) cout &lt;&lt; sa[i] &lt;&lt; ' ';\ncout &lt;&lt; '\\n';\n}\n</code></pre> <p>3\uff09\u5176\u4ed6\u7ebf\u6027\u7b97\u6cd5\uff1a\u8bf1\u5bfc\u6392\u5e8f\u4e0e SA-IS \u7b97\u6cd5\uff1bdc3</p>"},{"location":"oiwiki/%E5%B9%B6%E6%9F%A5%E9%9B%86/","title":"\u5e76\u67e5\u96c6","text":""},{"location":"oiwiki/%E5%B9%B6%E6%9F%A5%E9%9B%86/#1-union-find-structure","title":"1\uff0c\u5e76\u67e5\u96c6 union-find structure","text":"<p>\u5e76\u67e5\u96c6\u5e94\u7528 - OI Wiki (oi-wiki.org)</p> <p>\u5e76\u67e5\u96c6\u662f\u4e00\u79cd\u6811\u5f62\u7684\u6570\u636e\u7ed3\u6784\uff0c\u987e\u540d\u601d\u4e49\uff0c\u5b83\u7528\u4e8e\u5904\u7406\u4e00\u4e9b\u4e0d\u4ea4\u96c6\u7684 \u5408\u5e76 \u53ca \u67e5\u8be2 \u95ee\u9898\u3002 \u5b83\u652f\u6301\u4e24\u79cd\u64cd\u4f5c\uff1a</p> <ul> <li>\u67e5\u627e\uff08Find\uff09\uff1a\u786e\u5b9a\u67d0\u4e2a\u5143\u7d20\u5904\u4e8e\u54ea\u4e2a\u5b50\u96c6\uff1b</li> <li>\u5408\u5e76\uff08Union\uff09\uff1a\u5c06\u4e24\u4e2a\u5b50\u96c6\u5408\u5e76\u6210\u4e00\u4e2a\u96c6\u5408\u3002</li> </ul> <p></p> <ul> <li>\u521d\u59cb\u5316</li> </ul> <p>\\(warning\\)\uff1a\u6709\u65f6\u5019\u4e3a\u4e86\u4f7f\u9898\u76ee\u66f4\u7e41\u6742\u4e00\u70b9\uff0c\u7ed3\u70b9\u7684\u6807\u53f7\u53ef\u80fd\u4e3a\u8d1f \u6216\u8005 \u9700\u8981\u79bb\u6563\u5316</p> <pre><code>void init(int n){ for(int i=0; i&lt;n; ++i) fa[i] = i; }\n</code></pre> <ul> <li>\u67e5\u627e\uff08+\u8bb0\u5fc6\u5316\uff09</li> </ul> <p></p> <p></p> <p></p> <p></p> <pre><code>// \u975e\u9012\u5f52\uff0c\u65e0\u8bb0\u5fc6\u5316\nint find(int u){\nwhile(u != fa[u]) u = fa[u];\nreturn u;\n}\n// \u9012\u5f52\uff0c\u8bb0\u5fc6\u5316\nint find(int u){\nif(u == fa[u]) return u;\nreturn fa[u] = find(fa[u]);\n}\n</code></pre> <ul> <li>\u8bb0\u5fc6\u5316\u5408\u5e76\uff08\u9002\u5408\u6709\u5411\u5173\u7cfb\uff09</li> </ul> <p></p> <pre><code>// \u5408\u5e76 u \u4e0e v \u6240\u5728\u7684\u5bb6\u65cf\nvoid mer(int u, int v){\nu = find(u), v = find(v);\nfa[u] = v;\n}\n</code></pre> <ul> <li>\u542f\u53d1\u5f0f\u5408\u5e76\uff08\u9002\u5408\u5b58\u50a8\u65e0\u5411\u5173\u7cfb\uff1b\u4fdd\u62a4\u6811\u7ed3\u6784\uff09</li> </ul> <p></p> <p></p> <p></p> <p></p> <p>\uff08\u4f7f\u7528\u542f\u53d1\u5f0f\u5408\u5e76\u662f\u660e\u667a\u7684\uff09</p> <p>\u65f6\u7a7a\u590d\u6742\u5ea6\uff1a\\(O(m\\times\\alpha(m,~n))\\approx O(m\\times \\log{n})\\)\uff0c\\(O(n)\\)</p> <pre><code>const int N = 1e5+3;\nstruct US{\nint n, fa[N], sz[N];\nUS(int x){ n = x; for(int i=0; i&lt;n; ++i) fa[i] = i; fill(sz, sz+n, 1); }\nint find(int u){\nif(u == fa[u]) return u;\nreturn find(fa[u]);\n}\nvoid mer(int u, int v){\nint x = find(u), y = find(v);\nif(x == y) return ;\nif(sz[x] &gt; sz[y]) swap(x, y);\nfa[x] = y;\n//      sz[y] = max(sz[x] + 1, sz[y]);    // \u5982\u679csz\u8868\u793a\u9ad8\u5ea6\u65f6\nsz[y] += sz[x];\n}\n}tr(N);\n</code></pre> <ul> <li>\u5e26\u6743\u5e76\u67e5\u96c6</li> </ul> <p></p> <ul> <li> <p>\u4f8b\u9898</p> </li> <li> <ul> <li>1\uff0c\u3010NOI2015\u3011\u7a0b\u5e8f\u81ea\u52a8\u5206\u6790 - \u9898\u76ee - Universal Online Judge (uoj.ac)</li> </ul> </li> </ul> <p>\u79bb\u6563\u5316 + \u5e38\u89c4\u5e76\u67e5\u96c6</p> <ul> <li> <ul> <li>2\uff0cP1197 [JSOI2008] \u661f\u7403\u5927\u6218 - \u6d1b\u8c37 | \u8ba1\u7b97\u673a\u79d1\u5b66\u6559\u80b2\u65b0\u751f\u6001 (luogu.com.cn)</li> </ul> </li> </ul> <p>\u6bcf\u6b21\u8fdb\u884c\u5220\u70b9\u64cd\u4f5c\uff0c\u5e76\u4e14\u6c42\u8fde\u901a\u5757\u4e2a\u6570\uff0c\u5e76\u67e5\u96c6\u4e0d\u9002\u5408\u5220\u70b9\uff0c\u8003\u8651\u4ece\u672b\u72b6\u6001\u63a8\u81f3\u521d\u59cb\u72b6\u6001</p> <p>\u5148\u8ba1\u7b97\u672b\u72b6\u6001\u7684\u8fde\u901a\u5757\u6570\uff0c\u5e76\u4e14\u6bcf\u6b21\u8fdb\u884c\u52a0\u70b9\u64cd\u4f5c\uff08\u540c\u65f6\u8fde\u63a5\u76f8\u5173\u7684\u8fb9\uff0c\u6545\u9700\u8981\u5148\u5b58\u65e0\u5411\u56fe\uff09</p> <p>\u4e24\u4e2a\u91cd\u70b9</p> <p>1\uff0c\u8ba1\u7b97\u672b\u72b6\u6001\u7684\u8fde\u901a\u5757\u6570\uff1a\u5047\u8bbe\u8fde\u901a\u5757\u6570\u4e3a\u70b9\u7684\u4e2a\u6570\uff1b\u4e8e\u662f\u6bcf\u6b21\u52a0\u4e0a\u5f53\u524d\u72b6\u6001\u5b58\u5728\u7684\u8fb9\uff08\u8fb9\u7684\u4fe1\u606f\u6765\u81ea\u4e8e\u65e0\u5411\u56fe\uff09\u5c31\u4f1a\u4f7f\u8fde\u901a\u5757\u6570 \\(-1\\)</p> <p>2\uff0c\u52a0\u70b9\u64cd\u4f5c\u5bf9\u8fde\u901a\u5757\u6570\u7684\u5f71\u54cd\uff1a\u8fde\u901a\u5757\u6570\u5148 \\(+1\\) \uff0c\u904d\u5386\u5e76\u52a0\u4e0a\u8be5\u70b9\u7684\u5b58\u5728\u7684\u76f8\u5173\u8fb9\uff0c\u6bcf\u6b21\u6210\u529f\u52a0\u8fb9\u90fd\u9700\u8981\u4f7f \u8fde\u901a\u5757\u6570 \\(-1\\)</p> <ul> <li> <ul> <li>3\uff0cP2024 [NOI2001] \u98df\u7269\u94fe - \u6d1b\u8c37 | \u8ba1\u7b97\u673a\u79d1\u5b66\u6559\u80b2\u65b0\u751f\u6001 (luogu.com.cn)</li> </ul> </li> </ul> <p>\u5e26\u6743\u5e76\u67e5\u96c6\uff08\u901a\u8fc7\u66f4\u65b0\u7ed3\u70b9\u4e0e\u7236\u4eb2\u7684\u6743\u503c\uff0c\u53ef\u4ee5\u5feb\u901f\u63a8\u5bfc\u4efb\u610f\u4e24\u70b9\u7684\u5173\u7cfb\uff09</p> <p>\u8fd9\u91cc\u4f7f\u7528\u8bb0\u5fc6\u5316\u641c\u7d22\uff08\u8fd9\u9898\u542f\u53d1\u5f0f\u5408\u5e76\u4f3c\u4e4e\u4e0d\u597d\u7528\uff09</p> <p>\u4ee5\u4e0b\u8ba8\u8bba\u6743\u503c \\(W\\) \u7684\u66f4\u65b0</p> <p>1\uff0c\u67e5\u8be2\uff1a\u5bf9\u4e8e\u8bb0\u5fc6\u5316\u641c\u7d22\uff0c\u53ea\u6709\u4e09\u79cd\u60c5\u51b5\uff0c\u53ef\u4ee5\u53d1\u73b0\u6743\u503c\u4ec5\u5728\u7b2c\u4e09\u79cd\u60c5\u51b5\u4e0b\u9700\u8981\u66f4\u65b0</p> <p>\\(W_u' ~=~ (W_u + W_f)\\%3\\)</p> <p></p> <p>2\uff0c\u5408\u5e76\uff1a\u7531\u4e8e\u8bb0\u5fc6\u5316\u641c\u7d22\u7684\u5f71\u54cd\uff0cu \u548c v\u7684\u5173\u7cfb\u53ea\u6709\u56db\u79cd</p> <p>\u8003\u8651\u6700\u4e00\u822c\u7684\u7b2c\u56db\u79cd\u60c5\u51b5 $W_x + W_u = W_v + rel \\implies W_x = (W_v + rel - W_u)\\% 3 $</p> <p>\uff08\\(W_u \u6216 W_v = 0\\) \u53ef\u4ee5\u5bf9\u5e94\u4e8e\u524d\u4e09\u79cd\u60c5\u51b5\uff09</p> <p></p> <pre><code>#include&lt;iostream&gt;\nusing namespace std;\nconst int N = 5e4+3;\n// fa, w \u4e24\u8005\u5747\u662f\u5411\u4e0a\u76f8\u5173\u503c \nint fa[N], w[N];\nvoid init(int n){ for(int i=0; i&lt;=n; ++i) fa[i] = i, w[i] = 0; }\nint find(int u){\nint f = fa[u];\nif(f == u) return u;\nint f1 = find(f);\nif(f1 == f) return f;\n// \u66f4\u65b0 u \u7684\u5411\u4e0a\u76f8\u5173\u503c \nreturn w[u] = (w[u] + w[f]) % 3, fa[u] = f1;\n}\nbool add(int u, int v, int rel){\nint x = find(u), y = find(v);\nif(x == y) return false;\n// x\u6b32\u5408\u5e76\u5230y\u4e0a\uff0c\u66f4\u65b0 x\u7684\u5411\u4e0a \u548c y\u7684\u5411\u4e0b \u7684\u76f8\u5173\u503c\uff08\u4f46\u662f\u8fd9\u9898 y\u7684\u76f8\u5173\u503c\u4e0d\u7528\u53d8\uff09 \nw[x] = (w[v] + rel - w[u] + 3) % 3, fa[x] = y;\nreturn true;\n}\nint n, m;\nint main(){\nint ans = 0;\ncin &gt;&gt; n &gt;&gt; m;\ninit(n);\nfor(int i=0; i&lt;m; ++i){\nint op, u, v;\ncin &gt;&gt; op &gt;&gt; u &gt;&gt; v;\n//      \u8f93\u5165\u5f02\u5e38\uff08\u552f\u6709\u8f93\u5165\u6b63\u786e\uff0cadd()\u51fd\u6570\u624d\u80fd\u6b63\u786e\u5224\u65ad\uff09\nif(u &gt; n || v &gt; n){\n++ ans;\ncontinue;\n}\nif(op == 1){\nif(!add(u, v, 0) &amp;&amp; (w[u] - w[v] + 3) % 3 != 0) ++ ans;\n}else{\nif(!add(u, v, 1) &amp;&amp; (w[u] - w[v] + 3) % 3 != 1) ++ ans;\n}\n}\ncout &lt;&lt; ans &lt;&lt; '\\n';\n}\n</code></pre> <ul> <li> <ul> <li>4\uff0cP1196 [NOI2002] \u94f6\u6cb3\u82f1\u96c4\u4f20\u8bf4 - \u6d1b\u8c37 | \u8ba1\u7b97\u673a\u79d1\u5b66\u6559\u80b2\u65b0\u751f\u6001 (luogu.com.cn)</li> </ul> </li> </ul> <p>\\((u,~v)\\) \u7684\u5408\u5e76\u64cd\u4f5c\u88ab\u6307\u5b9a\u4e3a \u5c06 \\(u\\) \u6240\u5728\u7684\u96c6\u5408\uff08\u6216 \\(u\\) \u7684\u7956\u5148 \\(x\\)\uff09\u5408\u5e76\u5230 \\(v\\) \u7684\u540e\u9762</p> <p>\uff08\u8fd9\u610f\u5473\u7740\u5408\u5e76\u64cd\u4f5c\u6709\u5e8f\uff0c\u5373 \\(add(u,~v)\\ne add(v,~u)\\)\uff09</p> <p>\u6bcf\u6b21\u9700\u8981\u67e5\u8be2 \\(u,~v\\) \u4e4b\u95f4\u7684\u7ed3\u70b9\u4e2a\u6570\uff0c\u7528 \\(w[~]\\) \uff08\u5411\u4e0a\u76f8\u5173\u503c\uff09\u7ef4\u62a4\u5373\u53ef\uff0c\u800c\u5408\u5e76\u65f6\u66f4\u65b0 \\(w\\) \u53c8\u9700\u8981\u77e5\u9053 \\(v\\) \u6240\u5728\u96c6\u5408\u7684\u5927\u5c0f\uff0c\u5219\u518d\u7ef4\u62a4\u96c6\u5408\u7684\u7ed3\u70b9\u6570 \\(num[~]\\) \uff08\u5168\u5c40\u76f8\u5173\u503c\uff09</p> <pre><code>int fa[N], w[N], num[N];\nvoid init(int n){ for(int i=0; i&lt;=n; ++i) fa[i] = i, w[i] = 0, num[i] = 1; }\nint find(int u){\nint f = fa[u];\nif(f == u) return u;\nint f1 = find(f);\nif(f1 == f) return f;\nreturn w[u] = w[u] + w[f], num[u] = num[f1], fa[u] = f1;\n}\nbool add(int u, int v){\nint x = find(u), y = find(v);\nif(x == y) return false;\nw[x] = 1 + (num[y] - 1), num[x] = num[x] + num[y], fa[x] = y;\nnum[y] = num[x];\nreturn true;\n}\n</code></pre> <ul> <li> <ul> <li>5\uff0cUVA11987 Almost Union-Find - \u6d1b\u8c37 | \u8ba1\u7b97\u673a\u79d1\u5b66\u6559\u80b2\u65b0\u751f\u6001 (luogu.com.cn)</li> </ul> </li> </ul> <p>\u96be\u70b9\uff1a\u5220\u70b9</p> <pre><code>const int N = 2e5+3;\n// num, sum \u5747\u662f\u5168\u5c40\u76f8\u5173\u503c \nint fa[N], num[N], sum[N];\n// 1..n \u5185\u5b58\u7684\u662f\u5b9e\u9645\u7684\u5143\u7d20\u7684\u6307\u9488\uff0c n+1 .. n+n \u5b58\u7684\u662f\u865a\u70b9\uff08\u5305\u542b\u5404\u79cd\u76f8\u5173\u503c\uff09 \nvoid init(int n){\nfor(int i=0; i&lt;=n; ++i)\nfa[i] = fa[i + n] = i + n, num[i + n] = 1, sum[i + n] = i; }\nint find(int u){\nint f = fa[u];\nif(f == u) return u;\nint f1 = find(f);\nif(f1 == f) return f;\nreturn fa[u] = f1;\n}\nbool add(int u, int v){\nint x = find(u), y = find(v);\nif(x == y) return false;\nnum[x] += num[y], sum[x] += sum[y], fa[x] = y;\nnum[y] = num[x], sum[y] = sum[x];\nreturn true;\n}\nbool move(int u, int v){\nint x = find(u), y = find(v);\nif(x == y) return false;\n// \u79fb\u52a8 u \u5230 v \u7684\u6839 y \u4e0a \nfa[u] = y;\n// \u6539\u53d8 u \u5bf9\u76f8\u5173\u91cf\u7684\u8d21\u732e \n-- num[x], sum[x] -= u;\n++ num[y], sum[y] += u;\nreturn true;\n}\n</code></pre> <p>P3144 [USACO16OPEN]Closing the Farm S - \u6d1b\u8c37 | \u8ba1\u7b97\u673a\u79d1\u5b66\u6559\u80b2\u65b0\u751f\u6001 (luogu.com.cn)</p>"},{"location":"oiwiki/%E6%9D%82%E9%A1%B9/","title":"\u6742\u9879","text":""},{"location":"oiwiki/%E6%9D%82%E9%A1%B9/#1","title":"1\u3001\u53cc\u6307\u9488","text":"<ul> <li>\u7ef4\u62a4\u533a\u95f4\u4fe1\u606f</li> </ul> <ul> <li>1\uff0c713. \u4e58\u79ef\u5c0f\u4e8e K \u7684\u5b50\u6570\u7ec4 - \u529b\u6263\uff08LeetCode\uff09</li> </ul> <pre><code>const int N = 1e5+3;\nint n, k;\nint a[N];\nint f(){\nlong long prod = 1ll, ans = 0;\n// ub \u5148\u79fb\u52a8\uff0c\u518d\u66f4\u65b0 \uff1b lb \u5148\u66f4\u65b0\uff0c\u518d\u79fb\u52a8 \nfor(int lb = 1, ub = 1; ub &lt;= n; ++ ub){\nprod *= a[ub];\n</code></pre> <pre><code>      // \u5bfb\u627e \u6ee1\u8db3\u9898\u610f \u4e0e \u4e0d\u6ee1\u8db3\u9898\u610f \u7684\u4e2d\u4ecb\u70b9 lb_end\n      while(lb &lt;= ub &amp;&amp; prod &gt;= k) prod /= a[lb ++];\n      ans += ub - lb + 1;\n  }\n  return ans;\n</code></pre> <p>}</p> <pre><code>\u7c7b\u4f3c\u9898\u76ee\uff1a\u533a\u95f4\u548c\u4e0d\u5c0f\u4e8ek\u7684\u533a\u95f4\u4e2a\u6570\uff08\u5b9e\u9645\u4e0a\uff0c\u4e5f\u53ef\u4ee5\u7528\u5bb9\u65a5\uff0c\u5373\u6bcf\u6b21\u5927\u5faa\u73af\uff0c$ans ~+=~ ub - (ub-lb+1)=lb-1$\uff1b\u5f53\u7136\uff0c\u753b\u56fe\u4e5f\u662f\u53ef\u4ee5\u7684\uff09\n\n```cpp\n\nint f(){\n    long long sum = 0, ans = 0;\n    for(int lb = 1, ub = 1; ub &lt;= n; ++ ub){\n        sum += a[ub];\n\n        while(lb &lt;= ub &amp;&amp; sum &gt;= k) sum -= a[lb ++ ];\n        ans += lb - 1;\n    }\n    return ans;\n}\n</code></pre> <ul> <li>2\uff0cP3066 [USACO12DEC]Running Away From the Barn G - \u6d1b\u8c37 | \u8ba1\u7b97\u673a\u79d1\u5b66\u6559\u80b2\u65b0\u751f\u6001 (luogu.com.cn)\uff08\u53cc\u6307\u9488+\u6811\u4e0a\u5dee\u5206\uff09</li> </ul> <p>\u524d\u8a00\uff1a</p> <p>\uff08\u5929\u554a \uff0c\u4e0d\u4f1a\uff01\uff01\uff09</p> <p></p> <p>\u795e\u4ed9\u7684\u9898\u89e3\uff1a</p> <ul> <li> <p>\u5b50\u5e8f\u5217\u5339\u914d</p> </li> <li> <p>524. \u901a\u8fc7\u5220\u9664\u5b57\u6bcd\u5339\u914d\u5230\u5b57\u5178\u91cc\u6700\u957f\u5355\u8bcd - \u529b\u6263\uff08LeetCode\uff09</p> <pre><code>const int N = 1e3+3;\nint n;\nstring s, dict[N];\n// priority\uff1a\u957f\u5ea6 higner\uff0c\u5b57\u5178\u5e8f higher\nvoid solve(){\nstring ans_str;\nint ans_len = 0;\nsort(dict + 1, dict + n + 1);\nfor(int i=n; i&gt;=1; -- i){\nint lb = 0;\nfor(int ub = 0; ub &lt; s.length(); ++ ub){\nif(s[ub] == dict[i][lb]) ++ lb;\n}\nif(lb == dict[i].length()){\nif(ans_len &lt;= lb){\nans_len = lb;\nans_str = dict[i];\n}\n}\n}\n//    cout &lt;&lt; ans_len &lt;&lt; '\\n';\ncout &lt;&lt; ans_str &lt;&lt; '\\n';\n}\n</code></pre> </li> <li> <p>\u5229\u7528\u5e8f\u5217\u6709\u5e8f\u6027</p> </li> <li> <p>167. \u4e24\u6570\u4e4b\u548c II - \u8f93\u5165\u6709\u5e8f\u6570\u7ec4 - \u529b\u6263\uff08LeetCode\uff09</p> </li> </ul> <pre><code>const int N = 1e5+3;\nint n, k;\nint a[N];\nvoid f(){\nint lb = 1, ub = n;\nwhile(lb &lt; ub){\nif(a[lb] + a[ub] &gt; k) -- ub;\nelse if(a[lb] + a[ub] &lt; k) ++ lb;\nelse{\nprintf(\"%d %d\\n\", lb, ub);\nbreak;\n}\n}\n}\n</code></pre> <ul> <li>\u5355\u5411\u94fe\u8868\u4e2d\u627e\u73af</li> </ul>"},{"location":"oiwiki/%E6%9D%82%E9%A1%B9/#2","title":"2\uff0c\u79bb\u6563\u5316","text":"<ul> <li>\u6574\u6570\u79bb\u6563</li> </ul> <p>\u65b9\u6cd51\uff1a\uff08\u652f\u6301\u6d6e\u70b9\u6570\uff0c\u5b57\u7b26\u4e32\u79bb\u6563\uff09</p> <pre><code>map&lt;int, int &gt; mp;\n// idx\u5c3d\u91cf\u521d\u59cb\u5316\u4e3a0\nint idx;\n// \u52a8\u6001\u7f16\u53f7\nint get(int x){ return mp[x] ? mp[x] : mp[x] = ++idx; }\n</code></pre> <p>\u65b9\u6cd52\uff1a</p> <pre><code>const int N = 1e5+3;\nint n, num[N];\n// \u91cd\u65b0\u7f16\u53f7\nvoid dis(){ sort(num, num + n), n = unique(num, num + n) - num; }\n// \u67e5\u8be2\u65b0\u7f16\u53f7\nint get(int x){ return lower_bound(num, num+n, x) - num; }\n</code></pre> <p>\u65b9\u6cd53\uff1a</p> <pre><code>vector&lt;int&gt; num;\nvoid dis(){\nsort(num.begin(), num.end());\nnum.erase(unique(num.begin(), num.end()), num.end());\n}\nint get(int x){ return lower_bound(num.begin(), nmu.end(), x) - lower_bound(); }\n</code></pre> <p>\uff08\u4e5f\u53ef\u4ee5\u5c06\u9700\u8981\u79bb\u6563\u5316\u7684\u6570\u636e\u5b58\u5728\u6570\u7ec4\u91cc\uff0c\u52a0\u5feb\u67e5\u8be2 \\(O(\\log{n})\\to O(1)\\)\uff09</p> <ul> <li>\u4f8b\u9898\uff1aP1955 [NOI2015] \u7a0b\u5e8f\u81ea\u52a8\u5206\u6790 - \u6d1b\u8c37 | \u8ba1\u7b97\u673a\u79d1\u5b66\u6559\u80b2\u65b0\u751f\u6001 (luogu.com.cn)</li> </ul> <p>\uff08\u8003\u5bdf\u5e76\u67e5\u96c6 + \u79bb\u6563\u5316\uff09</p> <p>\u79bb\u6563\u5316\u90e8\u5206\u4ee3\u7801\uff1a</p> <pre><code>struct Q{\n// \u8981\u5bf9 u, v \u8fdb\u884c\u79bb\u6563\uff0c\u6240\u4ee5\u5148\u628a\u8f93\u5165\u6570\u636e\u5b58\u8d77\u6765\u79bb\u7ebf\u5904\u7406\nint u, v, f;\n// \u9898\u76ee\u7684\u7279\u6b8a\u5904\u7406\uff08\u4e0d\u662f\u79bb\u6563\u5316\u7684\u91cd\u70b9\uff09\nbool operator&lt;(const Q&amp;t){ return f&gt;t.f; }\n}q[N];\nint n;\nint idx, A[N&lt;&lt;1];\nvoid init(){\nidx = 0;\n// \u8f93\u5165\u9700\u8981\u79bb\u6563\u7684\u6570\u636e \nfor(int i=0; i&lt;n; ++i) A[ ++ idx] = q[i].u, A[ ++ idx] = q[i].v;\n// \u79bb\u6563\u5316 \nsort(A + 1, A + idx + 1), idx = unique(A + 1, A + idx + 1) - A;\n// \u8f93\u51fa\u79bb\u6563\u5316\u7684\u6570\u636e \nfor(int i=0; i&lt;n; ++i){\nq[i].u = lower_bound(A + 1, A + idx + 1, q[i].u) - A;\nq[i].v = lower_bound(A + 1, A + idx + 1, q[i].v) - A;\n}\n}\n</code></pre>"},{"location":"oiwiki/%E6%9D%BF%E5%AD%90/","title":"\u677f\u5b50","text":""},{"location":"oiwiki/%E6%9D%BF%E5%AD%90/#1ntt","title":"1\uff0cNTT","text":"<pre><code>#include&lt;iostream&gt;\n#include&lt;algorithm&gt;\nusing namespace std;\n#define int long long\nconst int P = (479&lt;&lt;21) + 1;\nconst int N = (1e6+3)*4;\nint fp(int a, int n){\nint ans = 1;\nwhile(n){\nif(n &amp; 1) ans = ans * a % P;\na = a * a % P;\nn &gt;&gt;= 1;\n}\nreturn ans;\n}\nint rev[N];\nvoid ntt(int y[], int len, int op){\nfor(int i=0; i&lt;len; ++i){\nrev[i] = rev[i&gt;&gt;1]&gt;&gt;1 | (i &amp; 1) * (len &gt;&gt; 1);\nif(i &lt; rev[i]) swap(y[i], y[rev[i]]);\n}\nfor(int n=2; n&lt;=len; n&lt;&lt;=1){\nint gn = fp(3, (P - 1) / n);\nif(op == -1) gn = fp(gn, P-2);\nfor(int j=0; j&lt;len; j+=n){\nint g = 1;\nfor(int k=j; k&lt;j+n/2; ++k){\nint u = y[k], v = y[k + n/2] * g % P;\ny[k] = (u + v) % P;\ny[k + n/2] = (u - v + P) % P;\ng = g * gn % P;\n}\n}\n}\nif(~op) return ;\n//    reverse(y + 1, y + len);\nint il = fp(len, P-2);\nfor(int i=0; i&lt;len; ++i) y[i] = y[i] * il % P;\n}\nint n, m;\nint a[N], b[N];\nsigned main(){\ncin &gt;&gt; n &gt;&gt; m;\nfor(int i=0; i&lt;=n; ++i) cin &gt;&gt; a[i];\nfor(int i=0; i&lt;=m; ++i) cin &gt;&gt; b[i];\nint l = 1;\nwhile(l &lt;= n+m) l &lt;&lt;= 1;\nntt(a, l, 1);\nntt(b, l, 1);\nfor(int i=0; i&lt;l; ++i) a[i] = a[i] * b[i] % P;\nntt(a, l, -1);\nfor(int i=0; i&lt;=n+m; ++i) cout &lt;&lt; a[i] &lt;&lt; ' ';\n}\n</code></pre>"},{"location":"oiwiki/%E6%9D%BF%E5%AD%90/#2burnside-polya","title":"2\uff0cBurnside &amp; p\u00f3lya","text":""},{"location":"oiwiki/%E6%9D%BF%E5%AD%90/#3","title":"3\uff0c\u7b5b\u6cd5","text":"<p>\u7ea6\u6570\u4e2a\u6570</p> <pre><code>const int N = 5e6+3;\nbool np[N];\nint p[N], idx;\nint num[N], d[N];\nvoid pre(int n){\nnum[1] = d[1] = 1;\nfor(int i = 2; i &lt;= n; ++ i){\nif(!np[i]) p[++ idx] = i, num[i] = 1, d[i] = 2;\nfor(int j = 1; p[j] &lt;= n/i; ++ j){\nnp[i * p[j]] = true;\nint n = i * p[j];\nnum[n] = i % p[j] ? num[i] * num[p[j]] : num[i] + 1; // num[n] = i % p[j] ? 1 : num[i] + 1;\nd[n] = i % p[j] ? d[i] * d[p[j]] : d[i] / num[n] * (num[n] + 1);\n// d[n] = i % p[j] ? d[i] * 2 : d[i] / num[n] * (num[n] + 1); \nif(!(i % p[j])) break;\n}\n}\nfor(int i=1; i&lt;=10; i++) cout &lt;&lt; num[i] &lt;&lt; ' ' &lt;&lt; d[i] &lt;&lt; '\\n';\n}\n</code></pre> <p>\u7ea6\u6570\u548c</p> <pre><code>const int N = 5e6+3;\nbool np[N];\nint p[N], idx;\nint g[N], f[N];\nvoid pre(int n){\ng[1] = f[1] = 1;\nfor(int i = 2; i &lt;= n; ++ i){\nif(!np[i]) p[++ idx] = i, g[i] = i + 1, f[i] = i + 1;\nfor(int j = 1; p[j] &lt;= n/i; ++ j){\nnp[i * p[j]] = true; int n = i * p[j];\ng[n] = i % p[j] ? g[i] * g[p[j]] : g[i] * p[j] + 1;\n// g[n] = i % p[j] ? 1 + p[j] : g[i] * p[j] + 1;\nf[n] = i % p[j] ? f[i] * f[p[j]] : f[i] / g[i] * g[n]; if(!(i % p[j])) break;\n}\n}\n}\n</code></pre>"},{"location":"oiwiki/%E6%9D%BF%E5%AD%90/#4","title":"4\uff0c\u6b27\u62c9","text":"<p>\u6734\u7d20\u7248 &amp; \u4f18\u5316\u7248</p> <pre><code>int f(int n){\nint ans = n;\nfor(int i=2; i&lt;=n/i; ++i){\nif(n % i) continue;\nfor(; !(n % i); n /= i);\nans = ans / i * (i - 1);\n}\nif(n &gt; 1) ans = ans / n * (n - 1);\nreturn ans;\n}\n// \u7ebf\u6027\u7b5b\u4f18\u5316\nint f(int n){\nint ans = n;\nfor(int i=1; i&lt;=idx &amp;&amp; p[i]&lt;=n/p[i]; ++i){\nif(n % p[i]) continue;\nfor(; !(n % p[i]); n/=p[i]);\nans = ans / p[i] * (p[i] - 1);\n}\nif(n &gt; 1) ans = ans / n * (n - 1);\nreturn ans;\n}\n</code></pre>"},{"location":"oiwiki/%E6%9D%BF%E5%AD%90/#5","title":"5\uff0c\u7c7b\u6b27\u51e0\u91cc\u5f97","text":"<pre><code>#include&lt;iostream&gt;\nusing namespace std;\n#define int long long\nconst int p = 998244353;\nint i2, i6;\ninline int inv(int n){ return n==1 ? 1 : (p - p / n) * inv(p % n) % p; }\ninline int s0(int n){ return n + 1; }\ninline int s1(int n){ return n * (n + 1) % p * i2 % p; }\ninline int s2(int n){ return n * (n + 1) % p * (2 * n + 1) % p * i6 % p; }\nstruct func{\nint f, g, h;\n};\nfunc calc(int a, int b, int c, int n){\nint ac = a / c, bc = b / c, D = (a * n + b) / c;\nif(!a) return {bc * s0(n) % p, bc * s1(n) % p, bc * bc % p * s0(n) % p};\nif(a &gt;= c || b &gt;= c){\nfunc x1 = calc(a % c, b % c, c, n);\nreturn {\n(ac * s1(n) % p + bc * s0(n) % p + x1.f) % p,\n(ac * s2(n) % p + bc * s1(n) % p + x1.g) % p,\n(ac * ac % p * s2(n) % p + 2 * ac * bc % p * s1(n) % p + bc * bc % p * s0(n) % p + x1.h + 2 * ac * x1.g % p + 2 * bc * x1.f % p) % p\n};\n}\nfunc x2 = calc(c, c - b - 1, a, D - 1);\nfunc x = {\n((D * n - x2.f) % p + p) % p,\n((D * s1(n) % p - i2 * x2.h % p - i2 * x2.f % p) % p + p) % p,\n((D * (D + 1) % p * n % p - 2 * x2.g % p - 2 * x2.f % p) % p + p) % p\n};\nx.h = ((x.h - x.f) % p + p) % p;\nreturn x;\n}\nsigned main(){\ni2 = inv(2), i6 = inv(6);\n//    cout &lt;&lt; i2 &lt;&lt; ' ' &lt;&lt; i6 &lt;&lt; '\\n';\nint T;\ncin &gt;&gt; T;\nwhile(T--){\nint n, a, b, c;\ncin &gt;&gt; n &gt;&gt; a &gt;&gt; b &gt;&gt; c;\nfunc x = calc(a, b, c, n);\ncout &lt;&lt; x.f &lt;&lt; ' ' &lt;&lt; x.h &lt;&lt; ' ' &lt;&lt; x.g &lt;&lt; '\\n';\n}\nreturn 0;\n}\n</code></pre>"},{"location":"oiwiki/%E6%9D%BF%E5%AD%90/#6","title":"6\uff0c\u6b27\u51e0\u91cc\u5f97 &amp; \u7ebf\u6027\u540c\u4f59","text":"<pre><code>int exgcd(int a, int b, int &amp;x, int &amp;y){\nif(!b) return x = 1, y = 0, a;\nint d = exgcd(b, a % b, x, y), x1 = x;\nreturn x = y, y = x1 - a / b * y, d;\n}\nint liEu(int a, int b, int n){\nint x, y, d = exgcd(a, b, x, y);\nif(n % d) return -1;\nint nd = n / d, bd = b / d;\nx *= nd;\nreturn (x % bd + bd) % bd;\n}\n</code></pre> <p>\\(x_1\\le x\\le x_2,~y_1\\le y\\le y_2\\)\uff0c\u6c42\u89e3\u7684\u6570\u91cf</p> <pre><code>int x1, x2, y1, y2;\nint liEu(int a, int b, int n){\nif(n &lt; 0) a *= -1, b *= -1, n *= -1;\nif(a &lt; 0) a *= -1, swap(x1, x2), x1 *= -1, x2 *= -1;\nif(b &lt; 0) b *= -1, swap(y1, y2), y1 *= -1, y2 *= -1;\nint l = x2-x1+1, l1 = y2-y1+1;\nif(!a &amp;&amp; !b) return !n ? l * l1 : 0;\nif(!a) return !(n % b) &amp;&amp; n/b&gt;=y1 &amp;&amp; n/b&lt;=y2 ? l : 0;\nif(!b) return !(n % a) &amp;&amp; n/a&gt;=x1 &amp;&amp; n/a&lt;=x2 ? l1 : 0; int x, y, d = exgcd(a, b, x, y);\nif(n % d) return 0;\nint nd = n / d, bd = b / d, ad = a / d;\nx *= nd, y *= nd;\nint s1 = ceil(1.0*(x1-x)/bd), s2 = floor(1.0*(x2-x)/bd);\nint t1 = ceil(1.0*(y2-y)/-ad), t2 = floor(1.0*(y1-y)/-ad);\nreturn max(0ll, min(s2, t2) - max(s1, t1) + 1);\n}\n</code></pre>"},{"location":"oiwiki/%E6%9D%BF%E5%AD%90/#7","title":"7\uff0c\u4e2d\u56fd\u5269\u4f59","text":"<pre><code>int excrt(int n, int *a, int *b){\nint A1 = a[1], B1 = b[1];\nfor(int i=2; i&lt;=n; ++i){\nint A2 = a[i], B2 = b[i];\n// liEu(a, b, c, x, y)\nint x, y;\nint d = exgcd(B1, B2, x, y), c = A2 - A1, cd = c / d, bd = B2 / d;\nif(c % d) return -1;\nx *= cd, y *= cd;\n// \u6c42\u89e3\u6700\u5c0f\u6b63\u6574\u6570\u89e3\nx = (x % bd + bd) % bd;\nA1 += B1 * x, B1 *= bd;\n}\n// \u4e0d\u77e5\u9053\u8981\u4e0d\u8981\u6a21 B1 \uff1f\nreturn A1;\n}\n</code></pre>"},{"location":"oiwiki/%E6%9D%BF%E5%AD%90/#8","title":"8\uff0c\u5362\u5361\u65af","text":"<pre><code>#define int long long\nconst int N = 2e5+3;\nint P;\nint fac[N], ifac[N];\nvoid init(int n){\nfac[0] = ifac[0] = ifac[1] = 1;\nfor(int i=1; i&lt;=n; ++i) fac[i] = fac[i-1] * i % P;\nfor(int i=2; i&lt;=n; ++i) ifac[i] = (P - P / i) * ifac[P % i] % P;\nfor(int i=1; i&lt;=n; ++i) ifac[i] = ifac[i-1] * ifac[i] % P;\n}\nint c(int a, int b){\nif(a &lt; P) return fac[a] * ifac[a-b] % P *ifac[b] % P;\nreturn c(a / P, b / P) * c(a % P, b % P) % P;\n}\n</code></pre> <pre><code>#define int long long\nconst int N = 4e4+3, p = 999911659, pb = p - 1;\nint k, a[4 + 1], b[4 + 1];\nvoid breakdown(int n){\n// \u6784\u9020 b[] \nfor(int i=2; i&lt;=n; ++i){\nif(n % i) continue;\nwhile(!(n % i)) n /= i;\nb[++ k] = i;\n}\nif(n &gt; 1) b[++ k] = n;\n}\nint fac[N];\nvoid init(int p){ fac[0] = 1; for(int i=1; i&lt;=p; ++i) fac[i] = fac[i-1] * i % p; }\nint fp(int a, int n, int p){ int ans = 1;while(n){    if(n &amp; 1) ans = ans * a % p;a = a * a % p;    n &gt;&gt;= 1; } return ans; }\nint inv(int n, int p){  return fp(n, p-2, p); }\nint c(int a, int b, int p){ return a &lt; b ? 0 : fac[a] * inv(fac[a - b], p) % p * inv(fac[b], p) % p; }\nint lucas(int a, int b, int p){ return !b ? 1 : lucas(a / p, b / p, p) * c(a % p, b % p, p) % p; }\nint crt(int k, int *a, int *b, int n){\n// \u6784\u9020 a[]\uff0c \u5373 x \u6a21 \u5404\u79cd bi \u610f\u4e49\u4e0b\u7684\u503c \nfor(int i=1; i&lt;=k; ++i){\ninit(b[i]);\nint ans = 0;\nfor(int j=1; j * j &lt;= n; ++j){\nif(n % j) continue;\nans = (ans + lucas(n, j, b[i])) % b[i];\nif(j * j != n) ans = (ans + lucas(n, n / j, b[i])) % b[i];\n}\na[i] = ans;\n}\n// \u5408\u5e76 \nint ans = 0;\nfor(int i=1; i&lt;=k; ++i){\nint b1 = pb / b[i], ib1 = inv(b1, b[i]);\nans = (ans + a[i] * b1 % pb * ib1 % pb) % pb;\n}\nreturn ans;\n}\n</code></pre>"},{"location":"oiwiki/%E6%9D%BF%E5%AD%90/#9","title":"9\uff0c\u79bb\u6563\u6839","text":"<pre><code>int log(int a, int b){\nif(b==1) return 0;\nint sq = sqrt(P) + 1;\nmap&lt;int, int&gt; T;\nint pr = 1;\nfor(int t=0; t&lt;sq; ++t){\nT[b * pr % P] = t;\npr = pr * a % P;\n}\nint pr1 = 1;\nfor(int s=1; s&lt;=sq; ++s){\npr1 = pr1 * pr % P;\nif(T.count(pr1)) return sq * s - T[pr1];\n}\nreturn -1;\n}\n//\n</code></pre> <pre><code>int gcd(int a, int b){ return !b ? a : gcd(b, a % b); }\nint fp(int a, int n, int p){ int ans = 1; while(n){ if(n &amp; 1) ans = 1ll * ans * a % p; a = 1ll * a * a % p; n &gt;&gt;= 1; } return ans; }\nint exbsgs(int a, int b, int p){\nif(b == 1) return 0;\n// \u533a\u522b 1 \nlong long cnt = 0, k = 1, d;\nwhile((d = gcd(a, p)) &gt; 1){\nif(b % d) return -1;\nb /= d, p /= d;\n++ cnt, k = a / d * k % p;\nif(k == b) return cnt;\n}\nint sq = sqrt(p) + 1;\nunordered_map&lt;int, int&gt; dec;\nd = b;\nfor(int i=0; i&lt;sq; ++i){\ndec[d] = i;\nd = d * a % p;\n}\nint asq = fp(a, sq, p);\n// \u533a\u522b2\uff0cd\u521d\u59cb\u5316\u4e3a k\uff0c\u800c\u4e0d\u662f 1\nd = k;\nfor(int i=1; i&lt;=sq; ++i){\nd = d * asq % p;\n// \u533a\u522b3\uff0c\u7ed3\u679c\u52a0\u4e0a cnt \nif(dec.count(d)) return cnt + i * sq - dec[d];\n}\nreturn -1;\n}\n</code></pre>"},{"location":"oiwiki/%E6%9D%BF%E5%AD%90/#10","title":"10\uff0c\u83ab\u6bd4\u4e4c\u65af","text":""},{"location":"oiwiki/%E6%9D%BF%E5%AD%90/#1","title":"1\uff0c\u5e76\u67e5\u96c6","text":"<ul> <li>\u542f\u53d1\u5f0f\u5408\u5e76\uff08\u4f18\u5148\u7ea7\u9ad8\u8005\u4f5c\u4e3a\u7956\u5148\uff09</li> <li>\u5224\u73af</li> </ul> <pre><code>const int N = 5e4+3, P = 3;\nint fa[N], w[N];\nvoid init(int n){ for(int i=0; i&lt;=n; ++i) fa[i] = i, w[i] = 0; }\nint find(int u){\nint f = fa[u];\nif(f == u) return u;\nint f1 = find(f);\nw[u] = (w[u] + w[f]) % P;\nreturn fa[u] = f1;\n}\nbool add(int u, int v, int rel){\nint x = find(u), y = find(v);\nif(x == y) return (w[u] - w[v] + P) % P == rel % P;\nfa[x] = y;\nw[x] = (w[v] + rel - w[u] + P) % P;\nreturn true;\n}\n</code></pre>"},{"location":"oiwiki/%E6%9D%BF%E5%AD%90/#2","title":"2\uff0c\u6811\u72b6\u6570\u7ec4","text":"<ul> <li> <p>\u6ce8\u610f\u79bb\u6563\u5316\uff1b\u4e0b\u6807\u4ece1\u5f00\u59cb\uff1b\u6743\u503c\u6570\u7ec4\u5b581\u4ee5\u4e0a\u7684\u503c</p> </li> <li> <p>\u53ef\u7ed3\u5408map</p> </li> </ul> <pre><code>#define lb(u) (u &amp; -u)\nint f[N], g[N];\nvoid add(int tr[], int u, int w){\nfor(int i=u; i&lt;N; i+=lb(i)) tr[i] += w;\n}\nint gsum(int tr[], int u){\nint ans = 0;\nfor(int i=u; i&gt;0; i-=lb(i)) ans += tr[i];\nreturn ans;\n}\nint gsum(int tr[], int lb, int ub){ return gsum(tr, ub) - gsum(tr, lb-1); }\n</code></pre>"},{"location":"oiwiki/%E6%9D%BF%E5%AD%90/#3_1","title":"3\uff0c\u77e9\u9635","text":"<ul> <li> <p>\u6c42\u9012\u63a8\u51fd\u6570\u7684\u4e24\u4e2a\u95ee\u9898\uff1a\u8fb9\u754c\u503c\uff0c\u9012\u63a8\u5f0f</p> </li> <li> <p>\u5217\u5411\u91cf\u7684 \\(k\\) \u6b21\u8f6c\u79fb</p> </li> <li> <p>\u6c42\u5e42\u65f6\uff0c\\(n\\ge 1\\) \u6216 \\(n\\ge 0\\) \uff08\u6839\u636e\u5b9e\u73b0\u7684\u7ec6\u8282\u800c\u4e0d\u540c\uff09</p> </li> </ul> <pre><code>#define int long long\nstruct mat{\nint r, c;\nvector&lt;vector&lt;int&gt;&gt; m;\nvector&lt;int&gt;&amp; operator[](int i){ return m[i]; }\nmat(int r, int c):r(r),c(c) { m.resize(r, vector&lt;int&gt;(c)); }\n};\nint P = 10;\nmat operator*(mat a, mat b){\nmat ans(a.r, b.c);\nfor(int i=0; i&lt;a.r; ++i) for(int k=0; k&lt;a.c; ++k) if(a[i][k]) for(int j=0; j&lt;b.c; ++j)\nans[i][j] = (ans[i][j] + a[i][k] * b[k][j] % P + P) % P;\nreturn ans;\n}\nmat operator+(mat a, mat b){\nmat ans(a.r, a.c);\nfor(int i=0; i&lt;a.r; ++i) for(int j=0; j&lt;a.c; ++j)\nans[i][j] = (a[i][j] + b[i][j]) % P;\nreturn ans;\n}\nmat operator^(mat a, int n){\nmat ans = a;\nfor(--n; n; n&gt;&gt;=1, a=a*a) if(n &amp; 1) ans = ans * a;\nreturn ans;\n}\nmat dfs(mat a, int k){\nif(k == 1) return a;\nmat ans = dfs(a, k/2);\nans = ans * (a ^ (k/2)) + ans;\nif(k &amp; 1) ans = ans + (a ^ k);\nreturn ans;\n};\n</code></pre>"},{"location":"oiwiki/%E6%9D%BF%E5%AD%90/#4_1","title":"4\uff0c\u5355\u8c03\u6808\u3001\u5355\u8c03\u961f\u5217","text":"<ul> <li> <p>\u5355\u8c03\u6808\uff1a\u6700\u8fd1\u7684\u66f4\u5927\u503c\uff08\u66f4\u5c0f\u503c\uff09</p> </li> <li> <p>\u5355\u8c03\u6808\u4f1a\u6bd4\u8f83\u7ec6\u8282</p> </li> <li> <p>\u5355\u8c03\u6808\u53c8\u53ef\u4ee5\u770b\u4f5c\u7279\u6b8a\u7684\u5355\u8c03\u961f\u5217</p> </li> </ul> <pre><code>int st[N], t;\nt = 0;\nfor(int i=1; i&lt;=n; ++i){\nfor(; t &amp;&amp; a[st[t]] &gt;= a[i]; --t);\nans[i] = t ? st[t]+1 : 1;\nst[ ++ t] = i;\n}\n</code></pre> <ul> <li>\u5355\u8c03\u961f\u5217\uff1a\u6ee1\u8db3\u67d0\u6761\u4ef6\u7684\u533a\u95f4\u7684\u6700\u5927\u503c\uff08\u6700\u5c0f\u503c\uff09</li> </ul> <p>\u5982\uff1a\u6c42\u5b9a\u957f \\(k\\) \u533a\u95f4\u7684\u6700\u5c0f\u503c</p> <pre><code>int st[N], s, t;\ns = 1, t = 0;\nfor(int i=1; i&lt;k; ++i){\nfor(; s&lt;=t &amp;&amp; a[st[t]] &gt; a[i]; -- t);\nst[ ++ t] = i;\nfor(; s&lt;=t &amp;&amp; i-st[s] &gt;= k; ++ s);\n}\nfor(int i=k; i&lt;=n; ++i){\nfor(; s&lt;=t &amp;&amp; a[st[t]] &gt; a[i]; -- t);\nst[ ++ t] = i;\nfor(; s&lt;=t &amp;&amp; i-st[s] &gt;= k; ++ s);\n// \u8f93\u51fa\u539f\u6570\u7ec4\u6700\u4f18\u4e0b\u6807 st[s] \n}\n</code></pre>"},{"location":"oiwiki/%E6%9D%BF%E5%AD%90/#5st","title":"5\uff0cST\u8868","text":"<ul> <li> <p>\\(O(n\\times log_n)~\\to O(1)\\) \u6c42\u53ef\u91cd\u590d\u8d21\u732e\u7684\u201c\u533a\u95f4\u548c\u201d</p> </li> <li> <p>\u53ef\u7ed3\u5408\u4e8c\u5206\uff08\u533a\u95f4\u957f\u5ea6 \u5177\u6709\u5355\u8c03\u6027\u7684\u60c5\u51b5\uff09</p> </li> </ul> <pre><code>const int N = 1e5+3;\nint f[N][23], n, lg[N];\nvoid init(){\nlg[1] = 0;\nfor(int i=2; i&lt;N; ++i) lg[i] = lg[i/2] + 1;\nfor(int j=1; j&lt;23; ++j){\nfor(int i=1; i+(1&lt;&lt;j)-1&lt;=n; ++i){\nf[i][j] = max(f[i][j-1], f[i+(1&lt;&lt;j-1)][j-1]);\n}\n}\n}\nint get(int lb, int ub){\nint s = lg[ub-lb+1];\n//    printf(\" %d %d\\n\", lb+(1&lt;&lt;s), ub-(1&lt;&lt;s)+1+(1&lt;&lt;s));\nreturn max(f[lb][s], f[ub-(1&lt;&lt;s)+1][s]);\n}\n</code></pre>"},{"location":"oiwiki/%E6%9D%BF%E5%AD%90/#1kmp","title":"1\uff0ckmp","text":"<pre><code>vector&lt;int&gt; pi;\nvoid kmp(string s){\nint n = s.size();\npi.clear(), pi.resize(n);\npi[0] = 0;\nfor(int i=1; i&lt;n; ++i){\nint j;\nfor(j=pi[i-1]; j &amp;&amp; s[j]!=s[i]; j=pi[j-1]);\npi[i] = s[j]==s[i] ? j+1 : j;\n}\n}\n</code></pre>"},{"location":"oiwiki/%E6%9D%BF%E5%AD%90/#2z","title":"2\uff0cz\u51fd\u6570","text":"<pre><code>void ZF(string s){\ncin &gt;&gt; s;\nint n = s.size();\nz.clear(), z.resize(n);\nz[0] = 0;\nfor(int i=1, lb=0, ub=0; i&lt;n; ++i){\nif(i&lt;=ub &amp;&amp; z[i-lb]&lt;ub-i+1) z[i] = z[i-lb];\nelse{\nz[i] = max(0, ub-i+1);\nfor(; i+z[i]&lt;=n &amp;&amp; s[z[i]]==s[i+z[i]]; ++ z[i]);\n}\nif(ub &lt; i+z[i]-1) lb = i, ub = i+z[i]-1;\n}\n}\n</code></pre>"},{"location":"oiwiki/%E6%9D%BF%E5%AD%90/#3ac","title":"3\uff0cac\u81ea\u52a8\u673a","text":"<pre><code>const int N = 153*73, M = 153;\nstring S[M];\nint n, tr[N][26], idx, st[N], q[N], s, t, f[N];\nvoid add(string s, int id){\nint u = 0;\nfor(int i=0, e; e=s[i]-'a', i&lt;s.size(); ++i, u=tr[u][e]){\nif(!tr[u][e]) tr[u][e] = ++ idx;\n}\nst[u] = id;\n}\nvoid ac(){\ns = 1, t = 0;\nfor(int i=0; i&lt;26; ++i) if(tr[0][i]) q[ ++ t] = tr[0][i];\nwhile(s &lt;= t){\nint u = q[s ++ ];\nfor(int i=0; i&lt;26; ++i){\nif(tr[u][i]){\nq[ ++ t] = tr[u][i];\nf[tr[u][i]] = tr[f[u]][i];\n}else tr[u][i] = tr[f[u]][i];\n}\n}\n}\nint tr_ans[N], li_ans[M];\nvoid get(string t){\nfor(int i=0, u=0; u=tr[u][t[i]-'a'], i&lt;t.size(); ++i){\nfor(int j=u; j; j=f[j]){\n++ tr_ans[j];\n}\n}\nint ans = 0;\nfor(int i=1; i&lt;=idx; ++i){\nif(st[i]){\nans = max(ans, tr_ans[i]);\nli_ans[st[i]] = tr_ans[i];\n}\n}\ncout &lt;&lt; ans &lt;&lt; '\\n';\nfor(int i=1; i&lt;=n; ++i){\nif(li_ans[i] == ans){\ncout &lt;&lt; S[i] &lt;&lt; '\\n';\n}\n}\n}\nvoid init(){\nidx = 0, memset(tr, 0, sizeof tr), memset(st, 0, sizeof st);\nmemset(f, 0, sizeof f);\nmemset(tr_ans, 0, sizeof tr_ans);\nmemset(li_ans, 0, sizeof li_ans);\n}\n</code></pre>"},{"location":"oiwiki/%E6%A0%91%E7%8A%B6%E6%95%B0%E7%BB%84/","title":"\u6811\u72b6\u6570\u7ec4","text":""},{"location":"oiwiki/%E6%A0%91%E7%8A%B6%E6%95%B0%E7%BB%84/#1","title":"1\uff0c\u7b80\u4ecb","text":"<p>\uff08\\(a_u\\) \u53d7\u4e00\u4e9b \\(c_v,~u\\le v\\le n\\) \u652f\u914d  \uff09</p> <p>\uff08\u6027\u8d28\uff1a\\(c\\)\u7684\u5076\u6570\u7ed3\u70b9 \\(c_{2u-1}\\) \u53ef\u4ee5\u76f4\u63a5\u6c42\u51fa\u5176\u652f\u914d\u7684\u533a\u95f4\u548c\uff0c\\(c\\)\u7684\u5947\u6570\u7ed3\u70b9 \\(c_{2u}\\)\uff08\u56fe\u4e2d\u6ca1\u753b\u51fa\uff0c\u5426\u5219\u4e0a\u56fe\u5c31\u4e0d\u50cf\u4e00\u9897\u6811\u4e86\uff09\u5219\u8981\u5bf9\u5176\u652f\u914d\u7684\u591a\u68f5\u6811\u6c42\u548c\uff09</p> <p></p> <p></p>"},{"location":"oiwiki/%E6%A0%91%E7%8A%B6%E6%95%B0%E7%BB%84/#2-lowbit","title":"2\uff0c\u6838\u5fc3\u64cd\u4f5c \\(lowbit\\)","text":"<p>\\(lowbit_u\\) \u8868\u793a \\(u\\) \u7684\u4e8c\u8fdb\u5236\u8868\u793a\u4e2d\uff0c\u6700\u4f4e\u4f4d\u7684 1 \u7684\u4f4d\u7f6e\u5bf9\u5e94\u7684\u6570\uff08\u8be5\u6570\u4ec5\u8be5\u4f4d\u7f6e\u4e3a 0\uff09</p> <p>\uff08\u6211\u89c9\u5f97\u5927\u6982\u4e5f\u672a\u5fc5\u4e00\u5b9a\u8981\u7528\\(lowbit\\) \u53ef\u80fd\u4e5f\u6709\u9002\u5408\u7684\u51fd\u6570\uff09</p> <p>\\(e.g.~~lowbit_{76}=lowbit_{1001100_2} = 100_2 = 4\\)</p> <pre><code>#define lb(u) u &amp; -u\n</code></pre> <p>\u6027\u8d28\uff1a\\(lowbit_u \\le u\\) \uff08\\(u+lowbit_u \\le 2\\times u\\)\uff09</p>"},{"location":"oiwiki/%E6%A0%91%E7%8A%B6%E6%95%B0%E7%BB%84/#3tricsk","title":"3\uff0c\u6734\u7d20\u6a21\u677f\uff0ctrics\uff0c\u7b2ck\u5c0f\u503c","text":"<p>\uff08\\(n\\) \u7684\u4e0a\u754c\u4e0d\u5f71\u54cd\u6548\u7387\u4e0b\u5e94\u8be5\u5c3d\u53ef\u80fd\u5927\uff09</p> <pre><code>const int N = 1e5+3;\nint a[N], n;\nint lb(int u){ return -u &amp; u; }\nvoid add(int u, int w){\n//  if(u &lt;= 0) return void(puts(\"yele\"));\n// \u66f4\u65b0 a_u \u53ca c_u \u652f\u914d\u7684\u7ed3\u70b9 \nwhile(u &lt;= n){\na[u] += w;\nu += lb(u);\n}\n}\nint gsum(int u){\n//  if(u &lt;= 0) return puts(\"yele\");\nint ans = 0;\n// \u7d2f\u52a0 a_u \u53ca\u5176 c_u \u652f\u914d\u7684\u5176\u4ed6\u7ed3\u70b9 \nwhile(u &gt;= 1){\nans += a[u];\nu -= lb(u);\n}\nreturn ans;\n}\n</code></pre> <p>\uff08\u6e29\u99a8\u5c0f\u63d0\u793a\uff1a\\(u=0\\) \u65f6\uff0c\\(lowbit_u = lowbit_0= 0 \\le n\\)\uff0c \u5fc5\u7136\u6b7b\u5faa\u73af\uff09\u3001</p> <ul> <li>\u533a\u95f4\u52a0 &amp; \u533a\u95f4\u548c\u67e5\u8be2</li> </ul> <p>\uff08\u4e3b\u8981\u8ba8\u8bba\u533a\u95f4\u548c\u67e5\u8be2\uff09</p> <p>\u8981\u6c42 \\(\\sum\\limits_{i=1}^u a_i\\) \uff0c\u6b64\u65f6\u5f15\u5165\u67e5\u5206\u6570\u7ec4 \\(b\\) \uff0c\\(a_u = \\sum\\limits_{i=1}^u b_i\\)</p> <p>\\(\\displaystyle \\operatorname{GSUM}_u = \\sum_{i=1}^u a_i = \\sum_{i=1}^u\\sum_{j=1}^i b_j = \\sum_{j=1}^u\\sum_{i=1}^u b_j[j\\le i] = \\sum_{j=1}^u\\sum_{i=j}^u b_j =  \\sum_{j=1}^u (u-j+1)\\times b_j \\\\ = (u+1)\\times\\sum_{j=1}^u b_j - \\sum_{j=1}^u j\\times b_j\\) </p> <p>\u4e8e\u662f\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u7ef4\u62a4\u4e24\u4e2a\u6570\u7ec4 \\(\\{b_j\\},~\\{j\\times b_j\\}\\)</p> <p>\\(\\operatorname{GSUM}_u = (u+1)\\times gsum_{u} -gsum1_{u}\\)</p> <p>\\(\\operatorname{GSUM}_{ub}-\\operatorname{GSUM}_{lb-1} = ((ub+1)\\times gsum_{ub}- gsum1_{ub}) - (lb\\times gsum_{lb-1}- gsum1_{lb-1})\\)</p> <p>\u677f\u5b50\uff1a</p> <pre><code>#define int long long\n#define lb(u) u&amp;-u\nconst int N = 1e6+3;\nint a[N], a1[N], n;\n// \u5355\u70b9\u6539 \nvoid add(int u, int w){\nint w1 = u * w;\nwhile(u &lt;= n){\na[u] += w, a1[u] += w1;\nu += lb(u);\n}\n}\n// \u533a\u95f4\u6539 \nvoid add(int lb, int ub, int w){\nadd(lb, w), add(ub + 1, -w);\n}\n// \u524d\u7f00\u67e5\nint gsum(int *a, int u){\nint ans = 0;\nwhile(u){\nans += a[u];\nu -= lb(u);\n}\nreturn ans;\n}\n// \u533a\u95f4\u67e5\nint gsum(int lb, int ub){\nreturn (ub + 1) * gsum(a, ub) - gsum(a1, ub)\n- (lb * gsum(a, lb-1) - gsum(a1, lb-1));\n}\n</code></pre> <ul> <li>Tricks</li> </ul> <p>\u6bcf\u4e00\u4e2a\u8282\u70b9\u7684\u503c\u662f\u7531\u6240\u6709\u4e0e\u81ea\u5df1\u76f4\u63a5\u76f8\u8fde\u7684\u513f\u5b50\u7684\u503c\u6c42\u548c\u5f97\u5230\u7684\u3002\u56e0\u6b64\u53ef\u4ee5\u5012\u7740\u8003\u8651\u8d21\u732e\uff0c\u5373\u6bcf\u6b21\u786e\u5b9a\u5b8c\u513f\u5b50\u7684\u503c\u540e\uff0c\u7528\u81ea\u5df1\u7684\u503c\u66f4\u65b0\u81ea\u5df1\u7684\u76f4\u63a5\u7236\u4eb2\u3002</p> <p>\u590d\u6742\u5ea6\uff1a\\(O(n)\\)</p> <pre><code>void init() {\nfor (int i = 1; i &lt;= n; ++i) {\nt[i] += a[i];\nint j = i + lowbit(i);\nif (j &lt;= n) t[j] += t[i];\n}\n}\n</code></pre> <ul> <li>\u67e5\u8be2\u7b2c \\(k\\) \u5c0f\u7684\u503c</li> </ul> <p></p> <p></p> <p>\\(\\displaystyle t=\\sum_{i=x+1}^{x+2^{depth}}a_i\\)</p> <ol> <li>\u6c42\u51fa\u00a0\\(depth=\\left \\lfloor \\log_2n \\right \\rfloor\\)</li> <li>\u8ba1\u7b97\u00a0\\(\\displaystyle t=\\sum_{i=x+1}^{x+2^{depth}}a_i\\)</li> <li>\u5982\u679c\u00a0\\(sum+t \\le k\\)\uff0c\u5219\u6b64\u65f6\u6269\u5c55\u6210\u529f\uff0c\u5c06\u00a0\\(2^{depth}\\)\u00a0\u7d2f\u52a0\u5230\u00a0\\(x\\)\u00a0\u4e0a\uff1b\u5426\u5219\u6269\u5c55\u5931\u8d25\uff0c\u5bf9\u00a0\\(x\\)\u00a0\u4e0d\u8fdb\u884c\u64cd\u4f5c</li> <li>\u5c06\u00a0\\(depth\\)\u00a0\u51cf 1\uff0c\u56de\u5230\u6b65\u9aa4 2\uff0c\u76f4\u81f3\u00a0\\(depth\\)\u00a0\u4e3a 0</li> </ol> <pre><code>#define lb(u) (u&amp;-u)\nconst int N = 3.2e4+3;\n// \u6743\u503c\u6811\u72b6\u6570\u7ec4\nint n, tr[N];\nvoid add(int u, int cnt = 1){\nfor(int i=u; i&lt;N; i+=lb(i)) tr[i] += cnt;\n}\nint gsum(int u){\nint ans = 0;\nfor(int i=u; i&gt;0; i-=lb(i)) ans += tr[i];\nreturn ans;\n}\nint kth(int k){\nint w = 0, sum = 0;\nfor(int i=log2(n); ~i; --i){\nw += 1 &lt;&lt; i, sum += tr[w];\nif(w &gt;= n || sum &gt;= k)\nw -= 1 &lt;&lt; i, sum -= tr[w];\n}\nreturn w + 1;\n}\n</code></pre> <p>\uff08warning\uff1a \\(N\\) \u662f \\(a_i\\) \u7684\u503c\u57df\u4e2d\u7684\u6700\u5927\u503c\uff1b\\(a_i\\) \u6700\u5c0f\u503c\u5e94\u5927\u4e8e0\uff08\u5426\u5219 \\(++ a_i\\)\uff09\uff09</p> <ul> <li>\u65f6\u95f4\u6233\u4f18\u5316</li> </ul> <p></p> <pre><code>#define lb(u) u&amp;-u\nconst int N = 1e5+3;\nint a[N], n;\nint tag[N], Tag;\nvoid reset(){ ++ Tag; }\nvoid add(int u, int w){\nwhile(u &lt;= n){\nif(tag[u] != Tag) a[u] = 0;\na[u] += w, tag[u] = Tag;\nu += lb(u);\n}\n}\nint gsum(int u){\nint ans = 0;\nwhile(u){\nif(tag[u] == Tag) ans += a[u];\nu -= lb(u);\n}\nreturn ans;\n}\n</code></pre>"},{"location":"oiwiki/%E6%A0%91%E7%8A%B6%E6%95%B0%E7%BB%84/#4","title":"4\uff0c\u4e8c\u7ef4\u6811\u72b6\u6570\u7ec4","text":"<p>\uff08warning\uff1a \u5bf9\u4e8e \\(a_i\\) \u503c\u57df\u5c0f\u4e8e \\(1e3\\) \u7684\u53ef\u4ee5\u8003\u8651\u4e8c\u7ef4\u6811\u72b6\u6570\u7ec4\uff0c\u5426\u5219\u5982\u679c \\(n\\le 1e3\\) \u53ef\u4ee5\u79bb\u6563\u5316\u5904\u7406\uff09</p> <p>1\uff0c\u5355\u6539\u591a\u67e5</p> <pre><code>#define int long long\n#define lb(u) (u&amp;-u)\nconst int N = 4.1e3+3;\nint a[N][N], n, m;\nvoid add(int u, int v, int w){\nfor(int i=u; i&lt;=n; i+=lb(i)){\nfor(int j=v; j&lt;=m; j+=lb(j)){\na[i][j] += w;\n}\n}\n}\nint gsum(int u, int v){\nint ans = 0;\nfor(int i=u; i; i-=lb(i)){\nfor(int j=v; j; j-=lb(j)){\nans += a[i][j];\n}\n}\nreturn ans;\n}\n</code></pre> <p>2\uff0c\u591a\u6539\u591a\u67e5</p> <p>\uff08\u8fd9\u662f\u4ec5\u9488\u5bf9\u533a\u95f4\u52a0\u7684\u4f18\u5316\uff0c\u9898\u76ee\u4e0d\u9700\u8981 \u533a\u95f4\u52a0 \u5219\u5c3d\u91cf\u4e0d\u7528\u6b64\u4f18\u5316\uff1b\u53e6\u5916\uff0c\u6811\u72b6\u6570\u7ec4\u5929\u751f\u652f\u6301\u533a\u95f4\u67e5\u8be2\uff09</p> <p>\u540c\u6837\u662f\u6811\u72b6\u6570\u7ec4\u7ef4\u62a4\u5dee\u5206\u6570\u7ec4</p> <p>\\(\\displaystyle \\sum_{i=1}^u\\sum_{j=1}^v a_{i,~j} = \\sum_{i=1}^u\\sum_{j=1}^v\\sum_{k=1}^i\\sum_{l=1}^j b_{k,~l} = \\sum_{k=1}^u\\sum_{l=1}^v\\sum_{i=1}^u\\sum_{j=1}^v b_{k,~l}[k\\le i,~l\\le j]\\\\ = \\sum_{k=1}^u\\sum_{l=1}^v b_{k,~l}\\times(u-k+1)\\times(v-l+1) = \\\\ (u+1)\\times(v+1)\\times\\sum_{k=1}^u\\sum_{l=1}^v b_{k,~l} - (u+1)\\sum_{k=1}^u\\sum_{l=1}^v b_{k,~l}\\times l \\\\ - (v+1)\\times\\sum_{k=1}^u\\sum_{l=1}^v b_{k,~l}\\times k + \\sum_{k=1}^u\\sum_{l=1}^v b_{k,~l}\\times k\\times l\\)</p> <p>\u56db\u4e2a\u6811\u72b6\u6570\u7ec4\u7ef4\u62a4\u56db\u4e2a\u6570\u5217 \\(\\{b_{i,~j}\\}\uff0c\\{i\\times b_{i,~j}\\}\uff0c\\{j\\times b_{i,~j}\\}\uff0c\\{i\\times j\\times b_{i,~j}\\}\\)\u5373\u53ef</p> <pre><code>#define int long long\n#define lb(u) (u&amp;-u)\nconst int N = 2.1e3+3;\nint a[N][N], a1[N][N], a2[N][N], a3[N][N];\nint n, m;\nvoid add(int u, int v, int w){\nint w1 = u * w, w2 = v * w, w3 = u * v * w;\nfor(int i=u; i&lt;=n; i+=lb(i))\nfor(int j=v; j&lt;=m; j+=lb(j))\na[i][j] += w, a1[i][j] += w1, a2[i][j] += w2, a3[i][j] += w3;\n}\nvoid add(int lb, int lb1, int ub, int ub1, int w){\nadd(lb, lb1, w), add(ub+1, ub1+1, w), add(lb, ub1+1, -w), add(ub+1, lb1, -w);\n}\nint gsum(int a[][N], int u, int v){\nint ans = 0;\nfor(int i=u; i; i-=lb(i))\nfor(int j=v; j; j-=lb(j))\nans += a[i][j];\nreturn ans;\n}\nint gsum(int lb, int lb1, int ub, int ub1){\n// \u6ce8\u610fdefine\u540e\u9762\u8fd8\u6709\u5f88\u957f\u4e00\u6bb5\n#define GS(u, v) ((u+1)*(v+1)*gsum(a, u, v) - (v+1)*gsum(a1, u, v) - (u+1)*gsum(a2, u, v) + gsum(a3, u, v))\nreturn GS(ub, ub1) + GS(lb-1, lb1-1) - GS(ub, lb1-1) - GS(lb-1, ub1);\n}\n</code></pre>"},{"location":"oiwiki/%E6%A0%91%E7%8A%B6%E6%95%B0%E7%BB%84/#5","title":"5\uff0c\u4e09\u7ef4\u6811\u72b6\u6570\u7ec4","text":"<p>1\uff0c\u533a\u95f4\u52a0+\u5355\u70b9\u67e5</p> <pre><code>#define lb(u) (u&amp;-u)\nconst int N = 1e2+3;\nint tr[N][N][N], n;\nvoid add(int x, int y, int z, int w){\nfor(int i=x; i&lt;=n; i+=lb(i))\nfor(int j=y; j&lt;=n; j+=lb(j))\nfor(int k=z; k&lt;=n; k+=lb(k))\ntr[i][j][k] += w;\n}\nvoid add(int lb, int lb1, int lb2, int ub, int ub1, int ub2, int w){\nadd(lb, lb1, lb2, w);\nadd(lb, lb1, ub2+1, -w);\nadd(lb, ub1+1, lb2, -w);\nadd(lb, ub1+1, ub2+1, w);\nadd(ub+1, lb1, lb2, -w);\nadd(ub+1, lb1, ub2+1, w);\nadd(ub+1, ub1+1, lb2, w);\nadd(ub+1, ub1+1, ub2+1, -w);\n}\nint gsum(int x, int y, int z){\nint ans = 0;\nfor(int i=x; i; i-=lb(i))\nfor(int j=y; j; j-=lb(j))\nfor(int k=z; k; k-=lb(k))\nans += tr[i][j][k];\nreturn ans;\n}\n</code></pre> <p>2\uff0c\u533a\u95f4\u52a0 + \u533a\u95f4\u67e5</p> <pre><code>#define lb(u) (u&amp;-u)\nconst int N = 103;\nint a[8][N][N][N], n;\nvoid add(int x, int y, int z, int w){\nint W[8] = {w, w * x, w * y, w * z, w * x * y, w * x * z, w * y * z, w * x * y * z};\nfor(int i=x; i&lt;=n; i+=lb(x))\nfor(int j=y; j&lt;=n; j+=lb(y))\nfor(int k=z; k&lt;=n; k+=lb(z))\nfor(int l=0; l&lt;8; ++l)\na[l][i][j][k] += W[l];\n}\nvoid add(int lb, int lb1, int lb2, int ub, int ub1, int ub2, int w){\nadd(lb, lb1, lb2, w);\nadd(lb, lb1, ub2+1, -w);\nadd(lb, ub1+1, lb2, -w);\nadd(lb, ub1+1, ub2+1, w);\nadd(ub+1, lb1, lb2, -w);\nadd(ub+1, lb1, ub2+1, w);\nadd(ub+1, ub1+1, lb2, w);\nadd(ub+1, ub1+1, ub2+1, -w);\n}\nint gsum(int x, int y, int z){\nint ans[8] = {};\nint st[8] = {-(x+1)*(y+1)*(z+1), (y+1)*(z+1), (x+1)*(z+1), (x+1)*(y+1), -(z+1), -(y+1), -(x+1), 1};\nfor(int i=x; i; i-=lb(i))\nfor(int j=y; j; j-=lb(j))\nfor(int k=z; k; k-=lb(k))\nfor(int l=0; l&lt;8; ++l)\nans[l] += a[l][i][j][k];\nint ret = 0;\nfor(int i=0; i&lt;8; ++i) ret += st[i] * ans[i];\nreturn ret;\n}\nint gsum(int lb, int lb1, int lb2, int ub, int ub1, int ub2){\nreturn 0\n+gsum(ub, ub1, ub2)\n-gsum(ub, ub1, lb2-1)\n-gsum(ub, lb1-1, ub2)\n+gsum(ub, lb1-1, lb2-1)\n-gsum(lb-1, ub1, ub2)\n+gsum(lb-1, ub1, lb2-1)\n+gsum(lb-1, lb1-1, ub2)\n-gsum(lb-1, lb1-1, lb2-1)\n;\n}\n</code></pre> <p>6\uff0c\u4f8b\u9898</p> <p>CWXU-\u6691\u671f\u96c6\u8bad-\u6811\u72b6\u6570\u7ec4 - Virtual Judge (csgrandeur.cn)</p> <p>\u6811\u72b6\u6570\u7ec4 \u4e13\u9898\u9898\u5355 - Virtual Judge (csgrandeur.cn)</p>"},{"location":"oiwiki/%E7%BA%BF%E6%AE%B5%E6%A0%91/","title":"\u7ebf\u6bb5\u6811","text":""},{"location":"oiwiki/%E7%BA%BF%E6%AE%B5%E6%A0%91/#1","title":"1\uff0c\u7b80\u4ecb","text":"<p>\uff08\u5e7a\u7fa4\uff09</p> <p></p>"},{"location":"oiwiki/%E7%BA%BF%E6%AE%B5%E6%A0%91/#2minmaxxor","title":"2\uff0c\u6734\u7d20\u7ebf\u6bb5\u6811\uff08\u533a\u95f4\u52a0/\u8d4b\u503c/\u4e58/min/max/xor + \u533a\u95f4\u67e5\uff09","text":"<p>\u5982\u6570\u7ec4 \\(a=\\{10,11,12,13,14\\}\\) \u5bf9\u5e94\u7684\u7ebf\u6bb5\u6811\uff1a</p> <p></p> <ul> <li>1\uff0c\u5efa\u6811</li> </ul> <pre><code>// \u51cf\u77ed\u957f\u4e32\u7684\u51fd\u6570\u5934\u58f0\u660e\uff1b\u6ce8\u610f\u9ed8\u8ba4\u53c2\u6570\n#define head int lb = 1, int ub = n, int u = 1\n// m, lc, rc \u80fd\u786e\u5b9a\u5de6\u53f3\u513f\u5b50\u7684 \u533a\u95f4 \u548c \u7ed3\u70b9\u7f16\u53f7\n#define def int m = lb + ub &gt;&gt; 1, lc = u&lt;&lt;1, rc = lc+1\nconst int N = 4e5+3;    // \u53d6\u56db\u500d\u5927\u5c0f\nint a[N], n;\nlong long sum[N], add[N];\nvoid init(head){\ndef;\nif(lb == ub) return void(sum[u] = a[lb]);\ninit(lb, m, lc), init(m+1, ub, rc);\nsum[u] = sum[lc] + sum[rc];\n}\n</code></pre> <p>\u9012\u5f52\u6b65\u9aa4\uff1a</p> <p>1\uff0c\\(lb == ub\\) \uff1a\u51fa\u53e3\uff0c\u5bf9\u533a\u95f4\u548c \\(sum\\) \u8d4b\u503c</p> <p>2\uff0c\\(down()\\)\uff1a\u65e0</p> <p>3\uff0c\u5206\u6cbb \\((lb,~mid,~lc),~(mid+1, ub,~rc)\\)</p> <p>4\uff0c\\(up()\\)\uff1a\u513f\u5b50\u66f4\u65b0\u7236\u4eb2\u7684\u6743\u503c\uff08\u521a\u597d\u4e0e\u51fa\u53e3\"\u5bf9\u7acb\"\uff09</p> <ul> <li> <ul> <li>\u7ebf\u6bb5\u6811\u7684\u5927\u5c0f</li> </ul> </li> </ul> <p></p> <p></p> <p>\uff08\u603b\u7ed3\uff1a\u53d6 \\(4\\times n\\) \u7684\u5927\u5c0f\u80fd\u7edd\u5bf9\u907f\u514d \\(segment~fault\\) \uff09</p> <ul> <li>2\uff0c\u533a\u95f4\u64cd\u4f5c\uff0c\u533a\u95f4\u67e5\u8be2</li> </ul> <p>\u6b65\u9aa4\uff1a</p> <p>1\uff0c\\(l\\le lb~~\\&amp;\\&amp;~~r\\ge ub\\)\uff1a\u51fa\u53e3\uff0c\u66f4\u65b0 \u7ed3\u70b9\\(u\\) \u7684\u6743\u503c \u6216 \u61d2\u6807\u8bb0\uff08\u5bf9\u66f4\u65b0\u64cd\u4f5c\u800c\u8a00\uff09\uff0c\u6216\u8fd4\u56de\u6743\u503c\uff08\u5bf9\u67e5\u8be2\u64cd\u4f5c\u800c\u8a00\uff09</p> <p>\uff08\u5e38\u89c1\u7684\u6743\u503c\uff1a\\(sum_u\\) \uff1b\u5e38\u89c1\u7684\u61d2\u6807\u8bb0\uff1a$$\uff09</p> <p>2\uff0c\\(down()\\)\uff1a\u66f4\u65b0\u4e24\u4e2a\u513f\u5b50\u7684\u61d2\u6807\u8bb0\uff08\u4e0b\u65b9\u61d2\u6807\u8bb0\uff09</p> <p>3\uff0c\u5206\u6cbb\uff1a\u82e5 \\(l\\le mid\\)\uff0c\u5219\u5206\u6cbb \\((lb,~mid,~lc)\\)\uff1b\u82e5 \\(r &gt; mid\\)\uff0c\u5219 \\(~(mid+1,~ub,~rc)\\)</p> <p>4\uff0c\\(up()\\)\uff1a\u4ece\u4e24\u4e2a\u513f\u5b50\u66f4\u65b0\u7236\u4eb2\u7684\u6743\u503c\uff08\u4ec5 \u66f4\u65b0 \u6216 \u521d\u59cb\u5316\u65f6 \u9700\u8981\uff09</p> <ul> <li> <ul> <li>\u533a\u95f4\u52a0\u6cd5</li> </ul> </li> </ul> <pre><code>void madd(int l, int r, int w, head){\ndef;\nif(l &lt;= lb &amp;&amp; r &gt;= ub) return void((sum[u] += len * w, add[u] += w));\nif(add[u]){\nsum[lc] += llen * add[u], add[lc] += add[u];\nsum[rc] += rlen * add[u], add[rc] += add[u];\nadd[u] = 0;\n}\nif(l &lt;= m) madd(l, r, w, lb, m, lc);\nif(r &gt; m) madd(l, r, w, m+1, ub, rc);\nsum[u] = sum[lc] + sum[rc];\n}\nlong long gsum(int l, int r, head){\ndef;\nlong long ans = 0;\nif(l &lt;= lb &amp;&amp; r &gt;= ub) return sum[u];\nif(add[u]){\nsum[lc] += llen * add[u], add[lc] += add[u];\nsum[rc] += rlen * add[u], add[rc] += add[u];\nadd[u] = 0;\n}\nif(l &lt;= m) ans += gsum(l, r, lb, m, lc);\nif(r &gt; m) ans += gsum(l, r, m+1, ub, rc);\nreturn ans;\n}\n</code></pre> <ul> <li> <ul> <li>\u533a\u95f4\u8d4b\u503c</li> </ul> </li> </ul> <pre><code>int sum[N], as[N];\nvoid mas(int l, int r, int w, head){\ndef;\nif(l &lt;= lb &amp;&amp; r &gt;= ub) return void((sum[u] = (ub - lb + 1) * w, as[u] = w));\nif(as[u]){\nsum[lc] = (mid - lb + 1) * as[u], as[lc] = as[u];\nsum[rc] = (ub - mid) * as[u], as[rc] = as[u];\nas[u] = 0;\n}\nif(l &lt;= mid) mas(l, r, w, lb, mid, lc);\nif(r &gt; mid) mas(l, r, w, mid+1, ub, rc);\nsum[u] = sum[lc] + sum[rc];\n}\nlong long gsum(int l, int r, head){\ndef;\nif(l &lt;= lb &amp;&amp; r &gt;= ub) return sum[u];\nif(as[u]){\nsum[lc] = (mid - lb + 1) * as[u], as[lc] = as[u];\nsum[rc] = (ub - mid) * as[u], as[rc] = as[u];\nas[u] = 0;\n}\nlong long ans = 0;\nif(l &lt;= mid) ans += gsum(l, r, lb, mid, lc);\nif(r &gt; mid) ans += gsum(l, r, mid+1, ub, rc);\nreturn ans;\n}\n</code></pre> <ul> <li> <ul> <li>\u533a\u95f4\u52a0\u6cd5 + \u533a\u95f4\u4e58\u6cd5</li> </ul> </li> </ul> <pre><code>#define head int lb = 1, int ub = n, int u = 1\n#define def int mid = lb+ub&gt;&gt;1, lc = u&lt;&lt;1, rc = lc + 1\nconst int N = 4e5+3;\nint a[N], n, P = 1e9+7;\nlong long sum[N], add[N], mul[N];\nvoid init(head){\ndef;\n// \u6ce8\u610f mul_u \u7684\u521d\u59cb\u5316 \nmul[u] = 1;\nif(lb == ub) return void(sum[u] = a[lb]);\ninit(lb, mid, lc), init(mid+1, ub, rc);\nsum[u] = sum[lc] + sum[rc];\n}\nvoid down(head){\ndef;\nif(mul[u] != 1){\nsum[lc] = sum[lc] * mul[u] % P, add[lc] = add[lc] * mul[u] % P, mul[lc] = mul[lc] * mul[u] % P;\nsum[rc] = sum[rc] * mul[u] % P, add[rc] = add[rc] * mul[u] % P, mul[rc] = mul[rc] * mul[u] % P;\nmul[u] = 1;\n}\nif(add[u]){\nsum[lc] = (sum[lc] + (mid - lb + 1) * add[u]) % P, add[lc] = (add[lc] + add[u]) % P;\nsum[rc] = (sum[rc] + (ub - mid) * add[u]) % P, add[rc] = (add[rc] + add[u]) % P;\nadd[u] = 0;\n}\n}\nvoid madd(int l, int r, int w, head){\ndef;\nif(l &lt;= lb &amp;&amp; r &gt;= ub) return void((\nsum[u] = (sum[u] + (ub - lb + 1) * w) % P, add[u] = (add[u] + w) % P)\n);\ndown(lb, ub, u);\nif(l &lt;= mid) madd(l, r, w, lb, mid, lc);\nif(r &gt; mid) madd(l, r, w, mid+1, ub, rc);\nsum[u] = (sum[lc] + sum[rc]) % P;\n}\nvoid mmul(int l, int r, int w, head){\ndef;\nif(l &lt;= lb &amp;&amp; r &gt;= ub) return void((\nsum[u] = sum[u] * w % P, add[u] = add[u] * w % P, mul[u] = mul[u] * w % P\n));\ndown(lb, ub, u);\nif(l &lt;= mid) mmul(l, r, w, lb, mid, lc);\nif(r &gt; mid) mmul(l, r, w, mid+1, ub, rc);\nsum[u] = (sum[lc] + sum[rc]) % P;\n}\nlong long gsum(int l, int r, head){\ndef;\nif(l &lt;= lb &amp;&amp; r &gt;= ub) return sum[u];\ndown(lb, ub, u);\nlong long ans = 0;\nif(l &lt;= mid) ans = (ans + gsum(l, r, lb, mid, lc)) % P;\nif(r &gt; mid) ans = (ans + gsum(l, r, mid+1, ub, rc)) % P;\nreturn ans;\n}\n</code></pre> <ul> <li>\u4e00\u4e9b\u5c0f\u4f18\u5316</li> </ul> <p></p> <ul> <li> <p>P3372 \u3010\u6a21\u677f\u3011\u7ebf\u6bb5\u6811 1 - \u6d1b\u8c37 | \u8ba1\u7b97\u673a\u79d1\u5b66\u6559\u80b2\u65b0\u751f\u6001 (luogu.com.cn)</p> </li> <li> <p>P3373 \u3010\u6a21\u677f\u3011\u7ebf\u6bb5\u6811 2 - \u6d1b\u8c37 | \u8ba1\u7b97\u673a\u79d1\u5b66\u6559\u80b2\u65b0\u751f\u6001 (luogu.com.cn)</p> </li> <li> <p>\u7ebf\u6bb5\u6811\u7684\u533a\u95f4\u4fee\u6539 - HihoCoder 1078 - Virtual Judge (csgrandeur.cn)</p> </li> <li> <p>Glad You Came - HDU 6356 - Virtual Judge (vjudge.net)</p> </li> <li> <p>P6242 \u3010\u6a21\u677f\u3011\u7ebf\u6bb5\u6811 3 - \u6d1b\u8c37 | \u8ba1\u7b97\u673a\u79d1\u5b66\u6559\u80b2\u65b0\u751f\u6001 (luogu.com.cn)</p> </li> </ul>"},{"location":"oiwiki/%E7%BA%BF%E6%AE%B5%E6%A0%91/#3","title":"3\uff0c\u732b\u6811\uff08\u5f85\u8865\uff09","text":""},{"location":"oiwiki/%E7%BA%BF%E6%AE%B5%E6%A0%91/#_1","title":"\u65e0\u4fee\u6539\u533a\u95f4\uff0c\u6811\u4e0a\u8be2\u95ee","text":"<p>\u4e00\u79cd\u9ad8\u6548\u5904\u7406\u65e0\u4fee\u6539\u533a\u95f4\u6216\u6811\u4e0a\u8be2\u95ee\u7684\u6570\u636e\u7ed3\u6784\uff08\u9644\u4ee3\u7801\uff09 - \u535a\u5ba2 - immortalCO\u7684\u535a\u5ba2 (uoj.ac)</p>"},{"location":"oiwiki/%E7%BA%BF%E6%AE%B5%E6%A0%91/#1_1","title":"1\uff0c\u524d\u8a00","text":"<ul> <li>\u95ee\u9898\u63cf\u8ff0</li> </ul> <ul> <li> <p>\u95ee\u9898\u4e3e\u4f8b</p> </li> <li> <ul> <li>1\uff0c\u53ef\u51cf\u4fe1\u606f\uff08\u533a\u95f4\u548c\u3001\u533a\u95f4\u5f02\u6216\u548c\uff09\uff1a</li> </ul> </li> </ul> <p>\u76f4\u63a5\u7528\u524d\u7f00\u548c\u5b9e\u73b0\uff0c\\(O(n)+O(1)+O(n)\\)</p> <ul> <li> <ul> <li>2\uff0c\u53ef\u91cd\u590d\u8d21\u732e\u4fe1\u606f\uff08\u533a\u95f4\u6700\u503c\uff09</li> </ul> </li> </ul> <p>\u5982\u679c\u5e8f\u5217\u5f88\u957f\uff0c\u4f7f\u7528\u7ebf\u6bb5\u6811\u5373\u53ef\uff0c\u590d\u6742\u5ea6 \\(O(n)+O(logn)+O(n)\\)</p> <p>\u5982\u679c\u8be2\u95ee\u5f88\u591a\uff0c\u4f46\u5e8f\u5217\u4e0d\u662f\u7279\u522b\u957f\uff0c\u53ef\u4ee5\u7528\u500d\u589e\u7684 RMQ\uff0c\u590d\u6742\u5ea6 \\(O(n\\log n)+O(1)+O(n\\log n)\\)</p> <p>\u5982\u679c\u5e8f\u5217\u5f88\u957f\uff0c\u8be2\u95ee\u4e5f\u5f88\u591a\uff0c\u53ef\u4ee5\u5bf9\u5e8f\u5217\u7ebf\u6027\u5efa\u7acb\u7b1b\u5361\u5c14\u6811\u8f6c\u4e3a LCA \u95ee\u9898\uff0c\u7136\u540e\u8f6c\u4e3a\u6b63\u8d1f 1 RMQ\uff0c\u6bcf \\(\\log n\\) \u5206\u4e00\u6bb5\u6253\u8868\u9884\u5904\u7406\uff0c\u590d\u6742\u5ea6 \\(O(n)+O(1)+O(n)\\)</p> <p>\uff08WTF\uff1f\uff09</p> <ul> <li> <ul> <li>3\uff0c\u4ec5\u6ee1\u8db3\u652f\u6301\u7ed3\u5408\u5f8b\u548c\u5feb\u901f\u5408\u5e76\uff0c\u5982\u6700\u5927\u5b50\u6bb5\u548c\u3001\u533a\u95f4\u7684\u4e32\u54c8\u5e0c\u503c</li> </ul> </li> </ul> <p>\u4e00\u822c\u4f7f\u7528\u7ebf\u6bb5\u6811\u5b9e\u73b0\uff0c\u590d\u6742\u5ea6 \\(O(n)+O(\\log n)+O(n)\\)</p> <ul> <li> <ul> <li>4\uff0c\u800c\u732b\u6811\u53ef\u4ee5\u505a\u5230 $ O(n\\log n)+O(1)+O(n\\log n)$ \u7684\u590d\u6742\u5ea6</li> </ul> </li> <li> <p>\u5e94\u7528</p> </li> <li> <ul> <li>1\uff0c\u6700\u5927\u533a\u95f4\u5b57\u6bb5\u548c</li> </ul> </li> <li> <ul> <li>2\uff0c\\(NAND\\) \uff08\u4e0e\u975e\u8fd0\u7b97\uff09</li> </ul> </li> </ul> <p></p> <p></p> <ul> <li> <ul> <li>3\uff0c\u533a\u95f4</li> </ul> </li> </ul> <p></p> <ul> <li> <ul> <li>4\uff0cBZOJ4540</li> </ul> </li> </ul> <p></p>"},{"location":"oiwiki-%E6%95%B0%E5%AD%A6/Meissel-Lehmer/","title":"Meissel Lehmer","text":"<p>Meissel-Lehmer\u6c42\u51fa\\(1..n\\)\u5185\u8d28\u6570\u4e2a\u6570\u7684\u4e9a\u7ebf\u6027\u7b97\u6cd5</p> <p>\\(\u4e9a\u7ebf\u6027\u7b97\u6cd5\uff1aT(n)=a+b\\times n^k, j\\in (0, 1)\\)</p> <p>\\(P_i\uff1a\u8868\u793a\u7b2ck\u4e2a\u8d28\u6570\uff0cP_1=2\\)</p> <p>\\(\\delta_n\u3001P_n^+\u4e3an\u7684\u6700\u5c0f\u3001\u6700\u5927\u8d28\u56e0\u5b50\uff0c\\delta_n\\le P_i\\le P_n^+\\)</p> <p>\\(\\pi_n\uff1a1..n\u5185\u7684\u8d28\u6570\u4e2a\u6570\uff0c\\pi_n=\\sum\\limits_{i=1}^n[i=p]\\)</p> <p>\\(\\phi_{n,a}\\)\u4e3a\u6240\u6709\u5c0f\u4e8e \\(n\\) \u7684\u6b63\u6574\u6570\u4e2d\u6ee1\u8db3\u5176\u6240\u6709\u8d28\u56e0\u5b50\u90fd\u5927\u4e8e \\(p_a\\) \u7684\u6570\u7684\u4e2a\u6570</p> <p>\\(\\phi_{n,a}=\\#\\{i\\le n|(p | i=&gt;p&gt;p_a)\\}\\)</p> <p>\\(=\\sum\\limits_{i=1}^{n-1}[~\\forall~p\\in~i,~p|i,~p~&gt;~p_a]\\)</p> <p>\\(P_{k, n, a}\\)\u4e3a\u6240\u6709\u5c0f\u4e8e \\(n\\) \u7684\u6b63\u6574\u6570\u4e2d\u6ee1\u8db3\u53ef\u91cd\u8d28\u56e0\u5b50\u6070\u597d\u6709 \\(k\\) \u4e2a\u4e14\u6240\u6709\u8d28\u56e0\u5b50\u90fd\u5927\u4e8e  \u7684\u6570\u7684\u4e2a\u6570</p> <p>\\(P_{k, n, a}=\\#\\{i\\le n|i=p_1\\times p_2\\times ..\\times p_k=&gt;\\forall j, p_j&gt;p_a\\}\\)</p> <p>\\(=\\sum\\limits_{i=1}^{n-1}[~n=p_1\\times p_2\\times ..\\times p_k,~p&gt; p_a~]\\)</p> <p>\\((p_a^k&gt;n~~=&gt;~~P_{k,n,a}=0)\\)</p> <p>\\(\u8bb0\uff1aP_{0,n,a}=1\\)</p> <p>\\(\\phi_{n,a}=\\sum\\limits_{i=0}^{+\\infty}P_{i,n,a}\uff08\u5b9e\u9645\u4e0a\u662f\u6709\u9650\u7684\u5408\u5f0f\uff09\\)</p> <p>\\(1)\u8ba1\u7b97\\pi_n\\)</p> <p>\\(\u53d6x\\in[n^\\frac13,n^\\frac12]\\)</p> <p>\\(P_{1,n,\\pi_{x}}=\\pi_n-\\pi_{x}\\)</p> <p>\\(k\\ge 3\u65f6,~P_{k,n,\\pi_{x}}=0\\)</p> <p>\\(=&gt;~~\\pi_n=\\pi_x+\\phi_{n,\\pi_x}-P_{0,n,\\pi_x}-P_{2,n,\\pi_x}+P_{k\\ge3,n,\\pi_x}\\)</p> <p>\\(~~~~~~~~~~~~~~=\\pi_x+\\phi_{n,\\pi_x}-1-P_{2,n,\\pi_x}\\)</p> <p>\\(2)\u8ba1\u7b97P_{2,n,\\pi_x}\\)</p>"},{"location":"oiwiki-%E6%95%B0%E5%AD%A6/%E4%BA%8C%E8%BF%9B%E5%88%B6%E9%9B%86%E5%90%88/","title":"\u4e8c\u8fdb\u5236\u96c6\u5408","text":"<p>\u53ef\u80fd\u4f1a\u7528\u5230\u7684\u77e5\u8bc6\uff1a</p> <ul> <li> <p>\u4f18\u5148\u7ea7\uff1a\u7b97\u672f &gt; \u79fb\u4f4d &gt; \u5173\u7cfb &gt; \u903b\u8f91 &gt; \u4f4d\u7b97\u672f &gt; \u53cc\u76ee &gt; \u8d4b\u503c</p> </li> <li> <p>\u8bb0\u5fc6\u5316\u7684dfs\u5c5e\u4e8edp</p> </li> <li> <p>\u8bb0\uff1a\\(lb_n = n~\\&amp;~-n,~ub_n = n~\\&amp;~n-1\\)</p> </li> <li> <ul> <li>\u6027\u8d28\uff1a\\(lb_n~|~ub_n == n,~lb_n~\\&amp;~ub_n==0\\)</li> </ul> </li> <li> <p>\u63a8\u8bba\uff1a\\(lb_n = n~ XOR ~ub_n, ub_n = n~ XOR ~lb_n\\)</p> </li> <li> <p><code>__builtin_popcount(n): n\u76841\u7684\u4e2a\u6570</code></p> </li> <li> <p><code>__builtin_ctz(n): n\u7684\u6700\u540e\u4e00\u4e2a1\u540e\u76840, \u8fd4\u56de\u503c\u4e0d\u5c0f\u4e8e0</code></p> </li> <li> <p><code>n &amp; -n: n\u7684\u6700\u540e\u4e00\u4e2a1\u7684\u6743\u503c</code></p> </li> <li> <p>\u5e38\u7528\u51fd\u6570\uff1a</p> </li> </ul> <pre><code>#define in(a, S) (S &gt;&gt; a &amp; 1)\n#define sub(S, T) (S == (S &amp; T))\n</code></pre>"},{"location":"oiwiki-%E6%95%B0%E5%AD%A6/%E4%BA%8C%E8%BF%9B%E5%88%B6%E9%9B%86%E5%90%88/#1","title":"1\uff0c\u4e8c\u8fdb\u5236\u96c6\u5408\u57fa\u672c\u64cd\u4f5c","text":"<p>\u96c6\u5408\u95f4\u7684\u64cd\u4f5c</p> \u64cd\u4f5c \u96c6\u5408\u8868\u793a \u4f4d\u8fd0\u7b97\u8bed\u53e5 \u4ea4\u96c6 \\(a \\cap b\\) <code>a &amp; b</code> \u5e76\u96c6 \\(a \\cup b\\) <code>a \\| b</code> \u8865\u96c6 \\(\\bar a\\) <code>~a</code>\u00a0\uff08\u5168\u96c6\u4e3a\u4e8c\u8fdb\u5236\u90fd\u662f 1\uff09 \u5dee\u96c6 \\(a\\setminus b\\) <code>a &amp; (~b)</code> \u5bf9\u79f0\u5dee \\(a \\triangle b\\) <code>a ^ b</code> a\u662fb\u7684\u5b50\u96c6 \\(a \\subseteq b\\) <code>a==(a&amp;b) \u6216 (a\\|b)==b</code> <p>\u5143\u7d20\u548c\u96c6\u5408\u7684\u64cd\u4f5c</p> \u64cd\u4f5c \u4f4d\u8fd0\u7b97\u8bed\u53e5 \\(i\\in s\\)\u00a0\u7684 \\(bool\\)\u00a0\u503c <code>s &gt;&gt; i &amp; 1</code> \u5c06 \\(i\\)\u00a0\u52a0\u5165 \\(s\\) <code>s \\|= 1 &lt;&lt; i</code> \u5c06 \\(i\\)\u00a0\u4ece \\(s\\)\u00a0\u4e2d\u5220\u9664\uff08\\(i\\)\u00a0\u5fc5\u987b\u5b58\u5728\uff09 <code>s ^= 1 &lt;&lt; i</code> \u5c06 \\(i\\) \u4ece \\(s\\) \u4e2d\u5220\u9664 <code>s &amp;= ~(1 &lt;&lt; i)</code>"},{"location":"oiwiki-%E6%95%B0%E5%AD%A6/%E4%BA%8C%E8%BF%9B%E5%88%B6%E9%9B%86%E5%90%88/#22","title":"2\uff0c\u6a212\u7684\u5e42","text":"<p>\\(n\\) \u6a21\u975e\u8d1f\u6574\u6570 \\(k\\) \u7684\u5e42 \\(\\iff\\) \\(n\\) \u7684\u4e8c\u8fdb\u5236\u53d6\u6700\u540e \\(k\\) \u4f4d \\(\\iff\\) \\(n~\\%~(2^k-1)\\)</p> <p>\u62d3\u5c55\uff1a\u5bf9\u4e8e\\(n,~n\\in N^+\\)\uff0c\\(n-1\\) \u4f1a\u5c06 \\(n\\) \u7684\u6700\u540e\u4e00\u4e2a1\u7f6e\u96f6\uff0c\u540e\u7ee7\u4f4d \u5168\u7f6e1\uff0c\\(n \\% (n-1)\\)\u7b49\u4ef7\u4e8e \u5c06 \\(n\\) \u5220\u6389\u4e8c\u8fdb\u5236\u7684\u6700\u540e\u4e00\u4f4d</p> <p>\u5e94\u7528\uff1a</p> <ul> <li>\u5224\u65ad2\u7684\u5e42</li> </ul> <pre><code>bool isPowOfTwo(int n){ return n&gt;0 &amp;&amp; !(n &amp; n-1); }\n</code></pre>"},{"location":"oiwiki-%E6%95%B0%E5%AD%A6/%E4%BA%8C%E8%BF%9B%E5%88%B6%E9%9B%86%E5%90%88/#32","title":"3\uff0c\u5b50\u96c6\u904d\u5386\uff08\u5bf9\"2\" \u7684\u5e94\u7528\uff09","text":"<p>\uff08\u5b50\u96c6\u4e5f\u53ef\u4ee5\u79f0\u4e3a\u63a9\u7801\uff1f\uff08\u63a9\u7801\u7528\u4e8e\u5bf9\u6e90\u7801\u8fdb\u884c \u6309\u4f4d\u4e0e \u64cd\u4f5c\uff0c\u4ee5\u5c4f\u853d\u6216\u663e\u793a\u67d0\u4e9b\u4f4d\uff09\uff09</p> <p>\uff08\u8bc1\u660e\uff09</p> <ul> <li>\u964d\u5e8f\u904d\u5386 \\(s\\) \u7684\u975e\u7a7a\u5b50\u96c6</li> </ul> <pre><code>for(int i=s; i&gt;0; i=i-1&amp;s){\ncout &lt;&lt; i &lt;&lt; ' ';\n}\n</code></pre> <ul> <li>\u964d\u5e8f\u904d\u5386 s \u7684\u5b50\u96c6</li> </ul> <pre><code>for(int i=s; ; i=i-1&amp;s){\ncout &lt;&lt; i &lt;&lt; ' ';\nif(i&lt;=0) break;\n}\n</code></pre> <p>\u4f7f\u7528 \\(popcount(s)\\) \u8868\u793a \\(s\\) \u4e8c\u8fdb\u5236\u4e2d 1 \u7684\u4e2a\u6570\uff0c\u7528\u8fd9\u79cd\u65b9\u6cd5\u53ef\u4ee5\u5728 \\(O(2^{popcount(s)})\\) \u7684\u65f6\u95f4\u590d\u6742\u5ea6\u5185\u904d\u5386\u96c6\u5408 \\(s\\) \u7684\u5b50\u96c6</p> <ul> <li>\u904d\u5386\u6240\u6709\u63a9\u7801\u7684\u5b50\u63a9\u7801\uff0c\\(O(3^n)\\)</li> </ul> <p>\u8f93\u5165\u4f4d\u6570 \\(n\\)</p> <p>1\uff09\u53ef\u91cd\u590d\u5212\u5206\u7248\uff08\u7528\u4e8e\u53ef\u91cd\u590d\u8ba1\u7b97\uff09</p> <pre><code>for(int S=0; S&lt;1&lt;&lt;n; ++S){\nfor(int T=S; T; T=T-1&amp;S){\n// T \u4e3a S\u7684\u5b50\u96c6\n// S^T \u6216 S-T \u4e3a T\u5bf9S\u7684\u8865\u96c6\n// S \u548c S^T \u4e3a S\u7684\u5212\u5206\n}\ncout &lt;&lt; '\\n';\n}\n</code></pre> <p>2\uff09\u4e0d\u91cd\u590d\u5212\u5206\u7248\uff1a\uff08\u7528\u4e8e\u8ba1\u6570\uff09</p> <pre><code>for(int S=1; S&lt;1&lt;&lt;n; ++S){\nint p = __builtin_ctz(S);\nfor(int T=S; T; T=T-1&amp;S){\nif(!(T &gt;&gt; p &amp; 1)) continue;\n}\n}\n</code></pre> <p>\u590d\u6742\u5ea6\u8bc1\u660e\uff1a</p> <p>\u5c06 \\(j\\) \u7684\u4e8c\u8fdb\u5236\u4e2d 1\u7684\u4e2a\u6570 \\(k\\) \u8fdb\u884c\u5212\u5206 \\((0\\le k\\le n)\\)\uff0c\u6b64\u65f6 \\(j\\) \u6709 \\(2^k\\) \u4e2a\u5b50\u96c6\uff0c\u56e0\u6b64 \\(T_n = \\sum\\limits_{k=0}^{n}C_{n}^{k}\\times 2^k = \\sum\\limits_{k=0}^{n}C_{n}^{k}\\times 2^k\\times 1^{n-k}=(2+1)^n=3^n\\)</p> <p>\uff08\\(a~\\&amp;~b \\le min\\{a,~b\\}\\)\uff09</p> <ul> <li>\u8ba1\u7b97\u4ee5\u67d0\u70b9\u4e3a\u6839\uff0c\u5177\u6709n\u4e2a\u7ed3\u70b9\u7684\u6811\u7684\u65b9\u6848\u6570</li> </ul> <p>1\uff09\u7ed3\u8bba\uff1a\\(n^{n-2}\\)</p> <p>2\uff09\u72b6\u538bdp\u8ba1\u7b97\uff1a</p> <p>\u8bbe\u4ee5 \\(u\\) \u4e3a\u6839\uff0c\u70b9\u96c6\u4e3a \\(S\\) \u7684\u65b9\u6848\u6570\u4e3a \\(f_{S,~u}\\)</p> <p>\\(\\displaystyle f_{S,~u} = \\sum_{T\\subseteq S\\setminus u,~v\\in T} f_{T,~v}\\times f_{S-T,~u}\\)</p> <p>\u53ef\u4ee5\u8bc1\u4e0a\u8ff0\u8f6c\u79fb\u5f0f\u65e0\u6cd5\u505a\u5230\u4e0d\u91cd\u4e0d\u6f0f\uff08\u4e0d\u4f1a\uff09</p> <p>\u4e3a\u4e86\u8ba1\u7b97\u4e0d\u91cd\u590d\uff0c\u5f15\u5165\u5e38\u91cf\u70b9 \\(p \\in S\\setminus u,~p\\in T\\)</p> <p>\\(\\displaystyle f_{S,~u} = \\sum_{T\\subseteq S\\setminus u,~v\\in T,~p\\in T} f_{T,~v}\\times f_{S-T,~u}\\)</p> <pre><code>#include&lt;bits/stdc++.h&gt;\nusing namespace std;\n#define int long long\nint n;\nint f[1&lt;&lt;20][20];\nint dfs(int S, int u){\nint &amp;ans = f[S][u]; if(~ans) return ans;\nif(__builtin_popcount(S) == 1) return ans = 1;\nans = 0;\nint Su = S ^ 1 &lt;&lt; u;\nint p = __builtin_ctz(Su);\nfor(int T=Su; T; T=T-1&amp;Su){\nif(!(T &gt;&gt; p &amp; 1)) continue;\nfor(int v=0; v&lt;n; ++v){\nif(!(T &gt;&gt; v &amp; 1)) continue;\nans += dfs(T, v) * dfs(S-T, u);\n}\n}\nreturn ans;\n}\nsigned main(){\nwhile(cin &gt;&gt; n){\nmemset(f, -1, sizeof f);\ncout &lt;&lt; dfs((1&lt;&lt;n)-1, 0) &lt;&lt; '\\n';\n}\n}\n</code></pre> <p></p> <ul> <li></li> <li>Atcoder - Close Group</li> <li>Codeforces - Nuclear Fusion</li> <li>Codeforces - Sandy and Nuts</li> <li>Uva 1439 - Exclusive Access 2</li> <li>UVa 11825 - Hackers' Crackdown</li> </ul> <p>Solution -\u300cCF 599E\u300dSandy and Nuts - Rainybunny - \u535a\u5ba2\u56ed (cnblogs.com)</p> <p>\\(T \\subseteq S\\) \\(u\\)</p> <p>\\(p \\in T\\)</p> <p>(70\u6761\u6d88\u606f) Codeforces 1741G. Kirill and Company\uff08BFS/\u4f4d\u8fd0\u7b97/\u5206\u7ec4\u80cc\u5305\uff09_Happig\u4e36\u7684\u535a\u5ba2-CSDN\u535a\u5ba2</p>"},{"location":"oiwiki-%E6%95%B0%E5%AD%A6/%E4%BA%8C%E8%BF%9B%E5%88%B6%E9%9B%86%E5%90%88/#4","title":"4\uff0c","text":""},{"location":"oiwiki-%E6%95%B0%E5%AD%A6/%E5%8D%9A%E5%BC%88%E8%AE%BA/","title":"\u535a\u5f08\u8bba","text":"<p>\u5df4\u4ec0\u535a\u5955(Bash Game)\u5165\u95e8 - \u77e5\u4e4e (zhihu.com)</p>"},{"location":"oiwiki-%E6%95%B0%E5%AD%A6/%E5%8D%9A%E5%BC%88%E8%AE%BA/#1bash-game","title":"1\uff0c\u5df4\u4ec0\u535a\u5f08(Bash Game)","text":"<p>\u63cf\u8ff0\uff1a\u6709\u4e00\u5806 \\(n\\) \u4e2a\u7269\u54c1\uff0c\u4e24\u4eba\u8f6e\u6d41\u53d6 \\(k\\) \u4e2a\u7269\u54c1\uff08\\(1\\le k\\le m\\) \uff09\uff0c\u6700\u540e\u53d6\u5149\u7740\u80dc</p> <p>\u7ed3\u8bba\uff1a\\((m+1)\\nmid n\\)\uff0c\u5219\u5148\u624b\u5fc5\u80dc</p> <p>\u5148\u624b\u5fc5\u80dc\u7b56\u7565\uff1a\u8bb0 \\(n=(m+1)\\times r+s~(1\\le s\\le m)\\)</p> <p>\u5148\u624b\u7b2c\u4e00\u6b21\u53d6 \\(s\\) \u4e2a\uff0c\u7136\u540e \u540e\u624b\u6bcf\u6b21\u53d6 \\(k\\) \u4e2a\uff0c\u5148\u624b\u5c31\u53d6 \\(m+1-k\\) \u4e2a\uff0c\u4f7f\u5f97\u540e\u624b\u6bcf\u6b21\u90fd\u9762\u4e34\u5fc5\u8d25\u5c40\u9762</p> <p>\uff08\\(m+1\\) \u6574\u9664 \\(n\\) \u65f6\uff0c\u4e3a\u5fc5\u8d25\u6001\uff1b\u4e0d\u65ad\u5236\u9020\u5fc5\u8d25\u6001\u5c31\u53ef\u83b7\u80dc\uff09</p>"},{"location":"oiwiki-%E6%95%B0%E5%AD%A6/%E5%8D%9A%E5%BC%88%E8%AE%BA/#2fibonacci-nim","title":"2\uff0c\u6590\u6ce2\u90a3\u5951\u535a\u5f08\uff08Fibonacci Nim\uff09","text":"<p>\u63cf\u8ff0\uff1a\u6709\u4e00\u5806 \\(n\\) \u4e2a\u7269\u54c1\uff0c\u4e24\u4eba\u8f6e\u6d41\u53d6 \\(k\\) \u4e2a\u7269\u54c1\uff08$1\\le k\\le $ \u5bf9\u624b\u53d6\u7684\u6570\u7684 \\(2\\) \u500d\uff09\uff0c\u6700\u540e\u53d6\u5149\u7740\u80dc</p> <p>\u7ed3\u8bba\uff1a\u5fc5\u8d25\u6001\u4e3a \\(n= \u6590\u6ce2\u90a3\u5951\u6570\\)</p>"},{"location":"oiwiki-%E6%95%B0%E5%AD%A6/%E5%8D%9A%E5%BC%88%E8%AE%BA/#3wythoff-game","title":"3\uff0c\u5a01\u4f50\u592b\u535a\u5f08\uff08Wythoff Game\uff09","text":""},{"location":"oiwiki-%E6%95%B0%E5%AD%A6/%E5%8D%9A%E5%BC%88%E8%AE%BA/#0","title":"0\uff0c\u535a\u5f08\u8bba","text":"<ul> <li>\u516c\u5e73\u7ec4\u5408\u6e38\u620f</li> </ul> <ul> <li>\u975e\u516c\u5e73\u7ec4\u5408\u6e38\u620f</li> </ul> <ul> <li>\u53cd\u5e38\u6e38\u620f</li> </ul>"},{"location":"oiwiki-%E6%95%B0%E5%AD%A6/%E5%8D%9A%E5%BC%88%E8%AE%BA/#1","title":"1\uff0c\u516c\u5e73\u7ec4\u5408\u6e38\u620f","text":"<ul> <li>\\(nim\\) \u6e38\u620f</li> </ul> <ul> <li>\u535a\u5f08\u56fe\u548c\u72b6\u6001</li> </ul> <p>\u5373\uff1a $1\u3001\u5fc5\u8d25\u72b6\u6001\u65e0\u540e\u7ee7\u72b6\u6001 \\ 2\u3001\u5fc5\u80dc\u72b6\u6001\u5b58\u5728\u4e00\u4e2a\u5fc5\u8d25\u540e\u7ee7\u72b6\u6001 \\3\u3001\u5fc5\u8d25\u72b6\u6001\u7684\u540e\u7ee7\u5747\u4e3a\u5fc5\u80dc\u72b6\u6001 $</p> <p></p> <ul> <li>\\(nim\\) \u548c</li> </ul> <p></p> <p></p> <p>\uff08\u7ed3\u8bba\uff1a\u5982\u679c \\(\\underset{i=1..n}\\oplus a_i \\ne 0\\)\uff0c\u5219\u5b58\u5728\u4e00\u79cd\u5148\u624b\u80dc\u5229\u7684\u65b9\u6848\uff1a\u6bcf\u6b21\u90fd\u4f7f</p> <p>$a_i' = a_i\\underset{i=1..n}\\oplus a_i \\&amp;\\&amp; a_i'\\ne a_i $  \uff09</p> <ul> <li>\u6709\u5411\u56fe\u6e38\u620f \u4e0e \\(sg\\) \u51fd\u6570</li> </ul> <p>(\u8f6c\u8f7d)Nim\u6e38\u620f\u535a\u5f08(\u6536\u96c6\u5b8c\u5168\u7248) - exponent - \u535a\u5ba2\u56ed (cnblogs.com)</p> <p>[\u7ec4\u5408\u6e38\u620f\u4e0e\u535a\u5f08\u8bba]\u3010\u5b66\u4e60\u7b14\u8bb0\u3011 - Candy? - \u535a\u5ba2\u56ed (cnblogs.com)</p>"},{"location":"oiwiki-%E6%95%B0%E5%AD%A6/%E5%A4%8D%E6%95%B0/","title":"\u590d\u6570","text":""},{"location":"oiwiki-%E6%95%B0%E5%AD%A6/%E5%A4%8D%E6%95%B0/#1","title":"1\uff0c\u590d\u6570","text":"<ul> <li>\u5f15\u5165</li> </ul> <ul> <li>\u5b9a\u4e49</li> </ul> <p>\u6211\u4eec\u5b9a\u4e49\u5f62\u5982 \\(a+bi\\)\uff0c\u5176\u4e2d \\(a,b\\in \\mathbb{R}\\) \u7684\u6570\u53eb\u505a \u590d\u6570\uff0c\u5176\u4e2d \\(i\\) \u88ab\u79f0\u4e3a \u865a\u6570\u5355\u4f4d\uff0c\u5168\u4f53\u590d\u6570\u7684\u96c6\u5408\u53eb\u505a \u590d\u6570\u96c6</p> <p>\u6570\u901a\u5e38\u7528 \\(\\mathcal{z}\\) \u8868\u793a\uff0c\u5373 \\(\\mathcal{z} ~=~ a+bi\\)\u3002\u8fd9\u79cd\u5f62\u5f0f\u88ab\u79f0\u4e3a \u590d\u6570\u7684\u4ee3\u6570\u5f62\u5f0f\u3002\u5176\u4e2d \\(a\\) \u79f0\u4e3a\u590d\u6570 \\(\\mathcal{z}\\) \u7684 \u5b9e\u90e8\uff0c\\(b\\) \u79f0\u4e3a\u590d\u6570 \\(\\mathcal{z}\\) \u7684 \u865a\u90e8\u3002\u5982\u65e0\u7279\u6b8a\u8bf4\u660e\uff0c\u90fd\u6709 \\(a,b\\in \\mathbb{R}\\)</p> <p>\u5bf9\u4e8e\u4e00\u4e2a\u590d\u6570 \\(z\\)\uff0c\u5f53\u4e14\u4ec5\u5f53 \\(b=0\\) \u65f6\uff0c\u5b83\u662f\u5b9e\u6570\uff0c\u5f53\\(b\\not = 0\\)  \u65f6\uff0c\u5b83\u662f\u865a\u6570\uff0c\u5f53 \\(a=0\\) \u4e14 \\(b\\ne 0\\) \u65f6\uff0c\u5b83\u662f\u7eaf\u865a\u6570</p> <p></p>"},{"location":"oiwiki-%E6%95%B0%E5%AD%A6/%E5%A4%8D%E6%95%B0/#2","title":"2\uff0c\u590d\u6570\u6027\u8d28\u3001\u8fd0\u7b97","text":"<ul> <li>\u51e0\u4f55\u610f\u4e49</li> </ul> <p>\uff08\u590d\u6570\u96c6\u7684\u6570 \\(\\iff\\) \u590d\u5e73\u9762\u4e0a\u7684\u70b9 \\(\\iff\\) \u590d\u5e73\u9762\u4e0a\u7684\u5411\u91cf\uff09</p> <p></p> <p></p> <ul> <li> <p>\u8fd0\u7b97</p> </li> <li> <ul> <li>\u52a0\u6cd5\uff0c\u51cf\u6cd5</li> </ul> </li> </ul> <p></p> <p></p> <p></p> <ul> <li> <ul> <li>\u4e58\u6cd5\uff0c\u9664\u6cd5</li> </ul> </li> </ul> <p></p> <p></p> <p></p> <p>\u590d\u6570\u4e58\u6cd5\u6ee1\u8db3\u4ea4\u6362\u5f8b\uff0c\u7ed3\u5408\u5f8b\u548c\u5bf9\u52a0\u6cd5\u7684\u5206\u914d\u5f8b\uff1a</p> <p>\\(z_1z_2=z_2z_1\\\\ (z_1z_2)z_3=z_1(z_2z_3)\\\\ z_1(z_2+z_3)=z_1z_2+z_1z_3\\)</p> <p></p> <p></p> <p>\uff08\u5171\u8f6d\u590d\u6570\uff1a\u4e24\u4e2a\u865a\u6570\u5b9e\u90e8\u76f8\u7b49\uff0c\u865a\u90e8\u4e92\u4e3a\u76f8\u53cd\u6570\u65f6\uff0c\u8fd9\u4e24\u4e2a\u590d\u6570\u4e92\u4e3a \u5171\u8f6d\u590d\u6570\uff0c\u901a\u5e38\u8bb0 \\(z=a+b\\text{i}\\) \u7684\u5171\u8f6d\u590d\u6570\u4e3a \\(\\bar z=a-b\\text{i}\\)\u3002\u6211\u4eec\u53ef\u4ee5\u53d1\u73b0\uff0c\u4e24\u4e2a\u590d\u6570\u4e92\u4e3a\u5171\u8f6d\u590d\u6570\uff0c\u90a3\u4e48\u5b83\u4eec \u5173\u4e8e\u5b9e\u8f74\u5bf9\u79f0\uff09</p>"},{"location":"oiwiki-%E6%95%B0%E5%AD%A6/%E5%A4%8D%E6%95%B0/#3","title":"3\uff0c\u6781\u5750\u6807\u7684\u89c6\u89d2","text":"<p>\u5982\u679c\u8bbe\u5b9a\u5b9e\u6570\u5355\u4f4d \\(1\\) \u4f5c\u4e3a\u6c34\u5e73\u6b63\u65b9\u5411\uff0c\u865a\u6570\u5355\u4f4d \\(i\\) \u4f5c\u4e3a\u7ad6\u76f4\u6b63\u65b9\u5411\uff0c\u5f97\u5230\u7684\u5c31\u662f\u76f4\u89d2\u5750\u6807\u89c6\u89d2\u4e0b\u7684\u590d\u5e73\u9762\u3002</p> <p>\u8868\u793a\u590d\u6570 \\(\\mathcal{z}\\) \u7684\u4f4d\u7f6e\uff0c\u4e5f\u53ef\u4ee5\u501f\u52a9\u4e8e\u6781\u5750\u6807 \\((r,~\\theta)\\) \u786e\u5b9a\u3002</p> <p>\u524d\u6587\u5df2\u7ecf\u63d0\u5230\u4e86 \\(r\\) \u4e3a\u590d\u6570 \\(z\\) \u7684\u6a21</p> <ul> <li>\u5e45\u89d2 \\(Arg\\)\uff0c\u8f90\u89d2\u4e3b\u503c \\(arg\\)</li> </ul> <p>\u4ece\u5b9e\u8f74\u6b63\u5411\u5230 \u975e\u96f6 \u590d\u6570 \\(z=x+iy\\) \u5bf9\u5e94\u5411\u91cf\u7684\u5939\u89d2 \\(\\theta\\) \u6ee1\u8db3\u5173\u7cfb \\(\\tan \\theta=\\frac{y}{x}\\)\uff0c\u79f0\u4e3a\u590d\u6570  \\(z\\)\u7684 \u8f90\u89d2\uff0c\u8bb0\u4e3a\uff1a\\(\\theta= \\operatorname{Arg} z\\)</p> <p>\u4efb\u4e00\u4e2a\u00a0\u975e\u96f6\u00a0\u590d\u6570\u00a0\u00a0\u6709\u65e0\u7a77\u591a\u4e2a\u8f90\u89d2\u3002\u501f\u52a9\u5f00\u5934\u5c0f\u5199\u7684\u00a0\\(\\operatorname{arg} z\\)\u00a0\u8868\u793a\u00a0\u5176\u4e2d\u4e00\u4e2a\u7279\u5b9a\u503c\uff0c\u6ee1\u8db3\u6761\u4ef6\uff1a\\(-\\pi&lt;\\operatorname{arg} z \\le \\pi\\)\uff0c\u79f0  \u4e3a \u8f90\u89d2\u4e3b\u503c \u6216 \u4e3b\u8f90\u89d2\u3002</p> <p>\uff08\\(\\operatorname{Arg}z ~=~ \\operatorname{arg}z ~+~ 2\\times k\\times\\pi,~k\\in\\mathbb{Z}\\)\uff09</p> <ul> <li>\u5355\u4f4d\u5706</li> </ul> <p>\u6a21\u5c0f\u4e8e \\(1\\) \u7684\u590d\u6570\uff0c\u5728\u590d\u5e73\u9762\u4e0a\u6784\u6210\u7684\u56fe\u5f62</p> <ul> <li>\u5355\u4f4d\u590d\u6570</li> </ul> <p>\u6a21\u7b49\u4e8e \\(1\\) \u7684\u590d\u6570</p> <ul> <li>\u5355\u4f4d\u5706\u5468</li> </ul> <p>\u5168\u4f53\u5355\u4f4d\u590d\u6570\u5728\u590d\u5e73\u9762\u4e0a\u6784\u6210\u7684\u56fe\u5f62</p> <p>\uff08\u5728\u4e0d\u5f15\u8d77\u6df7\u6dc6\u7684\u60c5\u51b5\u4e0b\uff0c\u6709\u65f6\u5355\u4f4d\u5706\u5468\u4e5f\u7b80\u79f0\u5355\u4f4d\u5706\uff09</p> <p>\u5728\u6781\u5750\u6807\u7684\u89c6\u89d2\u4e0b\uff0c\u590d\u6570\u7684\u4e58\u9664\u6cd5\u53d8\u5f97\u5f88\u7b80\u5355\u3002</p> <p>\u590d\u6570\u4e58\u6cd5\uff1a\u6a21\u76f8\u4e58\uff0c\u8f90\u89d2\u76f8\u52a0</p> <p>\u590d\u6570\u9664\u6cd5\uff1a\u6a21\u76f8\u9664\uff0c\u8f90\u89d2\u76f8\u51cf</p>"},{"location":"oiwiki-%E6%95%B0%E5%AD%A6/%E5%A4%8D%E6%95%B0/#4","title":"4\uff0c\u590d\u6307\u6570\u51fd\u6570\uff0c\u590d\u4e09\u89d2\u51fd\u6570","text":"<ul> <li>\u590d\u6307\u6570\u51fd\u6570</li> </ul> <p>\u5bf9\u4e8e\u590d\u6570 \\(z=x+i\\times y\\)\uff0c</p> <p>\\(f_z=e^x(\\cos y+i\\sin y)\\) \u6ee1\u8db3 \\(f_{z_1+z_2}=f_{z_1}f_{z_2}\\)</p> <p>\u5b9a\u4e49\u590d\u6307\u6570\u51fd\u6570\u4e3a\uff1a\\(\\operatorname{exp}z ~=~ e^x\\times (\\cos_y + i\\times \\sin_y)\\)</p> <ul> <li> <ul> <li>\u6027\u8d28</li> </ul> </li> </ul> <p>\u6a21\u6052\u6b63\uff1a\\(|\\operatorname{exp} z|=\\operatorname{exp} x&gt;0\\)</p> <p>\u8f90\u89d2\u4e3b\u503c\uff1a\\(\\operatorname{arg} \\operatorname{exp} z=y\\)</p> <p>\u52a0\u6cd5\u5b9a\u7406\uff1a\\(\\operatorname{exp} (z_1+z_2)=\\operatorname{exp} (z_1)\\operatorname{exp} (z_2)\\)</p> <p>\u5468\u671f\u6027\uff1a \\(\\operatorname{exp} z\\) \u662f\u4ee5 \\(2\\times\\pi\\times i\\) \u4e3a\u57fa\u672c\u5468\u671f\u7684\u5468\u671f\u51fd\u6570</p> <p>\uff08\u5982\u679c\u4e00\u4e2a\u51fd\u6570 \\(f_z\\) \u7684\u5468\u671f\u662f\u67d0\u4e00\u5468\u671f\u7684\u6574\u500d\u6570\uff0c\u79f0\u8be5\u5468\u671f\u4e3a \u57fa\u672c\u5468\u671f\uff09</p> <ul> <li>\u590d\u4e09\u89d2\u51fd\u6570</li> </ul> <p>\u6b27\u62c9\u516c\u5f0f\uff1a\\(\\displaystyle \\cos z=\\frac{\\operatorname{exp} (iz)+\\operatorname{exp} (-iz)}{2} \\\\ \\sin z=\\frac{\\operatorname{exp} (iz)-\\operatorname{exp} (-iz)}{2i}\\)</p> <ul> <li> <ul> <li>\u6027\u8d28</li> </ul> </li> </ul> <p>\u5947\u5076\u6027\uff1a\u6b63\u5f26\u51fd\u6570\u662f\u5947\u51fd\u6570\uff0c\u4f59\u5f26\u51fd\u6570\u662f\u5076\u51fd\u6570</p> <p>\u4e09\u89d2\u6052\u7b49\u5f0f\uff1a\u901a\u5e38\u7684\u4e09\u89d2\u6052\u7b49\u5f0f\u90fd\u6210\u7acb\uff0c\u4f8b\u5982\u5e73\u65b9\u548c\u4e3a \\(1\\)\uff0c\u6216\u8005\u89d2\u7684\u548c\u5dee\u516c\u5f0f\u7b49</p> <p>\u5468\u671f\u6027\uff1a\u6b63\u5f26\u4e0e\u4f59\u5f26\u51fd\u6570\u4ee5\u00a0\\(2\\pi\\)\u00a0\u4e3a\u57fa\u672c\u5468\u671f\u3002</p> <p>\u96f6\u70b9\uff1a\u5b9e\u6b63\u5f26\u4e0e\u5b9e\u4f59\u5f26\u51fd\u6570\u7684\u5168\u4f53\u96f6\u70b9\uff0c\u6784\u6210\u4e86\u590d\u6b63\u5f26\u4e0e\u590d\u4f59\u5f26\u51fd\u6570\u7684\u5168\u4f53\u96f6\u70b9\u3002\u8fd9\u4e2a\u63a8\u5e7f\u6ca1\u6709\u5f15\u8fdb\u65b0\u7684\u96f6\u70b9\u3002</p> <p>\u6a21\u7684\u65e0\u754c\u6027\uff1a\u590d\u6b63\u5f26\u4e0e\u590d\u4f59\u5f26\u51fd\u6570\uff0c\u6a21\u957f\u53ef\u4ee5\u5927\u4e8e\u4efb\u610f\u7ed9\u5b9a\u7684\u6b63\u6570\uff0c\u4e0d\u518d\u50cf\u5b9e\u6b63\u5f26\u4e0e\u5b9e\u4f59\u5f26\u51fd\u6570\u4e00\u6837\u88ab\u9650\u5236\u5728\u00a0\\(1\\)\u00a0\u7684\u8303\u56f4\u5185\u3002</p>"},{"location":"oiwiki-%E6%95%B0%E5%AD%A6/%E5%A4%8D%E6%95%B0/#5","title":"5\uff0c\u590d\u6570\u7684\u4e09\u79cd\u5f62\u5f0f","text":"<p>\u4ee3\u6570\u5f62\u5f0f\uff1a\\(z=x+yi\\)</p> <p>\u4e09\u89d2\u5f62\u5f0f\uff1a\\(z=r(\\cos \\theta +i\\sin \\theta)\\)</p> <p>\u6307\u6570\u5f62\u5f0f\uff1a\\(z=r \\operatorname{exp} (i\\theta)\\)</p> <p>\uff08\u540e\u4e24\u79cd\u5f62\u5f0f\u6613\u4e8e\u4f7f\u7528\u4e58\u9664\u8fd0\u7b97\uff09</p>"},{"location":"oiwiki-%E6%95%B0%E5%AD%A6/%E5%A4%8D%E6%95%B0/#6","title":"6\uff0c\u591a\u503c\u51fd\u6570","text":"<p>\u5355\u503c\u51fd\u6570\uff1a\u5bf9\u4e8e\u6bcf\u4e00\u4e2a\u590d\u6570\u81ea\u53d8\u91cf\uff0c\u53ea\u6709\u552f\u4e00\u7684\u590d\u6570\u51fd\u6570\u503c\u4e0e\u5176\u5bf9\u5e94\uff0c\u5982\uff1a\u6307\u6570\u51fd\u6570\u548c\u4e09\u89d2\u51fd\u6570</p> <p>\u591a\u503c\u51fd\u6570\uff1a\u5bf9\u4e8e\u67d0\u4e9b\u590d\u6570\u81ea\u53d8\u91cf\uff0c\u6709\u591a\u4e8e\u4e00\u4e2a\u7684\u590d\u6570\u51fd\u6570\u503c\u4e0e\u5176\u5bf9\u5e94</p> <p>\uff08\u591a\u503c\u51fd\u6570\u7684\u51fd\u6570\u503c\u4e3a\u96c6\u5408\uff0c\u503c\u57df\u4e3a\u51fd\u6570\u503c\u96c6\u5408\u7684\u96c6\u5408\u3002\u591a\u503c\u51fd\u6570\u5e38\u5e38\u9996\u5b57\u6bcd\u5927\u5199\uff0c\u5e76\u89c4\u5b9a\u4e00\u4e2a\u5bf9\u5e94\u9996\u5b57\u6bcd\u5c0f\u5199\u7684\u5355\u503c\u51fd\u6570\u79f0\u4e3a \u4e3b\u503c\uff09</p>"},{"location":"oiwiki-%E6%95%B0%E5%AD%A6/%E5%A4%8D%E6%95%B0/#7","title":"7\uff0c\u590d\u5bf9\u6570\u51fd\u6570","text":"<p>\u89c4\u5b9a \u590d\u5bf9\u6570\u51fd\u6570\uff08\u4e5f\u7b80\u79f0 \u5bf9\u6570\u51fd\u6570\uff09\u662f\u590d\u6307\u6570\u51fd\u6570\u7684\u53cd\u51fd\u6570\uff0c\u53ef\u4ee5\u89e3\u5f97\uff1a\\(\\operatorname{Ln} z=\\ln{|z|}+i \\operatorname{Arg} z\\)</p> <p>\u5bf9\u6570\u51fd\u6570\u7684\u5b9a\u4e49\u57df\u4e3a \u975e\u96f6 \u590d\u6570\u3002\u7531\u4e8e\u8f90\u89d2\u51fd\u6570\u662f\u591a\u503c\u51fd\u6570\uff0c\u56e0\u6b64\u5bf9\u6570\u51fd\u6570\u4e5f\u662f\u591a\u503c\u51fd\u6570\u3002\u76f8\u5e94\u5730\uff0c\u8bb0 \u5bf9\u6570\u51fd\u6570\u7684\u4e3b\u503c \u4e3a\uff1a\\(\\ln z=\\ln{|z|}+i \\operatorname{arg} z\\)</p> <p>\u4e8e\u662f\u5bf9\u6570\u51fd\u6570\u53ef\u8bb0\u4e3a\uff1a\\(\\operatorname{Ln} z=\\{\\ln z +2k\\pi i| k\\in Z\\}\\)</p> <p>\u590d\u5bf9\u6570\u51fd\u6570\u62e5\u6709\u6027\u8d28\uff1a\\(\\operatorname{Ln}(z_1z_2)=\\operatorname{Ln} z_1 + \\operatorname{Ln} z_2\\)\uff08\u4e58\u6cd5\u5b9a\u7406\uff1f\uff09</p> <p>\uff08\u8fd9\u4e2a\u6027\u8d28\u4e0e\u5b9e\u5bf9\u6570\u51fd\u6570\u76f8\u540c\u3002\u800c\u5bf9\u6570\u51fd\u6570\u7684\u4e3b\u503c\u4e0d\u6ee1\u8db3\u8be5\u6027\u8d28\uff09</p>"},{"location":"oiwiki-%E6%95%B0%E5%AD%A6/%E5%A4%8D%E6%95%B0/#8","title":"8\uff0c\u4e00\u822c\u6307\u6570\u51fd\u6570","text":"<p>1\uff09\u4e00\u822c\u6307\u6570\u51fd\u6570 \u5b9a\u4e49\u4e3a\uff1a\\(a^z=\\operatorname{exp} (z \\operatorname{Ln} a)\\)</p> <p>\u5bf9\u4e8e\u4efb\u610f\u7684 \u975e\u96f6 \u590d\u6570 \\(a\\)\uff0c\u4e00\u822c\u6307\u6570\u51fd\u6570\u662f\u591a\u503c\u51fd\u6570</p> <p>2\uff09\u5c55\u5f00\u5f62\u5f0f\uff1a\\(a^z=\\operatorname{exp} (z \\operatorname{Ln} a)=\\operatorname{exp} (z\\ln a +2k\\pi iz)=\\operatorname{exp} (z\\ln a)\\operatorname{exp} (2k\\pi iz)\\)</p> <p>\u4e00\u822c\u6307\u6570\u51fd\u6570\u7684\u591a\u503c\u6027\u6765\u6e90\u4e8e\u5e95\u6570\u8f90\u89d2\u7684\u591a\u503c\u6027\u3002\u4ee5\u5b9e\u6570\u5355\u4f4d \\(1\\) \u4e3a\u5e95\u7684\u6307\u6570\u51fd\u6570\u5e94\u5f53\u662f\uff1a\\(1^z=\\operatorname{exp} (2k\\pi iz)\\)</p> <p></p> <p>3\uff09\u4e8e\u662f\u4e00\u822c\u6307\u6570\u51fd\u6570\u53ef\u4ee5\u8bb0\u4e3a\uff1a\\(a^z=\\operatorname{exp} (z\\ln a) 1^z\\)</p> <p>\u4ee5\u81ea\u7136\u5bf9\u6570 \\(e\\) \u4e3a\u5e95\u7684\u6307\u6570\u51fd\u6570\u5e94\u5f53\u662f\uff1a\\(e^z=\\operatorname{exp} z 1^z\\)</p> <p></p>"},{"location":"oiwiki-%E6%95%B0%E5%AD%A6/%E5%A4%8D%E6%95%B0/#9","title":"9\uff0c\u4e00\u822c\u5e42\u51fd\u6570\u4e0e\u590d\u6570\u4e58\u65b9\u5f00\u65b9\uff08\u5f85\u8865\uff09","text":"<p>1\uff09\u4e00\u822c\u5e42\u51fd\u6570 \u5b9a\u4e49\u4e3a\uff1a\\(z^a=\\operatorname{exp} (a \\operatorname{Ln} z)\\)</p> <p>2\uff09\u4e00\u822c\u5e42\u51fd\u6570\u7684\u53d6\u503c\u60c5\u51b5\u9700\u8981\u5206\u7c7b\u8ba8\u8bba\u3002</p> <p>\u5c06\u4e0a\u8ff0\u5b9a\u4e49\u5f0f\u5c55\u5f00\uff1a\\(z^a=\\operatorname{exp} (a \\operatorname{Ln} z)=\\operatorname{exp} (a(\\ln z +2k\\pi i))=\\operatorname{exp} (a\\ln z) \\operatorname{exp} (2k\\pi ia)\\)</p> <p>\u6839\u636e \\(a\\) \u7684\u53d6\u503c\uff0c\u5206\u4e09\u79cd\u60c5\u5f62</p> <p></p> <p></p> <p></p> <p></p>"},{"location":"oiwiki-%E6%95%B0%E5%AD%A6/%E5%A4%8D%E6%95%B0/#10","title":"10\uff0c\u5355\u4f4d\u6839","text":"<p>\u79f0 \\(x^n=1\\) \u5728\u590d\u6570\u610f\u4e49\u4e0b\u7684\u89e3\u662f \\(n\\) \u6b21\u590d\u6839\u3002\u663e\u7136\uff0c\u8fd9\u6837\u7684\u89e3\u6709 \\(n\\) \u4e2a\uff0c\u79f0\u8fd9 \\(n\\) \u4e2a\u89e3\u90fd\u662f  \u6b21 \u5355\u4f4d\u6839 \u6216 \u5355\u4f4d\u590d\u6839\uff08the \\(n\\)-th root of unity\uff09\u3002\u6839\u636e\u590d\u5e73\u9762\u7684\u77e5\u8bc6\uff0c\\(n\\) \u6b21\u5355\u4f4d\u6839\u628a\u5355\u4f4d\u5706 \\(n\\) \u7b49\u5206\u3002</p> <p>\u8bbe \\(\\omega_n=\\operatorname{exp} i\\frac{2\\pi}{n}\\) \uff08\u5373\u5e45\u89d2\u4e3a \\(2\\pi \\over n\\) \u7684\u5355\u4f4d\u590d\u6570\uff09\uff0c</p> <p>\u5219\u00a0\\(x^n=1\\)\u00a0\u7684\u89e3\u96c6\u8868\u793a\u4e3a\u00a0\\(\\{\\omega_n^k\\mid k=0,1\\cdots,n-1\\}\\)\u3002</p> <p>\u5982\u679c\u4e0d\u52a0\u8bf4\u660e\uff0c\u4e00\u822c\u53d9\u8ff0\u7684\u00a0\\(n\\)\u00a0\u6b21\u5355\u4f4d\u6839\uff0c\u662f\u6307\u4ece\u00a0\\(1\\)\u00a0\u5f00\u59cb\u9006\u65f6\u9488\u65b9\u5411\u7684\u7b2c\u4e00\u4e2a\u89e3\uff0c\u5373\u4e0a\u8ff0\u00a0\\(\\omega_n\\)\uff0c\u5176\u5b83\u89e3\u5747\u53ef\u4ee5\u7528\u00a0\\(\\omega_n\\)\u00a0\u7684\u5e42\u8868\u793a\u3002</p> <ul> <li> <p>\u6027\u8d28\uff08\\(FFT\\) \u4e2d\u4f1a\u5f97\u5230\u5e94\u7528\uff09</p> </li> <li> <ul> <li>1\uff0c$\\omega_n^n = 1 $</li> </ul> </li> </ul> <p>\u8bc1\uff1a\\(\\omega_n^n = exp_{i\\frac{2\\times\\pi}{n}\\times n} = exp_{i\\times2\\times\\pi} = \\cos_{2\\times\\pi} + i\\times \\sin_{2\\times\\pi} = 1\\)</p> <ul> <li> <ul> <li>2\uff0c$\\omega_n^k = \\omega_{2\\times n}^{2\\times k} $</li> </ul> </li> </ul> <p>\u8bc1\uff1a\\(\\omega_n^k = exp_{i\\frac{2\\times\\pi}{n}\\times k} = exp_{i\\frac{2\\times\\pi}{2\\times n}\\times 2\\times k} = \\omega_{2\\times n}^{2\\times k}\\)</p> <ul> <li> <ul> <li>3\uff0c$ \\omega_{2\\times n}^{n+k} = -\\omega_{2\\times n}^k$</li> </ul> </li> </ul> <p>\u8bc1\uff1a\\(\\omega_{2\\times n}^{n+k} = exp_{i\\frac{2\\times\\pi}{2\\times n}\\times (n+k)} = exp_{i\\frac{2\\times\\pi}{2\\times n}\\times k + \\pi} = -exp_{i\\frac{2\\times\\pi}{2\\times n}\\times k} = -\\omega_{2\\times n}^k\\)</p>"},{"location":"oiwiki-%E6%95%B0%E5%AD%A6/%E5%A4%8D%E6%95%B0/#11","title":"11\uff0c\u672c\u539f\u5355\u4f4d\u6839","text":""},{"location":"oiwiki-%E6%95%B0%E5%AD%A6/%E5%A4%8D%E6%95%B0/#12c","title":"12\uff0cc\u5bb6\u65cf\u7684\u590d\u6570","text":"<ul> <li>\\(c99\\) \u590d\u6570 - OI Wiki (oi-wiki.org)</li> </ul> <p>s</p> <ul> <li>\\(C++ \u4e2d\u7684\u590d\u6570\\)</li> </ul> <p></p> <p></p> <p></p>"},{"location":"oiwiki-%E6%95%B0%E5%AD%A6/%E5%A4%9A%E9%A1%B9%E5%BC%8F/","title":"\u591a\u9879\u5f0f","text":""},{"location":"oiwiki-%E6%95%B0%E5%AD%A6/%E5%A4%9A%E9%A1%B9%E5%BC%8F/#1","title":"1\uff0c\u591a\u9879\u5f0f\u7b80\u4ecb","text":"<ul> <li>1\uff0c\u5ea6</li> </ul> <p>\u5bf9\u4e8e\u4e00\u4e2a\u591a\u9879\u5f0f \uff0c\u79f0\u5176\u6700\u9ad8\u6b21\u9879\u7684\u6b21\u6570\u4e3a\u8be5\u591a\u9879\u5f0f\u7684 \u5ea6\uff08Degree\uff09\uff0c\u8bb0\u4f5c \\(deg~f\\)\u3002</p> <ul> <li>2\uff0c\u591a\u9879\u5f0f\u4e58\u6cd5</li> </ul> <p>\\(f_x = a_0+a_1\\times x+..+a_n\\times x^n\\)</p> <p>\\(g_x = b_0+b_1\\times x+..+b_n\\times x^n\\)</p> <p>\\(Q_x=f_x\\times g_x=\\sum\\limits_{i=0}^n\\sum\\limits_{j=0}^m a_i\\times b_j\\times x^{i+j}=c_0+c_1\\times x+..+c_{n+m}\\times x^{n+m}\\)</p> <ul> <li>3\uff0c\u591a\u9879\u5f0f\u9006\u5143</li> </ul> <p>\\(f_x\\times g_x\\equiv 1(mod~x^n)\\)</p> <p>\\(g_x\u4e3af_x\u5728\u6a21x^n\u7684\u610f\u4e49\u4e0b\u7684\u9006\u5143\uff0c\u8bb0f^{-1}_x\\)</p> <p>\\(\u82e5deg~g&lt;n\uff0c\u5219g\u552f\u4e00\\)</p> <ul> <li>4\uff0c\u591a\u9879\u5f0f\u7684\u4f59\u6570\u548c\u5546 \uff08\u591a\u9879\u5f0f\u9664\u6cd5\uff09</li> </ul> <p>\u5bf9\u4e8e\u591a\u9879\u5f0f \\(f_x,~g_x\\)\uff0c\u5219\u5b58\u5728\u552f\u4e00\u7684 \\(Q_x,~R_x\\) \u6ee1\u8db3\uff1a</p> <p>\\(f_x=Q_x\\times g_x+R_x~~\\&amp;\\&amp;~~deg~R&lt;deg~g\\)</p> <p>\\(deg~f\\ge deg~g\u65f6\uff0cdeg~Q=deg~f-deg~g\uff0c\u5426\u5219Q_x=0\\) \uff08\u6574\u9664\uff1f\uff1f\uff09</p> <p>\\(Q_x\u4e3ag_x\u9664f_x\u7684\u5546(quotient)\uff0cR_x\u4e3ag_x\u9664f_x\u7684\u4f59\u6570(remainder)\\)</p> <p>\\(\u4ea6\u53ef\u8bb0\u4f5cf_x\\equiv R_x(mod~g_x)\\)</p> <ul> <li>5\uff0c\u591a\u9879\u5f0f\u7684\u5bf9\u6570\u51fd\u6570\u4e0e\u6307\u6570\u51fd\u6570</li> </ul> <p>\\(ln(1-f_x) = -\\sum\\limits_{i=1}^{+\\infty} \\frac{f_x^i}{i}\\)</p> <p>\\(ln(1+f_x) = \\sum\\limits_{i=1}^{+\\infty} (-1)^{i-1}\\times\\frac{f_x^i}{i}\\)</p> <p>\\(exp~f_x=e^{f_x}=\\sum\\limits_{i=0}^{+\\infty}\\frac{f_x^i}{i!}\\)</p> <ul> <li>6\uff0c\u591a\u9879\u5f0f\u7684\u591a\u70b9\u6c42\u503c\u548c\u63d2\u503c</li> </ul> <p>1\uff09\u591a\u9879\u5f0f\u7684\u591a\u70b9\u6c42\u503c(\\(Multi-point~evaluation\\))\uff1a</p> <p>\u7ed9\u51fa\u4e00\u4e2a\u591a\u9879\u5f0f\\(f_x\\)\u548cn\u4e2a\u70b9\\(x_1\uff0cx_2\uff0c..\uff0cx_n\\)\uff0c\u6c42\\(f_{x_1}, f_{x_2}, .., f_{x_n}\\)</p> <p>\u5373 \\(x_i ~\\to~ f_{x_i}\uff08i=0..n\uff09\\)</p> <p>2\uff09\u591a\u9879\u5f0f\u7684\u63d2\u503c(\\(Interpolation\\))\uff1a</p> <p>\u7ed9\u51fa\\(n+1\\)\u4e2a\u70b9\\((x_0,y_0), (x_1, y_1), .., (x_n, y_n)\\)\uff0c\u6c42\u4e00\u4e2an\u6b21\u591a\u9879\u5f0f\\(f_x\\)\u4f7f\u5f97\u8fd9n+1\u4e2a\u70b9\u90fd\u5728\\(f_x\\)\u4e0a</p> <p>\u5373 \\((x_i,~f_{x_i}) ~\\to~ f_x (i=0..n)\\)</p> <p>\\(\u8fd9\u4e24\u79cd\u64cd\u4f5c\u5b9e\u8d28\u4e0a\u662f\u591a\u9879\u5f0f\u7684~\u7cfb\u6570\u8868\u793a~\u548c~\u70b9\u503c\u8868\u793a~\u7684\u8f6c\u5316\\)</p> <ul> <li> <p>\u8865\u5145\uff1a\u591a\u9879\u5f0f\u7684\u8868\u793a\u6cd5\uff08\u5047\u8bbe\u5bf9 \\(n\\) \u6b21\u591a\u9879\u5f0f\u800c\u8a00\uff09</p> </li> <li> <ul> <li>\u7cfb\u6570\u8868\u793a\u6cd5</li> </ul> </li> </ul> <p>\\(f_x = \\{ a_0,~a_1,a_2,~...,~a_n \\}\\)</p> <p>\u591a\u9879\u5f0f\u4e58\u6cd5\u7684\u590d\u6742\u5ea6\uff1a \\(O(n^2)\\)</p> <ul> <li> <ul> <li>\u70b9\u503c\u8868\u793a\u6cd5</li> </ul> </li> </ul> <p>\\(f_x ~=~ \\{(x_0,~f_{x_0},~(x_1,~f_{x_1}),~...,~(x_n,~f_{x_n}))\\}\\)</p> <p>\u591a\u9879\u5f0f\u4e58\u6cd5\uff1a</p> <p>\u8bbe\u53e6\u4e00\u4e2a\u591a\u9879\u5f0f\u4e3a \\(g_x ~~=~~ \\{(x_0,~~g_{x_0},~~(x_1,~~g_{x_1}),~~...,~~(x_n,~~g_{x_n}))\\}\\)</p> <p>\u5219\u6709\uff1a\\(f_x\\times g_x ~=~ f_x ~~=~~ \\{(x_0,~~f_{x_0}\\times g_{x_0}),~~(x_1,~~f_{x_1}\\times g_{x_1}),~~...,~~(x_n,~~f_{x_n}\\times g_{x_n}))\\}\\)</p> <p>\u590d\u6742\u5ea6\u4e3a \\(O(n)\\)</p>"},{"location":"oiwiki-%E6%95%B0%E5%AD%A6/%E5%A4%9A%E9%A1%B9%E5%BC%8F/#2","title":"2\uff0c\u4ee3\u6570\u57fa\u672c\u5b9a\u7406\uff08\u5f85\u8865\uff09","text":"<p>\uff08\u590d\u7cfb\u6570\u591a\u9879\u5f0f\uff1f\u590d\u53d8\u51fd\u6570\uff1f\u8fd1\u4e16\u4ee3\u6570\uff1f\uff09</p> <p></p> <ul> <li>\u865a\u6839\u6210\u5bf9\u5b9a\u7406</li> </ul> <p></p> <ul> <li> <ul> <li></li> </ul> </li> </ul> <p></p> <ul> <li> <ul> <li></li> </ul> </li> <li> <ul> <li></li> </ul> </li> </ul> <p>\uff08\uff1f\uff1f\uff1f\uff09</p> <ul> <li> <ul> <li></li> </ul> </li> <li> <p>\u6797\u58eb\u8c14\u7b97\u6cd5\uff08\u7384\u5b66\uff0cnnd\uff0c\u5f85\u8865\uff01\uff01\uff09</p> </li> </ul> <p></p> <p></p> <p></p> <p>\u539f\u7406\uff1a</p> <p></p> <p></p> <pre><code>const double eps = 1e-6;\ndouble b[1000], c[1000];\nvoid shie(double a[], int n, double *p, double *q){\nmemset(b, 0, sizeof b);\nmemset(c, 0, sizeof c);\n*p = *q = 0;\ndouble dp = 1, dq = 1;\nwhile(dp &gt; eps || dp &lt; -eps || dq &gt; eps || dq &lt; -eps){\ndouble p0 = *p, q0 = *q;\nb[n - 2] = a[n];\nc[n - 2] = b[n - 2];\nb[n - 3] = a[n - 1] - p0 * b[n - 2];\nc[n - 3] = b[n - 3] - p0 * b[n - 2];\nint j;\nfor(j = n - 4; ~j; --j){\nb[j] = a[j + 2] - p0 * b[j + 1] - q0 * b[j + 2];\nc[j] = b[j] - p0 * c[j + 1] - q0 * c[j + 2];\n}\ndouble r = a[1] - p0 * b[0] - q0 * b[1];\ndouble s = a[0] - q0 * b[0];\ndouble rp = c[1];\ndouble sp = b[0] - q0 * c[2];\ndouble rq = c[0];\ndouble sq = -q0 * c[1];\ndp = (rp * s - r * sp) / (rp * sq - rq * sp);\ndq = (r * sq - rq * s) / (rp * sq - rq * sp);\n*p += dp;\n*q += dq;\n}\n}\n</code></pre>"},{"location":"oiwiki-%E6%95%B0%E5%AD%A6/%E5%A4%9A%E9%A1%B9%E5%BC%8F/#3","title":"3\uff0c\u62c9\u683c\u6717\u65e5\u63d2\u503c\u6cd5","text":"<p>\u5f15\u7406\uff1a \\(f_x ~=~ f_a \\pmod{(x-a)}\\)  \uff08\u4e07\u6076\u4e4b\u6e90\uff08bushi\uff09</p> <p>\u8bc1\uff1a\\(f_x-f_a=(a_0-a_0)+a_1(x^1-a^1)+a_1(x^2-a^2)+\\cdots +a_n(x^n-a^n)\\) \u7136\u6709 \\((x-a)\\) \u8fd9\u4e2a\u56e0\u5f0f\uff0c\u6240\u4ee5\u5f97\u8bc1</p> <p>\u8fd9\u6837\u6211\u4eec\u5c31\u53ef\u4ee5\u5217\u4e00\u4e2a\u5173\u4e8e \\(f_x\\) \u7684\u591a\u9879\u5f0f\u7ebf\u6027\u540c\u4f59\u65b9\u7a0b\u7ec4</p> <p>\\(\\begin{cases} f_x\\equiv f_{x_1}\\pmod{(x-x_1)}\\\\ f_x\\equiv f_{x_2}\\pmod{(x-x_2)}\\\\ \\cdots\\\\ f_x\\equiv f_{x_n}\\pmod{(x-x_n)} \\end{cases}\\)</p> <p>\uff08\\(f_x\\) \u4e3a\u5e26\u6c42\u51fd\u6570\u503c\uff09</p> <p>\u6839\u636e \\(crt\\) \u5b9a\u7406\uff0c\u8bbe\\(\\displaystyle M=\\prod_{i=1}^n{(x-x_i)},m_i=\\dfrac M{x-x_i}=\\prod_{j\\ne i}{(x-x_j)}\\)</p> <p>\u5219 \\(m_i\\) \u6a21 \\((x-x_i)\\) \u610f\u4e49\u4e0b\u7684\u9006\u5143\u5c31\u662f\uff1a \\(\\displaystyle m_i^{-1}=\\prod_{j\\ne i}{\\dfrac 1{x_i-x_j}}\\)</p> <p>\uff08\u81f3\u4e8e \\(x\\) \u600e\u4e48\u53d8\u6210 \\(x_i\\) \u7684\uff0c\u53ef\u80fd\u662f\u56e0\u4e3a\u7384\u5b66\u5427\uff09</p> <p>\u6240\u4ee5\uff0c\\(\\displaystyle f_x\\equiv\\sum_{i=1}^n{f_{x_i}\\times  m_i\\times m_i^{-1}}\\equiv\\sum_{i=1}^n{f_{x_i} \\times \\prod_{i=1}^n{\\dfrac {x-x_j}{x_i-x_j}}}[j \\ne i]\\pmod M\\)</p> <p>\uff08\u5176\u4e2d \\(f_x\\) \u662f \\(n-1\\)\u6b21\u591a\u9879\u5f0f\uff1b\u800c \\(n\\) \u6b21\u591a\u9879\u5f0f\u9700\u8981\u9884\u5904\u7406 \\(n+1\\) \u4e2a\u70b9\uff09</p> <p>P4781 \u3010\u6a21\u677f\u3011\u62c9\u683c\u6717\u65e5\u63d2\u503c - \u6d1b\u8c37 | \u8ba1\u7b97\u673a\u79d1\u5b66\u6559\u80b2\u65b0\u751f\u6001 (luogu.com.cn)</p> <p>\u590d\u6742\u5ea6\uff1a\\(O(n^2)\\)</p> <pre><code>const int N = 2e3+3;\nint n, k;\nint x[N], y[N];\nint fp(int a, int n, int P){\nint ans = 1;\nwhile(n){\nif(n &amp; 1) ans = ans * a % P;\na = a * a % P;\nn &gt;&gt;= 1;\n}\nreturn ans;\n}\nint inv(int n){ return fp(n, P-2, P);}\nint crt(int y[], int x[]){\nint ans = 0;\nfor(int i=1; i&lt;=n; ++i){\nint s1 = 1, s2 = 1;\nfor(int j=1; j&lt;=n; ++j)\nif(j != i)\ns1 = s1 * (k - x[j] + P) % P, s2 = s2 * (x[i] - x[j]) % P;\nans = (ans + y[i] * s1 % P * inv(s2) % P) % P;\n}\nreturn (ans % P + P) % P;\n}\n</code></pre> <ul> <li>\u6a2a\u5750\u6807\u662f\u8fde\u7eed\u6574\u6570\u7684\u62c9\u683c\u6717\u65e5\u63d2\u503c \\(O(n)\\)</li> </ul> <p></p> <p>\uff08\u5373 \u5df2\u77e5 \\(f_{x_i},~i=1..n+1\\)\uff0c\uff08n \u4e3a\u591a\u9879\u5f0f\u7684\u6b21\u6570\uff09 \u6216 \\(f_{x_i}\\) \u6613\u6c42\uff09\u00a0\u00a0\u00a0\u00a0</p> <p>\\(\\begin{aligned} f(x)&amp;=\\sum\\limits_{i=1}^{n+1}y_i\\times \\prod\\limits_{j=1}^{n+1}\\frac{x-x_j}{x_i-x_j} [j\\ne i] \\\\ &amp;= \\sum_{i=1}^{n+1}y_i\\times \\frac{\\prod\\limits_{j=1}^{n+1}(x-j) [j\\ne i]}{\\prod\\limits_{j=1}^{n+1}(i - j) [j\\ne i]} \\\\ &amp;= \\sum_{i=1}^{n+1}y_i\\times \\frac{\\prod\\limits_{j=1}^{n+1}(x-j) [j\\ne i]}{(-1)^{n+1-i}\\times (i-1)!\\times (n+1-i)!} \\end{aligned}\\)</p> <p>\uff08\\(y_i\\) \u53ef\u4ee5\u7ebf\u6027\u7b5b \u6216 \u9898\u76ee\u7ed9\u51fa\uff1b\u5206\u5b50\u53ef\u4ee5\u7528\u524d\u7f00\u79ef\u548c\u540e\u7f00\u79ef\u6c42\u5f97\uff1b\u5206\u6bcd\uff1a\u6c42\u8fde\u7eed\u6574\u6570\u7684\u9006\u5143 \\(\\to\\) \u6c42\u9006\u5143\u7684\u524d\u7f00\u79ef\uff0c\u5373\u53ef\u6c42\u5f97\u9636\u4e58\u7684\u9006\u5143\uff09</p> <p>\uff08\u6ce8\u610f\uff1a\uff09</p> <p></p> <p>Problem - F - Codeforces</p> <p>\u6613\u77e5 \\(f_{n,~k} = \\sum\\limits_{i=1}^n i^k\\) \u662f\u51fd\u6570\u503c\u4e3a \\(n\\) \u7684 \\(k+1\\) \u6b21\u591a\u9879\u5f0f\uff08 \\(???\\) \uff09\uff0c\u6240\u4ee5\u53ef\u4ee5\u7528\u62c9\u683c\u6717\u65e5\u63d2\u503c\u6cd5</p> <p>\u590d\u6742\u5ea6\uff1a\\(O(n)\\)  \u800c\u4e0d\u662f \\(O(x)\\) \uff08\\(n\\) \u79f0\u4e3a\u591a\u9879\u5f0f\u7684\u5ea6\uff09</p> <pre><code>#include&lt;iostream&gt;\nusing namespace std;\n#define int long long\nconst int N = 1e6+3, P = 1e9+7;\nint x, k;\nint fp(int a, int n){ int ans = 1; while(n){ if(n &amp; 1) ans = ans * a % P; a = a * a % P; n &gt;&gt;= 1; } return ans; }\nint p[N], idx, st[N], f[N];\n// \u9884\u5904\u7406\u63d2\u503c \uff08n\u81f3\u5c11\u4e3a\u591a\u9879\u5f0f\u6b21\u6570 + 1\uff09 \nvoid gp(int n){\nf[1] = 1;\nfor(int i=2; i&lt;=n; ++i){\nif(!st[i]) p[ ++ idx] = i, f[i] = fp(i, k);\nfor(int j=1; p[j]&lt;=n/i; ++j){\nst[i * p[j]] = true;\n//            \u5e42\u51fd\u6570\u7684\u662f\u5b8c\u5168\u79ef\u6027\u51fd\u6570\nf[i * p[j]] = f[i] * f[p[j]] % P;\nif(!(i % p[j])) break;\n}\n}\nfor(int i=1; i&lt;=n; ++i) f[i] = (f[i-1] + f[i]) % P;\n}\n// \u9884\u5904\u7406 \\segma(i - x) \u548c \u9636\u4e58\u9006\u5143 \nint pre[N], suf[N], ifac[N];\nvoid init(){\nint n = k + 2;\npre[0] = suf[n + 1] = 1;\nfor(int i=1; i&lt;=n; ++i) pre[i] = pre[i-1] * (i - x + P) % P;\nfor(int i=n; i&gt;=1; --i) suf[i] = suf[i+1] * (i - x + P) % P;\n// \u6ce8\u610f ifac[0] \u4e5f\u53ef\u4ee5\u53d6\u5230\uff01\uff01 \nifac[0] = ifac[1] = 1;\nfor(int i=2; i&lt;=n; ++i) ifac[i] = (P - P / i) * ifac[P % i] % P;\nfor(int i=2; i&lt;=n; ++i) ifac[i] = ifac[i-1] * ifac[i] % P;\n}\nint lag(){\nint n = k + 2;\ngp(n);\nif(x &lt;= n) return f[x];\ninit();\nint ans = 0;\nfor(int i=1; i&lt;=n; ++i){\nint pp = pre[i-1] * suf[i+1] % P;\nint qq = (i-1&amp;1 ? -1 : 1) * ifac[i-1] * ifac[n-i] % P + P;\nans = (ans + f[i] * pp % P *qq % P + P) % P;\n}\nreturn ans;\n}\nsigned main(){\ncin &gt;&gt; x &gt;&gt; k;\ncout &lt;&lt; lag() &lt;&lt; '\\n';\n}\n</code></pre> <ul> <li>P5667 \u62c9\u683c\u6717\u65e5\u63d2\u503c2 - \u6d1b\u8c37 | \u8ba1\u7b97\u673a\u79d1\u5b66\u6559\u80b2\u65b0\u751f\u6001 (luogu.com.cn)</li> </ul>"},{"location":"oiwiki-%E6%95%B0%E5%AD%A6/%E5%A4%9A%E9%A1%B9%E5%BC%8F/#4-fft","title":"4\uff0c\u5feb\u901f\u5085\u91cc\u53f6\u53d8\u6362 FFT","text":"<p>\u5168\u8fc7\u7a0b\uff1a\\(\u7cfb\u6570\u8868\u793a\\to \u70b9\u503c\u8868\u793a \\to \u591a\u9879\u5f0f\u4e58\u6cd5O(n) \\to res\u591a\u9879\u5f0f\u7684\u70b9\u503c\u8868\u793a \\to res \u7684\u7cfb\u6570\u8868\u793a\\)</p> <p>\uff08\\(fft\\) \u4f7f\u5f97\u4e24\u79cd\u8868\u793a\u6cd5\u7684\u8f6c\u6362\u590d\u6742\u5ea6\u4e3a \\(O(n\\log{n})\\)\uff09</p> <p>\u672c\u6587\u5c06\u4ecb\u7ecd\u4e00\u79cd\u7b97\u6cd5\uff0c\u5b83\u652f\u6301\u5728 \\(O(n\\log n)\\) \u7684\u65f6\u95f4\u5185\u8ba1\u7b97\u4e24\u4e2a \\(n\\) \u5ea6\u7684\u591a\u9879\u5f0f\u7684\u4e58\u6cd5\uff0c\u6bd4\u6734\u7d20\u7684 \\(O(n^2)\\) \u7b97\u6cd5\u66f4\u9ad8\u6548\u3002\u7531\u4e8e\u4e24\u4e2a\u6574\u6570\u7684\u4e58\u6cd5\u4e5f\u53ef\u4ee5\u88ab\u5f53\u4f5c\u591a\u9879\u5f0f\u4e58\u6cd5\uff0c\u56e0\u6b64\u8fd9\u4e2a\u7b97\u6cd5\u4e5f\u53ef\u4ee5\u7528\u6765\u52a0\u901f\u5927\u6574\u6570\u7684\u4e58\u6cd5\u8ba1\u7b97\u3002</p> <p>\\(\\displaystyle X_k=\\sum_{n=0}^{N-1}x_ne^{\\frac{-2\\pi ikn}{N}}\\)</p> <p>\\(\\displaystyle x_n=\\sum_{k=0}^{N-1}X_ke^{\\frac{-2\\pi ikn}{N}}\\)</p> <ul> <li> <p>\u524d\u7f6e\uff1a\u590d\u6570</p> </li> <li> <p>\u5f15\u5165\uff1a</p> </li> </ul> <p></p> <p></p> <p></p> <p>\\(c_{i} ~=~ \\sum\\limits_{j=0}^{i}a_j[j\\le|A|]\\times b_{i-j}[i-j\\le|B|]\\)</p> <p>\uff08\\([~]\\) \u5185\u4e3a \\(false\\) \uff0c\u5219\u5de6\u8fb9\u7684\u503c\u4e3a \\(1\\) \u800c\u975e \\(0\\)\uff09</p> <p>\\(fft\\) \u53ef\u4ee5\u5feb\u901f\u5c06\u591a\u9879\u5f0f\u7684 \u7cfb\u6570\u8868\u793a\u6cd5 \u8f6c\u6362\u4e3a \u70b9\u503c\u8868\u793a\u6cd5\uff0c\u590d\u6742\u5ea6\uff1a\\(O(n\\log{n})\\)</p> <ul> <li>1\uff0c\u5085\u91cc\u53f6\u53d8\u6362 FF\uff08\u5f85\u8865\uff09</li> </ul> <p>\\(Fourier~Transform\\) </p> <ul> <li>2\uff0c\u79bb\u6563\u5085\u91cc\u53f6\u53d8\u6362 DFT\uff08\u5f85\u8865\uff09</li> </ul> <p>\\(Discrete~Fourier~Transform\\)</p> <p>\u6734\u7d20\u7684\u53d8\u6362\u590d\u6742\u5ea6\u8fd8\u662f\\(O(n^2)\\)</p> <ul> <li>3\uff0c\u5feb\u901f\u5085\u91cc\u53f6\u53d8\u6362 FFT</li> </ul> <p>\u672c\u8d28\uff1a\u5206\u6cbb\u7684 \\(DFT\\)\uff0c\u7cfb\u6570\u8868\u793a\u6cd5 \\(\\to\\) \u70b9\u503c\u8868\u793a\u6cd5</p> <p>\u590d\u6742\u5ea6\uff1a\\(O(n\\log{n})\\)</p> <p></p> <p>\uff08\u63d2\u503c\uff1f\uff09</p> <p></p> <p></p> <p>\\(\\begin{aligned} f(\\omega_n^k) &amp;= G((\\omega_n^k)^2) + \\omega_n^k \\times H((\\omega_n^k)^2) \\\\  &amp;= G(\\omega_n^{2k}) + \\omega_n^k \\times H(\\omega_n^{2k}) \\\\  &amp;= G(\\omega_{n/2}^k) + \\omega_n^k \\times H(\\omega_{n/2}^k) \\end{aligned}\\)</p> <p>\\(\\begin{aligned} f(\\omega_n^{k+n/2}) &amp;= G(\\omega_n^{2k+n}) + \\omega_n^{k+n/2} \\times H(\\omega_n^{2k+n}) \\\\  &amp;= G(\\omega_n^{2k}) - \\omega_n^k \\times H(\\omega_n^{2k}) \\\\  &amp;= G(\\omega_{n/2}^k) - \\omega_n^k \\times H(\\omega_{n/2}^k) \\end{aligned}\\)</p> <p></p> <p>\u9012\u5f52\u7248 \\(fft\\)\uff1a</p> <pre><code>com t[N];\n// rev = 1, DFT; rev = -1, IDFT\nvoid DFT(com *f, int n, int rev){\nif(n == 1) return ;\nfor(int i=0; i&lt;n; ++i) t[i] = f[i];\n// \u5947\u6570\u9879\u653e\u53f3\u8fb9\uff0c\u5076\u6570\u9879\u653e\u5de6\u8fb9 \nfor(int i=0; i&lt;n; ++i) f[n / 2 + (n &amp; 1) * i / 2] = t[i];\ncom *g = f, *h = f + n / 2;\nDFT(g, n / 2, rev), DFT(h, n / 2, rev);\ncom cur(0, 1), delta(cos(2 * M_PI / n), sin(2 * M_PI / n * rev));\nfor(int k=0; k&lt;n/2; ++k){\nt[k] = g[k] + cur * h[k];\nt[k + n / 2] = g[k] - cur * h[k];\ncur *= delta;\n}\nfor(int i=0; i&lt;n; ++i) f[i] = t[i];\n}\n</code></pre> <ul> <li> <ul> <li>\u4f4d\u9006\u5e8f\u7f6e\u6362\uff08\u8774\u8776\u53d8\u6362\uff09</li> </ul> </li> </ul> <p></p> <p>\uff08\u53ef\u4ee5\u89e3\u51b3\u9012\u5f52\u7248\u7684\u5185\u5b58\u95ee\u9898\uff09</p> <p></p> <p></p> <ul> <li> <ul> <li> <ul> <li>\u65b9\u6cd51\uff0c\u590d\u6742\u5ea6\\(O(n\\log{n})\\)</li> </ul> </li> </ul> </li> </ul> <pre><code>void butter(com y[], int len){\nfor(int i=1, j=len&gt;&gt;1, k; i&lt;len-1; ++i){\nif(i &lt; j) swap(y[i], y[j]);\nk = len &gt;&gt; 1;\nwhile(j &gt;= k) j -= k, k &gt;&gt;= 1;\nif(j &lt; k) j += k;\n}\n}\n</code></pre> <ul> <li> <ul> <li> <ul> <li>\u65b9\u6cd52\uff0c\u590d\u6742\u5ea6\\(O(n)\\)</li> </ul> </li> </ul> </li> </ul> <p></p> <pre><code>int rev[N];\nvoid butter(com y[], int len){\nfor(int i=0; i&lt;len; ++i){\nrev[i] = rev[i&gt;&gt;1]&gt;&gt;1 | (i &amp; 1) * (len &gt;&gt; 1);\nif(i &lt; rev[i]) swap(y[i], y[rev[i]]);\n}\n}\n</code></pre> <ul> <li> <ul> <li>\u5085\u91cc\u53f6\u9006\u53d8\u6362 \\(IDFT\\)</li> </ul> </li> </ul> <p>\u6838\u5fc3\uff1a\u70b9\u503c\u8868\u793a\u6cd5 \\(\\to\\) \u7cfb\u6570\u8868\u793a\u6cd5</p> <p>\uff08\u5b9e\u73b0\u65f6\u53ea\u9700\u7a0d\u52a0\u6539\u52a8\u5373\u53ef\uff09</p> <p></p> <p>\u7531\u4e8e\u4e2d\u95f4\u7684\u5927\u77e9\u9635\u7684\u5143\u7d20\u975e\u5e38\u7279\u6b8a\uff0c\u5b83\u7684\u9006\u77e9\u9635\u4e5f\u6709\u7279\u6b8a\u7684\u6027\u8d28\uff0c\u5c31\u662f\u6bcf\u4e00\u9879 \u53d6\u5012\u6570\uff0c\u518d \u9664\u4ee5\u53d8\u6362\u7684\u957f\u5ea6 \uff0c\u5c31\u80fd\u5f97\u5230\u5b83\u7684\u9006\u77e9\u9635\u3002</p> <p>\u6700\u7ec8\u7248 \\(fft\\)\uff1a\uff08\u975e\u9012\u5f52\uff09</p> <pre><code>// \u8774\u8776\u53d8\u6362\nvoid butter(com y[], int len){\nfor(int i=1, j=len&gt;&gt;1, k; i&lt;len-1; ++i){\nif(i &lt; j) swap(y[i], y[j]);\nk = len &gt;&gt; 1;\nwhile(j &gt;= k) j -= k, k &gt;&gt;= 1;\nif(j &lt; k) j += k;\n}\n}\nvoid fft(com y[], int len, int op){\nbutter(y, len);\nfor(int n=2; n&lt;=len; n&lt;&lt;=1){\ncom wn(cos(2 * PI / n), sin(2 * PI / n * op));\nfor(int j=0; j&lt;len; j+=n){\ncom w(1, 0);\nfor(int k=j; k&lt;j+n/2; ++k){\ncom u = y[k], v = y[k + n/2] * w;\ny[k] = u + v;\ny[k + n / 2] = u - v;\nw *= wn;\n}\n}\n}\nif(~op) return ;\nfor(int i=0; i&lt;len; ++i) y[i] /= len;\n}\n</code></pre> <p>\uff08len \u53d6\u5927\u70b9\u4e5f\u662f\u6ca1\u5173\u7cfb\u7684\uff09</p> <ul> <li>Problem - 1402 (hdu.edu.cn) </li> </ul> <pre><code>#include&lt;iostream&gt;\n#include&lt;complex&gt;\n#include&lt;cmath&gt;\n#include&lt;cstring&gt;\nusing namespace std;\ntypedef complex&lt;double&gt; com;\nconst double PI = acos(-1.0);\nvoid butter(com y[], int len){\nfor(int i=1, j=len&gt;&gt;1, k; i&lt;len-1; ++i){\nif(i &lt; j) swap(y[i], y[j]);\nk = len &gt;&gt; 1;\nwhile(j &gt;= k) j -= k, k &gt;&gt;= 1;\nif(j &lt; k) j += k;\n}\n}\nvoid fft(com y[], int len, int op){\nbutter(y, len);\nfor(int n=2; n&lt;=len; n&lt;&lt;=1){\ncom wn(cos(2 * PI / n), sin(2 * PI / n * op));\nfor(int j=0; j&lt;len; j+=n){\ncom w(1, 0);\nfor(int k=j; k&lt;j+n/2; ++k){\ncom u = y[k], v = y[k + n/2] * w;\ny[k] = u + v;\ny[k + n / 2] = u - v;\nw *= wn;\n}\n}\n}\nif(~op) return ;\nfor(int i=0; i&lt;len; ++i) y[i] /= len;\n}\nconst int N = 1e5+3;\nchar a[N], b[N];\ncom A[N&lt;&lt;1], B[N&lt;&lt;1];\nint c[N&lt;&lt;1];\nint main(){\nwhile(cin &gt;&gt; a &gt;&gt; b){\nint l1 = strlen(a), l2 = strlen(b), l = 1;\nwhile(l &lt; l1 * 2 || l &lt; l2 * 2) l &lt;&lt;= 1;\nfor(int i=0; i&lt;l; ++i) A[i] = com((i &lt; l1) * (a[l1 - i - 1] - '0'), 0);\nfor(int i=0; i&lt;l; ++i) B[i] = com((i &lt; l2) * (b[l2 - i - 1] - '0'), 0);\nfft(A, l, 1), fft(B, l, 1);\nfor(int i=0; i&lt;l; ++i) A[i] *= B[i];\nfft(A, l, -1);\nfor(int i=0; i&lt;l; ++i) c[i] = A[i].real() + 0.5;\nfor(int i=0; i&lt;l; ++i) c[i + 1] += c[i] / 10, c[i] %= 10;\nl = l1 + l2 - 1;\nwhile(!c[l] &amp;&amp; l &gt; 0) -- l;\nfor(int i=l; i&gt;=0; --i) cout &lt;&lt; c[i];\ncout &lt;&lt; '\\n';\n}\n}\n</code></pre> <ul> <li>P3803 \u3010\u6a21\u677f\u3011\u591a\u9879\u5f0f\u4e58\u6cd5\uff08FFT\uff09 - \u6d1b\u8c37 | \u8ba1\u7b97\u673a\u79d1\u5b66\u6559\u80b2\u65b0\u751f\u6001 (luogu.com.cn)</li> </ul> <pre><code>int n, m;\ncom a[N&lt;&lt;2], b[N&lt;&lt;2];\nint main(){\ncin &gt;&gt; n &gt;&gt; m;\nfor(int i=0, x; i&lt;=n; ++i) cin &gt;&gt; x, a[i] = com(x, 0);\nfor(int i=0, x; i&lt;=m; ++i) cin &gt;&gt; x, b[i] = com(x, 0);\nint l = 1;\nwhile(l &lt;= n + m) l &lt;&lt;= 1;\n//    cout &lt;&lt; l &lt;&lt; '\\n';\nfft(a, l, 1), fft(b, l, 1);\nfor(int i=0; i&lt;l; ++i) a[i] *= b[i];\nfft(a, l, -1);\nfor(int i=0; i&lt;=n+m; ++i) cout &lt;&lt; int(a[i].real()+0.5) &lt;&lt; ' ';\ncout &lt;&lt; '\\n';\n}\n</code></pre>"},{"location":"oiwiki-%E6%95%B0%E5%AD%A6/%E5%A4%9A%E9%A1%B9%E5%BC%8F/#5-ntt","title":"5\uff0c\u5feb\u901f\u6570\u8bba\u53d8\u6362 NTT","text":"<p>\uff08\u53d6\u6a21\u610f\u4e49\u4e0a\u7684\u52a0\u5f3a\u7248 \\(fft\\)\uff09</p> <p></p> <ul> <li>\u79bb\u6563\u5085\u91cc\u53f6\u53d8\u6362DFT</li> </ul> <p>\u5bf9\u4e8e \\(N\\) \u70b9\u5e8f\u5217 \\(\\left\\{x[n]\\right\\}_{0\\le n &lt;N}\\)</p> <p>1\uff0c\u5b83\u7684\u79bb\u6563\u5085\u91cc\u53f6\u53d8\u6362\uff08DFT\uff09\u4e3a</p> <p>\\(\\displaystyle \\hat{x}[k]=\\sum_{j=0}^{N-1} e^{-i\\frac{2\\pi}{N}jk}x[j] \\qquad k = 0,1,\\ldots,N-1.\\)</p> <p>\u8bb0 \\(\\hat{x}=\\mathcal{F}x\\)</p> <p>2\uff0c\u9006\u79bb\u6563\u5085\u91cc\u53f6\u53d8\u6362\uff08IDFT\uff09\u4e3a\uff1a</p> <p>\\(\\displaystyle x\\left[j\\right]={1 \\over N}\\sum_{k=0}^{N-1} e^{ i\\frac{2\\pi}{N}jk}\\hat{x}[k] \\qquad j = 0,1,\\ldots,N-1.\\)</p> <p>\u8bb0 \\(x=\\mathcal{F}^{-1}\\hat{x}\\)</p> <p>3\uff0c\u6ce8\u610f\u5230 \\(\\omega_N^{-nk} = e^{-i\\frac{2\\pi}{N}nk} \\(\uff0c\\)k=0..N-1,~n=0..N-1\\)\uff0c\u5bb9\u6613\u60f3\u5230\u8fd9\u4e24\u4e2a\u53d8\u6362\u53ef\u4ee5\u7528\u77e9\u9635\u8868\u793a</p> <p>\uff08\u8bb0 \\(f_{x_k},~\\alpha,~x_j\\) \u5206\u522b\u8868\u793a\u4e0a\u8ff0\u5b9a\u4e49\u4e2d\u7684 \\(\\hat{x}[k],~\\omega_N^{-nk},~x\\left[j\\right]\\)\uff09</p> <p>\u5f97\u5230 DFT \u7684\u77e9\u9635\u5f62\u5f0f\uff1a</p> <p>\\({\\displaystyle {\\begin{bmatrix}f_{x_0}\\\\f_{x_1}\\\\\\vdots \\\\f_{x_n-1}\\end{bmatrix}}={\\begin{bmatrix}1&amp;1&amp;1&amp;\\cdots &amp;1\\\\1&amp;\\alpha &amp;\\alpha ^{2}&amp;\\cdots &amp;\\alpha ^{n-1}\\\\1&amp;\\alpha ^{2}&amp;\\alpha ^{4}&amp;\\cdots &amp;\\alpha ^{2(n-1)}\\\\\\vdots &amp;\\vdots &amp;\\vdots &amp;&amp;\\vdots \\\\1&amp;\\alpha ^{n-1}&amp;\\alpha ^{2(n-1)}&amp;\\cdots &amp;\\alpha ^{(n-1)(n-1)}\\\\\\end{bmatrix}}{\\begin{bmatrix}x_{0}\\\\x_{1}\\\\\\vdots \\\\x_{n-1}\\end{bmatrix}}.}\\)</p> <p>IDFT \u7684\u77e9\u9635\u5f62\u5f0f\uff1a</p> <p>\\({\\displaystyle {\\begin{bmatrix}x_{0}\\\\x_{1}\\\\\\vdots \\\\x_{n-1}\\end{bmatrix}} ~=~ \\frac{1}{n}\\times{\\begin{bmatrix}1^{-1}&amp;1^{-1}&amp;1^{-1}&amp;\\cdots &amp;1^{-1}\\\\1^{-1}&amp;\\alpha^{-1} &amp;(\\alpha ^{2})^{-1}&amp;\\cdots &amp;(\\alpha^{n-1})^{-1}\\\\1^{-1}&amp;(\\alpha ^{2})&amp;(\\alpha ^{4})^{-1}&amp;\\cdots &amp;(\\alpha ^{2(n-1)})^{-1}\\\\\\vdots &amp;\\vdots &amp;\\vdots &amp;&amp;\\vdots \\\\1^{-1}&amp;(\\alpha ^{n-1})^{-1}&amp;(\\alpha ^{2(n-1)})^{-1}&amp;\\cdots &amp;(\\alpha ^{(n-1)(n-1)})^{-1}\\\\\\end{bmatrix}}{\\begin{bmatrix}f_{x_0}\\\\f_{x_1}\\\\\\vdots \\\\f_{x_{n-1}}\\end{bmatrix}}.}\\)</p> <p>\uff08\u987a\u4fbf\u590d\u4e60 fft\uff09</p> <ul> <li>\u751f\u6210\u5b50\u7fa4\uff08\u7384\u5b66\uff09</li> </ul> <p></p> <ul> <li>\u539f\u6839\uff08\u7384\u5b66\uff09</li> </ul> <p></p> <ul> <li>NTT\uff08\u7384\uff0c\u4f46\u662f\u4ee3\u7801\u597d\u6572\uff01\uff01\uff09</li> </ul> <p></p> <p>\u5e38\u89c1\u7684 P \u548c g\uff1a</p> <p>\\(p = 1004535809 = 479 \\times 2^{21}+1, g=3\\)</p> <p>\\(p=998244353= 119 \\times 2^{23}+1, g=3\\)   \uff08 \\(7\\times 17=119\\)\uff09</p> <p>\\(w_{n} ~\\equiv~ g_n ~=~ g^{\\frac{P-1}{n}}\\)\uff0c\\(g_n^{-1} = (g^{\\frac{P-1}{n}})^{-1}\\)\uff08\u5373\u6a21 \\(P\\) \u7684\u9006\u5143\uff09</p> <p>\uff08\\(g\\) \u4e3a\u539f\u6839\uff0c \\(g_n\\) \u7c7b\u4f3c\u4e8e \\(fft\\) \u63d0\u5230\u7684\u5355\u4f4d\u6839\uff09</p> <pre><code>#define int long long\nconst int P = (479&lt;&lt;21) + 1;\nconst int N = (1e6+3)*4;\nint fp(int a, int n){\nint ans = 1;\nwhile(n){\nif(n &amp; 1) ans = ans * a % P;\na = a * a % P;\nn &gt;&gt;= 1;\n}\nreturn ans;\n}\nint rev[N];\nvoid ntt(int y[], int len, int op){\nfor(int i=0; i&lt;len; ++i){\nrev[i] = rev[i&gt;&gt;1]&gt;&gt;1 | (i &amp; 1) * (len &gt;&gt; 1);\nif(i &lt; rev[i]) swap(y[i], y[rev[i]]);\n}\nfor(int n=2; n&lt;=len; n&lt;&lt;=1){\nint gn = fp(3, (P - 1) / n);\n// \u9006\u53d8\u6362\u5904\u7406\u65b9\u6cd51\uff1a\nif(op == -1) gn = fp(gn, P-2);\nfor(int j=0; j&lt;len; j+=n){\nint g = 1;\nfor(int k=j; k&lt;j+n/2; ++k){\nint u = y[k], v = y[k + n/2] * g % P;\ny[k] = (u + v) % P;\ny[k + n/2] = (u - v + P) % P;\ng = g * gn % P;\n}\n}\n}\nif(~op) return ;\n//  \u9006\u53d8\u6362\u5904\u7406\u65b9\u6cd52\uff1a\n//    reverse(y + 1, y + len);\nint il = fp(len, P-2);\nfor(int i=0; i&lt;len; ++i) y[i] = y[i] * il % P;\n}\n</code></pre>"},{"location":"oiwiki-%E6%95%B0%E5%AD%A6/%E5%A4%9A%E9%A1%B9%E5%BC%8F/#6-cntt","title":"6\uff0c\u5feb\u901f\u590d\u6570\u8bba\u53d8\u6362 CNTT\uff08\u5f85\u8865\uff09","text":"<p>Number theoretic transforms to implement fast digital convolution | IEEE Journals &amp; Magazine | IEEE Xplore</p> <ul> <li>DFT \u53ef\u9006\u7684\u6761\u4ef6</li> </ul> <p></p> <ul> <li>\u6a21 \\(P\\) \u9ad8\u65af\u6574\u6570\u73af \\(Z_p[i]\\)</li> </ul> <p></p> <ul> <li>\u5e38\u7528\u6a21\u6570\u7684\u5355\u4f4d\u6839</li> </ul> <p>\\(n=2^{21}\\) \u65f6 \\(p_-=999292927=2^{20}\\times953-1\\) \u7684 \\(p_-^2-1\\) \u6b21\u5355\u4f4d\u6839 \\(\\omega=1+8\\text i\\)\uff1b</p> <p>\\(n=2^{23}\\) \u65f6 \\(p_+=998244353=2^{23}\\times119+1\\) \u7684 \\(p_+-1\\) \u6b21\u5355\u4f4d\u6839 \\(\\omega=1+\\text i\\)</p> <p>\\(n=2^{16}\\) \u65f6 \\(p_+=65537=2^{16}+1\\) \u7684 \\(p_+-1\\) \u6b21\u5355\u4f4d\u6839 \\(\\omega=4+17573\\text i\\)</p> <p></p>"},{"location":"oiwiki-%E6%95%B0%E5%AD%A6/%E5%A4%9A%E9%A1%B9%E5%BC%8F/#7","title":"7\uff0c\u5feb\u901f\u6c83\u5c14\u4ec0\u53d8\u6362\uff08\u5f85\u8865\uff09","text":"<p>\u6c83\u5c14\u4ec0\u8f6c\u6362\uff08Walsh Transform\uff09\u662f\u5728\u9891\u8c31\u5206\u6790\u4e0a\u4f5c\u4e3a\u79bb\u6563\u5085\u7acb\u53f6\u53d8\u6362\u7684\u66ff\u4ee3\u65b9\u6848\u7684\u4e00\u79cd\u65b9\u6cd5</p> <p>\u6d45\u8c08\u5feb\u901f\u6c83\u5c14\u4ec0\u53d8\u6362 - Hyscere - \u535a\u5ba2\u56ed (cnblogs.com)</p> <p>\\(fwt\\) \u53ef\u4ee5\u89e3\u51b3\u7c7b\u4f3c\u4ee5\u4e0b\u7684\u5377\u79ef</p> <p>\\(\\displaystyle C_{i} = \\sum_{i=j \\bigoplus k}A_{j} B_{k}\\) \uff0c\\(i=0..len\\) \uff08\\(\\bigoplus\\) \u8868\u793a \\(or\\) \u6216 \\(and\\) \u6216 \\(xor\\) \u6216 \\(xnor\\)\uff09</p> <p>\uff08\u800c \\(fft\\) \u89e3\u51b3\u7684\u662f\u8fd9\u6837\u7684\u5377\u79ef \\(\\displaystyle C_{i} = \\sum_{i=j ~~+~~ k}A_{j} B_{k}\\)\uff09</p> <ul> <li>\u6216\u8fd0\u7b97</li> </ul> <p>\\(\\displaystyle C_{i} = \\sum_{i=j ~or~~ k}A_{j} B_{k}\\)</p> <p>\\(fwt[A] = merge(fwt[A_0],~~fwt[A_0] + fwt[A_1])\\)</p> <p>\\(ifwt[A'] = merge(ifwt[A_0'],~~ifwt[A_1'] - ifwt[A_0'])\\)</p> <p>\uff08\\(ifwt[A'] ~=~ A\\)\uff09</p> <pre><code>void fwt_or(int y[], int len, int op){\nfor(int n=2; n&lt;=len; n&lt;&lt;=1){\nfor(int j=0; j&lt;len; j+=n){\nfor(int k=j; k&lt;j+n/2; ++k){\nint u = y[k], v = y[k + n / 2];\nif(~op) y[k + n / 2] = (u + v) % P;\nelse y[k + n / 2] = (-u + v + P) % P;\n}\n}\n}\n}\n</code></pre> <ul> <li>\u4e0e\u8fd0\u7b97</li> </ul> <p>\\(\\displaystyle C_{i} = \\sum_{i=j ~~and~~ k}A_{j} B_{k}\\)</p> <p>\\(fwt[A] = merge(fwt[A_0] + fwt[A_1], fwt[A_1])\\)</p> <p>\\(ifwt[A'] = merge(ifwt[A_0'] - ifwt[A_1'], ifwt[A_1'])\\)</p> <pre><code>void fwt_and(int y[], int len, int op){\nfor(int n=2; n&lt;=len; n&lt;&lt;=1){\nfor(int j=0; j&lt;len; j+=n){\nfor(int k=j; k&lt;j+n/2; ++k){\nint u = y[k], v = y[k + n / 2];\nif(~op) y[k] = (u + v) % P;\nelse y[k] = (u - v + P) % P;\n}\n}\n}\n}\n</code></pre> <ul> <li>\u5f02\u6216\u8fd0\u7b97</li> </ul> <p>\\(\\displaystyle C_{i} = \\sum_{i=j ~~xor~~ k}A_{j} B_{k}\\)</p> <p>\\(fwt[A] = merge(fwt[A_0] + fwt[A_1], fwt[A_0] - fwt[A_1])\\)</p> <p>\\(ifwt[A'] = merge(\\frac{ifwt[A_0'] + ifwt[A_1']}{2}, \\frac{ifwt[A_0'] - ifwt[A_1']}{2})\\)</p> <pre><code>void fwt_xor(int y[], int len, int op){\nfor(int n=2; n&lt;=len; n&lt;&lt;=1){\nfor(int j=0; j&lt;len; j+=n){\nfor(int k=j; k&lt;j+n/2; ++k){\nint u = y[k], v = y[k + n / 2];\nif(~op) y[k] = (u + v) % P, y[k + n / 2] = (u - v + P) % P;\nelse y[k] = (u + v) * i2 % P, y[k + n / 2] = (u - v + P) * i2 % P;\n}\n}\n}\n}\n</code></pre> <ul> <li>\u540c\u6216\u8fd0\u7b97</li> </ul> <p>\\(fwt[A] = merge(fwt[A_1] - fwt[A_0], fwt[A_1] + fwt[A_0])\\)</p> <p>\\(ifwt[A'] = merge(\\frac{ifwt[A_1'] - ifwt[A_0']}{2}, \\frac{ifwt[A_1'] + ifwt[A_0']}{2})\\)</p> <ul> <li>\u4f8b\u9898Problem - F - Codeforces\uff08\u7384\u5b66\u9898\uff09</li> </ul> <p><code>\"one should not give up the dream easily! Struggle, struggle until you are crushed by a rock!\"</code></p> <p>\\(\\displaystyle \\sum_{(x,y) \\in E} (x \\oplus y)^{33}x^{-2}y^{-1} \\mod 10^9+7\\)</p> <p>\u9898\u89e3\uff1aDetailed Editorial for problem \"The Struggle\" from XXII Opencup, Grand Prix of XiAn - Codeforces</p> <ul> <li>P4717 \u3010\u6a21\u677f\u3011\u5feb\u901f\u83ab\u6bd4\u4e4c\u65af/\u6c83\u5c14\u4ec0\u53d8\u6362 (FMT/fwt) - \u6d1b\u8c37 | \u8ba1\u7b97\u673a\u79d1\u5b66\u6559\u80b2\u65b0\u751f\u6001 (luogu.com.cn)</li> </ul>"},{"location":"oiwiki-%E6%95%B0%E5%AD%A6/%E5%A4%9A%E9%A1%B9%E5%BC%8F/#8chirp-z-czt","title":"8\uff0cchirp Z\u53d8\u6362 CZT\uff08\u5f85\u8865\uff09","text":"<p>P6800 \u3010\u6a21\u677f\u3011Chirp Z-Transform - \u6d1b\u8c37 | \u8ba1\u7b97\u673a\u79d1\u5b66\u6559\u80b2\u65b0\u751f\u6001 (luogu.com.cn)</p>"},{"location":"oiwiki-%E6%95%B0%E5%AD%A6/%E5%A4%9A%E9%A1%B9%E5%BC%8F1/","title":"\u591a\u9879\u5f0f1","text":""},{"location":"oiwiki-%E6%95%B0%E5%AD%A6/%E5%A4%9A%E9%A1%B9%E5%BC%8F1/#9","title":"9\uff0c\u591a\u9879\u5f0f\u6c42\u9006","text":"<p>P4238 \u3010\u6a21\u677f\u3011\u591a\u9879\u5f0f\u4e58\u6cd5\u9006 - \u6d1b\u8c37 | \u8ba1\u7b97\u673a\u79d1\u5b66\u6559\u80b2\u65b0\u751f\u6001 (luogu.com.cn)</p> <p>P5809 \u3010\u6a21\u677f\u3011\u591a\u9879\u5f0f\u590d\u5408\u9006 - \u6d1b\u8c37 | \u8ba1\u7b97\u673a\u79d1\u5b66\u6559\u80b2\u65b0\u751f\u6001 (luogu.com.cn)</p> <p>1737 -- Connected Graph (poj.org)</p>"},{"location":"oiwiki-%E6%95%B0%E5%AD%A6/%E6%95%B0%E8%AE%BA0/","title":"\u6570\u8bba0","text":""},{"location":"oiwiki-%E6%95%B0%E5%AD%A6/%E6%95%B0%E8%AE%BA0/#1","title":"1\u3001\u6574\u9664","text":"<p>\u9884\u5b9a\u4e49\uff1a\\(a,b,c\\in Z, a\\ne 0\\)</p> <p>\\(a\\mid b\\iff -a\\mid b \\iff a\\mid-b \\iff |a|\\mid|b|\\)\uff08\u6b63\u8d1f\u65e0\u5173\uff09</p> <p>\\(a\\mid b~\\land~b\\mid c\\implies a\\mid c\\)\uff08\u4f20\u9012\uff09</p> <p>\\(a\\mid b~\\land~b\\mid a \\implies b=\\pm a\\)\uff08\u81ea\u53cd\uff09</p> <p>\\(a\\mid b~\\land~a\\mid c\\iff \\forall x,y\\in Z, a\\mid(x\\times b+y\\times c)\\)</p> <p>\u5176\u4ed6\uff1a</p> <p>\\(a\\mid b\\iff m\\times a\\mid m\\times b\\)\uff08\u8865\u5145\uff1a\u7b26\u53f7\\(\u201c|\u201d\\)\u7684\u5de6\u8fb9\u5fc5\u7136\u4e0d\u4e3a0\uff0c\u8fd9\u662f\u5e38\u8bc6\uff09</p> <p>\\(b\\ne 0,a\\mid b \\implies |a|\\le|b|\\)</p> <p>\\(b=a\\times q + r, a\\mid b \\iff a\\mid c\\)</p>"},{"location":"oiwiki-%E6%95%B0%E5%AD%A6/%E6%95%B0%E8%AE%BA0/#2","title":"2\u3001\u540c\u4f59","text":"<ul> <li>\u7ebf\u6027\u8fd0\u7b97 \\(a\u3001b\u3001c\u3001d\\in Z\uff0cm\\in N^*\uff0ca\\equiv b(mod~m)\uff0cc\\equiv d(mod~m)\uff0c\u5219\u6709\uff1a\\)</li> </ul> <p>\\(a\\pm c\\equiv b\\pm d(mod~m)\\)</p> <p>$a\\times c\\equiv b\\times d(mod~m) $</p> <ul> <li> <p>\\(a\u3001b\\in Z\uff0cm\u3001k\\in N^*\uff0ca\\equiv b(mod~m) \\implies k\\times a\\equiv k\\times b(mod~k\\times m)\\)</p> </li> <li> <p>\\(a\u3001b\\in Z\uff0cm\u3001d\\in N^*\uff0ca\\equiv b(mod~~m)\uff0cd\\mid a\uff0cd\\mid b\uff0cd\\mid m \\implies \\frac{a}{d}\\equiv \\frac{b}{d}(mod~~\\frac{m}{d})\\)</p> </li> <li> <p>\\(a\u3001b\\in Z\uff0cm\u3001d\\in N^*\uff0ca\\equiv b(mod~~m)\uff0cd\\mid m \\implies a\\equiv b(mod~~d)\uff0c\\)</p> </li> <li> <p>\\(a\u3001b\\in Z\uff0cm\u3001d\\in N^*\uff0ca\\equiv b(mod~~m) \\implies (a, m) = (b, m)\\)</p> </li> <li> <p>\\(a\u3001b\\in Z\uff0cm\u3001d\\in N^*\uff0ca\\equiv b(mod~~m)\uff0cd |m\uff0cd|a(\u6216b) \\implies d|b(\u6216a)\\)</p> </li> </ul>"},{"location":"oiwiki-%E6%95%B0%E5%AD%A6/%E6%95%B0%E8%AE%BA0/#3cc","title":"3\u3001c\\c++\u7684\u6574\u6570\u9664\u6cd5 \u4e0e \u53d6\u6a21","text":"<ul> <li> <p>\\(a = a / b * b + a \\% b\uff0cb\\ne 0\\)</p> </li> <li> <p>\\(c99\uff0cc++11\u5f00\u59cb\uff0c\u89c4\u5b9a\u9664\u6cd5\u5411\u4e0b\u53d6\u6574\uff0c\u53d6\u6a21\u7684\u7b26\u53f7\u4e0e\u88ab\u9664\u6570\u76f8\u540c\\)</p> </li> </ul> <p>(e.g.\uff1a5 % 3 == 2\uff0c5 % -3 == 2\uff0c-5 % 3 == -2\uff0c-5 % -3 == -2  \u5747\u4e3a true)</p>"},{"location":"oiwiki-%E6%95%B0%E5%AD%A6/%E6%95%B0%E8%AE%BA0/#4","title":"4\u3001\u79ef\u6027\u51fd\u6570","text":"<ul> <li>\\(f_x\uff0cg_x\u5747\u4e3a\u79ef\u6027\u51fd\u6570\uff0c\u5219\u4ee5\u4e0b\u51fd\u6570\u5747\u4e3a\u79ef\u6027\u51fd\u6570\\)</li> </ul> \\[ f_{x^p}\u3001(f_x)^p\u3001f_x\\times g_x\u3001\\sum_{d|x}f_d\\times g_{\\frac{x}{d}} \\] <ul> <li> <p>\\(f_x\u4e3a\u79ef\u6027\u51fd\u6570 \\implies f_x = f_{\\prod\\limits_{i=1}^{k}p_i^{a_i}} =  \\prod\\limits_{i=1}^{k}f_{p_i^{a_i}}\\)</p> </li> <li> <p>\\(f_x\u4e3a\u5b8c\u5168\u79ef\u6027\u51fd\u6570 \\implies f_x = f_{\\prod\\limits_{i=1}^{k}p_i^{a_i}} = \\prod\\limits_{i=1}^{k}(f_{p_i})^{a_i}\\)</p> </li> <li> <p>\u5b8c\u5168\u79ef\u6027\u51fd\u6570</p> </li> </ul> <p>\\(\u5355\u4f4d\u51fd\u6570\uff1a\\varepsilon_x = [x = 1]\\\\ \u6052\u7b49\u51fd\u6570\uff1a\\operatorname{id}_k(x)=x^k\\\\ \u5e38\u6570\u51fd\u6570\uff1a\\operatorname{1}_x=1\\)</p> <ul> <li>\u79ef\u6027\u51fd\u6570</li> </ul> <p>$\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u9664\u6570\u51fd\u6570\uff1a\\sigma_k(x)=\\sum\\limits_{d|x}d^k\\~~\u8bb0~d_x\u6216\\tau_x = \\sigma_0(x)\\~~~~\u8bb0\\sigma_x = \\sigma_1(x)\\~~\u6b27\u62c9\u51fd\u6570\uff1a\\phi_x = \\sum\\limits_{i=1}^{x}[(i,x)=1]\\$</p> <p>$\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u83ab\u6bd4\u4e4c\u65af\u51fd\u6570\uff1a\\mu_x = \\begin{cases} 1 &amp; x=1\\ 0 &amp; \\exists d&gt;1,d^2\\mid x \\ (-1)^{\\omega_x} &amp; \\text{otherwise}\\end{cases}$</p> <p>\\(\uff08\u5176\u4e2d\\omega_x\u4e3ax\u7684\u672c\u8d28\u4e0d\u540c\u7684\u8d28\u56e0\u5b50\u4e2a\u6570\uff0c\u4e3a\u52a0\u6027\u51fd\u6570\uff09\\)</p>"},{"location":"oiwiki-%E6%95%B0%E5%AD%A6/%E6%95%B0%E8%AE%BA1/","title":"\u6570\u8bba1","text":"<p>\\(\u975e\u96f6\u6574\u6570a \\times \u6574\u6570b = a\u7684\u500d\u6570\\)</p>"},{"location":"oiwiki-%E6%95%B0%E5%AD%A6/%E6%95%B0%E8%AE%BA1/#1","title":"1\u3001\u6574\u9664","text":""},{"location":"oiwiki-%E6%95%B0%E5%AD%A6/%E6%95%B0%E8%AE%BA1/#2","title":"2\u3001\u663e\u7136\u7ea6\u6570/\u56e0\u5b50","text":""},{"location":"oiwiki-%E6%95%B0%E5%AD%A6/%E6%95%B0%E8%AE%BA1/#3","title":"3\u3001\"\u4f2a\u56e0\u5b50\"","text":"<p>\u5982\u679c\\(a\\mid b\\)\uff0c\u5fc5\u6709 \\(\\frac{b}{a}\\mid b\\)\uff0c\u6211\u81ea\u79f0 \\(\\frac{b}{a}\\) \u4e3a\u4f2a\u56e0\u5b50\uff1b\u4f2a\u56e0\u5b50\u4e3a\u6574\u6570\uff08\u53ef\u4ee5\u53d60\uff09</p>"},{"location":"oiwiki-%E6%95%B0%E5%AD%A6/%E6%95%B0%E8%AE%BA1/#4","title":"4\u3001\u4f59\u6570\u3001\u5e26\u4f59\u6570\u9664\u6cd5&amp;&amp;\u3001\u7edd\u5bf9\u6700\u5c0f\u4f59\u6570\u3001\u6700\u5c0f\u6b63\u4f59\u6570","text":""},{"location":"oiwiki-%E6%95%B0%E5%AD%A6/%E6%95%B0%E8%AE%BA1/#5gcdlcm","title":"5\u3001\u6700\u5927\u516c\u7ea6\u6570gcd\uff0c\u6700\u5c0f\u516c\u500d\u6570lcm\u3001\u6269\u5c55\u6b27\u51e0\u91cc\u5f97","text":"<pre><code>// \u6b27\u51e0\u91cc\u5f97\u7b97\u6cd5\nint gcd(int a, int b){\nreturn !b ? a : gcd(b, a % b);\n}\n</code></pre> <pre><code>int lcm(int a, int b){\nreturn a / gcd(a, b) * b;\n}\n</code></pre> <p>\\(a\\times x + b\\times y = (a, b)\\\\ b\\times x_1 + (a\\%b)\\times y_1=(b,a\\%b)\\\\ (a,b) = (b, a\\%b)\\\\ \\implies a\\times x + b\\times y = b\\times x_1 + (a\\%b)\\times y_1\\\\\u53c8a\\%b=a-\\lfloor\\frac{a}{b}\\rfloor\\times b\\\\ \\implies a\\times x + b\\times y = b\\times x_1 + (a-\\lfloor\\frac{a}{b}\\rfloor\\times b)\\times y_1 = a\\times y_1 + b\\times (x_1- \\lfloor\\frac{a}{b}\\rfloor\\times y_1 )\\)</p> <p>$\u6240\u4ee5\uff0cx = y_1, y = x_1 - \\lfloor\\frac{a}{b}\\rfloor \\times y_1 $</p> <p>\\(\u6700\u540e\uff0c\u518d\u8003\u8651\u8fb9\u754c\u60c5\u51b5b=0\uff0c\u5219a \\times x + 0 \\times y = (a, 0) = a \\\\ \\implies x = 1, y = 0, (a, 0) = a\\)</p> <pre><code>// \u9012\u5f52\u7248\nint exgcd(int a, int b, int &amp;x, int &amp;y){\nif(!b){\nx = 1, y = 0;\nreturn a;\n}\nint d = exgcd(b, a % b, x, y);\nint x1 = x, y1 = y;\nx = y1;\ny = x1 - a / b * y1;\nreturn d;\n}\n// \u8fed\u4ee3\u7248\nint exgcd(int a, int b, int&amp; x, int&amp; y) {\nx = 1, y = 0;\nint x1 = 0, y1 = 1, a1 = a, b1 = b;\nwhile (b1) {\nint q = a1 / b1;\ntie(x, x1) = make_tuple(x1, x - q * x1);\ntie(y, y1) = make_tuple(y1, y - q * y1);\ntie(a1, b1) = make_tuple(b1, a1 - q * b1);\n}\nreturn a1;\n}\n// \u77e9\u9635\u7248\nint exgcd(int a, int b, int &amp;x, int &amp;y) {\nint x1 = 1, x2 = 0, x3 = 0, x4 = 1;\nwhile (b != 0) {\nint c = a / b;\nstd::tie(x1, x2, x3, x4, a, b) =\nstd::make_tuple(x3, x4, x1 - x3 * c, x2 - x4 * c, b, a - b * c);\n}\nx = x1, y = x2;\nreturn a;\n}\n</code></pre> <p>\u8865\u5145\uff1a</p> <ul> <li>\u4f8b\u9898</li> </ul> <p>Online Judge</p> <p>Attachments - 2007-2008 Summer Petrozavodsk Camp, Japanese Contest, 2007-08-29 - Codeforces</p> <p>Online Judge</p>"},{"location":"oiwiki-%E6%95%B0%E5%AD%A6/%E6%95%B0%E8%AE%BA1/#6","title":"6\u3001\u4e92\u7d20","text":""},{"location":"oiwiki-%E6%95%B0%E5%AD%A6/%E6%95%B0%E8%AE%BA1/#7","title":"7\u3001\u88f4\u8700\u5b9a\u7406","text":"<p>\u8bc1\u660e</p> <p>\u4f8b\u9898\uff1aCodeforces Round #290 (Div. 2) D. Fox And Jumping</p> <ul> <li> <p></p> </li> <li> <p></p> </li> <li> <p></p> </li> </ul>"},{"location":"oiwiki-%E6%95%B0%E5%AD%A6/%E6%95%B0%E8%AE%BA1/#8euclid-5","title":"8\u3001\u8f97\u8f6c\u76f8\u9664\u6cd5Euclid\u7b97\u6cd5\uff08\u89c1 5\u3001\u6700\u5927\u516c\u7ea6\u6570\uff09","text":""},{"location":"oiwiki-%E6%95%B0%E5%AD%A6/%E6%95%B0%E8%AE%BA1/#9","title":"9\u3001\u7d20\u6570\u3001\u5408\u6570\u3001\u8d28\u56e0\u5b50\uff08\u7d20\u56e0\u6570/\u7d20\u7ea6\u6570\uff09","text":"<p>\u6027\u8d28\uff1a</p> <p></p>"},{"location":"oiwiki-%E6%95%B0%E5%AD%A6/%E6%95%B0%E8%AE%BA1/#10","title":"10\u3001\u7b97\u672f\u57fa\u672c\u5f15\u7406\u3001\u7b97\u6570\u57fa\u672c\u5b9a\u7406\u3001\u6807\u51c6\u7d20\u56e0\u6570\u5206\u89e3\u5f0f","text":"<p>\u8865\u5145\uff1a</p> <ul> <li> <p></p> </li> <li> <p></p> </li> </ul> <p></p>"},{"location":"oiwiki-%E6%95%B0%E5%AD%A6/%E6%95%B0%E8%AE%BA1/#11","title":"11\u3001\u540c\u4f59\u3001\u6a21\u6570","text":"<p>\u65e0\u8111\u6027\u8d28\uff1a</p> <p></p>"},{"location":"oiwiki-%E6%95%B0%E5%AD%A6/%E6%95%B0%E8%AE%BA1/#12-extends-11","title":"12\u3001\u4e58\u6cd5\u9006\u5143 extends (11)","text":"<ul> <li>\u6b27\u51e0\u91cc\u5f97\u6c42\u9006\u5143</li> </ul> <pre><code>// (a, p) = 1\u65f6\u6210\u7acb  \uff08\u4ee3\u7801\u8bc1b\u6307\u7684\u662fp\uff09\nvoid exgcd(int a, int b, int &amp;x, int &amp;y){\nif(!b){\nx = 1, y = 0;\nreturn ;\n}\nexgcd(b, a % b, x, y);\ny -= a / b * x;\n}\n// \u6ce8\u610f\uff1a\u7ecf\u8fc7\u8ba1\u7b97\u540ex\u4e0d\u4e00\u5b9a\u662f\u9006\u5143\uff0c\u9700\u8981 x = (x % p + p) % p \u5904\u7406\n</code></pre> <ul> <li>\u5feb\u901f\u5e42\u6c42\u9006\u5143</li> </ul> <pre><code>// p \u4e3a\u8d28\u6570\u65f6\u6210\u7acb\nconst int p = 1e9+7;\nint fp(long long a, int n){\nint ans = 1;\na = (a % p + p) % p;\nwhile(n){\nif(n &amp; 1) ans = ans * a % p;\na = a * a % p;\nn &gt;&gt;= 1;\n}\nreturn ans;\n}\n</code></pre> <ul> <li>\u7ebf\u6027\u6c42\u9006\u5143</li> </ul> <p>$\u5176\u6b21\uff0c\\lfloor\\frac{p}{x}\\rfloor \\times x + p\\%x = p \\ \\implies \\lfloor\\frac{p}{x}\\rfloor \\times x + p\\%x \\equiv 0(mod~p) \\ \\implies \\lfloor\\frac{p}{x}\\rfloor \\times (p\\%x)^{-1} + x^{-1} \\equiv 0(mod~p) \\ \\implies x^{-1} \\equiv -\\lfloor\\frac{p}{x}\\rfloor \\times (p\\%x)^{-1}(mod~p) $</p> <p></p> <pre><code>const int N = 1e5+3, p = 1e9+7;\nint inv[N];\nint n;\nvoid f(){\ninv[1] = 1;\n// (p - p / i) \u662f\u4e3a\u4e86\u9632\u6b62\u51fa\u73b0\u8d1f\u6570\nfor(int i=2; i&lt;=n; i++) inv[i] = (p - p / i) * inv[p % i] % p;\n}\n// \u6269\u5c55\uff1a\u9012\u5f52\u6c42\u9006\u5143\n// O(n^(1/3))\nconst int p = 1e9+7;\nint inv(int x){\nreturn x == 1 ? 1 : (p - p / x) * inv(p % x) % p;\n}\n// \u54c8\u5e0c\u8868\u4f18\u5316\nconst int p = 1e9+7;\nunordered_map&lt;int, int&gt; h;\nint inv(int x){\nif(h.count(x)) return h[x];\nreturn x == 1 ? 1 : (p - p / x) * (h[x] = inv(p % x)) % p;\n}\n</code></pre> <ul> <li>\u7ebf\u6027\u6c42\u4efb\u610fn\u4e2a\u6570\u7684\u9006\u5143</li> </ul> <p></p> <p>\\(S_i = S_{i-1} \\times a_i \\\\ SV_{i} = SV_{i+1} \\times a_{i+1} \\\\ av_{i} = SV_{i} \\times S_{i-1}\\)</p> <pre><code>const int N = 1e5+3;\nint n;\n// s\u4e3a\u524d\u7f00\u79ef\uff0csv\u4e3a\u524d\u7f00\u79ef\u7684\u9006\u5143\nint s[N], sv[N];\n// a\u4e3a\u6570\u5217\uff0cav\u4e3a\u6570\u5217\u7684\u9006\u5143\nint a[N], av[N];\nvoid f(){\ns[0] = 1;\nfor(int i=1; i&lt;=n; i++) s[i] = s[i-1] * a[i] % p;\nsv[n] = inv(s[n]);\nfor(int i=n-1; i&gt;=1; i--) sv[i] = sv[i+1] * a[i+1] % p;\nfor(int i=1; i&lt;=n; i++) av[i] = sv[i] * s[i-1] % p;\n}\n</code></pre> <p>#110. \u4e58\u6cd5\u9006\u5143 - \u9898\u76ee - LibreOJ (loj.ac)</p> <p>#161. \u4e58\u6cd5\u9006\u5143 2 - \u9898\u76ee - LibreOJ (loj.ac)</p> <p>#2605. \u300cNOIP2012\u300d\u540c\u4f59\u65b9\u7a0b - \u9898\u76ee - LibreOJ (loj.ac)</p> <p>P2054 [AHOI2005] \u6d17\u724c - \u6d1b\u8c37 \uff08\u9012\u63a8\u5173\u7cfb\u5f88\u96be\u60f3\uff1b\\((2^n)^{-1} = (2^{-1})^n\\)\uff09</p> <p>#2034. \u300cSDOI2016\u300d\u6392\u5217\u8ba1\u6570 - \u9898\u76ee - LibreOJ (loj.ac)</p>"},{"location":"oiwiki-%E6%95%B0%E5%AD%A6/%E6%95%B0%E8%AE%BA1/#13","title":"13\u3001\u6570\u8bba\u51fd\u6570","text":""},{"location":"oiwiki-%E6%95%B0%E5%AD%A6/%E6%95%B0%E8%AE%BA1/#14","title":"14\u3001\u79ef\u6027\u51fd\u6570","text":""},{"location":"oiwiki-%E6%95%B0%E5%AD%A6/%E6%95%B0%E8%AE%BA1/#15","title":"15\u3001\u4e22\u756a\u56fe\u65b9\u7a0b\uff08\u8865\uff09","text":""},{"location":"oiwiki-%E6%95%B0%E5%AD%A6/%E6%95%B0%E8%AE%BA1/#16","title":"16\u3001\u9519\u6392\u516c\u5f0f","text":"<pre><code>const int N = 1e5+3, p = 1e9+7;\nint f[N];\nvoid func(){\nf[0] = f[2] = 1;\nfor(int i=3; i&lt;N; i++) f[i] = (f[i-1] + f[i-2]) * (i - 1) % p;\n}\n</code></pre>"},{"location":"oiwiki-%E6%95%B0%E5%AD%A6/%E6%95%B0%E8%AE%BA1/#17-extends9","title":"17\u3001\u7d20\u6027\u5224\u5b9a\u3001\u53cd\u7d20\u6570\u00a0\u00a0\u00a0\u00a0 extends\uff089\uff09","text":"<ul> <li>\u66b4\u529b\u5224\u5b9a</li> </ul> <pre><code>bool isPrime(int n){\nif(n &lt; 2) return false;\nfor(int i=2; i&lt;=n/i; i++)\nif(n % i == 0) return false;\nreturn true;\n}\n</code></pre> <ul> <li>\u7d20\u6027\u6d4b\u8bd5</li> </ul> <ul> <li> <ul> <li>Fermat\u7d20\u6027\u6d4b\u8bd5</li> </ul> </li> </ul> <pre><code>#include&lt;ctime&gt;\nint TEST_NUM = 8;\nbool millerRabin(int n){\nif(n &lt; 3) return n == 2;\nfor(int i=1; i&lt;= TEST_NUM; ++i){\nint a = rand() % (n - 2) + 2;\nif(fp(a, n-1, n) != 1) return false;\n}\nreturn true;\n}\n</code></pre> <ul> <li> <ul> <li> <ul> <li>\u5361\u8fc8\u514b\u5c14\u6570</li> </ul> </li> </ul> <p>https://oeis.org/A006931</p> </li> <li> <ul> <li>Miller-Rabin\u7d20\u6027\u6d4b\u8bd5</li> </ul> <p></p> <p></p> </li> <li> <ul> <li> <ul> <li>\u4e8c\u6b21\u63a2\u6d4b\u5b9a\u7406</li> </ul> </li> </ul> </li> </ul> <p></p> <ul> <li> <ul> <li> <ul> <li>\u5b9e\u73b0</li> </ul> </li> </ul> </li> </ul> <p></p> <pre><code>#include&lt;ctime&gt;\nint TEST_NUM = 8;\nbool millerRabin(int n){\nif(n &lt; 3 || n % 2 == 0) return n == 2;\nint a = n - 1, b = 0;\nwhile(a % 2 == 0) a &gt;&gt;= 1, ++ b;\nfor(int _=0, i; _&lt;TEST_NUM; _++){\nint r = rand() % (n - 2) + 2, v = fp(r, a, n);\nif(v == 1) continue;\nfor(i=0; i&lt;b; i++){\nif(v == n-1) break;\nv = 1ll * v * v % n;\n}\nif(i &gt;= b) return false;\n}\nreturn true;\n}\n</code></pre> <pre><code>  ____\n</code></pre> <ul> <li>\u53cd\u7d20\u6570</li> </ul> <p></p> <p></p> <p></p> <p></p> <ul> <li> <ul> <li>\u6c42\u56e0\u5b50\u6570\u4e3an\u7684\u53cd\u8d28\u6570\uff08\u5373\u6c42\u56e0\u5b50\u6570\u4e3an\uff0c\u6700\u5c0f\u5316\u4e58\u79efprod\uff09</li> </ul> </li> </ul> <pre><code>#define int unsigned long long\nint p[16] = {\n2, 3, 5, 7, 11,\n13, 17, 19, 23, 29,\n31, 37, 41, 43, 47, 53\n};\nint n, ans_prod = ~0ull;\nvoid dfs(int pre = 63, int u = 0, int prod = 1, int num = 1){\n// \u51fa\u53e3\nif(u &gt;= 16) return ;\n// \u526a\u679d\nif(prod &gt; ans_prod || num &gt; n) return ;\n// \u66f4\u65b0\u7b54\u6848\nif(prod &lt; ans_prod &amp;&amp; num == n){\nans_prod = prod;\nreturn ;        // \u5c0f\u526a\u679d\n}\n// \u6269\u5c55\u679d\u53f6\nfor(int i=1; i&lt;=pre; i++)\ndfs(i, u + 1, prod *= p[u], num * (i + 1));\n}\n</code></pre> <ul> <li> <ul> <li>\u6c421..n\u4ee5\u5185\u6700\u5927\u7684\u53cd\u8d28\u6570\uff08\u5373\u56e0\u5b50\u6570num\u6700\u5927\u5316\uff0c\u4e58\u79efprod\u6700\u5c0f\u5316\uff09</li> </ul> </li> </ul> <pre><code>#define int unsigned long long\nint p[16] = {\n2, 3, 5, 7, 11,\n13, 17, 19, 23, 29,\n31, 37, 41, 43, 47, 53\n};\nint n, ans_prod, ans_num;\nvoid dfs(int pre = 63, int u = 0, int prod = 1, int num = 1){\nif(u &gt;= 16) return ;\nif(prod &gt; n) return ;\n// \u56e0\u5b50\u6570\u6700\u5927\u5316\uff0c\u4e58\u79ef\u6700\u5c0f\u5316 \nif(ans_num &lt; num){\nans_num = num;\nans_prod = prod;\n}else if(ans_num == num &amp;&amp; ans_prod &gt; prod){\nans_prod = prod;\n}\nfor(int i=1; i&lt;=pre; i++)\ndfs(i, u + 1, prod *= p[u], num * (i + 1));\n}\n</code></pre> <ul> <li>\u4f8b\u9898</li> </ul> <p>Problem - 27E - Codeforces</p> <p>ZOJ (pintia.cn)-More Divisors</p>"},{"location":"oiwiki-%E6%95%B0%E5%AD%A6/%E6%95%B0%E8%AE%BA1/#18","title":"18\u3001\u7b5b\u6cd5","text":"<ul> <li> <p>\u7b5b\u7d20\u6570</p> </li> <li> <ul> <li>\u57c3\u62c9\u6258\u65af\u7279\u5c3c\u7b5b\u6cd5Eratosthenes</li> </ul> </li> <li> <ul> <li>\u6734\u7d20\u7248\\(O(n\\times loglog~n)\\)\u3001\u7b5b\u81f3\u5e73\u65b9\u6839\\(O(n \\times lnln\\sqrt{n}+n)\\)</li> </ul> </li> </ul> <pre><code>const int N = 1e5+3;\nbool np[N];\nint p[N], idx;\n// \u6734\u7d20\u7248\nvoid f(int n){\nnp[0] = np[1] = true;\nfor(int i=2; i&lt;=n; ++i){\nif(!np[i]){\np[++ idx] = i;\n// \u5199\u6cd51\nif(1ll * i * i &lt;= n) for(int j=i*i; j&lt;=n; j+=i) np[j] = true;\n// \u5199\u6cd52 \uff08\u679a\u4e3e\u201c\u4f2a\u56e0\u5b50\u201d\uff09\nfor(int j=i; j&lt;=n/i; ++j) np[j * i] = true; }\n}\n}\n// \u7b5b\u81f3\u5e73\u65b9\u6839\nvoid f(int n){\nnp[0] = np[1] = true;\nfor(int i=2; i&lt;=n/i; ++i)\nif(!np[i]){\n//             for(int j=i*i; j&lt;=n; j+=i) np[j] = true;\nfor(int j=i; j&lt;=n/i; ++j) np[j * i] = true;\n}\n}\n</code></pre> <pre><code>____\n</code></pre> <ul> <li> <ul> <li>\u5206\u5757\u7b5b\u9009\uff08\u7b5b\u6cd5 - OI Wiki (oi-wiki.org)\uff0c\u4e0d\u60f3\u770b\uff09</li> </ul> </li> </ul> <pre><code>int count_primes(int n) {\nconst int S = 10000;\nvector&lt;int&gt; primes;\nint nsqrt = sqrt(n);\nvector&lt;char&gt; is_prime(nsqrt + 1, true);\nfor (int i = 2; i &lt;= nsqrt; i++) {\nif (is_prime[i]) {\nprimes.push_back(i);\nfor (int j = i * i; j &lt;= nsqrt; j += i) is_prime[j] = false;\n}\n}\nint result = 0;\nvector&lt;char&gt; block(S);\nfor (int k = 0; k * S &lt;= n; k++) {\nfill(block.begin(), block.end(), true);\nint start = k * S;\nfor (int p : primes) {\nint start_idx = (start + p - 1) / p;\nint j = max(start_idx, p) * p - start;\nfor (; j &lt; S; j += p) block[j] = false;\n}\nif (k == 0) block[0] = block[1] = false;\nfor (int i = 0; i &lt; S &amp;&amp; start + i &lt;= n; i++) {\nif (block[i]) result++;\n}\n}\nreturn result;\n}\n</code></pre> <ul> <li> <ul> <li>\u7ebf\u6027\u7b5b\u6cd5</li> </ul> </li> </ul> <pre><code>const int N = 1e8+3;\nbool np[N];\nint p[N], idx;\nint gp(int n){\nnp[0] = np[1] = true;\nfor(int i=2; i&lt;=n; ++i){\nif(!np[i]) p[++ idx] = i;\nfor(int j=1; p[j]&lt;=n/i; ++j){\nnp[i * p[j]] = true;\nif(!(i % p[j])) break;\n// i % p[j] == 0\n// \u6362\u8a00\u4e4b\uff0ci \u4e4b\u524d\u88ab p[j] \u7b5b\u8fc7\u4e86\n// \u7531\u4e8e p[] \u91cc\u9762\u8d28\u6570\u662f\u4ece\u5c0f\u5230\u5927\u7684\uff0c\u6240\u4ee5 i \u4e58\u4e0a\u5176\u4ed6\u7684\u8d28\u6570\u7684\u7ed3\u679c\u4e00\u5b9a\u4e5f\u662f\n// p[j] \u7684\u500d\u6570 \u5b83\u4eec\u90fd\u88ab\u7b5b\u8fc7\u4e86\uff0c\u5c31\u4e0d\u9700\u8981\u518d\u7b5b\u4e86\uff0c\u6240\u4ee5\u8fd9\u91cc\u76f4\u63a5 break\n// \u6389\u5c31\u597d\u4e86\n}\n}\nreturn idx;\n}\n</code></pre> <ul> <li>\u7b5b\u79ef\u6027\u51fd\u6570</li> </ul> <p></p> <p></p> <p>\u4e3b\u8981\u67094\u4e2a\u6761\u4ef6\uff1a\\(f_1\u3001f_p\u3001f_{i\\times p_j}\uff08p_j \\nmid i \u6216(i,p_j)=1\uff09\u3001f_{i\\times p_j}\uff08p_j \\mid i\uff09\\)</p> <p>\u5176\u4e2d\u5df2\u77e5\uff1a$f_1 = 1, \u3001f_{i\\times p_j}\uff08p_j \\nmid i \u6216(i,p_j)=1\uff09=f_i\\times f_{p_j} $</p> <p>\u6240\u4ee5\uff0c\u53ea\u9700\u8981\u6c42\uff1a\\(f_p\u3001f_{i\\times p_j}\uff08p_j \\mid i\uff09\\)</p> <ul> <li>\u7b5b\u6b27\u62c9\u51fd\u6570\\(\\phi_n\\)</li> </ul> <p>1\uff0cp\uff1a\\(\\phi_p~=~p-1\\)</p> <p>2\uff0c$i \\% p_j == 0 \\implies i \\times p_j\u4e0e i \u62e5\u6709\u5171\u540c\u7684\u8d28\u56e0\u5b50\u96c6\u5408 \\ \\implies \\phi_{i\\times p_j} = i \\times p_j \\times \\prod\\limits_{t=1}^{s}\\frac{p_t-1}{p_t} = i \\times \\prod\\limits_{t=1}^{s}\\frac{p_t-1}{p_t}\\times p_j = \\phi_i \\times p_j  $</p> <p>3\uff0c$i \\% p_j != 0 \\implies (i, p_j)==1 \\implies \\phi_{i\\times p_j} = \\phi_i \\times \\phi_{p_j} $</p> <pre><code>const int N = 5e6+3;\nbool np[N];\nint p[N], idx;\nint phi[N];\nvoid pre(int n){\nphi[1] = 1;\nfor(int i = 2; i &lt;= n; ++ i){\nif(!np[i]) p[++ idx] = i, phi[i] = i - 1;\nfor(int j = 1; p[j] &lt;= n/i; ++ j){\nnp[i * p[j]] = true;\nphi[i * p[j]] = i % p[j] ? phi[i] * phi[p[j]] : phi[i] * p[j];\nif(!(i % p[j])) break;\n}\n}\n}\n</code></pre> <ul> <li> <ul> <li>\u7b5b\u83ab\u6bd4\u4e4c\u65af\u51fd\u6570\\(\\mu_n\\)</li> </ul> </li> </ul> <pre><code>const int N = 5e6+3;\nbool np[N];\nint p[N], idx;\nint mu[N];\nvoid pre(int n){\nmu[1] = 1;\nfor(int i = 2; i &lt;= n; ++ i){\nif(!np[i]) p[++ idx] = i, mu[i] = -1;\nfor(int j = 1; p[j] &lt;= n/i; ++ j){\nnp[i * p[j]] = true;\nmu[i * p[j]] = i % p[j] ? mu[i] * mu[p[j]] : 0;\nif(!(i % p[j])) break;\n}\n}\n}\n</code></pre> <ul> <li> <ul> <li>\u7b5b\u7ea6\u6570\u4e2a\u6570\\(d_n\\)</li> </ul> </li> </ul> <p></p> <p></p> <pre><code>const int N = 5e6+3;\nbool np[N];\nint p[N], idx;\nint num[N], d[N];\nvoid pre(int n){\nnum[1] = d[1] = 1;\nfor(int i = 2; i &lt;= n; ++ i){\nif(!np[i]) p[++ idx] = i, num[i] = 1, d[i] = 2;\nfor(int j = 1; p[j] &lt;= n/i; ++ j){\nnp[i * p[j]] = true;\nint n = i * p[j];\nnum[n] = i % p[j] ? num[i] * num[p[j]] : num[i] + 1; // num[n] = i % p[j] ? 1 : num[i] + 1;\nd[n] = i % p[j] ? d[i] * d[p[j]] : d[i] / num[n] * (num[n] + 1);\n// d[n] = i % p[j] ? d[i] * 2 : d[i] / num[n] * (num[n] + 1); \nif(!(i % p[j])) break;\n}\n}\nfor(int i=1; i&lt;=10; i++) cout &lt;&lt; num[i] &lt;&lt; ' ' &lt;&lt; d[i] &lt;&lt; '\\n';\n}\n</code></pre> <ul> <li> <ul> <li> <p>\u7b5b\u7ea6\u6570\u548c\\(f_n\\)</p> <p></p> </li> </ul> </li> </ul> <pre><code>const int N = 5e6+3;\nbool np[N];\nint p[N], idx;\nint g[N], f[N];\nvoid pre(int n){\ng[1] = f[1] = 1;\nfor(int i = 2; i &lt;= n; ++ i){\nif(!np[i]) p[++ idx] = i, g[i] = i + 1, f[i] = i + 1;\nfor(int j = 1; p[j] &lt;= n/i; ++ j){\nnp[i * p[j]] = true; int n = i * p[j];\ng[n] = i % p[j] ? g[i] * g[p[j]] : g[i] * p[j] + 1;\n// g[n] = i % p[j] ? 1 + p[j] : g[i] * p[j] + 1;\nf[n] = i % p[j] ? f[i] * f[p[j]] : f[i] / g[i] * g[n]; if(!(i % p[j])) break;\n}\n}\n}\n</code></pre>"},{"location":"oiwiki-%E6%95%B0%E5%AD%A6/%E6%95%B0%E8%AE%BA1/#19","title":"19\u3001\u6570\u8bba\u5206\u5757","text":"<ul> <li>\u5f15\u7406</li> </ul> <ul> <li>\u4e00\u7ef4\u6570\u8bba\u5206\u5757</li> </ul> <pre><code>const int N = 5e6+3;\nint n;\nint f[N], s[N]; int block(){\n// \u5148\u6c42 f[] \u7684\u524d\u7f00\u548c s[] \nint ans = 0;\nfor(int lb = 1, ub; lb &lt;= n; lb = ub + 1){\nub = n / (n / lb); ans += (s[ub] - s[lb - 1]) * (n / lb);\n}\nreturn ans;\n}\n</code></pre> <ul> <li>\u591a\u7ef4\u6570\u8bba\u5206\u5757</li> </ul> <ul> <li> <p>\u4f8b\u9898</p> <p>P2261 [CQOI2007]\u4f59\u6570\u6c42\u548c </p> </li> </ul> <pre><code>#include&lt;iostream&gt;\nusing namespace std; #define int long long\nint s1(int n){\nreturn n * (n + 1) / 2;\n} signed main(){\nint n, k;\ncin &gt;&gt; n &gt;&gt; k; int ans = n * k;\nfor(int lb = 1, ub; lb &lt;= n; lb = ub + 1){\nif(lb &lt;= k) ub = min(k / (k / lb), n);\nelse ub = n; ans -= (s1(ub) - s1(lb - 1)) * (k / lb);\n}\ncout &lt;&lt; ans &lt;&lt; '\\n';\n}\n</code></pre> <ul> <li> <p>Online Judge</p> </li> <li> <p>P3455 [POI2007]ZAP-Queries - </p> </li> </ul>"},{"location":"oiwiki-%E6%95%B0%E5%AD%A6/%E6%95%B0%E8%AE%BA1/#20","title":"20\u3001\u6b27\u62c9\u51fd\u6570","text":"<ul> <li> <p>\u6027\u8d28</p> </li> <li> <p>\u79ef\u6027\uff1a</p> </li> <li> <p>\\(n~=~\\sum\\limits_{d \\mid n}\\phi_d\\)\uff08\u8bc1\u660e\uff1a\u83ab\u6bd4\u4e4c\u65af\u53cd\u6f14\uff09</p> </li> <li> <p>\\(\\phi_{p^n} ~=~ p^{n}-p^{n-1}\\)</p> </li> <li> <p>\\(\\phi_n ~=~ n \\times \\prod\\limits_{i=1}^{s}\\frac{p_i-1}{p_i}\\) </p> <p></p> </li> <li> <p>\u6c42\u5355\u503c\u6b27\u62c9\u51fd\u6570\uff08\u5229\u7528Pollard Rho\u7b97\u6cd5\u505a\u4f18\u5316\uff09</p> </li> </ul> <pre><code>int phi(int n){\nint ans = n;\n// int m = int(0.5 + sqrt(n));\n// for(int i=2; i&lt;=m; ++i)\nfor(int i=2; i&lt;=n/i; ++ i)\nif(!(n % i)){\nans = ans / i * (i - 1);\nwhile(!(n % i)) n /= i;\n}\nif(n &gt; 1) ans = ans / n * (n - 1);\nreturn ans;\n}\n</code></pre> <ul> <li>\u6b27\u62c9\u5b9a\u7406</li> </ul> <p>\\((a, m) ~=~ 1 \\implies a^{\\phi_m} ~\\equiv~ 1(mod~m)\\)</p> <ul> <li> <p>\u6269\u5c55\u6b27\u62c9\u5b9a\u7406</p> <p>\\(a^b ~\\equiv~ \\begin{cases}a^{b ~\\%~ \\phi_p}, &amp; (a, p)=1 ~\\\\~ a^b, ~&amp;~ (a, p ) ~\\ne~ 1, b&lt;\\phi_p ~\\\\~ a^{b ~\\%~ \\phi_p ~+~ \\phi_p}, ~~&amp;~~ (a, p ) ~~\\ne~~ 1, b \\ge \\phi_p\\end{cases}    \uff08mod~p\uff09\\)</p> </li> </ul>"},{"location":"oiwiki-%E6%95%B0%E5%AD%A6/%E6%95%B0%E8%AE%BA1/#21","title":"21\u3001\u5206\u89e3\u8d28\u56e0\u6570\uff08\u8865\uff09","text":"<ul> <li>\u6734\u7d20\u7b97\u6cd5\\(O(\\sqrt{\\frac{n}{ln~n}} \\to \\sqrt{n} )\\)</li> </ul> <pre><code>int d[55], idx;\nint breakdown(int n){\nidx = 0;\nfor(int i=2; i&lt;=n/i; ++i){\nif(n % i) continue;\nwhile(!(n % i)) n /= i;\nd[ ++ idx] = i;\n}\nif(n &gt; 1) d[ ++ idx] = n, n /= n;\nreturn idx;\n}\n</code></pre> <ul> <li>\u4f8b\u9898\uff1aProblem - 1445C - Codeforces</li> </ul> <pre><code>#include&lt;iostream&gt;\nusing namespace std; typedef long long ll;\nll a, b; int d[55], idx;\nll breakdown_solve(){\nidx = 0;\nll n = b;\nfor(int i=2; i&lt;=n/i; ++i){\nif(n % i) continue;\nwhile(!(n % i)) n /= i;\nd[ ++ idx] = i;\n}\nif(n &gt; 1) d[ ++ idx] = n, n /= n; ll ans = n;\nfor(int i=1; i&lt;=idx; ++i){\nll int m = a;\nwhile(!(m % b)) m /= d[i];\nans = max(ans, m);\n}\nreturn ans;\n} int main(){\nint T;\ncin &gt;&gt; T;\nwhile(T--){\ncin &gt;&gt; a &gt;&gt; b;\ncout &lt;&lt; breakdown_solve() &lt;&lt; '\\n';\n}\n}\n</code></pre> <ul> <li> <p>Pollard Rho\u7b97\u6cd5</p> </li> <li> <ul> <li>\u751f\u65e5\u6096\u8bba</li> </ul> </li> </ul> <p></p> <p></p> <p></p> <ul> <li> <p></p> </li> <li> <ul> <li>\u6784\u9020\u4f2a\u968f\u673a\u6570</li> </ul> </li> </ul> <p></p> <p></p> <ul> <li> <ul> <li>\u4f18\u5316\u968f\u673a\u7b97\u6cd5</li> </ul> </li> </ul> <p></p> <ul> <li> <p></p> </li> <li> <ul> <li>Floyd\u5224\u73af</li> </ul> </li> </ul> <p></p> <pre><code>std::mt19937 rd(time(0));\nint gcd(int a, int b){\nreturn !b ? a : gcd(b, a % b);\n}\nint f(int x, int c, int n){\nreturn (x * x + c) % n;\n}\nint pollard_rho(int n){\nint c = rd() % (n - 1) + 1;\nint t = f(0, c, n), r = f(t, c, n);\nwhile(t != r){\nint d = gcd(abs(t - r), n);\nif(d &gt; 1) return d;\nt = f(t, c, n), r = f(f(r, c, n), c, n);\n}\nreturn n;\n}\n</code></pre> <ul> <li> <ul> <li>\u500d\u589e\u4f18\u5316</li> </ul> </li> <li> <p></p> </li> </ul> <pre><code>int pollard_rho(int n){\nint c = rd() % (n - 1) + 1;\nint s = 0, t = 0;\nint step = 0, goal = 1;\nint val = 1;\nfor(goal = 1; ; goal &lt;&lt;= 1, s = t, val = 1){\nfor(step = 1; step &lt;= goal; ++ step){\nt = f(t, c, n);\nval = mul(val, abs(t - s), n) % n;\nif(step % 127 == 0){\nint d = gcd(val, n);\nif(d &gt; 1) return d;\n}\n}\nint d = gcd(val, n);\nif(d &gt; 1) return d;\n}\n}\n</code></pre>"},{"location":"oiwiki-%E6%95%B0%E5%AD%A6/%E6%95%B0%E8%AE%BA2/","title":"\u6570\u8bba2","text":""},{"location":"oiwiki-%E6%95%B0%E5%AD%A6/%E6%95%B0%E8%AE%BA2/#23","title":"23\u3001\u7c7b\u6b27\u51e0\u91cc\u5f97\uff08\u7537\uff09","text":"<ul> <li>pro</li> </ul> <ul> <li>\u63a8\u5bfcf</li> </ul> <p>\uff08\u8d21\u732e\u5408\u5e76\u8ba1\u7b97\uff0c\u5c06\u8d21\u732e\u4e0e\u6761\u4ef6\u505a\u8f6c\u5316\uff09\uff08\u4f9d\u8d56\u6027\uff1a\\(j \\to i \\to n\\)\uff09</p> <p></p> <p>\uff08\"\u9650\u5236\u8f6c\u79fb\"\uff09\uff08\u4f9d\u8d56\u6027\uff1a\\(j \\to n, i \\to n\\)\uff09</p> <p></p> <p></p> <p></p> <p></p> <p></p> <ul> <li>\u63a8\u5bfcg</li> </ul> <p></p> <p></p> <p></p> <p></p> <ul> <li>\u63a8\u5bfch</li> </ul> <p></p> <p></p> <p></p> <p></p> <p></p> <p></p> <p></p> <ul> <li>\u603b\u7ed3</li> </ul> <p>\uff08\u8bb0\uff1a\\(s_0=n+1,s_1=\\frac{n\\times(n+1)}{2},s_2=\\frac{n\\times(n+1)\\times(2\\times n+1)}{6}  ~\\\\~ d = \\frac{a\\times i+b}{c}, d_1=\\frac{a\\%c\\times i+b\\%c}{c}, d_2=\\frac{j\\times c + c - b - 1}{a} ~\\\\~ D = \\frac{a\\times n + b}{c} ~\\\\~ f = f(a, b, c, n),f_1 ~=~ f(a\\%c,~b\\%c,~c,~n), f_2 = f(c,~c-b-1,~a,~D-1) ~\\\\~\uff08g,g_1,g_2,h,h_1,h_2\u540c\u7406\uff09\\)\uff09</p> <p>\\(f ~=~ \\begin{cases}  \\lfloor\\frac{b}{c}\\rfloor \\times s_0 &amp; a == 0 \\\\ \\lfloor\\frac{a}{c}\\rfloor \\times s_1 + \\lfloor\\frac{b}{c}\\rfloor \\times s_0 + f_1 &amp; a \\ge c || b \\ge c ~\\\\~ D \\times n - f_2 &amp; a&lt;c, b&lt;c  \\end{cases}\\)</p> <p>\\(g ~~=~~ \\begin{cases} \\lfloor\\frac{b}{c}\\rfloor \\times s_1 &amp; a == 0 ~\\\\~ \\lfloor\\frac{a}{c}\\rfloor \\times s_2 + \\lfloor\\frac{b}{c}\\rfloor \\times s_1 + g_1 &amp; a \\ge c || b \\ge c ~~\\\\~~ D \\times s_1 - \\frac12\\times h_2 - \\frac12\\times f_2 &amp; a&lt;c, b&lt;c \\end{cases}\\)</p> <p>\\(h ~~=~~ \\begin{cases} \\lfloor\\frac{b}{c}\\rfloor^2 \\times s_0 &amp; a == 0 ~\\\\~ \\lfloor\\frac{a}{c}\\rfloor^2 \\times s_2 + 2 \\times \\lfloor\\frac{a}{c}\\rfloor \\times \\lfloor\\frac{b}{c}\\rfloor \\times s_1 + \\lfloor\\frac{b}{c}\\rfloor^2 \\times s_0  &amp; a \\ge c || b \\ge c ~~\\\\~~ + h_1 + 2 \\times \\lfloor\\frac{a}{c}\\rfloor \\times g_1 + 2 \\times \\lfloor\\frac{b}{c}\\rfloor f_1 ~\\\\~ D \\times (D + 1)\\times n - 2\\times g_2 - 2\\times f_2 - f &amp; a&lt;c, b&lt;c \\end{cases}\\)</p> <ul> <li>P5170 \u3010\u6a21\u677f\u3011\u7c7b\u6b27\u51e0\u91cc\u5f97\u7b97\u6cd5 - \u6d1b\u8c37 | \u8ba1\u7b97\u673a\u79d1\u5b66\u6559\u80b2\u65b0\u751f\u6001 (luogu.com.cn)</li> </ul> <pre><code>#include&lt;iostream&gt;\nusing namespace std;\n#define int long long\nconst int p = 998244353;\nint i2, i6;\ninline int inv(int n){ return n==1 ? 1 : (p - p / n) * inv(p % n) % p; }\ninline int s0(int n){ return n + 1; }\ninline int s1(int n){ return n * (n + 1) % p * i2 % p; }\ninline int s2(int n){ return n * (n + 1) % p * (2 * n + 1) % p * i6 % p; }\nstruct func{\nint f, g, h;\n};\nfunc calc(int a, int b, int c, int n){\nint ac = a / c, bc = b / c, D = (a * n + b) / c;\nif(!a) return {bc * s0(n) % p, bc * s1(n) % p, bc * bc % p * s0(n) % p};\nif(a &gt;= c || b &gt;= c){\nfunc x1 = calc(a % c, b % c, c, n);\nreturn {\n(ac * s1(n) % p + bc * s0(n) % p + x1.f) % p,\n(ac * s2(n) % p + bc * s1(n) % p + x1.g) % p,\n(ac * ac % p * s2(n) % p + 2 * ac * bc % p * s1(n) % p + bc * bc % p * s0(n) % p + x1.h + 2 * ac * x1.g % p + 2 * bc * x1.f % p) % p\n};\n}\nfunc x2 = calc(c, c - b - 1, a, D - 1);\nfunc x = {\n((D * n - x2.f) % p + p) % p,\n((D * s1(n) % p - i2 * x2.h % p - i2 * x2.f % p) % p + p) % p,\n((D * (D + 1) % p * n % p - 2 * x2.g % p - 2 * x2.f % p) % p + p) % p\n};\nx.h = ((x.h - x.f) % p + p) % p;\nreturn x;\n}\nsigned main(){\ni2 = inv(2), i6 = inv(6);\n//    cout &lt;&lt; i2 &lt;&lt; ' ' &lt;&lt; i6 &lt;&lt; '\\n';\nint T;\ncin &gt;&gt; T;\nwhile(T--){\nint n, a, b, c;\ncin &gt;&gt; n &gt;&gt; a &gt;&gt; b &gt;&gt; c;\nfunc x = calc(a, b, c, n);\ncout &lt;&lt; x.f &lt;&lt; ' ' &lt;&lt; x.h &lt;&lt; ' ' &lt;&lt; x.g &lt;&lt; '\\n';\n}\nreturn 0;\n}\n</code></pre>"},{"location":"oiwiki-%E6%95%B0%E5%AD%A6/%E6%95%B0%E8%AE%BA2/#24","title":"24\u3001\u8d39\u9a6c\u5c0f\u5b9a\u7406\u3001\u6b27\u62c9\u5b9a\u7406","text":"<ul> <li>\u8d39\u9a6c\u5c0f\u5b9a\u7406</li> </ul> <p>\\(p~~is~~prime,~(a,~p)=1 ~\\implies~ a^{p-1} ~\\equiv~ 1(mod~p)\\)</p> <p>\u53e6\u4e00\u4e2a\u5f62\u5f0f\uff1a\\(p~~id~~prime ~\\implies~ a^p ~\\equiv~ a(mod~p)\\)</p> <ul> <li>\u6b27\u62c9\u5b9a\u7406\uff08\u6bd4\u8d39\u9a6c\u5b9a\u7406\u66f4\u4e00\u822c\uff09</li> </ul> <p>$(a,~b) = 1 \\implies a^{\\phi_b} \\equiv 1(mod~b) $</p> <ul> <li>\u6269\u5c55\u6b27\u62c9\u5b9a\u7406</li> </ul> <p>\\(a^b ~\\equiv~ \\begin{cases}  a^{b~\\%~\\phi_m},    &amp;  (a,~m)~=~1        \\\\           a^b,       &amp;  (a,~m) ~\\ne~ 1,~b&lt;\\phi_m                               \\\\    a^{b~\\%~\\phi_m ~+~ \\phi_m}     &amp;    (a,~m) ~\\ne~ 1,~b \\ge \\phi_m     \\end{cases}   \\pmod{m}\\)</p> <p>\uff08\u5f53\\(a &lt; 2\\times m\\)\u65f6\uff0c\\((a,m)\\)\u4ec5\u5f53\\(a==m\\)\u65f6\uff0c\u4e3a\\(m\\)\uff0c\u6b64\u65f6\\(a^b\\pmod{m}=0\\)\uff1b\u5176\u4ed6\u60c5\u51b5\u4e0b\u4e3a1\uff0c\u5373\u6b27\u62c9\u5b9a\u7406\u7b2c\u4e00\u4e2a\u6761\u4ef6\uff09</p> <ul> <li>\u4f8b\u9898</li> </ul> <p>1\u3001SPOJ.com - Problem ETF\uff08\u6c34\u9898\uff09</p> <p>2\u3001UVA #10179 \"Irreducible Basic Fractions\"[Difficulty: Easy]\uff08\u6c34\u9898\uff09</p> <p>3\u3001UVA #10299 \"Relatives\"[Difficulty: Easy](\u6c34\u9898\uff0c\u4f46\u6570\u636e\u6709\u95ee\u9898(\\(\\phi_1=1\\)\u800c\u975e0))</p> <p>4\u3001UVA #11327 \"Enumerating Rational Numbers\"[Difficulty: Medium]\uff08\u4e8c\u5206+\u6b27\u62c9\u7b5b+gcd\uff09</p> <p>5\u3001TIMUS #1673 \"Admission to Exam\"[Difficulty: High]\uff08\u4e0d\u4f1a\uff09</p>"},{"location":"oiwiki-%E6%95%B0%E5%AD%A6/%E6%95%B0%E8%AE%BA2/#25lieu","title":"25\u3001\u7ebf\u6027\u540c\u4f59\u65b9\u7a0bliEu","text":"<pre><code>int exgcd(int a, int b, int &amp;x, int &amp;y){\nif(!b){\nx = 1, y = 0;\nreturn a;\n}\nint d = exgcd(b, a % b, x, y), x1 = x;\nx = y;\ny = x1 - a / b * x1;\nreturn d;\n}\n// \u4e00\u822c c\u662f\u6b63\u6574\u6570\uff1ba\uff0cb\u53ef\u4ee5\u4e0d\u662f\u6b63\u6574\u6570\uff08\u5f88\u591a\u4eba\u5f80\u5f80\u4f1a\u5ffd\u7565\u8fd9\u4e00\u70b9\uff0c\u8fd9\u4e5f\u56f0\u6270\u4e86\u6211\u597d\u4e45\uff09\nbool liEu(int a, int b, int c, int &amp;x, int &amp;y){\nint d = exgcd(a, b, x, y);\nif(c % d) return false;\nint ad = a / d, bd = b / d, cd = c / d;\nx *= cd, y *= cd;\n//  \u5982\u679c\u6a21\u6570bd\u662f\u8d1f\u6570\uff0c\u90a3\u4e48\u5bf9bd\u53d6\u53cd(\u91cd\u8981\uff01\uff01)\nbd = abs(bd);\n//  \u53d6\u6700\u5c0f\u6b63\u6574\u6570\u89e3\nx = (x % bd + bd) % bd;\nreturn true;\n}\n</code></pre> <p>\uff08\u6a21\u6570\u53d6\u5012\u6570\u7684\u6b63\u786e\u6027\uff1a</p> <p>\u8bbe \\(P\\) \u4e3a\u6a21\u6570\uff0c\u90a3\u4e48 \\(n - p\\times t \\iff n + p\\times -t\\) \uff0c\\(n,~t\\in Z\\) \uff09</p>"},{"location":"oiwiki-%E6%95%B0%E5%AD%A6/%E6%95%B0%E8%AE%BA2/#26crt","title":"26\u3001\u4e2d\u56fd\u5269\u4f59\u5b9a\u7406CRT","text":"<ul> <li>Chinese Remainder Theorem, CRT</li> </ul> <p>\\(\\begin{cases}  x \\equiv a_1 \\pmod{b_1}  \\\\   x \\equiv a_2 \\pmod{b_2}  \\\\  &amp;\\vdots   \\\\    x \\equiv a_n \\pmod{b_n} \\end{cases}\\)</p> <p>\u7ed3\u8bba\uff1a</p> <p>$ pb = \\prod\\limits_{i=1}^{n}b_i   \\  x=(\\sum\\limits_{i=1}^n a_i\\times\\frac{pb}{b_i} \\times (\\frac{pb}{b_i})^{-1}) \\% pb$</p> <ul> <li>\u6734\u7d20\u7248\uff08\\(b[~]\u4e92\u8d28\u7684\u60c5\u51b5\\)\uff09P3868 [TJOI2009] \u731c\u6570\u5b57</li> </ul> <pre><code>int exgcd(int a, int b, int &amp;x, int &amp;y){\nif(!b) return x = 1, y = 0, a;\nint d = exgcd(b, a % b, x, y), x1 = x;\nreturn x = y, y = x1 - a / b * y, d;\n}\nint crt(int k, int *a, int *b){\nint ans = 0;\nint pb = 1;\nfor(int i=1; i&lt;=k; ++i) pb = pb * b[i];\nfor(int i=1; i&lt;=k; ++i){\nint b1 = pb / b[i], ib1, y;\nexgcd(b1, b[i], ib1, y);\nans = (ans + a[i] * b1 %pb * ib1 % pb) % pb;\n}\nreturn (ans % pb + pb) % pb;\n}\n</code></pre> <ul> <li>\u6269\u5c55\u4e2d\u56fd\u5269\u4f59\u5b9a\u7406excrt\uff08\\(b[~]\u65e0\u9650\u5236\u7684\u60c5\u51b5\uff0c\u4f46\u4e0d\u4e00\u5b9a\u6709\u89e3\\)\uff09</li> </ul> <p>\u8003\u8651\u4e24\u4e2a\u65b9\u7a0b\u7684\u60c5\u51b5P4777 \u3010\u6a21\u677f\u3011\u6269\u5c55\u4e2d\u56fd\u5269\u4f59\u5b9a\u7406\uff08EXCRT\uff09</p> <p>$x \\equiv a_1 \\pmod{b_1} \\ x \\equiv a_2 \\pmod{b_2} \\ \\implies  x =a_1 + b_1\\times p = a_2 + b_2\\times q  \\ \\implies b_1\\times p - b_2\\times q = a_2 - a_1 \\ \\implies \u7528exgcd\u6c42\u51fap \\ \u5f53d | (a_2 - a_1)\u65f6\u6709\u89e3\uff0c\u89e3\u4e3a x \\equiv a_1 + b_1\\times p \\pmod{[b_1,~b_2]} \\ \\implies \u4e8e\u662f\uff0c\u5bf9\u4e8e\u591a\u4e2a\u65b9\u7a0b\u7684\u60c5\u51b5\uff0c\u66f4\u65b0 a_1 += b_1\\times p,~ b_1 *= b_2/d \u8fed\u4ee3\u6c42\u89e3\u5373\u53ef   $</p> <pre><code>#define int __int128\nint exgcd(int a, int b, int &amp;x, int &amp;y){\nif(!b) return x = 1, y = 0, a;\nint d = exgcd(b, a % b, x, y), x1 = x;\nreturn x = y, y = x1 - a / b * y, d;\n}\nint excrt(int n, int *a, int *b){\nint A1 = a[1], B1 = b[1];\nfor(int i=2; i&lt;=n; ++i){\nint A2 = a[i], B2 = b[i];\n// liEu(a, b, c, x, y)\nint x, y;\nint d = exgcd(B1, B2, x, y), c = A2 - A1, cd = c / d, bd = B2 / d;\nif(c % d) return -1;\nx *= cd, y *= cd;\n// \u6c42\u89e3\u6700\u5c0f\u6b63\u6574\u6570\u89e3\nx = (x % bd + bd) % bd;\nA1 += B1 * x, B1 *= bd;\n}\n// \u4e0d\u77e5\u9053\u8981\u4e0d\u8981\u6a21 B1 \uff1f\nreturn A1;\n}\n</code></pre> <ul> <li>\u53d8\u76f8\u7684excrt\uff0c\u5982P4774 [NOI2018] \u5c60\u9f99\u52c7\u58eb</li> </ul> <p>\u6bd2\u7624\u9898\u76ee\uff0c\u8fd8\u9700\u8981\u7279\u5224</p> <p>\u6c42\u89e3\u65b9\u7a0b\u7ec4\uff1a\\(c_i\\times x \\equiv a_i \\pmod{b_i}\\)</p> <p>\u4e00\u79cd(\u6211\u7684)\u505a\u6cd5\u662f\uff1a\u5c06\\(c_i\\)\u8f6c\u5316\u4e3a1\uff0c\u7136\u540e\u8c03\u7528\\(excrt()\\)\u6c42\u89e3</p> <pre><code>int exgcd(int a, int b, int &amp;x, int &amp;y){\nif(!b) return x = 1, y = 0, a;\nint d = exgcd(b, a % b, x, y), x1 = x;\nreturn x = y, y = x1 - a / b * y, d;\n}\nint liEu(int a, int b, int c, int &amp;x, int &amp;y){\nint d = exgcd(a, b, x, y), cd = c / d, bd = b / d;\nif(c % d) return -1;\nreturn x = ((__int128)x * cd % bd + bd) % bd, d;\n}\nint mx;\nint excrt(int n, int *a, int *b){\nint a1 = a[1], b1 = b[1];\nfor(int i=2; i&lt;=n; ++i){\nint a2 = a[i], b2 = b[i];\nint x, y, d = liEu(b1, b2, a2 - a1, x, y);\nif(d == -1) return -1;\na1 += b1 * x, b1 *= b2 / d;\na1 = (a1 % b1 + b1 ) % b1;\n}\n// \u7279\u5224\nif(a1 &lt; mx) a1 += ((mx - a1 - 1) / b1 + 1) * b1;\nreturn a1;\n}\nint ex(int n, int *a, int *b, int *c){\nfor(int i=1; i&lt;=n; ++i){\nint x, y, d = liEu(c[i], b[i], a[i], x, y);\nif(d == -1) return -1;\na[i] = x, b[i] = b[i] / d;\n}\nreturn excrt(n, a, b);\n}\n</code></pre> <ul> <li>Garner\u7b97\u6cd5\uff08crt\u7684\u5e94\u7528\uff09</li> </ul> <p></p> <p>\\(\\begin{cases} n \\equiv a_1 \\pmod{b_1} \\\\ n \\equiv a_2 \\pmod{b_2} \\\\ &amp;\\vdots \\\\ n \\equiv a_n \\pmod{b_n} \\end{cases}\\)</p> <p>\\(\u8bb0\uff1ap_i \\times r_{i,j} ~\\equiv~ 1 \\pmod{p_j}\\) \uff08\u5373\\(r_{i,j}\\)\u4e3a\\(p_i\\)\u6a21\\(p_j\\)\u610f\u4e49\u4e0b\u7684\u9006\u5143\uff09</p> <p>\u5b9a\u4e49$n = x_1 + x_2\\times p_1 + x_3\\times p_1\\times p_2 +\\ldots + x_k\\times p_1\\times\\ldots\\times p_{k-1} $</p> <p>\u5c06 \\(n\\) \u4ee3\u5165\u9010\u4e2a\u5f0f\u5b50\u4e2d\u5316\u7b80\uff0c\u5f97\uff1a</p> <p></p> <p></p> <p></p> <ul> <li>\u6a21\u6570</li> </ul>"},{"location":"oiwiki-%E6%95%B0%E5%AD%A6/%E6%95%B0%E8%AE%BA2/#27wilson","title":"27\u3001\u5a01\u5c14\u900a\u5b9a\u7406Wilson","text":"<ul> <li>Problem - 2973 (hdu.edu.cn) </li> </ul> <pre><code>#include\nusing namespace std; const int N = 1e6+8, M = 3 * N + 8;\nint s[N];\nbool notp[M]; int main(){\nnotp[1] = true;\nfor(int i=2; i&lt;M; i++)\nif(!notp[i])\nfor(int d=2; d &lt;= M / i; d ++ ) notp[d * i] = true;\nfor(int i=1; i&lt;N; i++) s[i] = s[i-1] + !notp[3 * i + 7]; int T;\ncin &gt;&gt; T;\nwhile(T--){\nint n;\nscanf(\"%d\", &amp;n);\nprintf(\"%d\\n\", s[n]);\n} }\n</code></pre>"},{"location":"oiwiki-%E6%95%B0%E5%AD%A6/%E6%95%B0%E8%AE%BA2/#28lte","title":"28\u3001\u5347\u5e42\u5b9a\u7406LTE","text":"<ul> <li>\\(LTE_p\\)\uff08\u6a21\u4e3a\u5947\u7d20\u6570\uff09</li> </ul> <p>$ p \\nmid a,~p \\nmid b,~a \\equiv b \\pmod{p} \\ \\implies v_{p, a^n - b^n} = v_{p, a - b} + v_{p, n}       $</p> <ul> <li>\\(LTE_2\\)</li> </ul> <p>\\(a,~b\u4e3a\u5947\u6570\\)</p> <p>$n\u4e3a\u5947\u6570 \\implies v_{2,~an-bn} = v_{2,~a-b} $</p> <p>$n\u4e3a\u5076\u6570 \\implies v_{2,~an-bn} = v_{2,~a-b} + v_{2,~a+b} + v_{2,~n} - 1  $</p>"},{"location":"oiwiki-%E6%95%B0%E5%AD%A6/%E6%95%B0%E8%AE%BA2/#29lucas","title":"29\u3001\u5362\u5361\u65af\u5b9a\u7406Lucas","text":"<p>\uff08\u524d\u7f6e\u77e5\u8bc6\uff1a\u5feb\u901f\u5e42\uff0c\u4e58\u6cd5\u9006\u5143\uff0c\u7ec4\u5408\u6570\uff09</p> <p></p> <p>\uff08\u7b80\u8a00\u4e4b\uff1a\u5362\u5361\u65af\u7528\u4e8e\u8ba1\u7b97 \\(a,~b\\) \u5f88\u5927\uff0c\u800c \\(P\\) \u8f83\u5c0f \u7684\u7ec4\u5408\u6570\uff0c\u590d\u6742\u5ea6\u4e0b\u9650\u4e3a \\(O(P)\\)  \uff1b</p> <p>\u82e5 \\(P~is~prime\\)\uff0c\u7528\u6734\u7d20 \\(lucas\\)\uff1b \u82e5 \\(P~is~not~prime\\)\uff0c\u7528 \\(exlucas\\)\uff09</p> <p>\uff08\u8bc1\u660e\u7565\uff09</p> <p></p> <p>\\(lucas\\) \u6c42\u6cd5\u4e00\uff0c\u590d\u6742\u5ea6\uff1a\\(O(p) ~\\to~ O(\\log_P\\times \\log_n)\\)\uff08\u9884\u5904\u7406\uff0c\u67e5\u8be2\uff09</p> <pre><code>#define int long long\nconst int N = 1e5+3;\nint fac[N];\nvoid init(int n, int p){\nfac[0] = 1;\nfor(int i=1; i&lt;=n; ++i) fac[i] = fac[i-1] * i % p;\n}\nint fp(int a, int n, int p){ int ans = 1; while(n){ if(n &amp; 1) ans = ans * a % p; a = a * a % p; n &gt;&gt;= 1; } return ans; }\nint inv(int n, int p){ return fp(n, p-2, p); }\nint c(int a, int b, int p){\nreturn a &lt; b ? 0 : fac[a] * inv(fac[a - b], p) % p * inv(fac[b], p) % p;\n}\nint lucas(int a, int b, int p){\nreturn !b ? 1 : lucas(a / p, b / p, p) * c(a % p, b % p, p) % p;\n}\n</code></pre> <p>\\(lucas\\) \u6c42\u6cd5\u4e8c\uff0c\u590d\u6742\u5ea6\uff1a\\(O(p) ~~\\to~~ O(\\log_n)\\)</p> <pre><code>#define int long long\nint P;\nint fac[N], ifac[N];\nvoid init(int n){\nfac[0] = ifac[0] = ifac[1] = 1;\nfor(int i=1; i&lt;=n; ++i) fac[i] = fac[i-1] * i % P;\nfor(int i=2; i&lt;=n; ++i) ifac[i] = (P - P / i) * ifac[P % i] % P;\nfor(int i=1; i&lt;=n; ++i) ifac[i] = ifac[i-1] * ifac[i] % P;\n}\nint c(int a, int b){\nreturn a &lt; P ? fac[a]*ifac[a-b] % P * ifac[b] % P : c(a%P, b%P) * c(a/P, b/P) % P;\n}\n</code></pre> <p>\u5728\u975e\u5e38\u5927\u7684\u4e0d\u4e3a\u8d28\u6570\u7684\u6a21\u6570\u4e0b\u7684\u4f18\u5316\uff1a\uff087\u4e2a\u51fd\u6570\uff09</p> <pre><code>#define int long long\nconst int N = 4e4+3, p = 999911659, pb = p - 1;\nint k, a[4 + 1], b[4 + 1];\nvoid breakdown(int n){\n// \u6784\u9020 b[] \nfor(int i=2; i&lt;=n; ++i){\nif(n % i) continue;\nwhile(!(n % i)) n /= i;\nb[++ k] = i;\n}\nif(n &gt; 1) b[++ k] = n;\n}\nint fac[N];\nvoid init(int p){ fac[0] = 1; for(int i=1; i&lt;=p; ++i) fac[i] = fac[i-1] * i % p; }\nint fp(int a, int n, int p){ int ans = 1;while(n){    if(n &amp; 1) ans = ans * a % p;a = a * a % p;    n &gt;&gt;= 1; } return ans; }\nint inv(int n, int p){  return fp(n, p-2, p); }\nint c(int a, int b, int p){ return a &lt; b ? 0 : fac[a] * inv(fac[a - b], p) % p * inv(fac[b], p) % p; }\nint lucas(int a, int b, int p){ return !b ? 1 : lucas(a / p, b / p, p) * c(a % p, b % p, p) % p; }\nint crt(int k, int *a, int *b, int n){\n// \u6784\u9020 a[]\uff0c \u5373 x \u6a21 \u5404\u79cd bi \u610f\u4e49\u4e0b\u7684\u503c \nfor(int i=1; i&lt;=k; ++i){\ninit(b[i]);\nint ans = 0;\nfor(int j=1; j * j &lt;= n; ++j){\nif(n % j) continue;\nans = (ans + lucas(n, j, b[i])) % b[i];\nif(j * j != n) ans = (ans + lucas(n, n / j, b[i])) % b[i];\n}\na[i] = ans;\n}\n// \u5408\u5e76 \nint ans = 0;\nfor(int i=1; i&lt;=k; ++i){\nint b1 = pb / b[i], ib1 = inv(b1, b[i]);\nans = (ans + a[i] * b1 % pb * ib1 % pb) % pb;\n}\nreturn ans;\n}\n</code></pre> <p>\\(n!\\)\u4e2d\u542b\u6709\u7684\u7d20\u6570\\(p\\)\u7684\u5e42\u6b21 $v_{p,~n!} = \\sum\\limits_{i=1}^{\\infty} \\lfloor\\frac{n}{p_{i}}\\rfloor $</p> <p>\u53e6\u4e00\u79cd\u5f62\u5f0f\uff1a\\(v_{p,~n!} ~=~ \\frac{n - s_{p,~n}}{p - 1} \\(\uff08\\)s_{p,~n}\\)\u4e3an\u5728p\u8fdb\u5236\u4e0b\u7684\u5404\u4f4d\u6570\u5b57\u4e4b\u548c\uff09</p> <ul> <li>\u7d20\u6570\u5728\u7ec4\u5408\u6570\u4e2d\u7684\u5e42\u6b21</li> </ul> <p>$v_{p,~C^a_b} = \\frac{s_{p,~a + s_{p,~b-a} - s_{p,~b}}}{p-1} $</p> <pre><code>int s(int p, int n){\nint ans = 0;\nwhile(n){\nans += n % p;\nn /= p;\n}\nreturn ans;\n}\nint v(int p, int n){\nreturn (n - s(p, n)) / (p - 1);\n}\nint v(int p, int a, int b){\nreturn -(s(p, a) + s(p, b - a) - s(p, b)) / (p - 1);\n}\n</code></pre> <ul> <li>exlucas</li> </ul>"},{"location":"oiwiki-%E6%95%B0%E5%AD%A6/%E6%95%B0%E8%AE%BA2/#30","title":"30\u3001\u4e8c\u6b21\u5269\u4f59\uff08\u7537\uff09","text":"<p>\uff08\u539f\u56fe (902\u00d7905) (oi-wiki.org)\uff09</p> <ul> <li>Euler\u5224\u522b\u51c6\u5219</li> </ul> <p></p> <p></p> <p>\uff08\u8bc1\u660e\u7565\uff09</p> <p></p> <ul> <li>\u4e8c\u6b21\u5269\u4f59\uff0c\u4e8c\u6b21\u975e\u5269\u4f59\u7684\u6570\u91cf</li> </ul> <p></p> <p></p> <p>\uff08\u8bc1\u660e\u7565\uff0c\u6d89\u53caFermat\u5c0f\u5b9a\u7406\u3001Lagrange\u5b9a\u7406\u3001Euler\u5224\u522b\u51c6\u5219\uff09</p> <ul> <li> <p>\u7279\u6b8a\u60c5\u51b5\u65f6\u7684\u7b97\u6cd5\uff08\\(a=4\\times i-1\\)\uff09</p> </li> <li> <ul> <li></li> </ul> </li> </ul> <p></p> <ul> <li> <ul> <li>Atkin\u7b97\u6cd5</li> </ul> </li> </ul> <p></p> <p></p> <ul> <li>Cipolla\u7b97\u6cd5\uff08\u770b\u4e0d\u61c2\uff09</li> </ul> <p></p> <ul> <li>Legendre\u7b97\u6cd5\uff08\u3002\u3002\u3002\uff09</li> </ul> <p></p> <ul> <li>Tonelli-Shanks\u7b97\u6cd5\uff08\u3002\u3002\u3002\uff09</li> </ul> <p></p> <ul> <li>\u7ec3\u4e60</li> </ul> <p>P5491 \u3010\u6a21\u677f\u3011\u4e8c\u6b21\u5269\u4f59 - \u6d1b\u8c37 </p> <p>\u300cTimus 1132\u300dSquare Root</p>"},{"location":"oiwiki-%E6%95%B0%E5%AD%A6/%E6%95%B0%E8%AE%BA2/#31","title":"31\u3001\u62c9\u683c\u6717\u65e5\u5b9a\u7406\uff08\u8865\uff09","text":"<ul> <li> <p>\u5e94\u7528</p> </li> <li> <ul> <li></li> </ul> </li> <li> <p></p> </li> <li> <p></p> </li> </ul>"},{"location":"oiwiki-%E6%95%B0%E5%AD%A6/%E6%95%B0%E8%AE%BA2/#32primitive-roots","title":"32\u3001\u539f\u6839\uff08Primitive Roots\uff09","text":"<ul> <li> <p>\u524d\u7f6e\uff1a\u8d39\u9a6c\u5c0f\u5b9a\u7406\uff0c\u6b27\u62c9\u5b9a\u7406\uff0c\u62c9\u683c\u6717\u65e5\u5b9a\u7406\u3002</p> </li> <li> <p>1\uff0c\u9636\\(\\delta_{m,a}\\)\u3001\u534a\u9636\\(\\delta_{m,a}^-\\)</p> </li> </ul> <p></p> <p></p> <ul> <li> <ul> <li>\u6027\u8d28</li> </ul> </li> <li> <ul> <li> <ul> <li>1\uff0c\\(a,~a^1,~a^2,~..~,~a^{\\delta_{m,~a}}\\)\u6a21\\(m\\)\u4e24\u4e24\u4e0d\u540c\u4f59</li> </ul> </li> </ul> </li> </ul> <p></p> <ul> <li> <ul> <li> <ul> <li>2\uff0c\u82e5\\(a^n ~\\equiv~ 1\\pmod{m}\\)\uff0c\u5219\\(\\delta_{m,~a} \\mid n\\)</li> </ul> </li> </ul> </li> </ul> <p></p> <ul> <li> <ul> <li> <ul> <li>3\uff0c\u8bbe\\(m\\in\\mathbb{N^*},~a,~b\\in\\mathbb{Z},~(a,~m)=(b,~m)=1\\)\uff0c\u5219\uff1a</li> </ul> </li> </ul> </li> </ul> <p>\\(\\delta_{m,~a\\times b}=\\delta_{m,~a}\\times \\delta_{m,~b} \\iff (\\delta_{m,~a},~\\delta_{m,~b})=1\\)</p> <p>\uff08\u8bc1\u660e\u7565\uff0c\u539f\u6839 - OI Wiki (oi-wiki.org)\uff09</p> <ul> <li> <ul> <li> <ul> <li>4\uff0c\u8bbe\\(k\\in \\mathbb{N},~m\\in \\mathbb{N^*},a\\in \\mathbb{Z},~(a,~m)=1  \\\\ \\implies \\delta_{m,~a^k} ~=~ \\frac{\\delta_{m,~a}}{(\\delta_{m,~a},~k)}\\)</li> </ul> </li> </ul> </li> <li> <p>2\uff0c\u539f\u6839</p> </li> </ul> <p>\u8bbe\\(m\\in \\mathbb{N}^*,~a\\in \\mathbb{Z}\\)\u3002\u82e5\\((a,~m)=1\\)\uff0c\u4e14\\(\\delta_{m,~a}=\\phi_m\\)\uff0c\u5219 \\(a\\) \u4e3a\u6a21 \\(m\\) \u7684\u539f\u6839</p> <p></p> <ul> <li> <ul> <li>1\uff0c\u539f\u6839\u5224\u5b9a\u5b9a\u7406</li> </ul> </li> </ul> <p>\u8bbe \\(m\\ge 3, (a,~m)=1\\)\uff0c\u5219</p> <p>\\(a\\) \u662f\u6a21 \\(m\\) \u7684\u539f\u6839 \\(\\iff  \\forall \u7d20\u56e0\u5b50p\\in \\phi_{m},~a^{\\frac{\\phi_m}{p}}\\not\\equiv 1\\pmod{m}\\)</p> <p>\uff08\u8bc1\u660e\u7565\uff09</p> <ul> <li> <ul> <li>2\uff0c\u539f\u6839\u4e2a\u6570</li> </ul> </li> </ul> <p>\u82e5\u4e00\u4e2a\u6570 \\(m\\) \u6709\u539f\u6839\uff0c\u5219\u5b83\u7684\u539f\u6839\u4e2a\u6570\u4e3a \\(\\phi_{\\phi_m}\\)</p> <p></p> <ul> <li> <ul> <li>3\uff0c\u539f\u6839\u5b58\u5728\u5b9a\u7406</li> </ul> </li> </ul> <p></p> <ul> <li> <ul> <li> <ul> <li>\u5f15\u7406</li> </ul> </li> </ul> </li> <li> <ul> <li> <p></p> </li> <li> <p></p> </li> <li> <p></p> </li> </ul> </li> <li> <ul> <li>\u6700\u5c0f\u539f\u6839\u7684\u6570\u91cf\u7ea7</li> </ul> </li> </ul> <p></p> <ul> <li> <p>\u4f8b\u9898\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0</p> </li> <li> <p>P6091 \u3010\u6a21\u677f\u3011\u539f\u6839 - \u6d1b\u8c37 | \u8ba1\u7b97\u673a\u79d1\u5b66\u6559\u80b2\u65b0\u751f\u6001 (luogu.com.cn)\uff08gcd+fp+\u7b5b+breakdown\u53ef\u4ee5\u5f97\u5230\u6700\u4f18\u590d\u6742\u5ea6\uff09</p> </li> </ul> <pre><code>#include &lt;iostream&gt;\n#include&lt;algorithm&gt;\nusing namespace std;\nconst int N = 1e6+4;\nint p[N], idx, st[N], phi[N];\n// \u5224\u65ad\u539f\u6839\u5b58\u5728\u6027 \uff08\u5982\u679c\u6ca1\u6709\u7ebf\u6027\u7b5b\uff0c\u590d\u6742\u5ea6\u5c06\u9000\u5316\u4e3a &gt; O(N)\uff09\n//bool rt[N];\nint gp(int n){\nphi[1] = 1;\nfor(int i=2; i&lt;=n; ++i){\nif(!st[i]) p[ ++ idx] = i, phi[i] = i-1;\nfor(int j=1; p[j]&lt;=n/i; ++j){\nst[i * p[j]] = true;\nphi[i * p[j]] = i % p[j] ? phi[i] * phi[p[j]] : phi[i] * p[j];\nif(!(i % p[j])) break;\n}\n}\n//    rt[2] = rt[4] = true;\n//    // \u679a\u4e3e\u5947\u7d20\u6570 \n//    for(int i=2; i&lt;=idx; ++i){\n////            cout &lt;&lt; p[i] &lt;&lt; '\\n';\n//        for(long long j=p[i]; j&lt;=n; j*=p[i]){\n//            rt[j] = true;\n//            if(2 * j &lt;= n) rt[2 * j] = true;\n//        }\n//    }\n}\nint gcd(int a, int b){ return !b ? a : gcd(b, a % b); }\nint fp(int a, int n, int p){\nint ans = 1;\nwhile(n){\nif(n &amp; 1) ans = 1ll * ans * a % p;\na = 1ll * a * a % p;\nn &gt;&gt;= 1;\n}\nreturn ans;\n}\nbool check(int a, int p) {\nif(gcd(a, p) != 1) return false;\nint n = phi[p];\nfor(int i=2; i*i&lt;=n; i++) {\nif(n % i) continue;\nwhile(!(n % i)) n /= i;\nif(fp(a, phi[p] / i, p) == 1) return false;\n}\nif (n &gt; 1) if(fp(a, phi[p] / n, p) == 1) return false;\nreturn true;\n}\nint findrt (int p) {\n//    if(!rt[p]) return -1;\nfor (int i=1; i&lt;p; i++)\nif (check(i, p)) return i;\nreturn -1;\n}\nint cnt, root[N];\nvoid getrt (int p, int g){\nint prod = 1;\nfor (int i=1; i&lt;=phi[p]; i++) {\nprod = 1ll * prod * g % p;\nif (gcd(i,phi[p])==1) {\nroot[++ cnt] = prod;\n}\n}\n}\nint main () {\ngp(N - 1);\nint T;\nscanf(\"%d\", &amp;T);\nwhile(T--){\nint p, d;\nscanf(\"%d%d\", &amp;p, &amp;d);\nint g = findrt(p);\nif(~g){\ncnt = 0;\ngetrt(p, g);\nsort(root+1, root+cnt+1);\ncout &lt;&lt; cnt &lt;&lt; '\\n';\nfor(int i=1; i&lt;=cnt/d; i++) printf(\"%d \", root[i*d]);\nputs(\"\");\n}else puts(\"0\\n\");\n}\n}\n</code></pre> <ul> <li> <p>Problem - 4992 (hdu.edu.cn)\uff08\u5fc5\u987b\u7ebf\u6027\u7b5b\uff0c\u5426\u5219TLE\uff09</p> </li> <li> <p>1284 -- Primitive Roots (poj.org)\uff08\u6c34\u9898\uff09</p> </li> <li> <p>Little Chu - URAL 1268 - Virtual Judge (vjudge.net)</p> </li> <li> <p>Problem - 1114F - Codeforces</p> </li> <li> <p>2018\u79e6\u7687\u5c9bccpc-camp Steins;Gate (\u539f\u6839+FFT) - xiuwenL - \u535a\u5ba2\u56ed (cnblogs.com)</p> </li> </ul>"},{"location":"oiwiki-%E6%95%B0%E5%AD%A6/%E6%95%B0%E8%AE%BA2/#33bsgsdr","title":"33\u3001\u79bb\u6563\u5bf9\u6570bsgs\uff0c\u79bb\u6563\u6839dr\uff08\u7537\uff09","text":"<p>\u4e3b\u8981\u95ee\u9898\uff1a\u79bb\u6563\u5bf9\u6570\\(discrete~logarithm\\)\uff08\u57fa\u7840\u7bc7+\u62d3\u5c55\u7bc7\uff09\uff0c\u79bb\u6563\u6839\\(discrete~roots\\)\uff08\u63d0\u9ad8\u7bc7\uff09</p> <p>BSGS\uff1a\u53ef\u4ee5 \\(x=\\log_a{b}\\pmod{P}\\) \u7684\u6700\u5c0f\u6700\u5c0f\u6b63\u6574\u6570\u89e3\uff0c\u590d\u6742\u5ea6\uff1a\\(O(\\sqrt{p})\\) </p> <ul> <li>\u57fa\u7840\u7bc7</li> </ul> <p></p> <p></p> <ul> <li>\u4e24\u79cd\u6a21\u677f\uff08\u9ed8\u8ba4\uff1a\\((a,p)=1\\)\uff09</li> </ul> <p>\\(O(\\sqrt{P})\\)</p> <pre><code>// vector\nint _bsgs(int a, int b, int p){\nif(!b) return 0;\nint sq = sqrt(p) + 1;\nvector&lt;pair&lt;int, int&gt;&gt; dec;\nfor(int i=1; i&lt;=sq; ++i) dec.push_back({fp(a, i * sq, p), i});\nsort(dec.begin(), dec.end());\nint x0 = INT_MAX;\nfor(int i=0; i&lt;sq; ++i){\nint my = fp(a, i, p) * b % p;\nauto it = lower_bound(dec.begin(), dec.end(), make_pair(my, 0ll));\nif(it != dec.end() &amp;&amp; it-&gt;first == my){\nx0 = min(x0, it-&gt;second * sq - i);\nbreak;\n}\n}\nreturn x0==INT_MAX ? -1 : x0;\n}\n// map\nint log(int a, int b){\nif(b == 1) return 0;\nint sq = sqrt(P) + 1;\nmap&lt;int, int&gt; T;\n// pr = a^t, t = 0..sq\nint pr = 1;\nfor(int t=0; t&lt;sq; ++t) T[b * pr % P] = t, pr = pr * a % P;\n// pr1 = (a^sq)^s\nint pr1 = 1;\nfor(int s=1; s&lt;=sq; ++s){\npr1 = pr1 * pr % P;\nif(T.count(pr1)) return s * sq - T[pr1];\n}\nreturn -1;\n}\n</code></pre> <ul> <li>\u8fdb\u9636\u7bc7</li> </ul> <p></p> <p></p> <p>\uff08\u5373\uff1a\\(x~\\%p,0\\le x\\le p-1\\) \u53ef\u4ee5\u8868\u793a\u4e3a \\(x ~\\equiv~ g^i~~\\%p, 0\\le i\\le p-1\\)\uff09</p> <p></p> <p></p> <p>\uff08\u53d6\u79bb\u6563\u5bf9\u6570\uff1f\uff09</p> <p></p> <ul> <li>\u6c42\u6240\u6709\u89e3\uff1a</li> </ul> <pre><code>int gcd(int a, int b){ return !b ? a : gcd(b, a % b); }\nint fp(int a, int n, int p){\nint ans = 1;\nwhile(n){\nif(n &amp; 1) ans = ans * a % p;\na = a * a % p;\nn &gt;&gt;= 1;\n}\nreturn ans;\n}\nint rt(int p){\nvector&lt;int&gt; fc;\nint phi = p-1, n = phi;\nfor(int i=2; i*i&lt;=n; ++i){\nif(n % i) continue;\nwhile(!(n % i)) n /= i;\nfc.push_back(i);\n}\nif(n &gt; 1) fc.push_back(n);\nfor(int ans=2; ans&lt;=p; ++ans){\nbool ok = true;\nfor(int fac : fc){\nif(fp(ans, phi / fac, p) == 1){\nok = false;\nbreak;\n}\n}\nif(ok) return ans;\n}\nreturn -1;\n}\nint ebg(int a, int b, int p){\nif(!b) return puts(\"1\\n0\"), 0;\nint g = rt(p);\n// bsgs discrete logarithm algorithm\nint sq = (int)sqrt(p + .0) + 1;\nvector&lt;pair&lt;int, int&gt;&gt; dec(sq);\nfor(int i=1; i&lt;=sq; ++i) dec[i-1] = {fp(g, a * i * sq % (p - 1), p), i};\nsort(dec.begin(), dec.end());\nint x0 = -1;\nfor(int i=0; i&lt;sq; ++i){\nint my = fp(g, a * i % (p - 1), p) * b % p;\nauto it = lower_bound(dec.begin(), dec.end(), make_pair(my, 0ll));\nif(it != dec.end() &amp;&amp; it-&gt;first == my){\nx0 = it-&gt;second * sq - i;\nbreak;\n}\n}\nif(x0 == -1) return puts(\"0\"), -1;\nint delta = (p - 1) / gcd(a, p - 1);\nvector&lt;int&gt; ans;\nfor(int cur = x0 % delta; cur &lt; p - 1; cur += delta) ans.push_back(fp(g, cur, p));\nsort(ans.begin(), ans.end());\ncout &lt;&lt; ans.size() &lt;&lt; '\\n';\nfor(int x : ans) cout &lt;&lt; x &lt;&lt; ' ';\ncout &lt;&lt; '\\n';\nreturn 1;\n}\n</code></pre> <ul> <li>\u6269\u5c55\u7bc7</li> </ul> <p></p> <p></p> <p>\\(exbsgs\\)\u5b9e\u73b0\uff08\u548c\u6734\u7d20\\(bsgs\\)\u53ea\u67093\u4e2a\u533a\u522b\uff09</p> <pre><code>int gcd(int a, int b){ return !b ? a : gcd(b, a % b); }\nint fp(int a, int n, int p){ int ans = 1; while(n){ if(n &amp; 1) ans = 1ll * ans * a % p; a = 1ll * a * a % p; n &gt;&gt;= 1; } return ans; }\nint exbsgs(int a, int b, int p){\nif(b == 1) return 0;\n// \u533a\u522b 1 \nlong long cnt = 0, k = 1, d;\nwhile((d = gcd(a, p)) &gt; 1){\nif(b % d) return -1;\nb /= d, p /= d;\n++ cnt, k = a / d * k % p;\nif(k == b) return cnt;\n}\nint sq = sqrt(p) + 1;\nunordered_map&lt;int, int&gt; dec;\nd = b;\nfor(int i=0; i&lt;sq; ++i){\ndec[d] = i;\nd = d * a % p;\n}\nint asq = fp(a, sq, p);\n// \u533a\u522b2\uff0cd\u521d\u59cb\u5316\u4e3a k\uff0c\u800c\u4e0d\u662f 1\nd = k;\nfor(int i=1; i&lt;=sq; ++i){\nd = d * asq % p;\n// \u533a\u522b3\uff0c\u7ed3\u679c\u52a0\u4e0a cnt \nif(dec.count(d)) return cnt + i * sq - dec[d];\n}\nreturn -1;\n}\n</code></pre> <ul> <li> <p>\u4f8b\u9898</p> </li> <li> <p>SPOJ.com - Problem MOD</p> </li> <li> <p>P3306 [SDOI2013] \u968f\u673a\u6570\u751f\u6210\u5668 - \u6d1b\u8c37 | \u8ba1\u7b97\u673a\u79d1\u5b66\u6559\u80b2\u65b0\u751f\u6001 (luogu.com.cn)</p> </li> <li> <p>Problem - 99999261 - Codeforces</p> </li> <li> <p>#10214. \u300c\u4e00\u672c\u901a 6.4 \u4f8b 6\u300d\u8ba1\u7b97\u5668 - \u9898\u76ee - LibreOJ (loj.ac)</p> </li> <li> <p>P4195 \u3010\u6a21\u677f\u3011\u6269\u5c55 BSGS/exBSGS - \u6d1b\u8c37 | \u8ba1\u7b97\u673a\u79d1\u5b66\u6559\u80b2\u65b0\u751f\u6001 (luogu.com.cn)</p> </li> <li> <p>Problem - F - Codeforces</p> </li> <li> <p>#6542. \u79bb\u6563\u5bf9\u6570 - \u9898\u76ee - LibreOJ (loj.ac) \uff08index calculus \u65b9\u6cd5\uff09</p> </li> </ul>"},{"location":"oiwiki-%E6%95%B0%E5%AD%A6/%E6%95%B0%E8%AE%BA3/","title":"\u6570\u8bba3","text":""},{"location":"oiwiki-%E6%95%B0%E5%AD%A6/%E6%95%B0%E8%AE%BA3/#1","title":"1\u3001\u83ab\u6bd4\u4e4c\u65af\u53cd\u6f14","text":"<ul> <li> <p>\u524d\u7f6e\u77e5\u8bc6\uff1a\u6570\u8bba\u5206\u5757\u3001\u72c4\u5229\u514b\u96f7\u5377\u79ef</p> </li> <li> <p>1\uff0c\u83ab\u6bd4\u4e4c\u65af\u51fd\u6570</p> </li> </ul> <p></p> <ul> <li> <ul> <li>\u6027\u8d281</li> </ul> </li> </ul> <p></p> <p>\uff08\\(\\epsilon_n=[n=1]\\)\uff09</p> <p></p> <p></p> <ul> <li> <ul> <li>\u7ed3\u8bba1\uff08\u5c06 \u6027\u8d281\u7684\\(\\epsilon_{(i,~j)}\\) \u5c55\u5f00\u5373\u53ef\uff09</li> </ul> </li> </ul> <p></p> <ul> <li> <p>2\uff0c\u7ebf\u6027\u7b5b\uff1a\u7565</p> </li> <li> <p>3\uff0c\u6b27\u62c9\u51fd\u6570\u7684\u6027\u8d28\uff1a</p> </li> </ul> <p></p> <p></p> <p>\uff08\u4e3a\u4ec0\u4e48\u53ea\u8981\u8bc1\u660e \\(n^{'}=p^c\\) \u7684\u60c5\u51b5\uff1f\uff09</p> <p></p> <p>\uff08\u8bc1\uff1a$\\phi *1 = id \\implies \\phi * 1 * \\mu = \\operatorname{id} * \\mu \\  \\implies \\phi * \\epsilon = \\operatorname{id} * \\mu \\implies \\phi = \\operatorname{id} * \\mu  $\uff09</p> <p>\uff08\u8bc1\\(\\operatorname{f} ~*~\\epsilon = \\operatorname{f}\\)\uff1a\\(\\operatorname{f} ~*~ \\epsilon = \\sum\\limits_{d|n}f_d \\times [\\frac{n}{d}=1] ~=~f_n ~=~ \\operatorname{f}\\)\uff09</p> <ul> <li>4\uff0c\u83ab\u6bd4\u4e4c\u65af\u53d8\u6362</li> </ul> <p></p> <ul> <li></li> </ul> <p></p> <p>\uff08\u9ece\u66fc\u51fd\u6570\uff1f\u72c4\u5229\u514b\u96f7\u751f\u6210\u51fd\u6570\uff1f\uff09</p> <ul> <li></li> </ul> <p>\u8bc1\u660e\uff1a</p> <p></p> <p></p> <p>\uff08\u5c31\u662f \u83ab\u6bd4\u4e4c\u65af \u6bd4\u8f83\u597d\u6b3a\u8d1f\u5457\uff09</p> <ul> <li> <p>5\uff0c\u95ee\u9898\u4e3e\u4f8b</p> </li> <li> <ul> <li>1\uff0cP2522 [HAOI2011]Problem b - \u6d1b\u8c37 | \u8ba1\u7b97\u673a\u79d1\u5b66\u6559\u80b2\u65b0\u751f\u6001 (luogu.com.cn)</li> </ul> </li> </ul> <p>\\(\u6c42\\displaystyle\\sum\\limits_{i=x}^{n}\\sum\\limits_{j=y}^{m}[\\gcd(i,j)=k]\\qquad (1\\leqslant T,x,y,n,m,k\\leqslant 5\\times 10^4)\\)</p> <p>$ = \\displaystyle\\sum\\limits_{i=1}{\\lfloor\\frac{n}{k}\\rfloor}\\sum\\limits_{j=1}{k}\\rfloor}[(i,j)=1]  = \\sum_{i=1}{\\lfloor\\frac{n}{k}\\rfloor}\\sum_{j=1}{k}\\rfloor}\\varepsilon((i,j)) =~ \\sum_{i=1}{\\lfloor\\frac{n}{k}\\rfloor}\\sum_{j=1}{k}\\rfloor}\\sum_{d\\mid \\gcd(i,j)}\\mu_d $</p> <p>$= \\displaystyle \\sum_{d=1}^{min{ \\lfloor\\frac{n}{k}\\rfloor,~\\lfloor\\frac{m}{k}\\rfloor }} \\mu_d\\times \\sum_{d | i}[i\\le min] \\times \\sum_{d | j}[j\\le min] $</p> <p>\uff08\u6216 \uff09</p> <p>\\(~=~ \\displaystyle\\sum_{d=1}^{\\min(\\lfloor \\frac{n}{k}\\rfloor,\\lfloor \\frac{m}{k}\\rfloor)}\\mu_d \\times \\lfloor\\frac{n}{kd}\\rfloor \\times \\lfloor\\frac{m}{kd}\\rfloor\\)</p> <p>( \u6ce8\u610f:\\(\\displaystyle\\lfloor\\frac{a}{b\\times c}\\rfloor ~=~ \\lfloor\\frac{\\lfloor \\frac{a}{b} \\rfloor}{c}\\rfloor\\)\uff0c\u56e0\u6b64 \\(n,m\\) \u53ef\u4ee5\u63d0\u524d \\(n/=k,m/=k\\) )</p> <p>\\(\u590d\u6742\u5ea6\uff1aO(n ~+~ \\sqrt{n/k}\\times T) = O(n ~+~ \\sqrt{n}\\times T)\\)</p> <pre><code>// \u4e24\u79cd\u5b9e\u73b0\u90fd\u662f\u53ef\u4ee5\u7684\nint block(int n, int m, int k){\nn /= k, m /= k;\nint ans = 0;\nfor(int lb = 1, ub; lb&lt;=min(n, m); lb = ub + 1){\nub = min(n / (n / lb), m / (m / lb));\nans += (ms[ub] - ms[lb-1]) * (n / lb) * (m / lb);\n}\nreturn ans;\n}\nint block1(int n, int m, int k){\nint ans = 0;\nfor(int lb = 1, ub; lb&lt;=min(n/k, m/k); lb = ub + 1){\nub = min(n / (n / lb), m / (m / lb));\nans += (ms[ub] - ms[lb-1]) * (n / (lb * k)) * (m / (lb * k));\n}\nreturn ans;\n}\n</code></pre> <ul> <li> <ul> <li>2\uff0cSPOJ.com - Problem LCMSUM</li> </ul> </li> </ul> <p>\\(\\displaystyle \\sum_{i=1}^n \\operatorname{lcm}(i,n)\\quad \\text{s.t.}\\ 1\\leqslant T\\leqslant 3\\times 10^5,1\\leqslant n\\leqslant 10^6\\)</p> <ul> <li> <ul> <li> <ul> <li>1\uff0c\\(\\phi_n\\) \u7684\u4e00\u4e2a\u6027\u8d28\uff08\u5bf9 \\(i=1..n\\) \u5185 \\((i,~n)\\)\u76f8\u540c\u7684\u6570\u8fdb\u884c\u5206\u7ec4\uff09\uff1a</li> </ul> </li> </ul> </li> </ul> <p>\\(\\displaystyle\\sum_{i=1}^n 1 ~=~ \\sum_{d|n}\\phi_{\\frac{n}{d}}\\times 1\\)</p> <p>\u6bd4\u5982\uff1a</p> <p>\\(\\displaystyle\\sum_{i=1}^n (i,~n)^k ~~=~~ \\sum_{d|n}\\phi_{\\frac{n}{d}}\\times d^k\\)</p> <p>\\(\\displaystyle\\sum_{i=1}^n \\frac{n^2}{(i,~n)} ~~=~~ \\sum_{d|n}\\frac{n^2\\times\\phi_{\\frac{n}{d}}}{d}\\)</p> <pre><code>// i=1..n, \u6309 d = (i, n) \u8fdb\u884c\u5206\u7ec4\uff0cd \u679a\u4e3e\u7684\u662f\u6700\u5c0f\u7684  \nmap&lt;int, vector&lt;int&gt;&gt; mp;\nfor(int i=1; i&lt;=100; ++i){\nint my = gcd(i, 100);\nmp[my].push_back(i);\n}\nfor(auto x : mp){\ncout &lt;&lt; x.first &lt;&lt; ' ' &lt;&lt; phi(100 / x.first) &lt;&lt; '\\n';\nfor(auto v : x.second) cout &lt;&lt; v &lt;&lt; ' ';\nputs(\"\\n\");\n}\n</code></pre> <ul> <li> <ul> <li> <ul> <li>2\uff0c\u53ef\u4ee5\u8bc1\u660e\u4e00\u4e2a\u5173\u4e8e\u7ebf\u6027\u7b5b\u79ef\u6027\u51fd\u6570\u7684\u7ed3\u8bba\uff1a\uff08\u7b5b\u5377\u79ef\uff09</li> </ul> </li> </ul> </li> </ul> <p>\u5bf9\u4e8e\u51fd\u6570\uff1a$f_n = \\sum\\limits_{d|n}d^x\\times \\phi_d \\ \\implies f_{i\\times p_j} [p_j |i] = f_i + (f_i - f_{\\frac{i}{p_j}})\\times p_j^{x+1},~ f_p = 1 + (p-1)\\times p^x  $</p> <p>\u8bc1\u660e\uff1a</p> <p>\u5f15\u74061\uff1a\u7ebf\u6027\u7b5b\u8981\u6c42 \\(f_{i\\times p_j} ~[p_j ~|~i]\\) \u65f6\uff0c\u8bbe \\(i ~=~ a\\times p_j^k,~k\\in N^+,~(a,~p_j)=1\\)\uff0c\u90a3\u4e48\\(i\\times p_j = a\\times p_j^{k+1}\uff0c\\frac{i}{p_j} = a\\times p_j^{k-1}\\) </p> <p>\\(\\displaystyle \\frac{f_{i\\times p_j} ~-~ f_{i}}{f_{i} ~~-~~ f_{\\frac{i}{p_j}}} ~=~ \\frac{f_a\\times (f_{p_j^{k+1}} ~-~ f_{p_j^{k}})}{f_a\\times (f_{p_j^{k}} ~~-~~ f_{p_j^{k-1}})} = \\frac{ f_{p_j^{k+1}} ~~-~~ f_{p_j^{k}}}{ f_{p_j^{k}} ~~-~~ f_{p_j^{k-1}}} \\qquad \u2460\\)</p> <p>\u82e5\u7b49\u5f0f\u53f3\u8fb9\u53ef\u4ee5\u6d88\u6389\uff0c\u5c06\u53f3\u8fb9\u8bb0\u4e3a\u51fd\u6570 \\(g_{p_j}\\)\uff0c\u5219\\(f_{i\\times p_j}\\) \u5373\u53ef\u901a\u8fc7\\(f_{i},~f_{\\frac{i}{p_j}},~g_{p_j}\\)\u6c42\u5f97</p> <p>\u5f15\u74062\uff1a$\\displaystyle f_{p^k} = \\sum\\limits_{d|pk}dx\\times \\phi_{d} \\overset{\u2460}= \\sum_{i=0}^k p^{i\\times x} \\times \\phi_{p^i} \\overset{\u2461}= \\sum_{i=0}^k p^{i\\times (x + 1)-1}\\times (p-1) \\ \\implies \\begin{cases} f_{p^{k+1}} - f_{p^k} = p^{(k+1)\\times(x+1)-1}\\times (p-1) \\  f_{p^{k}} - f_{p^{k-1}} = p^{k\\times(x+1)-1}\\times (p-1) \\end{cases} \\ \\implies \\frac{f_{p^{k+1}} - f_{pk}}{f_{p} - f_{p^{k-1}}} = p^{x+1}  $</p> <p>\u5c06\u4e0a\u5f0f\u4ee3\u5165\u5f15\u74061\u4e2d\u7684 \\(\u2460\\) \uff0c\u7a0d\u4f5c\u5316\u7b80\u5373\u5f97 \\(f_{i\\times p_j} = f_i ~~+~~ (f_i ~~-~~ f_{\\frac{i}{p_j}})\\times p_j^{x+1}\\)</p> <p>\u8bc1\u6bd5 \\(\\square\\)</p> <p>\u5f53 \\(x=0\\)  \u65f6\uff0c\\(f_n ~=~ \\sum\\limits_{d|n}\\phi_d\\)\uff0c\u7b5b \\(\\sum\\limits_{d|n}\\phi_d\\) \u4e4b\u540e\uff0c\u53ef\u4ee5\u53d1\u73b0 \\(f_n ~=~ n\\) \u6210\u7acb\uff0c\u4ee3\u7801\u5982\u4e0b\uff1a</p> <pre><code>#define int long long\nconst int N = 1e6+3;\nint p[N], idx, st[N];\nlong long f[N];\nvoid gp(int n){\nf[1] = 1;\nfor(int i=2; i&lt;=n; ++i){\nif(!st[i]) p[ ++ idx] = i, f[i] = 1ll + 1ll *  (i - 1) ;\nfor(int j=1; j&lt;=idx &amp;&amp; i * p[j]&lt;=n; ++j){\nst[i * p[j]] = true;\nf[i * p[j]] = i % p[j] ? f[i] * f[p[j]] :\nf[i] + (f[i] - f[i / p[j]]) * p[j] ;\nif(!(i % p[j])) break;\n}\n}\nfor(int i=1; i&lt;=10; ++i) cout &lt;&lt; f[i] &lt;&lt; '\\n';\n}\n</code></pre> <p>\u539f\u5f0f $\\displaystyle \\sum_{i=1}^n \\operatorname{lcm}(i,n) \\quad $ \u7684\u5316\u7b80\u5982\u4e0b\uff1a</p> <p>$\\displaystyle \\sum_{i=1}^n[i,~n] = \\sum_{i=1}^n \\frac{i\\times n}{(i,~n)} \\overset{\u2460}= \\frac12\\times(\\sum_{i=1}^{n-1}\\frac{i\\times n}{(i,~n)} + \\sum_{i=n-1}^{1}\\frac{i\\times n}{(i,~n)}) + n $</p> <p>\\(\\displaystyle ~\\overset{\u2461}=~ \\frac12\\times(\\sum_{i=1}^{n-1}\\frac{i\\times n}{(i,~~n)} ~+~~ \\sum_{i=n-1}^{1}\\frac{i\\times n}{(n-i,~~n)}) ~+~~ n\\)</p> <p>\\(\\displaystyle ~\\overset{\u2462}=~ \\frac{1}{2}\\cdot \\sum_{i=1}^{n-1}\\frac{n^2}{(i,n)}+n  ~~=~~ \\frac{1}{2}\\cdot \\sum_{i=1}^{n}\\frac{n^2}{(i,n)}+\\frac{n}{2} ~\\overset{\u2463}=~ \\frac{1}{2}\\cdot\\sum_{d\\mid n}\\frac{n^2\\cdot\\phi_{\\frac{n}{d}}}{d}+\\frac{n}{2}\\)</p> <p>\\(\\displaystyle  ~=~ \\frac{1}{2}n\\cdot\\left(\\sum_{d'\\mid n}d'\\cdot\\varphi(d')+1\\right)\\)</p> <p>\\(\u2460\\)\uff1a\u5c06\u539f\u5f0f\u590d\u5236\u4e00\u4efd\u5e76\u4e14\u98a0\u5012\u987a\u5e8f\uff0c\u7136\u540e\u5c06 n \u4e00\u9879\u5355\u72ec\u63d0\u51fa</p> <p>\\(\u2461\\)\uff1a\u6839\u636e \\(\\gcd(i,n)=\\gcd(n-i,n)\\)</p> <p>\\(\u2462\\)\uff1a\u4e24\u4e2a\u6c42\u548c\u5f0f\u4e2d\u5206\u6bcd\u76f8\u540c\u7684\u9879\u53ef\u4ee5\u5408\u5e76\u3002</p> <p>\\(\u2463\\)\uff1a\u5c06\u76f8\u540c\u7684 \\(\\gcd(i,n)\\) \u5408\u5e76\u5728\u4e00\u8d77\u8ba1\u7b97\uff0c\u6545\u53ea\u9700\u8981\u7edf\u8ba1 \\(\\gcd(i,n)=d\\) \u7684\u4e2a\u6570\u3002\u5f53 \\(\\gcd(i,n)=d\\) \u65f6\uff0c\\(\\displaystyle\\gcd(\\frac{i}{d},\\frac{n}{d})=1\\)\uff0c\u6240\u4ee5 \\(\\gcd(i,n)=d\\) \u7684\u4e2a\u6570\u6709 \\(\\displaystyle\\varphi(\\frac{n}{d})\\) \u4e2a\u3002\uff08\u5373\u201c\u5206\u7ec4\u6c42\u548c\u201d\u6216\u201c\u5206\u7ec4\u53d8\u6362\u201d\uff09</p> <p>\\(\\sum\\limits_{d|n}d\\times\\phi_d\\) \u53ef\u4ee5\u5728\u7ebf\u6027\u65f6\u95f4\u5185\u7b5b\u51fa\uff0c\u539f\u5f0f\u7684\u67e5\u8be2\u590d\u6742\u5ea6\u4e3a \\(O(1)\\)\uff0c\u5219\u603b\u590d\u6742\u5ea6\uff1a\\(O(n ~+~ T)\\) </p> <ul> <li> <ul> <li>3\uff0cP1829 [\u56fd\u5bb6\u96c6\u8bad\u961f]Crash\u7684\u6570\u5b57\u8868\u683c / JZPTAB - \u6d1b\u8c37 | \u8ba1\u7b97\u673a\u79d1\u5b66\u6559\u80b2\u65b0\u751f\u6001 (luogu.com.cn)</li> </ul> </li> </ul> <p>\u6c42\uff1a \\(\\displaystyle \\sum_{i=1}^n\\sum_{j=1}^m\\operatorname{lcm}(i,j)  \\pmod{20101009}\\qquad (n,m\\leqslant 10^7)\\)</p> <p>$\\displaystyle = \\sum_{i=1}n\\sum_{j=1}m\\frac{i\\cdot j}{(i,j)} = \\sum_{i=1}n\\sum_{j=1}m\\sum_{d\\mid i,d\\mid j,(\\frac{i}{d},\\frac{j}{d})=1}\\frac{i\\cdot j}{d}  \\ = \\sum_{d=1}^n d\\cdot\\sum_{i=1}{\\lfloor\\frac{n}{d}\\rfloor}\\sum_{j=1}{d}\\rfloor}[\\gcd(i,j)=1] i\\cdot j \\ \u8bb0\\operatorname{sum}(n,m)=\\sum_{i=1}n\\sum_{j=1}m [\\gcd(i,j)=1] i\\cdot j  \\ = \\sum_{d=1}^n\\sum_{d\\mid i}^n\\sum_{d\\mid j}^m\\mu(d)\\cdot i\\cdot j  = \\sum_{d=1}^n\\mu(d)\\cdot d2\\cdot\\sum_{i=1}{d}\\rfloor}\\sum_{j=1}^{\\lfloor\\frac{m}{d}\\rfloor}i\\cdot j \\   \u8bb0g(n,m)=\\sum_{i=1}n\\sum_{j=1}m i\\cdot j=\\frac{n\\cdot(n+1)}{2}\\times\\frac{m\\cdot(m+1)}{2} $</p> <p>\u4e00\u7ea7\u7ed3\u8bba\uff1a</p> <p>\\(\\displaystyle \\operatorname{sum}(n,m)=\\sum_{d=1}^n\\mu(d)\\cdot d^2\\cdot g(\\lfloor\\frac{n}{d}\\rfloor,\\lfloor\\frac{m}{d}\\rfloor) \\\\  ans ~=~ \\sum_{d=1}^n d\\cdot\\operatorname{sum}(\\lfloor\\frac{n}{d}\\rfloor,\\lfloor\\frac{m}{d}\\rfloor)\\)</p> <p>\u590d\u6742\u5ea6\uff1a\\(O(n)\u8fd8\u662fO(n^{\\frac{2}{3}})\uff1f\\)</p> <pre><code>#define int long long\nconst int N = 1e7+3, P = 20101009;\nint i2, i6;\nint inv(int n){ return n==1 ? 1 : (P - P / n) * inv(P % n) % P; }\nint s1(int n){ return n * (n + 1) % P * i2 % P; }\nint p[N], idx, st[N];\nint f[N];\nvoid gp(int n){\nf[1] = 1;\nfor(int i=2; i&lt;=n; ++i){\nif(!st[i]) p[ ++ idx] = i, f[i] = -1;\nfor(int j=1; p[j]&lt;=n/i; ++j){\nst[i * p[j]] = true;\nf[i * p[j]] = i % p[j] ? f[i] * f[p[j]] : 0;\nif(!(i % p[j])) break;\n}\n}\nfor(int i=1; i&lt;=n; ++i) f[i] = (f[i-1] + f[i] * i % P * i % P) % P;\n}\nint b1(int n, int m){\nint ans = 0;\nfor(int lb = 1, ub; lb &lt;= min(n, m); lb = ub + 1){\nub = min(n / (n / lb), m / (m / lb));\nans = (ans + (f[ub] - f[lb-1]) * s1(n / lb) % P * s1(m / lb) % P + P) % P;\n}\nreturn ans;\n}\nint b2(int n, int m){\nint ans = 0;\nfor(int lb = 1, ub; lb &lt;= min(n, m); lb = ub + 1){\nub = min(n / (n / lb), m / (m / lb));\nans = (ans + (s1(ub) - s1(lb-1)) * b1(n / lb, m / lb) % P + P) % P;\n}\nreturn ans;\n}\n</code></pre> <p>\u4e8c\u7ea7\u7ed3\u8bba\uff1a$\\sum\\limits_{t=1}^{min{n,~m}} S_1(\\frac{n}{t},~\\frac{m}{t}) \\times t\\times \\sum\\limits_{d|t}d \\times \\mu_d $</p> <pre><code>#define int long long\nconst int N = 1e7+3, P = 20101009;\nint i2;\nint inv(int n){ return n==1 ? 1 : (P - P / n) * inv(P % n) % P; }\nint s1(int n){ return n * (n + 1) % P * i2 % P; }\nint p[N], idx, st[N], f[N];\nvoid gp(int n){\nf[1] = 1;\nfor(int i=2; i&lt;=n; ++i){\nif(!st[i]) p[ ++ idx] = i, f[i] = (1 - i + P) % P;\nfor(int j=1; p[j]&lt;=n/i; ++j){\nst[i * p[j]] = true;\nf[i * p[j]] = i % p[j] ? f[i] * f[p[j]] % P : f[i];\nif(!(i % p[j])) break;\n}\n}\nfor(int i=1; i&lt;=n; ++i) f[i] = (f[i-1] + f[i] * i % P) % P;\n}\nint blk(int n, int m){\nint ans = 0;\nfor(int lb = 1, ub; lb &lt;=min(n, m); lb = ub + 1){\nub = min(n / (n / lb), m / (m / lb));\nans = (ans + (f[ub] - f[lb - 1]) * s1(n / lb) % P * s1(m / lb) % P + P) % P;\n}\nreturn ans;\n}\n</code></pre> <ul> <li> <ul> <li>4\uff0c#2185. \u300cSDOI2015\u300d\u7ea6\u6570\u4e2a\u6570\u548c - \u9898\u76ee - LibreOJ (loj.ac)</li> </ul> </li> </ul> <p>\u6c42\uff1a\\(\\displaystyle \\sum_{i=1}^n\\sum_{j=1}^md(i\\cdot j)\\\\ \\left(d(n)=\\sum_{i \\mid n}1\\right) n,m,T\\leq5\\times10^4\\)</p> <pre><code>#define int long long\nconst int N = 1e5+3;\nint p[N], idx, st[N], num[N], d[N], mu[N];\nvoid gp(int n){\nnum[1] = d[1] = mu[1] = 1;\nfor(int i=2; i&lt;=n; ++i){\nif(!st[i]) p[ ++ idx] = i, num[i] = 2, d[i] = 2, mu[i] = -1;\nfor(int j=1; p[j]&lt;=n/i; ++j){\nst[i * p[j]] = true;\nnum[i * p[j]] = i % p[j] ? 2 : num[i] + 1;\nd[i * p[j]] = i % p[j] ? d[i] * d[p[j]] : d[i] / num[i] * (num[i] + 1);\nmu[i * p[j]] = i % p[j] ? mu[i] * mu[p[j]] : 0;\nif(!(i % p[j])) break;\n}\n}\nfor(int i=1; i&lt;=n; ++i) d[i] = (d[i-1] + d[i]);\nfor(int i=1; i&lt;=n; ++i) mu[i] = (mu[i-1] + mu[i]);\n}\nint blk(int n, int m){\nint ans = 0;\nfor(int lb = 1, ub; lb &lt;= min(n, m); lb = ub + 1){\nub = min(n / (n / lb), m / (m / lb));\nans += (mu[ub] - mu[lb-1]) * d[n / lb] * d[m / lb];\n}\nreturn ans;\n}\n</code></pre> <ul> <li>\u83ab\u6bd4\u4e4c\u65af\u53cd\u6f14\u6269\u5c55</li> </ul> <p></p>"},{"location":"oiwiki-%E6%95%B0%E5%AD%A6/%E6%95%B0%E8%AE%BA3/#2","title":"2\uff0c\u675c\u6559\u7b5b","text":"<p>\u6ce8\u610f\u70b9\uff1a</p> <p>1\uff0c\u675c\u6559\u7b5b\u524d\u5fc5\u987b\u7528\u7ebf\u6027\u7b5b\u9884\u5904\u7406</p> <p>2\uff0c\u7ebf\u6027\u7b5b \u548c \\(map\\) \u7684\u8bb0\u5fc6\u5316</p> <p>3\uff0c\u6ce8\u610f\u533a\u5206\u666e\u901a\u7684\u5206\u5757\uff1a</p> <p>\\(ans\\) \u521d\u59cb\u5316\u4e3a \\(\\sum\\limits_{i=1}^n \\sum\\limits_{d|i}f_d\\times g_{\\frac{i}{d}}\\) \uff1b\\(lb\\) \u7684\u4e0b\u9650\u4e3a \\(2\\) \uff1b\\(ans ~-=~ ..\\) \u7684\u5f62\u5f0f</p> <p>4\uff0c\u5c06 \\(i2,~i6,~s1(),~s2(),~s3()\\) \u9884\u5904\u7406\u51fa\u6765\uff0c\u6c42\u548c\u51fd\u6570 \\(s\\)  \u52a1\u5fc5\u5148\u5bf9 \\(n\\)  \u53d6\u6a21\uff08\u56e0\u4e3a\u675c\u6559\u7b5b\u9762\u5bf9\u7684\u662f\u5927\u6570\u636e\uff0c\u975e\u5e38\u5bb9\u6613\u6ea2\u51fa\uff09</p> <p>5\uff0c\u675c\u6559\u7b5b\u7684\u4f7f\u7528\u8303\u56f4\uff1a\u4e00\u822c\u53ef\u4ee5\u7b5b \\(\\sum\\limits_{i=1}^n i^k \\times \\phi_i\\)\uff0c\\(\\sum\\limits_{i=1}^n i^k \\times \\mu_i\\)\uff0c\\(\\sum\\limits_{i=1}^n i^k \\times \\phi_i \\times g_{\\frac{n}{i}}\\)\uff1b\u53ef\u4ee51\u79d2\u5185\u7b5b \\(1e9\\) \u7684\u6570\u636e</p> <ul> <li>\u201d\u996d\u524d\u751c\u70b9\u201c</li> </ul> <p>\\(\\begin{cases} \\epsilon~*~1=\\epsilon \\\\ 1~*~1=d \\\\ id~*~1=\\sigma \\\\ \\mu~*~1=\\epsilon \\\\ \\phi~*~1=id \\\\ \\phi~*~1~*~1=\\sigma \\\\ id~*~\\mu=\\phi \\end{cases}\\)</p> <ul> <li>\u675c\u6559\u7b5b\uff08\u590d\u6742\u5ea6\\(O(N^{\\frac{2}{3}} \\to N^{\\frac{3}{4}})\\)\uff09</li> </ul> <p>\uff08\\(\u4e00\u822c\u7ebf\u6027\u7b5b\u7b5b\u81f35e6\u80fd\u83b7\u53d6\u6700\u5927\u6548\u7387\\)\uff09</p> <p>\u675c\u6559\u7b5b\u88ab\u7528\u6765\u5904\u7406\u6570\u8bba\u51fd\u6570\u7684\u524d\u7f00\u548c\u95ee\u9898\u3002\u5bf9\u4e8e\u6c42\u89e3\u4e00\u4e2a\u524d\u7f00\u548c\uff0c\u675c\u6559\u7b5b\u53ef\u4ee5\u5728\u4f4e\u4e8e\u7ebf\u6027\u65f6\u95f4\u7684\u590d\u6742\u5ea6\u5185\u6c42\u89e3</p> <p></p> <p>\\(\\displaystyle\\sum_{i=1}^{n}\\sum_{d \\mid i}g(d)f\\left(\\frac{i}{d}\\right)=\\sum_{i=1}^{n}g(i)S\\left(\\left\\lfloor\\frac{n}{i}\\right\\rfloor\\right)\\\\ \\iff \\sum_{i=1}^{n}(f\\ast g)(i)=\\sum_{i=1}^{n}g(i)S\\left(\\left\\lfloor\\frac{n}{i}\\right\\rfloor\\right)\\)</p> <p></p> <p></p>"},{"location":"oiwiki-%E6%95%B0%E5%AD%A6/%E6%95%B0%E8%AE%BA3/#3powerful-number","title":"3\uff0cPowerful Number \u7b5b","text":"<ul> <li>\u6d89\u53ca\u77e5\u8bc6\uff1a\u7ebf\u6027\u7b5b\uff0c\uff08\u675c\u6559\u7b5b(\u53ef\u80fd\u7528\u5230)\uff09\uff0c\u679a\u4e3e\u8d28\u6570\u6784\u9020 \\(powerfulnumber\\)</li> </ul> <ul> <li>Powerful Number</li> </ul> <ul> <li>PN \u7b5b</li> </ul> <p>\u5177\u4f53\u6b65\u9aa4\u5982\u4e0b\uff1a</p> <ul> <li> <ul> <li>\u82e5\u51fd\u6570\u7ed9\u5b9a \\(f_{p^{j}}\\) \u7684\u8ba1\u7b97\u516c\u5f0f\uff0c\u5e76\u53ef\u4ee5\u4fdd\u8bc1 \\(f_1 = 1\\) \uff0c\\(f_{a\\times b} = f_a \\times f_b~~[(a,~b) ~=~ 1]\\)\uff0c\u5219\u53ef\u4ee5\u8003\u8651 \\(pn\u7b5b\\)</li> </ul> </li> <li> <ul> <li>\u6784\u9020\u51fd\u6570 \\(g\\) \u6ee1\u8db3 \\(g_p = f_p\\) \uff08 \\(g\\) \u7684\u524d\u7f00\u548c \\(gs\\) \u53ef\u4ee5 \u675c\u6559\u7b5b \u6216 \\(O(1)\\) \u6c42\uff09</li> </ul> </li> <li> <ul> <li>\u6784\u9020\u51fd\u6570 \\(h\\) \u6ee1\u8db3 $h = f/g $ \uff08\u72c4\u5229\u514b\u96f7\u5377\u79ef\u9664\u6cd5\uff09\uff0c\u5373 \\(f ~=~ g * h\\)\uff0c\u800c $h_1 = 1, f_p = g_1\\times h_p + g_p\\times h_1 = h_p + g_p \\implies h_p=0\uff0c\u53c8 h\u662f\u79ef\u6027\u51fd\u6570 \\ \\implies h \u4ec5\u5728 pn \u5904\u53ef\u80fd\u975e\u96f6 \\ \uff08\u8bc1\uff1a\\displaystyle f_n = f_{\\prod\\limits_{i=1}^k p_i^{a_i}} ~= \\prod_{i=1}^k f_{p_i^{a_i}}, \u4ec5\u5f53 a_i \\ge 2\u65f6 f_n\\ne 0\uff0c\u5f97\u8bc1\uff09   $</li> </ul> </li> <li> <ul> <li>\u91cd\u8981\u516c\u5f0f1\uff1a $\\displaystyle f = h * g \\implies fs_n = \\sum\\limits_{x=1,~xisPN}^n h_x\\times gs_{\\lfloor\\frac{n}{x}\\rfloor} $ </li> </ul> </li> <li> <ul> <li>\u675c\u6559\u7b5b \u6216 \u76f4\u63a5\u8ba1\u7b97 \\(gs\\) </li> </ul> </li> <li> <p>\u7528 \\(dfs\\) \u6784\u9020 \\(pn\\) \uff08\u4ee3\u7801\u4e2d$pn = x\\times p_i^j = nx,~h_{pn} = h_{x\\times p_i^j} = h_x\\times h_{p_i^j} = h\\times h_{p_i^j} $\uff0c\u5373 \\(h_{p_i^j}\u9700\u8981\u516c\u5f0f\u63a8\u5bfc\uff08\u5173\u4e8ef_{p_i^j}\u7684\u51fd\u6570\uff09\u6216\u66b4\u529b\u6c42\\)\uff09</p> </li> <li> <p>\u91cd\u8981\u516c\u5f0f2\uff1a$\\displaystyle f = h * g \\implies f_{p^j} = \\sum_{k=0}^j h_{p^{j-k}}\\times g_{p^{k}} \\implies h_{p^j} = f_{p^j} - \\sum_{k=1}^j h_{p^{j-k}}\\times g_{p^k} $</p> </li> </ul> <p>\u590d\u6742\u5ea6\u5206\u6790\uff1a</p> <p>\u2460 \\(1..n\\) \u5185\u7684\u7d20\u6570\u6709 \\(O(\\frac{\\sqrt{N}}{logN})\\) \u4e2a\uff0c\u6bcf\u4e2a\u7d20\u6570\u7684\u6307\u6570c\u6709 \\(O(logN)\\) \u4e2a\uff0c\u8ba1\u7b97 \\(h_{p^j}\\) \u9700\u8981\u5faa\u73af \\(O(logN)\\) \u6b21\uff0c\u8be5\u90e8\u5206\u590d\u6742\u5ea6\u4e3a \\(O(\\sqrt{N}\\times logN)\\)</p> <p>\u2461 \u641c\u7d22 \\(gs\\) \u7684\u90e8\u5206\uff1a\\(1..n\\) \u5185\u7684 \\(pn\\) \u6709 \\(O(\\sqrt n)\\) \u4e2a\uff0c\u82e5 \\(gs\\) \u80fd \\(O(1)\\) \u6c42 \\(\\implies O(\\sqrt n)\\) \uff1b</p> <p>\\(gs\\) \u7528 \u675c\u6559\u7b5b\u6c42 $\\implies O(n^{\\frac{2}{3}}) $</p> <p>\u6a21\u677f\u9898\uff1aProblem - F - Codeforces - Flipped Factorization\uff08\\(n=1e14\\)\uff09</p> <p>\u9898\u610f\uff1a$\\displaystyle f_n = f_{\\prod\\limits_{i=1}^k p_i^{a_i}} \\overset{\u2460}= \\prod_{i=1}^k f_{p_i^{a_i}} = \\prod_{i=1}^k {a_i}{p_i}\uff0c\u6c42\\sum\\limits_{i=1}n f_i \\ \\implies f_{{p_i}^j} =    j^{p_i} \\ 1)~~ j=1\u65f6\uff0cf_{p_i} = 1\uff0c\u6545 \u8bbe g = 1\uff0c\u5219gs = id  \\ 2)~~ \u63a8\u5bfch_{p^j}\uff1a f_{p^j} = \\sum_{k=0}^j h_{p^{j-k}}\\times g_{p^{k}} =  \\sum_{k=0}^j h_{p^{j-k}} \\implies f_{p^j} - f_{p^{j-1}} = h_{p^j} \\ \u2460\u79ef\u6027\u51fd\u6570\u7684\u6709\u5173\u6027\u8d28   $</p> <pre><code>int n, ans;\nvoid dfs(int x, int h, int pos){\n// \u7d2f\u8ba1\u8d21\u732e \nans = (ans + h * (n / x % P) % P) % P;\nfor(int i=pos; i&lt;=idx; ++i){\n// \u526a\u679d \nif(p[i] * p[i] &gt; n / x) return ;\nint nx = x * p[i];\nfor(int j=2; nx &lt;= n / p[i]; ++j){\nnx *= p[i];\n// \u8ba1\u7b97 h(nx) = h(x * pi^j) = h(x) * h(pi^j)\uff0c\u53ef\u4ee5\u76f4\u63a5\u63a8 h(pi^j)\uff0c\u4e5f\u53ef\u4ee5\u76f4\u63a5\u7b97 \n// tips: nx \u5c31\u662f\u4e00\u4e2a powerful number \nint nh = h * (fp(j, p[i]) - fp(j - 1, p[i]) + P) % P;\ndfs(nx, nh, i + 1);\n}\n}\n}\n</code></pre> <ul> <li> <p>\u4f8b\u9898\uff1a</p> </li> <li> <ul> <li>P5325 \u3010\u6a21\u677f\u3011Min_25\u7b5b - \u6d1b\u8c37 | \u8ba1\u7b97\u673a\u79d1\u5b66\u6559\u80b2\u65b0\u751f\u6001 (luogu.com.cn)</li> </ul> </li> </ul> <p></p> <p>\uff08\u7ebf\u6027\u7b5b + \u675c\u6559\u7b5b + pn\u7b5b\uff09\uff08\u2460 \u4ee4 \\(g=id*\\phi\\)\uff0c\u7528\u675c\u6559\u7b5b\u6c42 \\(gs\\) \uff1b\u2461 \u53ef\u4ee5\u63a8\u51fa\uff1a \\(h_{p^j ~=~ (p-1)\\times(j-1)\\times p^j}\\) \uff0c\u4ee3\u7801\u4e2d \\(p^j = nx / x\\)\uff09</p> <pre><code>#include&lt;iostream&gt;\n#include&lt;unordered_map&gt;\nusing namespace std;\n#define int long long\nconst int N = 5e6+3, P = 1e9+7;\nint i2, i6;\nint inv(int n){ return n == 1 ? 1 : (P - P / n) * inv(P % n) % P; }\nint s1(int n){ n %= P; return n * (n + 1) % P * i2 % P; }\nint s2(int n){ n %= P; return n * (n + 1) % P * i6 % P * (2 * n + 1) % P; }\nint p[N], idx, st[N], g[N];\nvoid init(int n){\ni2 = inv(2), i6 = inv(6);\ng[1] = 1;\nfor(int i=2; i&lt;=n; ++i){\nif(!st[i]) p[ ++ idx] = i, g[i] = i - 1;\nfor(int j=1; p[j] &lt;= n/i; ++j){\nst[i * p[j]] = true;\ng[i * p[j]] = i % p[j] ? g[i] * g[p[j]] : g[i] * p[j];\nif(!(i % p[j])) break;\n}\n}\nfor(int i=1; i&lt;=n; ++i) g[i] = (g[i-1] + g[i] * i % P) % P;\n}\nunordered_map&lt;int, int&gt; GS;\nint gs(int n){\nif(n &lt; N) return g[n];\nif(GS[n]) return GS[n];\nint ans = s2(n);\nfor(int lb = 2, ub; lb &lt;= n; lb = ub + 1){\nub = n / (n / lb);\nans -= (s1(ub) - s1(lb - 1)) * gs(n / lb) % P;\nans = (ans % P + P) % P;\n}\nreturn GS[n] = ans;\n}\n// \u516c\u5f0f\u63a8 h(p^j)\nint n, ans;\nvoid dfs(int x, int h, int pos){\nans = (ans + h % P * gs(n / x) % P) % P;\nfor(int i=pos; i&lt;=idx; ++ i){\nif(x &gt; n / p[i] / p[i]) return ;\nint nx = x * p[i];\nfor(int j=2; p[i] * nx &lt;= n; ++j){\nnx *= p[i];\nint nh = h % P * (j - 1) % P * (p[i] - 1) % P * (nx / x) % P;\ndfs(nx, nh, i + 1);\n}\n}\n}\n// \u66b4\u529b\u63a8 h(p^j)\nint n, ans;\nint hp[N][66];\nvoid dfs(__int128 x, __int128 h, int pos){\nans = (ans + h % P * gs(n / x) % P + P) % P;\nfor(int i=pos; i&lt;=idx; ++ i){\nif(x &gt; n / p[i] / p[i]) return ;\nint nx = x * p[i];\nfor(int j=2; p[i] * nx &lt;= n; ++j){\nnx *= p[i];\nif(!hp[i][j]){\nint hh = (nx / x) * (nx / x - 1) % P;\nint g = p[i] * (p[i] - 1) % P, t = p[i] * p[i] % P;\nfor(int k=1; k&lt;=j; ++k){\nhh = (hh - hp[i][j-k] * g % P) % P;\nif(hh &lt; 0) hh += P;\ng = g * t % P;\n}\nhp[i][j] = hh;\n}\ndfs(nx, h * hp[i][j] % P, i + 1);\n}\n}\n}\nsigned main(){\ninit(N - 1);\ncin &gt;&gt; n;\nans = 0;\ndfs(1, 1, 1);\ncout &lt;&lt; ans &lt;&lt; '\\n';\n}\n</code></pre> <ul> <li> <ul> <li>#6053. \u7b80\u5355\u7684\u51fd\u6570 - \u9898\u76ee - LibreOJ (loj.ac)</li> </ul> </li> <li> <ul> <li>PE708 Twos are all you need</li> </ul> </li> <li> <ul> <li> <ul> <li>PE639 Summing a multiplicative function</li> </ul> </li> </ul> </li> <li> <ul> <li> <ul> <li>PE484 Arithmetic Derivative</li> </ul> </li> </ul> </li> </ul>"},{"location":"oiwiki-%E6%95%B0%E5%AD%A6/%E6%95%B0%E8%AE%BA3/#4min_25","title":"4\uff0cmin_25\u7b5b","text":""},{"location":"oiwiki-%E6%95%B0%E5%AD%A6/%E6%A6%82%E7%8E%87%E8%AE%BA/","title":"\u6982\u7387\u8bba","text":"<p>\\(\u5145\u5206 \\implies \u5fc5\u8981\\)</p> <p>\u6982\u7387\u5206\u5e03\u3001\u5bc6\u5ea6\u51fd\u6570</p> <p>\u671f\u671b\u3001\u5206\u5e03\u51fd\u6570</p>"},{"location":"oiwiki-%E6%95%B0%E5%AD%A6/%E7%94%9F%E6%88%90%E5%87%BD%E6%95%B0/","title":"\u751f\u6210\u51fd\u6570","text":""},{"location":"oiwiki-%E6%95%B0%E5%AD%A6/%E7%94%9F%E6%88%90%E5%87%BD%E6%95%B0/#1","title":"1\uff0c\u751f\u6210\u51fd\u6570\u7b80\u4ecb","text":"<p>\u751f\u6210\u51fd\u6570\uff08generating function\uff09\uff0c\u53c8\u79f0\u6bcd\u51fd\u6570\uff0c\u662f\u4e00\u79cd\u5f62\u5f0f\u5e42\u7ea7\u6570\uff0c\u5176\u6bcf\u4e00\u9879\u7684\u7cfb\u6570\u53ef\u4ee5\u63d0\u4f9b\u5173\u4e8e\u8fd9\u4e2a\u5e8f\u5217\u7684\u4fe1\u606f\u3002</p> <p>\u751f\u6210\u51fd\u6570\u6709\u8bb8\u591a\u4e0d\u540c\u7684\u79cd\u7c7b\uff0c\u4f46\u5927\u591a\u53ef\u4ee5\u8868\u793a\u4e3a\u5355\u4e00\u7684\u5f62\u5f0f\uff1a</p> <p>\\(\\displaystyle F_x ~=~ \\sum_{n}a_n\\times k_{n,~x}\\)</p> <p>\u5176\u4e2d \\(k_{n,~x}\\) \u88ab\u79f0\u4e3a\u6838\u51fd\u6570\u3002\u4e0d\u540c\u7684\u6838\u51fd\u6570\u4f1a\u5bfc\u51fa\u4e0d\u540c\u7684\u751f\u6210\u51fd\u6570\uff0c\u62e5\u6709\u4e0d\u540c\u7684\u6027\u8d28\u3002\u4e3e\u4e2a\u4f8b\u5b50\uff1a</p> <ul> <li> <p>1\uff0c\u666e\u901a\u751f\u6210\u51fd\u6570 \\(OGF\\)\uff1a$\\displaystyle OGF_x = \\sum\\limits_{i}a_i\\times k_{i,~x} = \\sum\\limits_{i}a_i\\times x^{i} $</p> </li> <li> <p>2\uff0c\u6307\u6570\u751f\u6210\u51fd\u6570 \\(EGF\\)\uff1a$\\displaystyle EGF_x = \\sum\\limits_{i}a_i\\times k_{i,x} ~= \\sum\\limits_{i}a_i\\times \\frac{x^i}{i!} $</p> </li> <li> <p>3\uff0c\u72c4\u5229\u514b\u96f7\u751f\u6210\u51fd\u6570 \\(DGF\\)\uff1a\\(\\displaystyle EGF_x ~~=~~ \\sum\\limits_{i}a_i\\times k_{i,~~x} ~=~~ \\sum\\limits_{i}a_i\\times \\frac{1}{i^x}\\)</p> </li> </ul> <p>\u53e6\u5916\uff0c\u5bf9\u4e8e\u751f\u6210\u51fd\u6570 \\(F_x\\) \uff0c\u6211\u4eec\u7528\u00a0\\([k_{n,~x}]F_x\\)\u00a0\u6765\u8868\u793a\u5b83\u7684\u7b2c\u00a0\\(n\\)\u00a0\u9879\u7684\u6838\u51fd\u6570\u5bf9\u5e94\u7684\u7cfb\u6570\uff0c\u4e5f\u5c31\u662f\u00a0\\(a_n\\)\u3002</p>"},{"location":"oiwiki-%E6%95%B0%E5%AD%A6/%E7%94%9F%E6%88%90%E5%87%BD%E6%95%B0/#2","title":"2\uff0c\u7b26\u53f7\u5316\u65b9\u6cd5","text":"<p>\u7b26\u53f7\u5316\u65b9\u6cd5\uff08\\(symbolic~method\\)\uff09\u662f\u5c06\u7ec4\u5408\u5bf9\u8c61\u5feb\u901f\u8f6c\u6362\u6210\u751f\u6210\u51fd\u6570\u7684\u4e00\u79cd\u65b9\u6cd5\uff0c\u6211\u4eec\u5c06\u8003\u8651\u5bf9\u4e8e\u96c6\u5408\u4e0a\u5b9a\u4e49\u7684\u7279\u5b9a\u8fd0\u7b97\uff0c\u7136\u540e\u5bfc\u51fa\u5176\u5bf9\u5e94\u7684\u751f\u6210\u51fd\u6570\u7684\u8fd0\u7b97\u3002</p> <p></p> <ul> <li>\u65e0\u6807\u53f7\u4f53\u7cfb</li> </ul> <p></p> <p>\uff08\u4e0d\u8ba8\u8bba \u53ef\u5bb9\u8bb8\u6027 \\(admissibility\\)\uff0c\u53ef\u53c2\u8003  Analytic Combinatorics \u7684\u7b2c\u4e00\u7ae0\uff09</p> <p>\u4e24\u79cd\u7279\u6b8a\u7684\u7ec4\u5408\u7c7b \u548c \u7ec4\u5408\u5bf9\u8c61</p> <ul> <li> <ul> <li>\u4e2d\u6027\u5bf9\u8c61 \\(neutral~object\\) \u8bb0\u4f5c \\(\\epsilon\\)\uff0c\u5176\u5927\u5c0f\u4e3a0\uff1b\u4e2d\u6027\u7c7b \\(neutral~class\\) \u8bb0\u4f5c \\(\\mathcal{E} ~=~ \\{\\epsilon \\}\\)\uff0c\u5176OGF\u4e3a \\(E(z) ~=~ 1\\)</li> </ul> </li> <li> <ul> <li>\u539f\u5b50\u5bf9\u8c61 \\(atom~object\\) \u8bb0\u4f5c \\(\\circ \u6216 \\bullet\\) \uff0c\u5176\u5927\u5c0f\u4e3a1\uff1b\u539f\u5b50\u7c7b \\(atom~class\\) \u8bb0\u4f5c $\\mathcal{Z_{\\circ}} = {\\circ} \u6216 \\mathcal{Z_{\\bullet}} = {\\bullet} \u6216 \\mathcal{Z} $\uff0c\u5176OGF\u4e3a \\(Z(z) ~=~ z\\)</li> </ul> </li> </ul> <p>\u5bf9\u4e8e\u4e24\u4e2a\u7ec4\u5408\u7c7b \\(\\mathcal{A}\\) \u548c \\(\\mathcal{B}\\) \u5728\u7ec4\u5408\u610f\u4e49\u4e0a\u540c\u6784\u4e3a \\(\\mathcal{A=B}\\) \u6216 \\(\\mathcal{A\\cong B}\\)\uff0c\u4f46\u4ec5\u5f53\u8be5\u540c\u6784\u4e0d\u5e73\u51e1\u65f6\u624d\u4f7f\u7528\u540e\u8005\u7684\u8bb0\u53f7</p> <p>\uff08\u7ec4\u5408\u7c7b\uff1f\u7ec4\u5408\u5bf9\u8c61\uff1f\u540c\u6784\uff1f\u4e0d\u5e73\u51e1\uff1f\uff09</p> <p>\u6211\u4eec\u6709\uff1a \\(\\mathcal{A}\\cong\\mathcal{E}\\times \\mathcal{A}\\cong\\mathcal{A}\\times\\mathcal{E}\\)</p> <p>\uff08\u5176\u4e2d \\(\\times\\) \u4e3a\u4e8c\u5143\u8fd0\u7b97\uff0c\u8868\u793a\u96c6\u5408\u7684\u7b1b\u5361\u5c14\u79ef\uff09</p> <ul> <li>1\uff0c\u00a0\u96c6\u5408\u7684\uff08\u4e0d\u76f8\u4ea4\uff09\u5e76\u6784\u9020</li> </ul> <p>\u5bf9\u4e8e\u7c7b \\(\\mathcal{A}\\) \u548c \\(\\mathcal{B}\\) \u7684\u5e76\u8bb0\u4e3a\uff1a\\(\\mathcal{A}+\\mathcal{B}=(\\mathcal{E}_{1}\\times\\mathcal{A})+(\\mathcal{E}_2\\times\\mathcal{B})\\)</p> <p></p> <p>\u5bf9\u5e94\u7684OGF\u4e3a\uff1a \\(A(z)+B(z)\\)</p> <p>\u8003\u8651 \\(A(z)+B(z)=\\sum _ {\\alpha\\in\\mathcal{A}}z^{\\lvert \\alpha\\rvert} + \\sum _ {\\beta\\in\\mathcal{B}}z^{\\lvert \\beta\\rvert}=\\sum_{n\\geq 0}(a_n+b_n)z^n\\)</p> <p>\uff08\u5bf9\u5e94\u5f62\u5f0f\u5e42\u7ea7\u6570\u7684\u52a0\u6cd5\uff09</p> <ul> <li>2\uff0c\u96c6\u5408\u7684\u7b1b\u5361\u5c14\u79ef\u6784\u9020</li> </ul> <p>\u5bf9\u4e8e\u7c7b \\(\\mathcal{A}\\) \u548c \\(\\mathcal{B}\\) \u7684\u7b1b\u5361\u5c14\u79ef\u8bb0\u4e3a\uff1a\\(\\mathcal{A}\\times \\mathcal{B}=\\left\\lbrace (\\alpha, \\beta)\\mid \\alpha \\in \\mathcal{A},\\beta\\in\\mathcal{B}\\right\\rbrace\\)</p> <p>\u5bf9\u5e94 OGF \u4e3a\uff1a\\(A(z)\\cdot B(z)\\)</p> <p>\u6211\u4eec\u5b9a\u4e49 \\((\\alpha,~\\beta)\\) \u7684\u5927\u5c0f\u4e3a\u5176\u7ec4\u6210\u90e8\u5206\u7684\u5927\u5c0f\u4e4b\u548c\uff0c\u90a3\u4e48\u663e\u7136\u4e5f\u6709\uff1a\\(\\gamma =(\\alpha_1,\\alpha_2,\\dots ,\\alpha_n)\\implies \\lvert \\gamma\\rvert =\\lvert \\alpha_1\\rvert +\\lvert \\alpha_2\\rvert +\\cdots +\\lvert \\alpha_n\\rvert\\)</p> <p>\u6240\u4ee5\uff1a\\(\\displaystyle A(z)\\cdot B(z)=\\left(\\sum _ {\\alpha\\in\\mathcal{A}}z^{\\lvert \\alpha\\rvert}\\right)\\left(\\sum _ {\\beta\\in\\mathcal{B}}z^{\\lvert \\beta\\rvert}\\right)=\\sum _ {(\\alpha, \\beta)\\in(\\mathcal{A}\\times \\mathcal{B})}z^{\\lvert \\alpha\\rvert +\\lvert \\beta\\rvert}=\\sum_{n\\geq 0}\\sum_{i+j=n}a_ib_jz^n\\)</p> <p>\uff08\u5bf9\u5e94\u5f62\u5f0f\u5e42\u7ea7\u6570\u7684\u4e58\u6cd5\uff09</p> <ul> <li>3\uff0c\u96c6\u5408\u7684 Sequence \u6784\u9020</li> </ul> <p></p> <p></p> <p></p> <p></p> <p>\uff08\u5f00\u6446\uff01\uff01\u5929\u4e66\uff01\uff01\uff1f\uff09</p> <ul> <li>4\uff0c\u96c6\u5408\u7684 Multiset \u6784\u9020</li> </ul> <p></p> <p></p> <p></p> <p></p> <ul> <li> <ul> <li>#6268. \u5206\u62c6\u6570 - \u9898\u76ee - LibreOJ (loj.ac)</li> </ul> </li> <li> <p>P4389 \u4ed8\u516c\u4e3b\u7684\u80cc\u5305 - \u6d1b\u8c37 | \u8ba1\u7b97\u673a\u79d1\u5b66\u6559\u80b2\u65b0\u751f\u6001 (luogu.com.cn)</p> </li> <li> <p>P5900 \u65e0\u6807\u53f7\u65e0\u6839\u6811\u8ba1\u6570 - \u6d1b\u8c37 | \u8ba1\u7b97\u673a\u79d1\u5b66\u6559\u80b2\u65b0\u751f\u6001 (luogu.com.cn)</p> </li> </ul> <p>s</p> <ul> <li>5\uff0c\u96c6\u5408\u7684 Powerset \u6784\u9020</li> </ul>"},{"location":"oiwiki-%E6%95%B0%E5%AD%A6/%E7%BA%BF%E6%80%A7%E4%BB%A3%E6%95%B0/","title":"\u7ebf\u6027\u4ee3\u6570","text":""},{"location":"oiwiki-%E6%95%B0%E5%AD%A6/%E7%BA%BF%E6%80%A7%E4%BB%A3%E6%95%B0/#1","title":"1\uff0c\u5411\u91cf","text":"<p>\u5b9a\u4e49</p> <p>\u5411\u91cf\u7684\u7ebf\u6027\u8fd0\u7b97\uff08\u52a0\u3001\u51cf\u3001\u6570\u4e58\uff09</p> <p>\u5e73\u9762\u5411\u91cf\u57fa\u672c\u5b9a\u7406 \u53ca \u5750\u6807\u8868\u793a</p> <p>\u5e73\u9762\u5411\u91cf\u7684\u5750\u6807\u8fd0\u7b97</p> <p>\u5411\u91cf\u7684\u6570\u91cf\u79ef</p> <ul> <li>1\uff0c\u5b9a\u4e49</li> </ul> <p></p> <ul> <li> <ul> <li>\u5411\u91cf\uff1a\u65e2\u6709\u5927\u5c0f\u53c8\u6709\u65b9\u5411\u7684\u91cf\u3002\u6570\u5b66\u4e0a\u7814\u7a76\u7684\u5411\u91cf\u4e3a \u81ea\u7531\u5411\u91cf\uff0c\u5373\u53ea\u8981\u4e0d\u6539\u53d8\u5b83\u7684\u5927\u5c0f\u548c\u65b9\u5411\uff0c\u8d77\u70b9\u548c\u7ec8\u70b9\u53ef\u4ee5\u4efb\u610f\u5e73\u884c\u79fb\u52a8\u7684\u5411\u91cf\u3002\u8bb0 \\(\\vec a\\) \u6216 $ \\boldsymbol{a}$</li> </ul> </li> <li> <ul> <li>\u6709\u5411\u7ebf\u6bb5\uff1a\u5e26\u6709\u65b9\u5411\u7684\u7ebf\u6bb5\u79f0\u4e3a\u6709\u5411\u7ebf\u6bb5\u3002\u6709\u5411\u7ebf\u6bb5\u6709\u4e09\u8981\u7d20\uff1a\u8d77\u70b9\uff0c\u65b9\u5411\uff0c\u957f\u5ea6\uff0c\u77e5\u9053\u4e86\u4e09\u8981\u7d20\uff0c\u7ec8\u70b9\u5c31\u552f\u4e00\u786e\u5b9a\u3002\u6211\u4eec\u7528\u6709\u5411\u7ebf\u6bb5\u8868\u793a\u5411\u91cf\u3002</li> </ul> </li> </ul> <p></p> <ul> <li> <ul> <li>\u96f6/\u5355\u4f4d/\u5e73\u884c/\u76f8\u7b49/\u76f8\u53cd \u5411\u91cf</li> </ul> </li> </ul> <p></p> <p></p> <p></p> <p></p> <p></p> <p>-__- </p> <p></p> <p>\uff08 \\(\\angle~\\)\uff0c\\(~\\langle a,~b\\rangle\\)\uff0c\\(\\perp\\) \uff0c \uff09</p> <p>\uff08\u6ce8\u610f\u5230\u5e73\u9762\u5411\u91cf\u5177\u6709\u65b9\u5411\u6027\uff0c\u6211\u4eec\u5e76\u4e0d\u80fd\u6bd4\u8f83\u4e24\u4e2a\u5411\u91cf\u7684\u5927\u5c0f\uff08\u4f46\u53ef\u4ee5\u6bd4\u8f83\u4e24\u5411\u91cf\u7684\u6a21\u957f\uff09\u3002\u4f46\u662f\u4e24\u4e2a\u5411\u91cf\u53ef\u4ee5\u76f8\u7b49\u3002\uff09</p> <ul> <li> <p>2\uff0c\u5411\u91cf\u7684\u7ebf\u6027\u8fd0\u7b97\uff08\u52a0\u3001\u51cf\u3001\u6570\u4e58\uff09</p> </li> <li> <ul> <li>\u52a0\u51cf\u6cd5</li> </ul> </li> </ul> <p>\u52a0\u6cd5\uff1a</p> <p></p> <p></p> <p>\u53ef\u4ee5\u9a8c\u8bc1\uff0c\u5411\u91cf\u7684\u52a0\u6cd5\u6ee1\u8db3 \u4ea4\u6362\u5f8b\u4e0e\u7ed3\u5408\u5f8b</p> <p>\u51cf\u6cd5\uff1a</p> <p></p> <p></p> <p></p> <ul> <li> <ul> <li>\u5411\u91cf\u7684\u6570\u4e58</li> </ul> </li> </ul> <p></p> <p></p> <p></p> <p></p> <ul> <li> <ul> <li>\u5224\u5b9a\u4e24\u5411\u91cf\u5171\u7ebf</li> </ul> </li> </ul> <p></p> <ul> <li> <p>3\uff0c\u5e73\u9762\u5411\u91cf\u57fa\u672c\u5b9a\u7406 \u53ca \u5750\u6807\u8868\u793a</p> </li> <li> <ul> <li>1\uff0c\u5e73\u9762\u5411\u91cf\u57fa\u672c\u5b9a\u7406</li> </ul> </li> </ul> <p></p> <p></p> <p></p> <ul> <li> <ul> <li>2\uff0c\u5e73\u9762\u5411\u91cf\u7684\u5750\u6807\u8868\u793a</li> </ul> </li> </ul> <p></p> <p></p> <ul> <li> <p>4\uff0c\u5e73\u9762\u5411\u91cf\u7684\u5750\u6807\u8fd0\u7b97</p> </li> <li> <ul> <li>1\uff0c\u5e73\u9762\u5411\u91cf\u7684\u7ebf\u6027\u8fd0\u7b97</li> </ul> </li> </ul> <p></p> <p></p> <ul> <li> <ul> <li>2\uff0c\u6c42\u5411\u91cf\u7684\u5750\u6807\u8868\u793a</li> </ul> </li> </ul> <p></p> <ul> <li> <ul> <li>3\uff0c\u5e73\u79fb\u4e00\u70b9</li> </ul> </li> </ul> <p></p> <ul> <li> <ul> <li>4\uff0c\u4e09\u70b9\u5171\u7ebf\u7684\u5224\u5b9a</li> </ul> </li> </ul> <p></p> <ul> <li>5\uff0c\u5411\u91cf\u7684\u6570\u91cf\u79ef</li> </ul> <p></p> <p>\uff08\u6211\u4eec\u53d1\u73b0\uff0c\u8fd9\u79cd\u8fd0\u7b97\u5f97\u5230\u7684\u7ed3\u679c\u662f\u4e00\u4e2a\u5b9e\u6570\uff0c\u4e3a\u6807\u91cf\uff0c\u5e76\u4e0d\u5c5e\u4e8e\u5411\u91cf\u7684\u7ebf\u6027\u8fd0\u7b97\uff09</p> <p>\u5e94\u7528\uff1a</p> <p>\u5224\u5b9a\u4e24\u5411\u91cf\u5782\u76f4\uff1a$\\vec a \\perp \\vec b \\iff \\vec a \\cdot \\vec b = 0 $</p> <p>\u5224\u5b9a\u4e24\u5411\u91cf\u5171\u7ebf\uff1a$\\vec{a}=\\lambda\\times\\vec{b} \\iff |\\vec{a}\\cdot\\vec{b}| = |\\vec{a}|\\cdot|\\vec{b}| $</p> <p>\u6570\u91cf\u79ef\u7684\u5750\u6807\u8fd0\u7b97\uff1a\u82e5 \\(\\boldsymbol a=(m,n),\\boldsymbol b=(p,q),\\)  \u5219 \\(\\boldsymbol a\\cdot \\boldsymbol b=mp+nq\\)</p> <p>\u5411\u91cf\u7684\u6a21\uff1a\\(|\\boldsymbol a|=\\sqrt {m^2+n^2}\\)</p> <p>\u4e24\u5411\u91cf\u7684\u5939\u89d2\uff1a\\(\\cos \\theta=\\cfrac{\\boldsymbol a\\cdot\\boldsymbol b}{|\\boldsymbol a||\\boldsymbol b|}\\)</p> <ul> <li> <p>6\uff0c\u6269\u5c55</p> </li> <li> <ul> <li>1\uff0c\u5411\u91cf \u4e0e \u77e9\u9635</li> </ul> </li> </ul> <p></p> <ul> <li> <ul> <li>2\uff0c\u5411\u91cf\u79ef</li> </ul> </li> </ul> <p></p> <p>\uff08\u53f3\u624b\u6cd5\u5219\uff1a\u5148\u6253\u5f00\u624b\u638c\uff0c\\(x\u8f74\u6b63\u65b9\u5411\\) \u4e3a\u56db\u6307\u7684\u6307\u5411\uff0c\\(z\u8f74\u6b63\u65b9\u5411\\) \u4e3a\u624b\u638c\u5e73\u9762\u5185\u4e0e\u56db\u6307\u5782\u76f4\u7684\u65b9\u5411\uff0c\u800c \\(y\u8f74\u6b63\u65b9\u5411\\) \u7531 \\(x\u8f74\u6b63\u65b9\u5411\\) \u9006\u65f6\u9488\u8f6c \\(90\\degree\\) \u5f97\u5230\uff09</p> <p>\uff08\u7531\u4e8e\u5411\u91cf\u79ef\u6d89\u53ca\u5230\u7a7a\u95f4\u51e0\u4f55\u4e0e\u7ebf\u6027\u4ee3\u6570\u77e5\u8bc6\uff0c\u6240\u4ee5\u5e76\u672a\u5728\u9ad8\u4e2d\u8bfe\u672c\u4e2d\u51fa\u73b0\uff09</p> <p>\u51e0\u4f55\u610f\u4e49\uff1a</p> <p>\\(|\\boldsymbol a\\times \\boldsymbol b|\\) \u662f\u4ee5\u00a0\\(\\boldsymbol a,\\boldsymbol b\\)\u00a0\u4e3a\u90bb\u8fb9\u7684\u5e73\u884c\u56db\u8fb9\u5f62\u7684\u9762\u79ef</p> <p></p> <p>\uff08\u7a7a\u95f4\u5411\u91cf \\((a,~b,~0)\\times(c,~d,~0) ~=~ (0,~0,~a\\times d-b\\times c)\\)  \uff1f\uff1f  \uff09</p> <ul> <li> <ul> <li>3\uff0c\u5411\u91cf\u65cb\u8f6c</li> </ul> </li> </ul> <p>\u8bbe \\(\\boldsymbol a=(x,y)\\)\uff0c\u503e\u89d2\u4e3a\\(\\theta\\) \uff0c\u957f\u5ea6\u4e3a \\(l=\\sqrt{x^2+y^2}\\)\u3002\u5219 \\(x=l\\cos \\theta,y=l\\sin\\theta\\)\u3002\u4ee4\u5176\u9006\u65f6\u9488\u65cb\u8f6c \\(\\alpha\\) \u5ea6\u89d2\uff0c\u5f97\u5230\u5411\u91cf \\(\\boldsymbol b=(l\\cos(\\theta+\\alpha),l\\sin(\\theta+\\alpha))\\)</p> <p>$\\vec b =(l\\times\\cos(\\theta+\\alpha),~l\\times\\sin(\\theta+\\alpha)) \\ \\quad =(l\\times\\cos{\\theta}\\times\\cos{\\alpha}-l\\times\\sin{\\theta}\\times\\sin{\\alpha},l\\times\\sin{\\theta}\\times\\cos{\\alpha}+l\\times\\cos{\\theta}\\times\\sin{\\alpha})  \\ \\quad=(x\\times\\cos{\\alpha}-y\\times\\sin{\\alpha},~y\\times\\cos{\\alpha}+x\\times\\sin{\\alpha}) $</p> <ul> <li> <p>7\uff0c\u6781\u5750\u6807 \u4e0e \u6781\u5750\u6807\u7cfb</p> </li> <li> <ul> <li>\u4efb\u610f\u89d2 \u4e0e \u5f27\u5ea6\u5236</li> </ul> </li> </ul> <p></p> <p></p> <p></p> <p>\uff08\\(\u5f27\u5ea6~=~ \\displaystyle \\frac{\u5f27\u957f}{\u534a\u5f84}\\)\uff09</p> <p></p> <p></p>"},{"location":"oiwiki-%E6%95%B0%E5%AD%A6/%E7%BA%BF%E6%80%A7%E4%BB%A3%E6%95%B0/#2","title":"2\uff0c\u77e9\u9635\uff08\u5f85\u8865\uff08\u6811\u7684\u90e8\u5206\uff09\uff09","text":"<p>\uff08\u5e38\u7cfb\u6570\u9f50\u6b21\u9012\u63a8\uff1fohhhhhh\uff09</p> <p>__</p> <ul> <li>\u6027\u8d28</li> </ul> <p>\u77e9\u9635\u7684\u9006\uff1a</p> <p></p> <ul> <li>\u8fd0\u7b97</li> </ul> <p>\u77e9\u9635\u7684\u52a0\u51cf\u6cd5\u662f\u9010\u4e2a\u5143\u7d20\u8fdb\u884c\u7684</p> <ul> <li> <ul> <li>\u77e9\u9635\u4e58\u6cd5</li> </ul> </li> </ul> <p></p> <p></p> <p></p> <p></p> <ul> <li> <p>\u5e94\u7528</p> </li> <li> <ul> <li>1\uff0c\u52a0\u901f\u9012\u63a8</li> </ul> </li> </ul> <p>\u53ea\u9700\u8981\u77e5\u9053 \u521d\u59cb\u5411\u91cf \u548c \u9012\u63a8\u77e9\u9635 \\(M\\) \u5c31\u53ef\u4ee5\u4e86</p> <p>\uff08\u6709\u65f6\u5019\u521d\u59cb\u5411\u91cf\u8f83\u96be\u6784\u9020\uff1b\uff09</p> <p>\uff08warning\uff1a \u77e9\u9635\u7ef4\u6570\u5fc5\u987b \\(N \\le 500\\) \uff09</p> <p>(17\u6761\u6d88\u606f) \u77e9\u9635\u5feb\u901f\u5e42\u4e60\u9898_cheng__yu_\u7684\u535a\u5ba2-CSDN\u535a\u5ba2</p> <p>\u300c\u5b66\u4e60\u7b14\u8bb0\u300d\u77e9\u9635\u5feb\u901f\u5e42 - cyhyyds - \u535a\u5ba2\u56ed (cnblogs.com)</p> <p>1\uff0cP1962 \u6590\u6ce2\u90a3\u5951\u6570\u5217 - \u6d1b\u8c37 | \u8ba1\u7b97\u673a\u79d1\u5b66\u6559\u80b2\u65b0\u751f\u6001 (luogu.com.cn)</p> <p></p> <p>\u6839\u636e \\((f_{n+1},~f_{n}) ~=~ (f_{n},~f_{n-1})\\times M\\) \u6784\u9020\u77e9\u9635 \\(M\\)</p> <p>\u6613\u5f97\uff1a\\(\\left[\\begin{array}{ccc} 1 &amp; 1 \\\\ 1 &amp; 0 \\end{array}\\right]\\)</p> <p>\uff08\u6784\u9020\u987a\u5e8f\uff1a\u6309\u987a\u5e8f\u5bf9 \\(M\\) \u7684\u6bcf\u4e00\u5217\u8fdb\u884c\u6784\u9020\uff09</p> <p>\uff08\u8fd9\u9898\u53ef\u4ee5\u4f5c\u4e3a\u677f\u5b50\uff09</p> <pre><code>#include&lt;bits/stdc++.h&gt;\nusing namespace std;\n#define no(u) memset(u, 0, sizeof u)\n#define int long long\nconst int P = 1e9+7;\n// 1\uff1a\u77e9\u9635\u5927\u5c0f\n#define N 2\nvoid mul(int a[N][N], int b[N][N]){\nint ans[N][N] = {};\nfor(int i=0; i&lt;N; ++i) for(int j=0; j&lt;N; ++j) for(int k=0; k&lt;N; ++k)\nans[i][j] = (ans[i][j] + a[i][k] * b[k][j] % P) % P;\n//  \u5982\u679c\u7528 sizeof a \u7b49\u7740\u89c1\u960e\u7f57\u738b\u5427\uff01\uff01\uff08a[]\u4f5c\u4e3a\u53c2\u6570\u4f20\u9001\u4f1a\u51fa\u9519\uff09\nmemcpy(a, ans, sizeof ans);\n}\n// 2\uff1a\u521d\u59cb\u5411\u91cf (f2, f1)\nint st[N] = {1, 1};\nint fp(int n){        // (fn, f(n-1)) = (f2, f1) \\times M^(n-2)\n//  3\uff1a\u9012\u63a8\u77e9\u9635 M\nint a[N][N] = {{1, 1}, {1, 0}};\nint ans[N][N]= {};\nfor(int i=0; i&lt;N; ++i) ans[i][i] = 1;\nwhile(n &gt; 0){\nif(n &amp; 1) mul(ans, a);\nmul(a, a);\nn &gt;&gt;= 1;\n}\nint ret = 0;\nfor(int i=0; i&lt;N; ++i) ret = (ret + st[i] * ans[i][0] % P) % P;\nreturn ret;\n}\nsigned main(){\nint n;\nwhile(cin &gt;&gt; n){\ncout &lt;&lt; fp(n-2) &lt;&lt; '\\n';\n}\n}\n</code></pre> <p>2\uff0cP1349 \u5e7f\u4e49\u6590\u6ce2\u90a3\u5951\u6570\u5217 - \u6d1b\u8c37 | \u8ba1\u7b97\u673a\u79d1\u5b66\u6559\u80b2\u65b0\u751f\u6001 (luogu.com.cn)</p> <p></p> <p>\\(st = (f_2,~f_1) = (1,~1)\\) </p> <p>\\(M = \\begin{bmatrix}p &amp; 1\\\\ q &amp; 0\\end{bmatrix}\\)</p> <p>3\uff0cP1939 \u3010\u6a21\u677f\u3011\u77e9\u9635\u52a0\u901f\uff08\u6570\u5217\uff09 - \u6d1b\u8c37 | \u8ba1\u7b97\u673a\u79d1\u5b66\u6559\u80b2\u65b0\u751f\u6001 (luogu.com.cn)</p> <p></p> <p>\\(st = (f_3,~~f_2,~~f_1) = (1,~~1,~~1)\\)</p> <p>\\(M = \\begin{bmatrix} 1 &amp; 1 &amp; 0\\\\ 0 &amp; 0 &amp; 1 \\\\ 1 &amp; 0 &amp; 0 \\end{bmatrix}\\)</p> <p>4\uff0c\\(\\begin{gathered} f_{1} = f_{2} = 0\\\\ f_{n} = 7f_{n-1}+6f_{n-2}+5n+4\\times 3^n \\end{gathered}\\)</p> <p>\u8fd9\u662f\u4e2a\u7ed3\u5408\u4e86 1\u6b21\u591a\u9879\u5f0f \u548c \u5e42\u51fd\u6570 \u7684\u9012\u63a8\u5f0f</p> <p>\uff08\u7ef4\u6570 = 2 + 2 + 1 = 5\u7ef4\uff08n\u6b21\u591a\u9879\u5f0f\u5bf9\u7ef4\u6570\u7684\u8d21\u732e\u662fn+1\uff09\uff09</p> <p>\\(F_n := (f_n,~~f_{n-1},~~n,~~3^n,~~1)\\) \uff0c\\(F_n\\times M ~=~ F_{n+1}\\)</p> <p>\\(st = F_2 = (f_2,~~f_1,~~2,~~9,~~1) = (0,~~0,~~2,~~9,~~1)\\)</p> <p>\\(M = \\begin{bmatrix} 7 &amp; 1 &amp; 0 &amp; 0 &amp; 0 \\\\ 6 &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\\\ 5 &amp; 0 &amp; 1 &amp; 0 &amp; 0 \\\\ 12 &amp; 0 &amp; 0 &amp; 3 &amp; 0 \\\\ 5 &amp; 0 &amp; 1 &amp; 0 &amp; 1 \\end{bmatrix}\\)</p> <p>5\uff0c2019\u725b\u5ba2\u7b2c\u4e94\u573a B. generator 1</p> <p> \u5341\u8fdb\u5236\u77e9\u9635\u5feb\u901f\u5e42</p> <pre><code>#include&lt;bits/stdc++.h&gt;\nusing namespace std;\n#define int long long\n#define N 2\nint P;\nvoid mul(int a[N][N], int b[N][N]){\nint ans[N][N] = {};\nfor(int i=0; i&lt;N; ++i) for(int j=0; j&lt;N; ++j) for(int k=0; k&lt;N; ++k)\nans[i][j] = (ans[i][j] + a[i][k] * b[k][j] % P) % P;\nmemcpy(a, ans, sizeof ans);\n}\nint st[N], m[N][N];\nint fp(string n){\nint a[N][N] = {};\nmemcpy(a, m, sizeof m);\nint ans[N][N] = {};\nfor(int i=0; i&lt;N; ++i) ans[i][i] = 1;\n// \u6838\u5fc3\nfor(int i=n.size()-1; i&gt;=0; --i){\nint cnt = n[i] - '0';\nfor(int j=0; j&lt;cnt; ++j) mul(ans, a);\nint tmp[N][N] = {{1, 0}, {0, 1}};\nfor(int j=0; j&lt;10; ++j) mul(tmp, a);\nmemcpy(a, tmp, sizeof tmp);\n}\nint ret = 0;\nfor(int i=0; i&lt;N; ++i) ret = (ret + st[i] * ans[i][1] % P) % P;\nreturn ret;\n}\nsigned main(){\nstring n;\ncin &gt;&gt; st[1] &gt;&gt; st[0] &gt;&gt; m[0][0] &gt;&gt; m[1][0];\ncin &gt;&gt; n &gt;&gt; P;\nfor(int i=1; i&lt;N; ++i) m[i-1][i] = 1;\n// n = n-1\n//    int i = n.size()-1;\n//    while(n[i] == '0') -- i;\n//    if(!i &amp;&amp; n[i] == '1') n.erase(0, 1);\n//    else -- n[i];\n//    int j = i + 1;\n//    while(j &lt; n.size()) n[j] = '9', ++ j;\ncout &lt;&lt; fp(n) &lt;&lt; '\\n';\n}\n</code></pre> <p>6\uff0c3233 -- Matrix Power Series (poj.org)</p> <p>\u975e\u5e38\u6076\u5fc3\u4e4b\u77e9\u9635\u5206\u5757\u4e58\u6cd5</p> <p>7\uff0cProblem - 2276 (hdu.edu.cn)</p> <p>\u8f83\u597d\u7684\u601d\u7ef4\u9898</p> <p>\u7ed9\u5b9a01\u5e8f\u5217 \\(F=[f_0,~f_2,~...,~f_{n-1}]\\)\uff0c\\(F\\) \u7ecf\u8fc7\u4e00\u6b21\u53d8\u6362\u540e\uff0c\u82e5 \\(f_{(i-1)\\%n}=1\\) \uff0c\u5219 \\(f_i\\) \u7f6e\u53cd</p> <p>\u5982\uff1a\\(\\displaystyle 0101111\\implies 1111000\\)</p> <p>\u8ba8\u8bba\u6700\u7b80\u5355\u7684\u5f62\u5f0f\uff1a\\(\\begin{bmatrix} \\dots &amp; f_1 &amp; f_2 &amp; \\dots \\end{bmatrix}\\times \\begin{bmatrix} \\vdots \\\\ a \\\\ b \\\\ \\vdots \\end{bmatrix} \\equiv (f_1\\otimes a)\\oplus(f_2\\otimes b) = f'_2\\)</p> <p>\uff08\u4e0a\u9762\u7684\u5217\u5411\u91cf\u662f \\(M\\) \u4e2d\u7684\u4e00\u90e8\u5206\uff0c\\(f'_2\\) \u5373\u9700\u8981\u6c42\u7684 \\(f_2\\) \u8f6c\u6362\u540e\u72b6\u6001\uff09</p> <p>\uff08\u6ce8\u610f\uff1a\\(\\equiv\\) \u540e\u9762\u7684\u90e8\u5206\u8868\u793a\u901a\u8fc7\u5b9a\u4e49 \\(\\otimes\\) \u548c \\(\\oplus\\) \u8fd0\u7b97\uff0c\u4e00\u4e9b\u591a\u4f59\u7684\u90e8\u5206\u7684\u5bf9\u503c\u6ca1\u6709\u8d21\u732e\uff09</p> <p>\u5982\u679c\u5bf9 \\(f_1,~f_2,~f'_2\\) \u8fdb\u884c\u771f\u503c\u8868\u7684\u89c2\u5bdf\u53d1\u73b0 \\(f_1 \\bigoplus f_2 = f'_2\\) \uff08\\(\\bigotimes\\)\u6307\u5f02\u6216\uff09</p> <p>\u5b9a\u4e49\uff1a\\(\\oplus = \\bigoplus\\)\uff0c \\(\\otimes = \\&amp;\\) </p> <p>\u81ea\u7136\u5730\uff0c\u9012\u63a8\u77e9\u9635 \\(M = \\begin{bmatrix} 1 &amp; 1 &amp; 0 &amp; \\dots &amp; 0 \\\\ 0 &amp; 1 &amp; 1 &amp; \\dots &amp; 0 \\\\ 0 &amp; 0 &amp; 1 &amp; \\dots &amp; 0 \\\\ &amp; \\vdots &amp; &amp; \\vdots \\\\ 0 &amp; 0 &amp; 0 &amp; \\dots &amp; 1 \\\\ 1 &amp; 0 &amp; 0 &amp; \\dots &amp; 1 \\end{bmatrix}\\) </p> <pre><code>#include&lt;bits/stdc++.h&gt;\nusing namespace std;\n#define N 100\n#define mc(u, v) memcpy(u, v, sizeof v)\nint n;\nvoid mul(int a[N][N], int b[N][N]){\nint ans[N][N] = {};\nfor(int i=0; i&lt;n; ++i) for(int j=0; j&lt;n; ++j) for(int k=0; k&lt;n; ++k)\nans[i][j] ^= a[i][k] &amp; b[k][j];\nmc(a, ans);\n}\nint st[N], m[N][N];\nvoid fp(int k){\nint a[N][N] = {}; mc(a, m);\nint ans[N][N] = {}; mc(ans, m);\n-- k;\nwhile(k){\nif(k &amp; 1) mul(ans, a);\nmul(a, a);\nk &gt;&gt;= 1;\n}\nint ret[N] = {};\nfor(int i=0; i&lt;n; ++i) for(int j=0; j&lt;n; ++j) ret[i] ^= st[j] &amp; ans[j][i];\nfor(int i=0; i&lt;n; ++i) cout &lt;&lt; ret[i];\ncout &lt;&lt; '\\n';\n}\nint main(){\nint k;\nstring s;\nwhile(cin &gt;&gt; k &gt;&gt; s){\nmemset(st, 0, sizeof st);\nmemset(m, 0, sizeof m);\nfor(int i=0; i&lt;s.size(); ++i) st[i] = s[i] - '0';\nn = s.size();\nfor(int i=0; i&lt;n; ++i) m[i][i] = m[(i-1+n)%n][i] = 1;\nfp(k);\n}\n}\n</code></pre> <p>8\uff0cProblem - E - Codeforces\uff08\u597d\u9898\uff09</p> <p></p> <p>\\(f_{n} = f_{n-1}\\times f_{n-2}\\times f_{n-3}\\times c^{2\\times n-6}\\)</p> <p>\\(f_n := f_1^{F_{1,~n}}\\times f_2^{F_{2,~n}}\\times f_3^{F_{3,~n}}\\times c^{F_{4,~n}}\\)</p> <p>\uff08\\(F_{i,~n}\\) \u5206\u522b\u8868\u793a \\(f_n\\) \u4e2d \\(f_1,~f_2,~f_3,~c\\) \u7684\u5e42\u6b21\uff09</p> <p>\u56e0\u6b64\uff0c\u8ba1\u7b97\u51fa \\(F_{1,~n},~F_{2,~n},~F_{3,~n},~F_{4,~n}\\) \u5373\u53ef\u5f97\u5230\u7b54\u6848\uff1a</p> <p>1\uff09\\(F_{i,~n} = F_{i,~n-1} + F_{i,~n-2} + F_{i,~n-3}\uff0ci=1..3\\) </p> <p>\u6b64\u5f62\u5f0f\u53ef\u4ee5\u7528\u77e9\u9635\u5feb\u901f\u5e42</p> <p>\uff08\u4e09\u4e2a\u8d21\u732e\u5206\u522b\u6765\u81ea\u4e8e \\(f_{n-1}\uff0c f_{n-2}\uff0c f_{n-3}\\)\uff09</p> <p>\\(\\begin{bmatrix}F_{i,~n} &amp; F_{i,~{n-1}} &amp; F_{i,~{n-2}}\\end{bmatrix}\\times M_i = \\begin{bmatrix}F_{i,~~{n+1}} &amp; F_{i,~~{n}} &amp; F_{i,~{n-1}}\\end{bmatrix}\\)</p> <p>\\(M_i = \\begin{bmatrix}1 &amp; 1 &amp; 0 \\\\ 1 &amp; 0 &amp; 1 \\\\ 1 &amp; 0 &amp; 0\\end{bmatrix}\uff0ci=1..3\\)</p> <p>\\(\\because f_1 = f_1^1\\times f_2^0\\times f_3^0 \\\\ f_2 = f_1^0\\times f_2^1\\times f_3^0 \\\\ f_3 = f_1^0\\times f_2^0\\times f_3^1\\)</p> <p>\\(\\therefore st_1 = \\begin{bmatrix}F_{1,~~3} &amp; F_{1,~~{2}} &amp; F_{1,~{1}}\\end{bmatrix} = \\begin{bmatrix}0 &amp; 0 &amp; 1\\end{bmatrix}\\)</p> <p>\\(st_2 = \\begin{bmatrix}F_{2,~~3} &amp; F_{2,~~{2}} &amp; F_{2,~{1}}\\end{bmatrix} = \\begin{bmatrix}0 &amp; 1 &amp; 0\\end{bmatrix}\\)</p> <p>\\(st_3 = \\begin{bmatrix}F_{3,~~3} &amp; F_{3,~~{2}} &amp; F_{3,~{1}}\\end{bmatrix} = \\begin{bmatrix}1 &amp; 0 &amp; 0\\end{bmatrix}\\)</p> <p>2\uff09\\(F_{4,~n} = F_{4,~~n-1} + F_{4,~~n-2} + F_{4,~n-3} + 2\\times n-6\\)</p> <p>\\(\\begin{bmatrix}F_{i,~~n} &amp; F_{i,~~{n-1}} &amp; F_{i,~{n-2}} &amp; n &amp; 1\\end{bmatrix}\\times M_4 = \\begin{bmatrix}F_{i,~~{n+1}} &amp; F_{i,~~{n}} &amp; F_{i,~{n-1}} &amp; n &amp; 1\\end{bmatrix}\\)</p> <p>\\(M_4 = \\begin{bmatrix}1 &amp; 1 &amp; 0 &amp; 0 &amp; 0\\\\ 1 &amp; 0 &amp; 1 &amp; 0 &amp; 0 \\\\ 1 &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\\\ 2 &amp; 0 &amp; 0 &amp; 1 &amp; 0 \\\\ -4 &amp; 0 &amp; 0 &amp; 1 &amp; 1\\end{bmatrix}\\)</p> <p>\\(st_4 = \\begin{bmatrix}0 &amp; 0 &amp; 0 &amp; 3 &amp; 1\\end{bmatrix}\\)</p> <p>\uff08\\(F_{i,~n}\\) \u5f88\u5927\uff0c\u6240\u4ee5\u8981\u6b27\u62c9\u964d\u5e42\uff09</p> <pre><code>#include&lt;bits/stdc++.h&gt;\nusing namespace std;\n#define N 5\n#define mc(u, v) memcpy(u, v, sizeof v)\n#define int long long\nconst int P = 1e9+7, p = 1e9+6;\nint n;\nvoid mul(int a[N][N], int b[N][N]){\nint ans[N][N] = {};\nfor(int i=0; i&lt;n; ++i) for(int j=0; j&lt;n; ++j) for(int k=0; k&lt;n; ++k)\nans[i][j] = (ans[i][j] + a[i][k] * b[k][j] % p) % p;\nmc(a, ans);\n}\nint k, f1, f2, f3, c;\nint st[4][N] = {\n{0, 0, 1},\n{0, 1, 0},\n{1, 0, 0},\n{0, 0, 0, 3, 1}\n};\nint m[4][N][N] = {\n{{1, 1, 0}, {1, 0, 1}, {1, 0, 0}},\n{{1, 1, 0}, {1, 0, 1}, {1, 0, 0}},\n{{1, 1, 0}, {1, 0, 1}, {1, 0, 0}},\n{{1, 1, 0, 0, 0}, {1, 0, 1, 0, 0}, {1, 0, 0, 0, 0}, {2, 0, 0, 1, 0}, {p-4, 0, 0, 1, 1}}\n};\nint mfp(int f, int k){\nint a[N][N] = {}; mc(a, m[f]);\nint ans[N][N] = {}; mc(ans, a);\n-- k;\nwhile(k){\nif(k &amp; 1) mul(ans, a);\nmul(a, a);\nk &gt;&gt;= 1;\n}\nint ret = 0;\nfor(int i=0; i&lt;n; ++i) ret = (ret + st[f][i] * ans[i][0] % p) % p;\nreturn ret;\n}\nint fp(int a, int n){\nint ans = 1;\nwhile(n){\nif(n &amp; 1) ans = ans * a % P;\na = a * a % P;\nn &gt;&gt;= 1;\n}\nreturn ans;\n}\nsigned main(){\ncin &gt;&gt; k &gt;&gt; f1 &gt;&gt; f2 &gt;&gt; f3 &gt;&gt; c;\nk -= 3;\nn = 3;\nint ans = fp(f1, mfp(0, k)) * fp(f2, mfp(1, k)) % P * fp(f3, mfp(2, k)) % P;\nn = 5;\nans = ans * fp(c, mfp(3, k)) % P;\ncout &lt;&lt; ans &lt;&lt; '\\n';\n}\n</code></pre> <p>9\uff0c2017\u5e74\u94dc\u724c\u9898 [Cloned] - Virtual Judge (csgrandeur.cn)</p> <p>\u6c42\uff1a\\(f_n = f_{n-1} + 2\\times f_{n-2} + n^4\\)\uff0c\\(f_1 = a,~f_2 = b\\)</p> <p>\uff08\u9700\u8981\u4e8c\u9879\u5f0f\u5b9a\u7406\uff09</p> <p>$f_{n+1} = f_{n} + 2\\times f_{n-1} + (n+1)^4  \\ = f_{n} + 2\\times f_{n-1} + C_4^4\\times n^4 + C_4^3\\times n^3 + C_4^2\\times n^2 + C_4^1\\times n^1 + C_4^0\\times n^0 \\= f_{n} + 2\\times f_{n-1} + n^4 + 4\\times n^3 + 6\\times n^2 + 4\\times n^1 + n^0 $</p> <p>\uff08\\((n+1)^3,~(n+1)^2,~(n+1)^1,~(n+1)^0\\) \u7684\u62c6\u5206\u540c\u7406 \uff09</p> <p>\\(\\begin{bmatrix}f_n &amp; f_{n-1} &amp; n^4 &amp; n^3 &amp; n^2 &amp; n^1 &amp; 1\\end{bmatrix}\\times M = \\begin{bmatrix}f_{n+1} &amp; f_{n} &amp; (n+1)^4 &amp; (n+1)^3 &amp; (n+1)^2 &amp; (n+1)^1 &amp; 1\\end{bmatrix}\\)</p> <p>\\(M = \\begin{bmatrix}1 &amp; 1 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\\\ 2 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\\\ 1 &amp; 0 &amp; 1 &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\\\ 4 &amp; 0 &amp; 4 &amp; 1 &amp; 0 &amp; 0 &amp; 0 \\\\ 6 &amp; 0 &amp; 6 &amp; 3 &amp; 1 &amp; 0 &amp; 0 \\\\ 4 &amp; 0 &amp; 4 &amp; 3 &amp; 2 &amp; 1 &amp; 0 \\\\ 1 &amp; 0 &amp; 1 &amp; 1 &amp; 1 &amp; 1 &amp; 1 \\end{bmatrix}\\)</p> <pre><code>#include&lt;bits/stdc++.h&gt;\nusing namespace std;\n#define int long long\n#define N 7\n#define mc(u, v) memcpy(u, v, sizeof v)\nconst int P = 2147493647;\nvoid mul(int a[N][N], int b[N][N]){\nint ans[N][N] = {};\nfor(int i=0; i&lt;N; ++i) for(int j=0; j&lt;N; ++j) for(int k=0; k&lt;N; ++k)\nans[i][j] = (ans[i][j] + a[i][k] * b[k][j] % P) % P;\nmc(a, ans);\n}\nint n, a, b;\nint st[N] = {b, a, 16, 8, 4, 2, 1};\nint m[N][N] = {\n{1, 1, 0, 0, 0, 0, 0},\n{2, 0, 0, 0, 0, 0, 0},\n{1, 0, 1, 0, 0, 0, 0},\n{4, 0, 4, 1, 0, 0, 0},\n{6, 0, 6, 3, 1, 0, 0},\n{4, 0, 4, 3, 2, 1, 0},\n{1, 0, 1, 1, 1, 1, 1}};\nint fp(int n){\nint a[N][N] = {}; mc(a, m);\nint ans[N][N] = {}; for(int i=0; i&lt;N; ++i) ans[i][i] = 1;\nwhile(n){\nif(n &amp; 1) mul(ans, a);\nmul(a, a);\nn &gt;&gt;= 1;\n}\nint ret = 0;\nfor(int i=0; i&lt;N; ++i) ret = (ret + st[i] * ans[i][0] % P) % P;\nreturn ret;\n}\nsigned main(){\nint T;\ncin &gt;&gt; T;\nwhile(T--){\ncin &gt;&gt; n &gt;&gt; a &gt;&gt; b;\n//        m[0][0] = a, m[1][0] = b;\nst[0] = b, st[1] = a;\nif(n == 1) cout &lt;&lt; a &lt;&lt; '\\n';\nelse if(n == 2) cout &lt;&lt; b &lt;&lt; '\\n';\nelse cout &lt;&lt; fp(n-2) &lt;&lt; '\\n';\n}\n}\n</code></pre> <p>10\uff0cProblem - C - Codeforces</p> <p></p> <p>\u6784\u9020\u77e9\u9635\\(\\begin{bmatrix}f_1 &amp; f_2 &amp; ... &amp; f_n \\end{bmatrix}\\)\uff0c\\(f_i\\) \u8868\u793a\u5f53\u524d\u5728 \u70b9\\(i\\)  \u7684\u6982\u7387\uff0c</p> <p>\u4ee4 \\(\\begin{bmatrix}f_1 &amp; f_2 &amp; ... &amp; f_n \\end{bmatrix}\\times M = \\begin{bmatrix}f'_1 &amp; f'_2 &amp; ... &amp; f'_n \\end{bmatrix}\\)</p> <p>\u5219 \\(f'_i ~=~ \\sum\\limits_{j=1}^n f_j\\times M_{j,~i}\\)  \u4e3a\u5168\u6982\u7387\u516c\u5f0f\u7684\u5f62\u5f0f\uff1f </p> <p>\u90a3\u4e48 \\(f'_i\\) \u7684\u542b\u4e49\u5c31\u662f\u7ecf\u8fc7\u4e00\u6b21\u53d8\u6362\u540e\u51fa\u73b0\u5728 \u70b9\\(i\\)  \u7684\u6982\u7387</p> <p>\u53e6\u5916\uff0c\u521d\u59cb\u77e9\u9635\u4e3a\uff1a\\([1,~0,~...,~0]\\) \uff08\u53ef\u4ee5\u5077\u61d2\u6700\u540e\u53ea\u8f93\u51fa \\(M^k_{1,~i},~i=1..n\\)\uff09</p> <pre><code>#include&lt;bits/stdc++.h&gt;\nusing namespace std;\n#define db double\n#define mc(u, v) memcpy(u, v, sizeof v)\n#define N 200\nint n;\nvoid mul(db a[N][N], db b[N][N]){\ndb ans[N][N] = {};\nfor(int i=0; i&lt;n; ++i) for(int j=0; j&lt;n; ++j) for(int k=0; k&lt;n; ++k)\nans[i][j] += a[i][k] * b[k][j];\nmc(a, ans);\n}\ndb st[N], m[N][N];\nvoid fp(int k){\ndb a[N][N] = {}; mc(a, m);\ndb ans[N][N] = {}; for(int i=0; i&lt;N; ++i) ans[i][i] = 1;\nwhile(k){\nif(k &amp; 1) mul(ans, a);\nmul(a, a);\nk &gt;&gt;= 1;\n}\nfor(int i=0; i&lt;n; ++i) cout &lt;&lt; ans[0][i] &lt;&lt; '\\n';\n}\nsigned main(){\nint k;\ncin &gt;&gt; n &gt;&gt; k;\nfor(int i=0; i&lt;n; ++i) for(int j=0; j&lt;n; ++j) cin &gt;&gt; m[i][j];\nfp(k);\n}\n</code></pre> <p>11\uff0cP3758 [TJOI2017]\u53ef\u4e50 - \u6d1b\u8c37 | \u8ba1\u7b97\u673a\u79d1\u5b66\u6559\u80b2\u65b0\u751f\u6001 (luogu.com.cn)</p> <p>P5789 [TJOI2017]\u53ef\u4e50\uff08\u6570\u636e\u52a0\u5f3a\u7248\uff09 - \u6d1b\u8c37 | \u8ba1\u7b97\u673a\u79d1\u5b66\u6559\u80b2\u65b0\u751f\u6001 (luogu.com.cn)</p> <p>\u548c\u7b2c\uff0810\uff09\u9898\u5f88\u50cf\uff0c\u521d\u59cb\u65f6\u8bbe\u7f6e\u77e9\u9635 \\(F := [f_1,~f_2,~f_3,~...,~f_n]\\) \u8868\u793a\u5f53\u524d\u505c\u7559\u5728\u6bcf\u4e2a\u70b9\u7684\u201c\u673a\u5668\u4eba\u6570\u91cf\u201d\uff0c\u9012\u63a8\u77e9\u9635 \\(M\\) \u5c31\u662f\u539f\u56fe\uff08\\(01\\) \u77e9\u9635\uff09\uff0c\u6bcf\u7ecf\u8fc7\u4e00\u6b21\u53d8\u6362\u53ef\u89e3\u91ca\u4e3a\u5404\u4e2a\u673a\u5668\u4eba\u590d\u5236\u4e00\u6b21\u5230\u8fbe\u53e6\u4e00\u4e2a\u70b9\uff08\u53ef\u4ee5\u662f\u81ea\u5df1\uff09\uff0c\u7ecf\u8fc7 \\(k\\) \u6b21\u53d8\u6362\u540e\u7684 \u5411\u91cf \\(F\\) \u7684\u673a\u5668\u4eba\u6570\u91cf\u7684\u603b\u548c\u5373\u4e3a\u65b9\u6848\u603b\u548c</p> <p>\uff08\u521d\u59cb\u65f6 \\(F=[1,~0,~0,~...,~0]\\) \uff09</p> <p>\u201c\u7206\u70b8\u201d\uff1a\u8fdb\u5165\u51fa\u5ea6\u4e3a0 \u7684\u70b9</p> <p>\u201c\u505c\u5728\u539f\u5730\u201d\uff1a\u901a\u8fc7\u81ea\u73af\u8d70\u5411\u81ea\u5df1</p> <p>\uff08\u7075\u611f\uff1a\u6539\u53d8\u521d\u59cb\u77e9\u9635 \\(F\\)  \u6216 \u628a \\(01\u9012\u63a8\u77e9\u9635M\\) \u6539\u4e3a \\(\u5e26\u6743\u77e9\u9635 M\\) \u5c31\u80fd\u5f97\u5230\u65b0\u9898\uff09</p> <p>12\uff0cP2886 [USACO07NOV]Cow Relays G - \u6d1b\u8c37 | \u8ba1\u7b97\u673a\u79d1\u5b66\u6559\u80b2\u65b0\u751f\u6001 (luogu.com.cn)</p> <p>\uff08\u201c\u5b9a\u65f6\u201d\u6700\u77ed\u8def\uff0ctnnd\uff0c\u4e0d\u9020\u54ea\u91cc\u9519\uff09</p> <p>13\uff0cP2233 [HNOI2002]\u516c\u4ea4\u8f66\u8def\u7ebf - \u6d1b\u8c37 | \u8ba1\u7b97\u673a\u79d1\u5b66\u6559\u80b2\u65b0\u751f\u6001 (luogu.com.cn)</p> <p>\uff08easy\u9898\uff09</p> <ul> <li> <ul> <li>2\uff0c\u77e9\u9635\u8868\u8fbe\u4fee\u6539\uff08\u5f85\u8865\uff09</li> </ul> </li> </ul> <p>P7453 [THUSCH2017] \u5927\u9b54\u6cd5\u5e08 - \u6d1b\u8c37 | \u8ba1\u7b97\u673a\u79d1\u5b66\u6559\u80b2\u65b0\u751f\u6001 (luogu.com.cn)</p> <p>#6208. \u6811\u4e0a\u8be2\u95ee - \u9898\u76ee - LibreOJ (loj.ac)</p> <ul> <li> <ul> <li>3\uff0c\u5b9a\u957f\u8def\u5f84\u7edf\u8ba1</li> </ul> </li> </ul> <p>\u7ed9\u5b9a \\(n\\) \u9636\u6709\u5411\u56fe\uff0c\u8fb9\u6743\u4e3a1\uff0c\u6c42\u8fb9\u6570\u4e3a \\(k\\) \u7684 \\(u\\to v\\) \u7684\u8def\u5f84\u6570</p> <p>\u82e5 \\(u\\to v\\) \u6709\u76f4\u63a5\u8def\u5f84\uff0c\u5219 \\(G_{u,~v}\\) \u4e3a\u76f4\u63a5\u8def\u5f84\u7684\u6570\u91cf\uff0c\u5426\u5219\u4e3a 0 </p> <p>\\(G_{p+1} = G_p\\times G = \\sum\\limits_{k=1}^n G_{i,~k}\\times G_{k,~j}\\)</p> <ul> <li> <ul> <li>4\uff0c\u5b9a\u957f\u6700\u77ed\u8def</li> </ul> </li> </ul> <p>\u7ed9\u5b9a \\(n\\) \u9636\u6709\u5411\u56fe\uff0c\u8fb9\u6743\u4e3a1\uff0c\u6c42\u8fb9\u6570\u4e3a k \u7684 \\(u\\to v\\) \u7684\u8def\u5f84\u6570</p> <p>\u82e5 \\(u\\to v\\) \u6709\u76f4\u63a5\u8def\u5f84\uff0c\u5219 \\(G_{u,~v}\\) \u4e3a\u91cd\u8fb9\u6743\u7684\u6700\u5c0f\u503c\uff0c\u5426\u5219\u4e3a \\(\\infin\\) </p> <p>\\(G_{p+1} = G_p\\otimes G = \\min\\limits_{k=1}^n \\{G_{i,~~k}+ G_{k,~~j}\\}\\)</p> <ul> <li> <ul> <li>5\uff0c\u9650\u957f\u8def\u5f84\u8ba1\u6570/\u6700\u77ed\u8def</li> </ul> </li> </ul> <p>\uff083\uff09/\uff084\uff09\u4e2d\u7684\u56fe\u52a0\u4e0a\u6743\u4e3a 1 / 0 \u7684\u81ea\u73af\u5373\u53ef</p>"},{"location":"oiwiki-%E6%95%B0%E5%AD%A6/%E7%BA%BF%E6%80%A7%E4%BB%A3%E6%95%B0/#3","title":"3\uff0c\u9ad8\u65af\u6d88\u5143\uff08\u5f85\u8865\uff09","text":"<p>\\(det_{A}~=~\\sum\\limits_{\\sigma\\in S_n}sgn_{\\sigma}\\times \\prod\\limits_{i=1}^n a_{i,~\\sigma_{i}}\\)</p>"},{"location":"oiwiki-%E6%95%B0%E5%AD%A6/%E7%BA%BF%E6%80%A7%E4%BB%A3%E6%95%B0/#4","title":"4\uff0c\u7279\u5f81\u591a\u9879\u5f0f\uff08\u5f85\u8865\uff09","text":""},{"location":"oiwiki-%E6%95%B0%E5%AD%A6/%E7%BA%BF%E6%80%A7%E4%BB%A3%E6%95%B0/#5","title":"5\uff0c\u7ebf\u6027\u57fa\uff08\u5f85\u8865\uff09","text":"<p>\uff08\u5f85\u8865\u77e5\u8bc6\uff1a\u7ebf\u6027\u57fa\u5408\u5e76\uff0c\u5b9e\u6570\u7ebf\u6027\u57fa\uff09</p> <p>\u7ebf\u6027\u57fa\u662f\u5411\u91cf\u7a7a\u95f4\u7684\u4e00\u7ec4\u57fa\uff0c\u901a\u5e38\u53ef\u4ee5\u89e3\u51b3\u6709\u5173\u5f02\u6216\u7684\u4e00\u4e9b\u9898\u76ee\u3002</p> <p>\u901a\u4fd7\u4e00\u70b9\u7684\u8bb2\u6cd5\u5c31\u662f\u7531\u4e00\u4e2a\u96c6\u5408\u6784\u9020\u51fa\u6765\u7684\u53e6\u4e00\u4e2a\u96c6\u5408\uff0c\u5b83\u6709\u4ee5\u4e0b\u51e0\u4e2a\u6027\u8d28\uff1a</p> <ul> <li> <p>\u7ebf\u6027\u57fa\u7684\u5143\u7d20\u80fd\u76f8\u4e92\u5f02\u6216\u5f97\u5230\u539f\u96c6\u5408\u7684\u5143\u7d20\u7684\u6240\u6709\u76f8\u4e92\u5f02\u6216\u5f97\u5230\u7684\u503c\u3002</p> </li> <li> <p>\u7ebf\u6027\u57fa\u662f\u6ee1\u8db3\u6027\u8d28 1 \u7684\u6700\u5c0f\u7684\u96c6\u5408\u3002</p> </li> <li> <p>\u7ebf\u6027\u57fa\u6ca1\u6709\u5f02\u6216\u548c\u4e3a 0 \u7684\u5b50\u96c6\u3002</p> </li> <li> <p>\u7ebf\u6027\u57fa\u4e2d\u6bcf\u4e2a\u5143\u7d20\u7684\u5f02\u6216\u65b9\u6848\u552f\u4e00\uff0c\u4e5f\u5c31\u662f\u8bf4\uff0c\u7ebf\u6027\u57fa\u4e2d\u4e0d\u540c\u7684\u5f02\u6216\u7ec4\u5408\u5f02\u6216\u51fa\u7684\u6570\u90fd\u662f\u4e0d\u4e00\u6837\u7684\u3002</p> </li> <li> <p>\u7ebf\u6027\u57fa\u4e2d\u6bcf\u4e2a\u5143\u7d20\u7684\u4e8c\u8fdb\u5236\u6700\u9ad8\u4f4d\u4e92\u4e0d\u76f8\u540c\u3002</p> </li> </ul> <pre><code>#define int long long\nconst int N = 63;\nint a[N], zero;\nvoid add(int w){\nfor(int i=N-1; ~i; --i){\nif(!(w &gt;&gt; i &amp; 1)) continue;\nif(!a[i]) return void(a[i] = w);\nw ^= a[i];\n}\n}\n// \u67e5\u8be2 w \u662f\u5426\u80fd\u88ab\u5f02\u6216\u51fa\u6765 \nbool ask(int w){\nfor(int i=N-1; ~i; --i){\nif(!(w &gt;&gt; i &amp; 1)) continue;\nw ^= a[i];\n}\nreturn !w;\n}\n// \u67e5\u8be2\u5f02\u6216\u6700\u5c0f\u503c\nint gmin(){\nif(zero) return 0;\nfor(int i=0; i&lt;N; ++i) if(a[i]) return a[i];\n}\n// \u67e5\u8be2\u5f02\u6216\u6700\u5927\u503c\nint gmax(){\nint ans = 0;\nfor(int i=N-1; ~i; --i) ans = (ans, ans ^ a[i]);\nreturn ans;\n}\nint cnt, d[N];\n// \u91cd\u6784\u7ebf\u6027\u57fa \nvoid rebuild(){\ncnt = 0;\nfor(int i=N-1; ~i; --i)\nfor(int j=i-1; ~j; --j)\nif(a[i] &gt;&gt; j &amp; 1) a[i] ^= a[j];\nfor(int i=0; i&lt;N; ++i) if(a[i]) d[cnt ++] = a[i];\n}\n// \u67e5\u8be2\u5f02\u6216\u7b2ck\u5c0f\u503c \uff08\u6b63\u786e\u6027\u672a\u77e5\uff09\nint kth(int k){\nif(k == zero) return 0;\nk -= zero;\nif(k &gt;&gt; cnt &amp; 1) return -1;\nint ans = 0;\nfor(int i=cnt-1; ~i; --i) if(k &gt;&gt; i &amp; 1) ans ^= d[i];\nreturn ans;\n}\n// \u67e5\u8be2 w\u7684\u5f02\u6216\u6392\u540d\uff08\u6b63\u786e\u6027\u672a\u77e5\uff09 \nint rank(int w){\nint ans = 0;\nfor(int i=N-1; ~i; --i)\nif(w &gt;= a[i]) ans |= 1 &lt;&lt; i, w ^= a[i];\nreturn ans + zero;\n}\n</code></pre> <p>\u8f83\u597d\u7684\u7406\u8bba\u4ecb\u7ecd\uff1a</p> <p>P3812 \u3010\u6a21\u677f\u3011\u7ebf\u6027\u57fa - \u6d1b\u8c37 | \u8ba1\u7b97\u673a\u79d1\u5b66\u6559\u80b2\u65b0\u751f\u6001 (luogu.com.cn)</p> <p></p> <p>xor\uff08\u7ebf\u6027\u57fa\u7684\u5408\u5e76\uff09 - \u6267||\u5ff5 - \u535a\u5ba2\u56ed (cnblogs.com)</p> <ul> <li>P3857 [TJOI2008]\u5f69\u706f - \u6d1b\u8c37 | \u8ba1\u7b97\u673a\u79d1\u5b66\u6559\u80b2\u65b0\u751f\u6001 (luogu.com.cn)</li> </ul> <p>\u6c42\u7ebf\u6027\u57fa\u5927\u5c0f\uff08\u88f8\u9898\uff09</p> <ul> <li>P4301 [CQOI2013] \u65b0Nim\u6e38\u620f - \u6d1b\u8c37 | \u8ba1\u7b97\u673a\u79d1\u5b66\u6559\u80b2\u65b0\u751f\u6001 (luogu.com.cn)</li> </ul> <p>1\uff09\u7b2c\u4e00\u6b21\u53d6\u8d70\u4efb\u610f\u5806\u540e\u4f7f\u5f97\u4e4b\u540e\u7684\u5c40\u9762\u6240\u6709\u6570\u7684\u5f02\u6216\u548c\u4e0d\u4e3a0\u65f6\uff08\u5373\u540e\u624b\u5fc5\u8d25\u5c40\u9762\uff09\uff0c\u5148\u624b\u5fc5\u80dc</p> <p>\u56e0\u4e3a\u4e00\u4e2a\u6570 \\(w\\) \u63d2\u5165\u7ebf\u6027\u57fa\u540e\u8fd4\u56de0 \u610f\u5473\u7740 \\(w=0\\) \u6216 \\(w\\) \u53ef\u4ee5\u7528\u4e4b\u524d\u63d2\u5165\u7ebf\u6027\u57fa\u7684\u6570 \u7ebf\u6027\u8868\u793a\uff08\u5373\u4e3a\u51e0\u4e2a\u6570\u5f02\u6216\u548c\uff1b \\(a\\) ^ \\(b\\) ^ \\(...\\) ^ \\(u\\) ^ \\(w = 0\\) \\(\\implies\\) \\(a\\) ^ \\(b\\) ^ \\(...\\) ^ \\(u = w\\) \uff08\\(w\\ne 0\\) \u7684\u60c5\u51b5\uff09 \uff09 </p> <p>\u6839\u636e\u7ebf\u6027\u57fa\u7684\u6027\u8d28\uff1a\u7ebf\u6027\u57fa\u5185\u4efb\u610f\u51e0\u4e2a\u6570\u7684\u5f02\u6216\u4e0d\u4e3a0</p> <p>\u56e0\u6b64\u6e38\u620f\u7684\u7b2c\u4e00\u4e2a\u56de\u5408 \u53d6\u51fa\u63d2\u5165\u5931\u8d25\u7684\u6240\u6709\u6570\uff0c\u800c\u63d2\u5165\u6210\u529f\u7684\u6570\u4e0d\u53ef\u80fd\u7ebf\u6027\u8868\u793a0\uff0c\u8fdb\u800c\u5fc5\u7136\u5bfc\u81f4\u540e\u624b\u5fc5\u8d25\u5c40\u9762</p> <p>2\uff09\u8981\u4f7f\u7b2c\u4e00\u56de\u5408\u6240\u53d6\u6570\u4e4b\u548c\u6700\u5c0f\uff0c\u53ef\u4ee5\u8bc1\u660e\u8d2a\u5fc3\u7b56\u7565\u53ef\u4ee5\u6ee1\u8db3\u8981\u6c42\uff08\u4ece\u5927\u5230\u5c0f\u63d2\u5165\u6bcf\u4e2a\u6570\uff09</p> <p>\u5b9a\u7406\uff1a\\(a\\) ^ \\(b\\) ^ \\(...\\) \\(\\le a+b+...\\)    \uff08\u5f02\u6216\u662f\u4e0d\u4ec5\u4e3a\u52a0\u6cd5\uff09</p> <ul> <li>P4570 [BJWC2011]\u5143\u7d20 - \u6d1b\u8c37 | \u8ba1\u7b97\u673a\u79d1\u5b66\u6559\u80b2\u65b0\u751f\u6001 (luogu.com.cn)\uff08\u5f85\u770b\uff09</li> </ul> <p>\u5173\u4e8e\u8d2a\u5fc3\u7b56\u7565\u7684\u7406\u8bba\uff1a(19\u6761\u6d88\u606f) \u62df\u9635\uff1a\u8d2a\u5fc3\u539f\u7406\uff08bzoj 3105: [cqoi2013]\u65b0Nim\u6e38\u620f\uff09_Jaihk662\u7684\u535a\u5ba2-CSDN\u535a\u5ba2</p> <p>\u7ebf\u6027\u57fa\u5b66\u4e60\u7b14\u8bb0 | Sengxian's Blog</p> <ul> <li>\u67e5\u627e\u5f02\u6216\u548c\u4e3a\u7b2c \\(k\\) \u5c0f\u7684\u503c\uff08\u6ca1\u6709\u8fd4\u56de-1\uff09 </li> </ul> <pre><code>int cnt, d[N];\n// \u91cd\u6784\u7ebf\u6027\u57fa\nvoid rebuild(){\ncnt = 0;\nfor(int i=N-1; ~i; --i)\nfor(int j=i-1; ~j; --j)\nif(a[i] &gt;&gt; j &amp; 1) a[i] ^= a[j];\nfor(int i=0; i&lt;N; ++i) if(a[i]) d[cnt ++] = a[i];\n}\nint kth(int k){\nif(cnt != n) -- k;\nif(k &gt;= (1ll &lt;&lt; cnt)) return -1;\nint ans = 0;\nfor(int i=cnt-1; ~i; --i) if(k &gt;&gt; i &amp; 1) ans ^= d[i];\nreturn ans;\n}\n</code></pre> <ul> <li>P4151 [WC2011]\u6700\u5927XOR\u548c\u8def\u5f84 - \u6d1b\u8c37 | \u8ba1\u7b97\u673a\u79d1\u5b66\u6559\u80b2\u65b0\u751f\u6001 (luogu.com.cn)</li> </ul> <pre><code>#include&lt;bits/stdc++.h&gt;\nusing namespace std;\n#define int long long\nconst int N = 63, M = 5e4+3;\nint a[N];\nvoid add(int w){\nfor(int i=N-1; ~i; --i){\nif(!(w &gt;&gt; i &amp; 1)) continue;\nif(!a[i]) return void(a[i] = w);\nw ^= a[i];\n}\n}\nstruct nd{ signed v, ne; int w; }e[M&lt;&lt;2];\nsigned idx, n, h[M]; int xr[M]; bool st[M];\nvoid add(signed u, signed v, int w){\ne[ ++ idx] = {v, h[u], w}, h[u] = idx;\n}\nvoid dfs(int u, int p, int res){\nst[u] = true, xr[u] = res;\nfor(int i=h[u]; i; i=e[i].ne){\nint v = e[i].v, w = e[i].w;\nif(v == p) continue;\n// s -&gt; ... -&gt; u -&gt; v \u6ca1\u51fa\u73b0\u8fc7\u73af\uff0c\u7ee7\u7eed\u641c \nif(!st[v]) dfs(v, u, res ^ w);\n// s -&gt; ... -&gt; v -&gt; ... -&gt; u -&gt; v\uff0c\u5373 v\u4e3a\u73af\u53e3 \n// res ^ w \u8868\u793a \u4ece s -&gt; u \u7684\u5f02\u6216\u548c\uff0c\u518d\u5f02\u6216\u4e0a xr[v] \u76f8\u5f53\u4e8e\u6d88\u9664 s-&gt;v\u7684\u8d21\u732e\n// res ^ w ^ xr[v] \u5219\u8868\u793a\u73af\u7684\u5f02\u6216\u548c \nelse add((res ^ w) ^ xr[v]);\n}\n}\nsigned main(){\nios::sync_with_stdio(false);\nint m;\ncin &gt;&gt; n &gt;&gt; m;\nfor(int i=0; i&lt;m; ++i){\nint u, v, w;\ncin &gt;&gt; u &gt;&gt; v &gt;&gt; w;\nadd(u, v, w), add(v, u, w);\n}\ndfs(1, 0, 0ll);\nint ans = xr[n];\nfor(int i=N-1; ~i; --i) ans = max(ans, ans ^ a[i]);\ncout &lt;&lt; ans &lt;&lt; '\\n';\n}\n</code></pre> <ul> <li>P3292 [SCOI2016]\u5e78\u8fd0\u6570\u5b57 - \u6d1b\u8c37 | \u8ba1\u7b97\u673a\u79d1\u5b66\u6559\u80b2\u65b0\u751f\u6001 (luogu.com.cn)\uff08\u5f85\u8865\uff09</li> </ul> <p>\u524d\u7f6e\uff1aLCA\uff0ctarjan\u7b49</p> <ul> <li>Problem - 6579 (hdu.edu.cn) </li> </ul> <p>\u524d\u7f00\u7ebf\u6027\u57fa + \u6e7f\u9a6c\u7684\u5f3a\u5236\u5728\u7ebf\uff08\u6bcf\u6b21\u64cd\u4f5c\u7684\u53c2\u6570\u9700\u8981\u5f02\u6216\u4e0a\u4e00\u4e2a\u8f93\u51fa\u7684\u6570\uff09</p> <pre><code>#define int long long\n#define mc(u, v) memcpy(u, v, sizeof v)\n#define ms(u) memset(u, 0, sizeof u)\nconst int N = 31, M = 5e5+3;\nint a[M][N], pos[M][N], num;\nvoid add(int w){\n++ num;\nmc(a[num], a[num-1]), mc(pos[num], pos[num-1]);\nint p = num;\nfor(int i=N-1; ~i; --i){\nif(!(w &gt;&gt; i &amp; 1)) continue;\nif(!a[num][i]) return void((a[num][i] = w, pos[num][i] = p));\nelse{\nif(pos[num][i] &lt; p) swap(a[num][i], w), swap(pos[num][i], p);\nw ^= a[num][i];\n}\n}\n}\nint gmax(int lb, int ub){\nint ans = 0;\nfor(int i=N-1; ~i; --i){\nif(pos[ub][i] &lt; lb) continue;\nans = max(ans, ans ^ a[ub][i]);\n}\nreturn ans;\n}\nint gmin(int lb, int ub){\nfor(int i=N-1; ~i; --i){\nif(pos[ub][i] &lt; lb) continue;\nif(a[ub][i]) return a[ub][i];\n}\nreturn 0;\n}\n</code></pre> <p>\u76f8\u540c\u7684\u9898\u76ee\uff1aProblem - F - Codeforces\uff08\u79bb\u7ebf\uff09</p>"},{"location":"oiwiki-%E6%95%B0%E5%AD%A6/%E7%BB%84%E5%90%88%E6%95%B0%E5%AD%A61/","title":"\u7ec4\u5408\u6570\u5b661","text":""},{"location":"oiwiki-%E6%95%B0%E5%AD%A6/%E7%BB%84%E5%90%88%E6%95%B0%E5%AD%A61/#1","title":"1\uff0c\u6392\u5217\u7ec4\u5408","text":"<p>\u6392\u5217\u5c31\u662f\u6307\u4ece\u7ed9\u5b9a\u4e2a\u6570\u7684\u5143\u7d20\u4e2d\u53d6\u51fa\u6307\u5b9a\u4e2a\u6570\u7684\u5143\u7d20\u8fdb\u884c\u6392\u5e8f</p> <p>\u7ec4\u5408\u5219\u662f\u6307\u4ece\u7ed9\u5b9a\u4e2a\u6570\u7684\u5143\u7d20\u4e2d\u4ec5\u4ec5\u53d6\u51fa\u6307\u5b9a\u4e2a\u6570\u7684\u5143\u7d20\uff0c\u4e0d\u8003\u8651\u6392\u5e8f</p> <p>\u6392\u5217\u7ec4\u5408\u7684\u4e2d\u5fc3\u95ee\u9898\u662f\u7814\u7a76\u7ed9\u5b9a\u8981\u6c42\u7684\u6392\u5217\u548c\u7ec4\u5408\u53ef\u80fd\u51fa\u73b0\u7684\u60c5\u51b5\u603b\u6570\u3002\u6392\u5217\u7ec4\u5408\u4e0e\u53e4\u5178\u6982\u7387\u8bba\u5173\u7cfb\u5bc6\u5207\u3002</p> <ul> <li>1\uff0c\u52a0\u6cd5\u539f\u7406\uff08\u5206\u7c7b\uff09</li> </ul> <p></p> <ul> <li>2\uff0c\u4e58\u6cd5\u539f\u7406\uff08\u5206\u5e03\uff09</li> </ul> <p></p> <ul> <li>3\uff0c\u6392\u5217\u6570</li> </ul> <p>\u2014\u2014\u5bf9\u96c6\u5408\u8fdb\u884c\u6784\u9020 \u5e8f\u5217 \u7684\u65b9\u6848\u6570</p> <p></p> <p>\\(\\mathrm A_n^m = n(n-1)(n-2) \\cdots (n-m+1) = \\frac{n!}{(n - m)!}\\)</p> <ul> <li>4\uff0c\u7ec4\u5408\u6570</li> </ul> <p>\u2014\u2014\u5bf9\u96c6\u5408\u8fdb\u884c\u6784\u9020 \u5b50\u96c6 \u7684\u65b9\u6848\u6570</p> <p></p> <p>\\(\\mathrm C_n^m = \\frac{\\mathrm A_n^m}{m!} = \\frac{n!}{m!(n - m)!}\\)</p> <p>\u7ec4\u5408\u6570\u4e5f\u5e38\u7528 \\(\\displaystyle \\binom{n}{m}\\) \u8868\u793a\uff0c\u8bfb\u4f5c\u300c\\(n\\) \u9009 \\(m\\)\u300d\uff0c\u5373 \\(\\displaystyle \\mathrm C_n^m=\\binom{n}{m}\\)\u3002\u5b9e\u9645\u4e0a\uff0c\u540e\u8005\u8868\u610f\u6e05\u6670\u660e\u4e86\uff0c\u7f8e\u89c2\u7b80\u6d01\uff0c\u56e0\u6b64\u73b0\u5728\u6570\u5b66\u754c\u666e\u904d\u91c7\u7528 \\(\\binom{n}{m}\\) \u7684\u8bb0\u53f7\u800c\u975e \\(C_{n}^m\\)\u3002</p> <ul> <li> <ul> <li>\u6027\u8d28</li> </ul> </li> </ul> <p>1\uff0c</p> <p>\\(\\displaystyle \\binom{n}{m}=\\binom{n}{n-m}\uff0c\\binom{n}{m}=\\frac{n}{m}\\binom{n-1}{m-1}\uff0c\\binom{n}{m} = \\binom{n-1}{m} + \\binom{n-1}{m-1}\\)</p> <p>2\uff0c\u4e8c\u9879\u5f0f\u5b9a\u7406\u53ef\u63a8\u51fa\uff1a</p> <p>\\(\\displaystyle \\sum_{i=0}^n\\binom{n}{i} = 2^n\uff0c\\sum_{i=0}^n(-1)^i\\binom{n}{i}=[n=0]\\)</p> <p>\uff08\u6ce8\u610f\uff1a \\(\\epsilon = [n=1] \\ne [n=0]\\)\uff09</p> <p>3\uff0c\u62c6\u7ec4\u5408\u6570\u7684\u5f0f\u5b50\uff0c\u5728\u5904\u7406\u67d0\u4e9b\u6570\u636e\u7ed3\u6784\u9898\u65f6\u4f1a\u7528\u5230</p> <p>\\(\\displaystyle\\sum_{i=0}^m \\binom{n}{i}\\binom{m}{m-i} = \\binom{m+n}{m}\\ \\ \\ (n \\geq m)\\)</p> <p>\u7279\u6b8a\u60c5\u51b5\uff1a\\(\\displaystyle \\sum_{i=0}^n\\binom{n}{i}^2=\\binom{2n}{n}\\)</p> <p>4\uff0c\u5e26\u6743\u548c</p> <p>\\(\\displaystyle \\sum_{i=0}^ni\\binom{n}{i} = n\\times 2^{n-1} \\\\ \\sum_{i=0}^ni^2\\binom{n}{i} = n\\times (n+1)\\times 2^{n-2}\\)</p> <p>\uff08\u53ef\u4ee5\u901a\u8fc7\u5bf9\u591a\u9879\u5f0f\u51fd\u6570\u6c42\u5bfc\u8bc1\u660e\uff09</p> <p>5\uff0c\u602a\u5f02\u7684\u516c\u5f0f</p> <p>\\(\\displaystyle \\sum_{l=0}^n\\binom{l}{k} = \\binom{n+1}{k+1} \\\\ \\binom{n}{r}\\binom{r}{k} = \\binom{n}{k}\\binom{n-k}{r-k} \\\\ \\sum_{i=0}^n\\binom{n-i}{i}=F_{n+1}\\)</p> <ul> <li>5\uff0c\u4e8c\u9879\u5f0f\u5b9a\u7406</li> </ul> <p>\u5728\u8fdb\u5165\u6392\u5217\u7ec4\u5408\u8fdb\u9636\u7bc7\u4e4b\u524d\uff0c\u6211\u4eec\u5148\u4ecb\u7ecd\u4e00\u4e2a\u4e0e\u7ec4\u5408\u6570\u5bc6\u5207\u76f8\u5173\u7684\u5b9a\u7406\u2014\u2014\u4e8c\u9879\u5f0f\u5b9a\u7406</p> <p>\u4e8c\u9879\u5f0f\u5b9a\u7406\u9610\u660e\u4e86\u4e00\u4e2a\u5c55\u5f00\u5f0f\u7684\u7cfb\u6570\uff1a</p> <p>\\(\\displaystyle (a+b)^n=\\sum_{i=0}^n\\binom{n}{i}a^{n-i}b^i\\)</p> <p>\u8bc1\u660e\u53ef\u4ee5\u91c7\u7528\u6570\u5b66\u5f52\u7eb3\u6cd5\uff0c\u5229\u7528 \\(\\displaystyle \\binom{n}{k}+\\binom{n}{k-1}=\\binom{n+1}{k}\\) \u505a\u5f52\u7eb3\u3002</p> <p></p> <ul> <li>6\uff0c\u591a\u91cd\u96c6\u7684\u6392\u5217\u6570 / \u591a\u91cd\u7ec4\u5408\u6570</li> </ul> <p>\u2014\u2014\u591a\u91cd\u96c6\u7684\u5168\u6392\u5217\u6570</p> <p></p> <p>\\(\\displaystyle \\frac{n!}{\\prod\\limits_{i=1}^kn_i!}=\\frac{n!}{n_1!n_2!\\cdots n_k!}\\)</p> <p></p> <p>\\(\\displaystyle \\binom{n}{n_1,n_2,\\cdots,n_k}=\\frac{n!}{\\prod_{i=1}^kn_i!}\\)</p> <p></p> <p>\uff08\u4e00\u5b9a\u8981\u533a\u5206 \u591a\u91cd\u7ec4\u5408\u6570 \u4e0e \u591a\u91cd\u96c6\u7684\u7ec4\u5408\u6570\uff01\u4e24\u8005\u662f\u5b8c\u5168\u4e0d\u540c\u7684\u6982\u5ff5\uff01\uff09</p> <ul> <li>7\uff0c\u591a\u91cd\u96c6\u7684\u7ec4\u5408\u65701</li> </ul> <p>\u2014\u2014\u591a\u91cd\u96c6\u751f\u6210\u591a\u91cd\u5b50\u96c6\u7684\u65b9\u6848\u6570\uff08\u5e76\u4e14\u5177\u6709\u9650\u5236\\(M\\le n_i\\) \uff09</p> <p>\uff08\\(M\\) \u4e3a\u591a\u91cd\u5b50\u96c6\u7684\u201d\u5927\u5c0f\u201c\uff09</p> <p>\u591a\u91cd\u96c6 \\(S=\\{n_i\\times a_i\\mid i=1..k\\},~0\\le n_i,~\\sum\\limits_{j=1}^k n_j=N\\) \u6784\u9020 </p> <p>\\(Sub = \\{x_i\\times a_i\\mid i=1..k\\},~0\\le x_i\\le n_i,~\\sum\\limits_{j=1}^k x_j=M\\) </p> <p>\u5e76\u4e14\u8981\u6c42 \\(M\\le n_i,~i=1..k\\) \u7684\u65b9\u6848\u6570</p> <p>\uff08\u663e\u7136 \\(x_i\\le M\\) \u662f\u5fc5\u7136\u6ee1\u8db3\u7684\uff0c\u9650\u5236\u5c31\u8f6c\u6362\u4e3a \\(\\sum\\limits_{j=1}^k x_j=M,~x_j\\ge 0\\)\uff09</p> <p>\u5bf9\u4e8e \\(Sub\\) \u7684\u9650\u5236\u53ef\u4ee5\u4f7f\u7528\u9694\u677f\u6cd5 \u6c42\u51fa\u65b9\u6848\u6570\u4e3a\uff1a</p> <p>\\(\\displaystyle\\binom{M+k-1}{k-1}\\) </p> <p>\uff08\u6ce8\u610f\uff1a\u8f93\u5165\u7684\u53d8\u91cf\u662f \\(M\\)\uff0c\u800c \\(k\\) \u662f\u539f\u6765\u7684\u591a\u91cd\u96c6\u7684\u5c5e\u6027\uff09</p> <ul> <li> <ul> <li>\u5f15\u7406\uff1a\u9694\u677f\u6cd5\uff1a\u96c6\u5408\u5212\u5206\u4e3a \\(k\\) \u4e2a\u975e\u7a7a\u72ec\u7acb\u5b50\u96c6\u7684\u65b9\u6848\u6570\u4e3a \\(\\displaystyle \\binom{n-1}{k-1}\\)</li> </ul> </li> </ul> <p>\u7b49\u4ef7\u95ee\u9898\uff1a\\(\\displaystyle \\sum\\limits_{i=1}^k x_i = n,~x_i\\ge 1\\)</p> <p>\u6269\u5c551\uff1a\\(\\displaystyle \\sum_{i=1}^k x_i = n,~x_i\\ge 0 \\implies \\sum_{i=1}^k x'_i = n+k,~x'_i\\ge 1\\) \uff0c</p> <p>\u65b9\u6848\u6570\u4e3a\uff1a\\(\\displaystyle \\binom{n+k-1}{k-1}\\)</p> <p>\uff08\u540c\u6837\u5730\uff0c\u96c6\u5408\u5212\u5206\u4e3a \\(k\\) \u4e2a\u72ec\u7acb\u5b50\u96c6\u7684\u65b9\u6848\u6570\u4e3a \\(\\displaystyle \\binom{n+k-1}{k-1}\\)\uff09</p> <p>\u6269\u5c552\uff1a\\(\\displaystyle \\sum_{i=1}^k x_i=n,~x_{a_j}\\ge n_{a_j},~x_{else}\\ge 0\\)   \uff0c\u65b9\u6848\u6570\u4e3a\uff1a \\(\\displaystyle \\binom{n-\\sum\\limits_{a_j}x_{a_j}+k-1}{k-1}\\) </p> <ul> <li>8\uff0c\u591a\u91cd\u96c6\u7684\u7ec4\u5408\u65702</li> </ul> <p>\u2014\u2014\u591a\u91cd\u96c6\u751f\u6210\u591a\u91cd\u5b50\u96c6\u7684\u65b9\u6848\u6570</p> <p>\u591a\u91cd\u96c6 \\(S=\\{n_i\\times a_i\\mid i=1..k\\},~~0\\le n_i,~~\\sum\\limits_{j=1}^k n_j=N\\) \u6784\u9020</p> <p>\\(Sub = \\{x_i\\times a_i\\mid i=1..k\\},~~0\\le x_i\\le n_i,~~\\sum\\limits_{j=1}^k x_j=M\\)  \u7684\u65b9\u6848\u6570</p> <ul> <li> <ul> <li>\u5f15\u7406\uff1a\u5bb9\u65a5\u539f\u7406</li> </ul> </li> </ul> <p>\\(\\displaystyle|\\bigcup_{i=1}^kS_i| ~=~ \\sum_{i=1}^k (-1)^{i-1}\\sum_{1\\le a_1&lt; a_2&lt;...&lt; a_i\\le k}|\\bigcap_{j=1}^i S_{a_j}|\\)</p> <ul> <li> <ul> <li>\u5f00\u59cb\u63a8\u5bfc\uff1a</li> </ul> </li> </ul> <p>\u4ee4\u5c5e\u6027 \\(P_i := 0\\le x_i\\le n_i\\)\uff0c\u5bf9\u5e94\u7684\u96c6\u5408\u4e3a \\(S_i\\)</p> <p>\uff08\u540c\u7406 \\(x_i &gt; n_i \\implies \\overline{S_i}\\)\uff09</p> <p>\\(\\displaystyle Ans = |\\bigcap_{i=1}^k S_i| = |U| - |\\bigcup_{i=1}^k \\overline S_{i}| \\\\ = |U| - \\sum_{i=1}^k(-1)^{i-1}\\sum_{1\\le a_1&lt;a_2&lt;...&lt;a_i\\le k}|\\bigcap_{j=1}^i\\overline{S_{a_j}}|\\) </p> <p>$\\displaystyle = \\binom{M+k-1}{k-1} - \\sum_{i=1}k(-1)\\sum_{1\\le a_1&lt;a_2&lt;...&lt;a_i\\le k} \\binom{M-\\sum\\limits_{j=1}^i(n_{a_j}+1)+k-1}{k-1} $ </p> <p>$\\displaystyle = \\sum_{i=0}k(-1)\\sum_{1\\le a_1&lt;a_2&lt;...&lt;a_i\\le k} \\binom{M-\\sum\\limits_{j=1}^i(n_{a_j}+1)+k-1}{k-1} $</p> <ul> <li>9\uff0c\u4e0d\u76f8\u90bb\u7684\u6392\u5217\u6570</li> </ul> <p>\u2014\u2014\u5bf9\u5e8f\u5217\u53d6 \\(k\\) \u4e2a\u4e0d\u76f8\u90bb\u7684\u5143\u7d20\u6784\u6210\u5b50\u96c6\u7684\u65b9\u6848\u6570</p> <p>\\(\\displaystyle \\binom{n-k+1}{k}\\)</p> <ul> <li>10\uff0c\u9519\u4f4d\u6392\u5217</li> </ul> <p>\u2014\u2014\u5bf9\u5e8f\u5217\u9519\u6392\u7684\u65b9\u6848\u6570</p> <p>\uff08\u5982\u521d\u59cb\u5e8f\u5217\uff1a\\(a_{1..n}=1..n\\)\uff0c\u9519\u4f4d\u540e\uff0c\\(a'_i\\ne i\\)\uff09</p> <p>\\(f_{n} = (n-1)\\times(f_{n-1}+f_{n-2}),~f_0=1,~f_1=0,\\)</p> <p>\u524d\u51e0\u9879\uff1a\\(0,1,2,9,44,265\\)</p> <p>\uff08\u8bc1\u660e\u7565\uff09</p> <ul> <li>11\uff0c\u5706\u6392\u5217</li> </ul> <p>\u2014\u2014\u5bf9\u96c6\u5408\u6784\u6210\u5706\u5e8f\u5217\u7684\u65b9\u6848\u6570</p> <p>\\(\\displaystyle Q_{n}^{m} = \\frac{A_{n}^{m}}{m} \\\\ Q_{n}^{n} = (n-1)!\\)</p> <p>\u8bc1\uff1a\u5047\u8bbe\u5df2\u7ecf\u5f97\u5230\u5706\u5e8f\u5217 \\(Q_n^m\\) \uff0c\u5bf9 \\(a_i\\) \u548c \\(a_{i+1}\\) \u65ad\u5f00\uff08\\(m\\) \u79cd\uff09\uff0c\u5373\u53ef\u5f97\u5230 \u5e8f\u5217 \\(A_n^m\\)</p> <p>\\(\\displaystyle \\therefore Q_n^m\\times m = A_n^m \\implies Q_n^m = \\frac{A_n^m}{m}\\)</p>"},{"location":"oiwiki-%E6%95%B0%E5%AD%A6/%E7%BB%84%E5%90%88%E6%95%B0%E5%AD%A61/#2catalan","title":"2\uff0c\u5361\u7279\u5170\u6570Catalan","text":"<ul> <li> <p>\u516c\u5f0f</p> </li> <li> <ul> <li>1\uff0c\u9012\u63a8\u5f0f\uff1a</li> </ul> </li> </ul> <p>1\uff09\\(\\displaystyle H_{n} = \\begin{cases} 1 &amp; n=0..1 \\\\ \\displaystyle \\sum_{i=1}^n H_{i-1}\\times H_{n-i} &amp; n\\ge 2\\end{cases}\\)</p> <p>2\uff09\\(\\displaystyle H_n = \\frac{H_{n-1}\\times (4\\times n-2)}{n+1}\\)</p> <ul> <li> <ul> <li>2\uff0c\u9012\u63a8\u89e3</li> </ul> </li> </ul> <p>1\uff09\\(\\displaystyle H_{n} = \\frac{\\displaystyle \\binom{2\\times n}{n}}{n+1}\\)</p> <p>2\uff09\\(\\displaystyle H_{n} = \\binom{2\\times n}{n} - \\binom{2\\times n}{n-1}\\)</p> <ul> <li> <p>\u5e38\u89c1\u95ee\u9898</p> </li> <li> <ul> <li>1\uff0c\u51e0\u4f55/\u6570\u636e\u7ed3\u6784\u76f8\u5173</li> </ul> </li> </ul> <p>1\uff09\u5706\u4e0a\u6709 \\(2\\times n\\) \u4e2a\u70b9\uff0c\u6784\u9020\u70b9\u4e4b\u95f4\u8fde\u63a5 \\(n\\) \u4e2a\u4e92\u4e0d\u76f8\u4ea4\u7684\u7ebf\u6bb5\u7684\u65b9\u6848\u6570\u4e3a \\(H_{n}\\)</p> <p>\u8bc1\uff1a\u5bf9\u70b9\u7f16\u53f7 \\(1..2\\times n\\)\uff0c\u4ee5 \\(1\\) \u53f7\u70b9\u4e3a\u57fa\u70b9\uff0c\u8fde\u63a5\u53e6\u4e00\u5076\u6570\u7f16\u53f7\u7684\u70b9 \\(2\\times i,~i=1..n\\)\uff0c\u5c06\u65b9\u6848\u5212\u5206\u4e3a\u4e0d\u91cd\u7684 \\(n\\) \u4e2a\u5b50\u65b9\u6848\uff0c\u6bcf\u4e2a\u65b9\u6848\u90fd\u53ef\u4ee5\u5206\u6cbb\u8be5\u8fb9\u7684\u5de6\u53f3\u4e24\u8fb9\uff0c</p> <p>\u5bb9\u6613\u5f97\u51fa \\(f_{n}=\\sum\\limits_{i=1}^n f_{i-1}\\times f_{n-i},f_{0..1}=1 \\implies f_n=H_n\\)</p> <p>2\uff09  \\(n\\) \u4e2a\u8fb9\u7684\u51f8\u591a\u8fb9\u5f62\u533a\u57df\u5212\u5206\u4e3a\u542b \\(n-2\\) \u4e2a\u4e09\u89d2\u5f62\u533a\u57df\u7684\u65b9\u6848\u6570\u4e3a \\(H_{n-2}\\)</p> <p>\u8bc1\uff1a\u5c06 \\(1\\) \u4e2a\u90bb\u8fb9\u4f5c\u4e3a\u57fa\uff0c\u8fde\u63a5\u975e\u6b64\u8fb9\u4e0a\u7684\u70b9\uff0c\u5bf9\u6784\u6210\u7684\u4e09\u89d2\u5f62\u4e24\u8fb9\u5206\u6cbb\uff0c</p> <p>\u6613\u5f97 \\(f_n = \\sum\\limits_{i=1}^{n-2}f_{i-1+2}\\times f_{n-i+2},~f_{2..3=1}\\implies f_n=H_{n-2}\\)</p> <p>\uff08\u5c06 \\(f_n\\) \u5de6\u79fb \\(2\\) \u4e2a\u5355\u4f4d\u5373\u53ef\u5f97\u5230 \\(H_n\\)\uff09</p> <p>3\uff09\\(n\\) \u4e2a\u7ed3\u70b9\u6784\u9020\u7684\u4e8c\u53c9\u6811\u65b9\u6848\u6570\u4e3a \\(H_n\\)</p> <p>\u5c06\u65b9\u6848\u5212\u5206\u4e3a \\(T(0, n-1),T(1, n-2),...\uff0cT(n-1, 0)\\)\uff0c</p> <p>\u663e\u7136 \\(f_n = f_{0}\\times f_{n-1}+f_{1}\\times f_{n-2}+...+f_{n-1}\\times f_0 = H_n\\)</p> <p>\uff08\\(T(a,~b)\\) \u8868\u793a\u5de6\u53f3\u5b50\u6811\u7684\u7ed3\u70b9\u6570\u5206\u522b\u4e3a \\(a,~b\\)\uff09</p> <p>4\uff09\u6808\u7684\u8fdb\u6808\u5e8f\u5217\u4e3a \\(a_1,~a_2,~...,~a_n\\)\uff08\\(a_i\\) \u4e92\u4e0d\u76f8\u540c\uff09\uff0c\u51fa\u6808\u5e8f\u5217\u7684\u65b9\u6848\u6570\u4e3a\\(H_n\\)</p> <ul> <li> <ul> <li>2\uff0c\u5e8f\u5217\u76f8\u5173</li> </ul> </li> </ul> <p>\\(n\\) \u4e2a \\(-1\\) \u548c \\(n\\) \u4e2a \\(-1\\) \u6784\u6210 \\(2\\times n\\) \u9879 \\(a_1,a_2, \\cdots ,a_{2n}\\)\uff0c\\(\\sum\\limits_{i=1}^k a_{i}\\ge 0,~k\\le 2\\times n\\) \uff0c\u6ee1\u8db3\u6b64\u5e8f\u5217\u7684\u65b9\u6848\u6570\u4e3a \\(H_n\\)</p> <ul> <li> <ul> <li>3\uff0c\u8def\u5f84\u95ee\u9898</li> </ul> </li> </ul> <p>\u7ea6\u5b9a\uff1a\u975e\u964d\u8def\u5f84\u662f\u6307\u53ea\u80fd\u5411\u4e0b\u6216\u5411\u53f3\u8d70\u7684\u8def\u5f84</p> <p>\\((a,~b)\\) \u5230 \\((a_1,~b_1)\\) \u7684\u975e\u964d\u8def\u5f84\u6570\u4e3a \\(\\displaystyle \\binom{a_1-a+b_1-b}{a_1-a}\\)</p> <p>\\((0,~0)\\) \u5230 \\((n,~m)\\) \u7684\u975e\u964d\u8def\u5f84\u6570\uff1a \\(\\displaystyle \\binom{n+m}{n}\\)</p> <ul> <li> <ul> <li> <ul> <li>1\uff09\\((0,~0)\\to (n,~n)\\) \u4e0d\u63a5\u89e6 \u5bf9\u89d2\u7ebf\\(y=x\\)\uff08\u9664 \\(2\\) \u4e2a\u7aef\u70b9\u5916\uff09 \u7684\u65b9\u6848\u6570\u4e3a \\(2\\times H_{n-1}\\)</li> </ul> </li> </ul> </li> </ul> <p>\u8bc1\uff1a\u5212\u5206\u4e3a \\((1,~0)\\to (n,~n-1)\\) \u548c \\((0,~1)\\to (n-1,~n)\\)\uff0c\u4e24\u79cd\u65b9\u6848\u5bf9\u79f0\uff0c\u6545\u53ea\u8ba8\u8bba\u5176\u4e2d\u4e00\u79cd\uff0c\u8003\u8651\u5bb9\u65a5\uff0c</p> <p>\u91cd\u70b9\u5173\u6ce8\u7a7f\u8fc7 \\(y=x\\) \u7684\u60c5\u51b5\uff0c\u6ce8\u610f\u5230\u5bf9\u8def\u5f84 \\((1,~0)\\to (n-1,~n)\\) \u4e0a \\(x\\le y\\) \u7684\u70b9\u505a\u5173\u4e8e \\(y=x\\) \u7684\u5bf9\u79f0\u53d8\u6362\u540e\uff0c\u53ef\u4ee5\u4e0e \\((1,~0)\\to (n,~n-1)\\) \u7684\u7ecf\u8fc7 \\(y=x\\) \u7684\u8def\u5f84\u4e00 \u4e00\u5bf9\u5e94\uff0c</p> <p>\u6545\u8be5\u60c5\u51b5\u7684\u65b9\u6848\u4e3a \\(\\displaystyle \\binom{2\\times(n-1)}{n-1} - \\binom{2\\times(n-1)}{n}= H_{n-1}\\) </p> <p>\u603b\u65b9\u6848\u4e3a \\(2\\times H_{n-1}\\)</p> <p>\uff08\u4e0a\u9762\u7b26\u53f7\u540e\u7684\u5f0f\u5b50\u91c7\u7528\u4e86\u8f83\u4e3a\u8ff7\u60d1\u7684\u5199\u6cd5\uff0c\u6ce8\u610f\u8fa8\u8bc6\uff09</p>"},{"location":"oiwiki-%E6%95%B0%E5%AD%A6/%E7%BB%84%E5%90%88%E6%95%B0%E5%AD%A61/#3","title":"3\uff0c\u65af\u7279\u6797\u6570","text":""},{"location":"oiwiki-%E6%95%B0%E5%AD%A6/%E7%BB%84%E5%90%88%E6%95%B0%E5%AD%A62/","title":"\u7ec4\u5408\u6570\u5b662","text":""},{"location":"oiwiki-%E6%95%B0%E5%AD%A6/%E7%BB%84%E5%90%88%E6%95%B0%E5%AD%A62/#_1","title":"\u52a0\u6cd5 &amp; \u4e58\u6cd5\u539f\u7406","text":"<p>\u52a0\u6cd5\u539f\u7406\uff1a\u5b8c\u6210\u4e00\u4e2a\u5de5\u7a0b\u53ef\u4ee5\u6709 \\(n\\) \u7c7b\u529e\u6cd5\uff0c \u4ee3\u8868\u7b2c \\(a_i(1\\le i\\le n)\\) \u7c7b\u65b9\u6cd5\u7684\u6570\u76ee\u3002\u90a3\u4e48\u5b8c\u6210\u8fd9\u4ef6\u4e8b\u5171\u6709 \\(s=a_1+a_2+..+a_n\\) \u79cd\u4e0d\u540c\u7684\u65b9\u6cd5\u3002</p> <p>\u4e58\u6cd5\u539f\u7406\uff1a\u5b8c\u6210\u4e00\u4e2a\u5de5\u7a0b\u9700\u8981\u5206 \\(n\\) \u4e2a\u6b65\u9aa4\uff0c \u4ee3\u8868\u7b2c \\(a_i(1\\le i\\le n)\\) \u4e2a\u6b65\u9aa4\u7684\u4e0d\u540c\u65b9\u6cd5\u6570\u76ee\u3002\u90a3\u4e48\u5b8c\u6210\u8fd9\u4ef6\u4e8b\u5171\u6709 \\(s=a_1+a_2+..+a_n\\) \u79cd\u4e0d\u540c\u7684\u65b9\u6cd5\u3002</p>"},{"location":"oiwiki-%E6%95%B0%E5%AD%A6/%E7%BB%84%E5%90%88%E6%95%B0%E5%AD%A62/#_2","title":"\u6392\u5217\u6570","text":"<p>\u4ecen\u4e2a\u4e0d\u540c\u5143\u7d20\u4e2d\uff0c\u4efb\u53d6\\(m(m\\le n)\\)\u4e2a\u5143\u7d20\uff0c\u6309\u4e00\u5b9a\u987a\u5e8f\u6392\u5217 \u7684\u65b9\u6848\u6570\uff0c\u8bb0\\(A_n^m\\) \\(A_n^m=n\\times(n-1)\\times..\\times(n-m+1)=\\frac{n!}{(n-m)!}\\)</p>"},{"location":"oiwiki-%E6%95%B0%E5%AD%A6/%E7%BB%84%E5%90%88%E6%95%B0%E5%AD%A62/#_3","title":"\u7ec4\u5408\u6570\uff08\u4e8c\u9879\u5f0f\u7cfb\u6570\uff09","text":"<p>\u4ece n \u4e2a\u4e0d\u540c\u5143\u7d20\u4e2d\uff0c\u4efb\u53d6 \\(m(m\\le n)\\) \u4e2a\u5143\u7d20\u7ec4\u6210\u4e00\u4e2a\u96c6\u5408 \u7684\u65b9\u6848\u6570\uff0c\u8bb0\\(C_n^m \u6216(\\begin{matrix}n\\\\m\\end{matrix})\\)</p> <p>$C_nm=\\frac{A_nm}{m!}=\\frac{n!}{(n-m)!\\times m!} $</p> <p>\\(\\binom{n}{m}=\\frac{n^{\\underline m}}{m!}\\)</p> <p>\\(\u89c4\u5b9a\uff1am\\ge n\u65f6\uff0cC_n^m=0\\)</p> <p>\\((\\begin{matrix}n\\\\m\\end{matrix})+(\\begin{matrix}n\\\\m-1\\end{matrix})=(\\begin{matrix}n+1\\\\m\\end{matrix})\\)</p> <p>\\(\\sum\\limits_{i=0}^{n}(\\begin{matrix}n\\\\i\\end{matrix})=2^n\\)</p> <p>\\(\\binom{n-a}{n-b} = \\frac{(n-a)!/(b-a)!}{(n-b)!} = \\frac{(n-a)!}{(b-a)!\\times(n-b)!}\\)</p> <p>\\(\\frac{1}{(b-a)!\\times(n-b)!}=\\frac{\\binom{n-a}{n-b}}{(n-a)!}\\)</p>"},{"location":"oiwiki-%E6%95%B0%E5%AD%A6/%E7%BB%84%E5%90%88%E6%95%B0%E5%AD%A62/#_4","title":"\u4e8c\u9879\u5f0f\u5b9a\u7406","text":"<p>$(a+b)n=\\sum\\limits_{i=0}n(\\begin{matrix}n\\m\\end{matrix})\\times a^{n-i}\\times b^i $</p> <p>\u6269\u5c55\uff08\u591a\u9879\u5f0f\uff09\uff1a\\((a_1+a_2+..+a_k)^n=\\sum\\limits_{\u6ee1\u8db3x_1+x_2+..+x_k=n\u7684\u975e\u8d1f\u6574\u6570\u89e3}(\\begin{matrix}n\\\\x_1x_2..x_k\\end{matrix})\\times a_1^{x_1}\\times a_2^{x_2}\\times..\\times a_k^{x_k}\\)</p> <p>\\(\\sum\\limits_{\u6ee1\u8db3x_1+x_2+..+x_k=n\u7684\u975e\u8d1f\u6574\u6570\u89e3}(\\begin{matrix}n\\\\x_1x_2..x_k\\end{matrix})=k^n\\)</p> <p>\u591a\u91cd\u96c6\uff1a\u5305\u542b\u91cd\u590d\u5143\u7d20\u7684\u5e7f\u4e49\u96c6\u5408\uff0c\u8bb0\\(S=\\{n_1\\times a_1,~n_2\\times a_2,~..,~n_k\\times a_k\\}\\)\uff0c\\(\\sum\\limits_{i=1}^k n_i=n\\)</p>"},{"location":"oiwiki-%E6%95%B0%E5%AD%A6/%E7%BB%84%E5%90%88%E6%95%B0%E5%AD%A62/#_5","title":"\u591a\u91cd\u96c6\u7684\u6392\u5217\u6570","text":"<p>\u5176\u5168\u6392\u5217\u6570\u4e3a\uff1a\\(\\binom{n}{n_1,n_2,..,n_k}=\\frac{n!}{\\prod\\limits_{i=1}^k n_i!}\\)</p>"},{"location":"oiwiki-%E6%95%B0%E5%AD%A6/%E7%BB%84%E5%90%88%E6%95%B0%E5%AD%A62/#1","title":"\u591a\u91cd\u96c6\u7684\u7ec4\u5408\u65701","text":"<p>\u4ece \u591a\u91cd\u96c6S \u4e2d\u9009\u51fa\\(r(r\\le min\\{n_i\\}, i\\in[1,k])\\)\u4e2a\u5143\u7d20\u7ec4\u6210\u4e00\u4e2a \u591a\u91cd\u96c6 \u7684\u65b9\u6848\u6570\u4e3a \\(\\binom{r+k-1}{k-1}\\)</p> <p>\uff08\u76f8\u5f53\u4e8e\\(x_i\\)\u53ef\u4ee5\u4efb\u610f\u53d6\u503c\uff09</p>"},{"location":"oiwiki-%E6%95%B0%E5%AD%A6/%E7%BB%84%E5%90%88%E6%95%B0%E5%AD%A62/#2","title":"\u591a\u91cd\u96c6\u7684\u7ec4\u5408\u65702","text":"<p>\u4ece \u591a\u91cd\u96c6S \u4e2d\u9009\u51fa \\(r\\)\u4e2a\u5143\u7d20\u7ec4\u6210\u4e00\u4e2a \u591a\u91cd\u96c6 \u7684\u65b9\u6848\u6570\u4e3a </p> <p>\\(\\sum\\limits_{i=1}^k x_i=r,~x_i\\le n_i,\\forall~i\\in[1,~k]\\)</p> <p>\u8bbe\\(S_i\\)\u4e3a\\(x_i\\le n_i\\)\uff0c\\(\\overline{S_i}\\)\u4e3a\\(x_i\\ge n_i+1\\)</p> <p>\\(ans=\\left|\\bigcap\\limits_{i=1}^k S_i\\right|=\\left|U\\right|-\\left|\\bigcup\\limits_{i=1}^k \\overline S_i\\right|\\)</p> <p>\u5bb9\u65a5\uff1a\\(\\left|\\bigcup\\limits_{i=1}^k \\overline S_i\\right|=\\sum\\limits_i \\left|\\overline S_i\\right|-\\sum\\limits_{i,j} \\left|\\overline S_i\\cap \\overline S_j\\right| + \\sum\\limits_{i,j, k} \\left|\\overline S_i\\cap \\overline S_j \\cap \\overline S_k\\right|-..+(-1)^{k-1}\\left| \\bigcap\\limits_{i=1}^{k}\\overline S_i\\right|\\)</p> <p>\\(\\sum\\limits_i \\binom{r-(n_i+1)+k-1}{k-1}-\\sum\\limits_{i,j} \\binom{r-((n_i+1) + (n_j+1))+k-1}{k-1} + \\sum\\limits_{i,j, k} \\binom{r-((n_i+1) + (n_j+1) + (n_k+1))+k-1}{k-1}-..+(-1)^{k-1}\\binom{r-\\sum\\limits_{i=1}^k(n_i+1)+k-1}{k-1}\\)</p> <p>\\(ans=\\sum\\limits_{p=0}^k(-1)^p\\times \\sum\\limits_{A_i}\\binom{r-\\sum\\limits_{e\\in A_i}(n_e+1)+k-1}{k-1}\\)</p> <p>\uff08Tips\uff1a\\(P\\)\u679a\u4e3e \u96c6\u5408\\({1..k}\\)\u7684\u5b50\u96c6\u7684\u4e2a\u6570\uff0c\u4e00\u4e2a\\(P\\)\u53ef\u4ee5\u5bf9\u5e94\u591a\u4e2a \\(A_i\\)\uff0c\u6ee1\u8db3\\(P=|A_i|\\)\uff09</p> <p>\uff08\\(P=0\u7684\u60c5\u51b5\u5bf9\u5e94\u5168\u96c6\u7684\u60c5\u51b5\\)\uff09</p>"},{"location":"oiwiki-%E6%95%B0%E5%AD%A6/%E7%BB%84%E5%90%88%E6%95%B0%E5%AD%A62/#_6","title":"\u4e0d\u76f8\u90bb\u7684\u6392\u5217","text":"<p>\\(1\\sim n\\)\u8fd9n\u4e2a\u6b63\u6574\u6570\u4e2d\u9009k\u4e2a\uff0c</p>"},{"location":"oiwiki-%E6%95%B0%E5%AD%A6/%E7%BB%84%E5%90%88%E6%95%B0%E5%AD%A62/#_7","title":"\u9519\u4f4d\u6392\u5217","text":""},{"location":"oiwiki-%E6%95%B0%E5%AD%A6/%E7%BB%84%E5%90%88%E6%95%B0%E5%AD%A62/#_8","title":"\u5361\u5854\u5170\u6570","text":"<p>\\(1, 1, 2, 5, 14, 42, 132, ..\uff08\u4eceH_0\u5f00\u59cb\uff09\\)</p> <p>\\(H_n=H_{n-1}\\times \\frac{4\\times n-2}{n+1}\uff08\u6700\u6838\u9002\uff09\\)</p> <p>\\(H_n=\\frac{\\binom{2\\times n}{n}}{n+1}\\)</p> <p>\\(H_n=\\binom{2\\times n}{n}-\\binom{2\\times n}{n-1}\\)</p> <p>\\(H_n=\\begin{cases}\\sum\\limits_{i=1}^n H_{i-1}\\times H_{n-i}&amp;n\\ge 2,n\\in N_+ \\\\ 1 &amp; n=0, 1\\end{cases}\\)</p> <p>\u6a21\u578b\uff1a</p> <p>1\uff09\u3001\u6709\\(2n\\)\u4e2a\u4eba\u6709\u5e8f\u8fdb\u5165\u5267\u573a\u3002\u5165\u573a\u8d39\\(k\\)\u5143\u3002\u5176\u4e2dn\u4eba\u53ea\u6709\u4e00\u5f20\\(k\\)\u5143\u949e\u7968\uff0c\u53e6\u5916n\u4eba\u53ea\u6709\u4e00\u5f20\\(2k\\)\u5143\u949e\u7968\u3002\u521d\u59cb\u65f6\u552e\u7968\u5904\u6ca1\u949e\u7968\uff0c\u95ee\u552e\u7968\u5904\u5728\u53ef\u6362\u96f6\u94b1\u7684\u60c5\u51b5\u4e0b\u7684\u65b9\u6848\u6570</p> <p>2\uff09\u3001\u5706\u4e0a\u6709\\(2n\\)\u4e2a\u70b9\uff0c\u5c06\u8fd9\u4e9b\u70b9\u6210\u5bf9\u8fde\u63a5\u8d77\u6765\u5f97\u5230 \\(n\\) \u6761\u7ebf\u6bb5\u4e0d\u76f8\u4ea4\u7684\u65b9\u6848\u6570</p> <p>3\uff09\u3001\u4e00\u4e2a\u6808\u8fdb\u6808\u5e8f\u5217\u4e3a\\(1\uff0c2\uff0c3\uff0c..\uff0cn\\)\uff0c\u51fa\u6808\u5e8f\u5217\u7684\u6240\u6709\u65b9\u6848\u6570</p> <p>4\uff09\u3001\\(n\\)\u4e2a \\(+1\\) \u548c \\(n\\) \u4e2a \\(-1\\) \u6784\u6210 \\(2n\\) \u60f3 \\(a_1, a_2, .., a_n\\)\uff0c\u5176\u90e8\u5206\u548c \\(S_i\\ge 0\\)\u7684\u65b9\u6848\u6570</p> <p>5\uff09\u3001\u5bf9\u89d2\u7ebf\u4e0d\u76f8\u4ea4\u7684\u60c5\u51b5\u4e0b\uff0c\u5c06\u4e00\u4e2a\u51f8\u591a\u8fb9\u5f62\u533a\u57df\u5206\u6210\u4e09\u89d2\u5f62\u533a\u57df\u7684\u65b9\u6848\u6570</p> <p>6\uff09\u3001\u4e00\u4f4d\u5927\u57ce\u5e02\u7684\u5f8b\u5e08\u5728\u5979\u4f4f\u6240\u4ee5\u5317\u00a0\\(n\\)\u00a0\u4e2a\u8857\u533a\u548c\u4ee5\u4e1c\u00a0\\(n\\)\u00a0\u4e2a\u8857\u533a\u5904\u5de5\u4f5c\u3002\u6bcf\u5929\u5979\u8d70\u00a0\\(2n\\)\u00a0\u4e2a\u8857\u533a\u53bb\u4e0a\u73ed\u3002\u5982\u679c\u4ed6\u4ece\u4e0d\u7a7f\u8d8a\uff08\u4f46\u53ef\u4ee5\u78b0\u5230\uff09\u4ece\u5bb6\u5230\u529e\u516c\u5ba4\u7684\u5bf9\u89d2\u7ebf\uff0c\u90a3\u4e48\u6709\u591a\u5c11\u6761\u53ef\u80fd\u7684\u9053\u8def\uff1f</p> <p>7\uff09\u3001\\(n\\)\u4e2a\u7ed3\u70b9\u53ef\u6784\u9020\u7684\u4e8c\u53c9\u6811\u65b9\u6848\u6570</p>"},{"location":"oiwiki-%E6%95%B0%E5%AD%A6/%E7%BB%84%E5%90%88%E6%95%B0%E5%AD%A62/#_9","title":"\u8def\u5f84\u8ba1\u6570\u95ee\u9898","text":"<p>\\(\u975e\u964d\u8def\u5f84\uff1a\u53ea\u80fd\u5f80\u4e24\u4e2a\u65b9\u5411\u8d70\u7684\u8def\u5f84\uff08\u5982 \u5f80\u4e0b\u6216\u5f80\u53f3\uff09\\)</p> <p>\\(1\uff0c\u4ece(0, 0)\u8d70\u5230(n, m)\u7684\u975e\u964d\u8def\u5f84\u6570=\\binom{n+m}{n}\\)\uff08\u4ece\u89e3\u5411\u91cf\u4e2d\u53d6n\u4e2a\u5143\u7d20\u4f5c\u4e3a\u5411\u4e0b\u8d70\u7684\u89e3\uff0c\u5269\u4e0b\u7684m\u4e2a\u5143\u7d20\u53ea\u80fd\u662f\u5411\u53f3\u8d70\u7684\u89e3\uff09</p> <p>\\(2\uff0c\u4ece(0, 0)\u8d70\u5230(n, n)\u7684\u9664\u7aef\u70b9\u5916\u4e0d\u63a5\u89e6\u76f4\u7ebf~y=x~\u7684\u975e\u964d\u8def\u5f84\u6570~=~2\\times (\\binom{2\\times n-2}{n-1}-\\binom{2\\times n-2}{n})\\)</p> <p>\\(3\uff0c\u4ece(0, 0)\u5230(n, n)\u7684\u9664\u7aef\u70b9\u5916\u4e0d\u7a7f\u8fc7\u76f4\u7ebf~y=x~\u7684\u975e\u964d\u8def\u5f84\u6570~=~2\\times H_n\\)</p>"},{"location":"oiwiki-%E6%95%B0%E5%AD%A6/%E7%BB%84%E5%90%88%E6%95%B0%E5%AD%A62/#_10","title":"\u7b2c\u4e8c\u7c7b\u65af\u7279\u6797\u6570\uff08\u65af\u7279\u6797\u5b50\u96c6\u6570\uff09","text":"<p>\\(\u8bb0\\begin{Bmatrix}n\\\\k\\end{Bmatrix}\uff0c\u6216 S(n, k)\\)</p> <p>\u5c06n\u4e2a\u4e24\u4e24\u4e0d\u540c\u7684\u5143\u7d20\uff0c\u5212\u5206\u4e3ak\u4e2a\u4e92\u4e0d\u533a\u5206\u7684\u975e\u7a7a\u5b50\u96c6\u7684\u65b9\u6848\u6570</p> <p>\\(\\begin{Bmatrix}n\\\\k\\end{Bmatrix} = \\begin{Bmatrix}n-1\\\\k-1\\end{Bmatrix}+k\\times\\begin{Bmatrix}n-1\\\\k\\end{Bmatrix}\\)</p> <p>\\(\\begin{Bmatrix}n\\\\k\\end{Bmatrix}=\\sum\\limits_{i=0}^k\\frac{(-1)^{k-i}\\times i^n}{i!\\times (k-i)!}\\)</p> <p>\\(\\begin{Bmatrix}n\\\\0\\end{Bmatrix}=[n=0]\\)</p>"},{"location":"oiwiki-%E6%95%B0%E5%AD%A6/%E7%BB%84%E5%90%88%E6%95%B0%E5%AD%A62/#_11","title":"\u7b2c\u4e00\u7c7b\u65af\u7279\u6797\u6570\uff08\u65af\u7279\u6797\u8f6e\u6362\u6570\uff09","text":"<p>\u5c06 \\(k\\) \u4e2a\u4e24\u4e24\u4e0d\u540c\u7684\u5143\u7d20\uff0c\u5212\u5206\u4e3a  \u4e2a\u4e92\u4e0d\u533a\u5206\u7684\u975e\u7a7a\u8f6e\u6362\u7684\u65b9\u6848\u6570\u3002</p> <p>\uff08\u4e00\u4e2a\u8f6e\u6362\u5c31\u662f\u4e00\u4e2a\u9996\u5c3e\u76f8\u63a5\u7684\u73af\u5f62\u6392\u5217\uff09</p> <p>\\(\\begin{bmatrix}n\\\\k\\end{bmatrix} = \\begin{bmatrix}n-1\\\\k-1\\end{bmatrix}+(n-1)\\times\\begin{bmatrix}n-1\\\\k\\end{bmatrix}\\)</p> <p>\\(\\begin{bmatrix}n\\\\0\\end{bmatrix}=[n=0]\\)</p>"},{"location":"oiwiki-%E6%95%B0%E5%AD%A6/%E7%BB%84%E5%90%88%E6%95%B0%E5%AD%A62/#_12","title":"\u4e0a\u5347\u5e42\u4e0e\u666e\u901a\u5e42\u7684\u76f8\u4e92\u8f6c\u5316","text":"<p>\\(\u8bb0\u4e0a\u5347\u5e42\uff1ax^{\\over n}=\\prod\\limits_{i=0}^{n-1}(x+i)\\)</p> <p>\\(x^{\\overline n}=\\sum\\limits_{i}\\begin{bmatrix}n\\\\i\\end{bmatrix}\\times x^i\\)</p> <p>\\(x^n=\\sum\\limits_{i}\\begin{Bmatrix}n\\\\i\\end{Bmatrix}\\times (-1)^{n-i}\\times x^{\\overline i}\\)</p>"},{"location":"oiwiki-%E6%95%B0%E5%AD%A6/%E7%BB%84%E5%90%88%E6%95%B0%E5%AD%A62/#_13","title":"\u4e0b\u964d\u5e42\u4e0e\u666e\u901a\u5e42\u7684\u76f8\u4e92\u8f6c\u5316","text":"<p>\\(\u8bb0\u4e0a\u5347\u5e42\uff1ax^{\\underline n}=\\prod\\limits_{i=0}^{n-1}(x-i)\\)</p> <p>\\(x^n=\\sum\\limits_{i}\\begin{Bmatrix}n\\\\i\\end{Bmatrix}\\times x^{\\underline i}\\)</p> <p>\\(x^{\\underline n}=\\sum\\limits_{i}\\begin{bmatrix}n\\\\i\\end{bmatrix}\\times (-1)^{n-i}\\times x^i\\)</p>"},{"location":"oiwiki-%E6%95%B0%E5%AD%A6/%E7%BB%84%E5%90%88%E6%95%B0%E5%AD%A62/#_14","title":"\u591a\u9879\u5f0f\u4e0b\u964d\u9636\u4e58\u8868\u793a \u4e0e \u591a\u9879\u5f0f\u70b9\u503c\u8868\u793a \u7684\u5173\u7cfb","text":"<p>\\(\u591a\u9879\u5f0f\u7684\u4e0b\u964d\u9636\u4e58\u5e42\u8868\u793a\uff1af(x)=\\sum\\limits_{i=0}^n b_i\\times x^{\\underline i}\\)</p> <p>\\(\u591a\u9879\u5f0f\u7684\u70b9\u503c\u8868\u793a\uff1a(i, a_i), i=0..n\\)</p> <p>\\(\u4e24\u8005\u7684\u5173\u7cfb\uff1a\\)</p> <p>\\(a_k=\\sum\\limits_{i=0}^n b_i\\times k^{\\underline i}\\)</p> <p>\\(\u5373 a_k=\\sum\\limits_{i=0}^n b_i\\times \\frac{k!}{(k-i)!}\\)</p> <p>\\(\\frac{a_k}{k!}=\\sum\\limits_{i=0}^n b_i\\times \\frac{1}{(k-i)!}\\)</p>"},{"location":"oiwiki-%E6%95%B0%E5%AD%A6/%E7%BB%84%E5%90%88%E6%95%B0%E5%AD%A62/#_15","title":"\u8d1d\u5c14\u6570","text":"<p>\\(1, 1, 2, 5, 15, 52, 203, ..\uff08\u4eceB_0\u5f00\u59cb\uff09\\)</p> <p>\u57fa\u6570\u4e3a \\(n\\) \u7684\u96c6\u5408\u7684\u5212\u5206\u65b9\u6cd5\u7684\u6570\u76ee</p> <p>\\(B_{n+1}=\\sum\\limits_{i=0}^n\\binom{n}{i}B_i\\)</p>"},{"location":"oiwiki-%E6%95%B0%E5%AD%A6/%E7%BE%A4%E8%AE%BA/","title":"\u7fa4\u8bba","text":""},{"location":"oiwiki-%E6%95%B0%E5%AD%A6/%E7%BE%A4%E8%AE%BA/#1","title":"1\uff0c\u751f\u6210\u51fd\u6570\u7b80\u4ecb","text":"<p>\u751f\u6210\u51fd\u6570\uff08generating function\uff09\uff0c\u53c8\u79f0\u6bcd\u51fd\u6570\uff0c\u662f\u4e00\u79cd\u5f62\u5f0f\u5e42\u7ea7\u6570\uff0c\u5176\u6bcf\u4e00\u9879\u7684\u7cfb\u6570\u53ef\u4ee5\u63d0\u4f9b\u5173\u4e8e\u8fd9\u4e2a\u5e8f\u5217\u7684\u4fe1\u606f\u3002</p> <p>\u751f\u6210\u51fd\u6570\u6709\u8bb8\u591a\u4e0d\u540c\u7684\u79cd\u7c7b\uff0c\u4f46\u5927\u591a\u53ef\u4ee5\u8868\u793a\u4e3a\u5355\u4e00\u7684\u5f62\u5f0f\uff1a</p> <p>\\(\\displaystyle F_x ~=~ \\sum_{n}a_n\\times k_{n,~x}\\)</p> <p>\u5176\u4e2d \\(k_{n,~x}\\) \u88ab\u79f0\u4e3a\u6838\u51fd\u6570\u3002\u4e0d\u540c\u7684\u6838\u51fd\u6570\u4f1a\u5bfc\u51fa\u4e0d\u540c\u7684\u751f\u6210\u51fd\u6570\uff0c\u62e5\u6709\u4e0d\u540c\u7684\u6027\u8d28\u3002\u4e3e\u4e2a\u4f8b\u5b50\uff1a</p> <ul> <li> <p>1\uff0c\u666e\u901a\u751f\u6210\u51fd\u6570 \\(OGF\\)\uff1a$\\displaystyle OGF_x = \\sum\\limits_{i}a_i\\times k_{i,~x} = \\sum\\limits_{i}a_i\\times x^{i} $</p> </li> <li> <p>2\uff0c\u6307\u6570\u751f\u6210\u51fd\u6570 \\(EGF\\)\uff1a$\\displaystyle EGF_x = \\sum\\limits_{i}a_i\\times k_{i,x} ~= \\sum\\limits_{i}a_i\\times \\frac{x^i}{i!} $</p> </li> <li> <p>3\uff0c\u72c4\u5229\u514b\u96f7\u751f\u6210\u51fd\u6570 \\(DGF\\)\uff1a\\(\\displaystyle EGF_x ~~=~~ \\sum\\limits_{i}a_i\\times k_{i,~~x} ~=~~ \\sum\\limits_{i}a_i\\times \\frac{1}{i^x}\\)</p> </li> </ul> <p>\u53e6\u5916\uff0c\u5bf9\u4e8e\u751f\u6210\u51fd\u6570 \\(F_x\\) \uff0c\u6211\u4eec\u7528\u00a0\\([k_{n,~x}]F_x\\)\u00a0\u6765\u8868\u793a\u5b83\u7684\u7b2c\u00a0\\(n\\)\u00a0\u9879\u7684\u6838\u51fd\u6570\u5bf9\u5e94\u7684\u7cfb\u6570\uff0c\u4e5f\u5c31\u662f\u00a0\\(a_n\\)\u3002</p>"},{"location":"oiwiki-%E6%95%B0%E5%AD%A6/%E7%BE%A4%E8%AE%BA/#2","title":"2\uff0c\u7b26\u53f7\u5316\u65b9\u6cd5","text":"<p>\u7b26\u53f7\u5316\u65b9\u6cd5\uff08\\(symbolic~method\\)\uff09\u662f\u5c06\u7ec4\u5408\u5bf9\u8c61\u5feb\u901f\u8f6c\u6362\u6210\u751f\u6210\u51fd\u6570\u7684\u4e00\u79cd\u65b9\u6cd5\uff0c\u6211\u4eec\u5c06\u8003\u8651\u5bf9\u4e8e\u96c6\u5408\u4e0a\u5b9a\u4e49\u7684\u7279\u5b9a\u8fd0\u7b97\uff0c\u7136\u540e\u5bfc\u51fa\u5176\u5bf9\u5e94\u7684\u751f\u6210\u51fd\u6570\u7684\u8fd0\u7b97\u3002</p> <p></p> <ul> <li>\u65e0\u6807\u53f7\u4f53\u7cfb</li> </ul> <p></p> <p>\uff08\u4e0d\u8ba8\u8bba \u53ef\u5bb9\u8bb8\u6027 \\(admissibility\\)\uff0c\u53ef\u53c2\u8003  Analytic Combinatorics \u7684\u7b2c\u4e00\u7ae0\uff09</p> <p>\u4e24\u79cd\u7279\u6b8a\u7684\u7ec4\u5408\u7c7b \u548c \u7ec4\u5408\u5bf9\u8c61</p> <ul> <li> <ul> <li>\u4e2d\u6027\u5bf9\u8c61 \\(neutral~object\\) \u8bb0\u4f5c \\(\\epsilon\\)\uff0c\u5176\u5927\u5c0f\u4e3a0\uff1b\u4e2d\u6027\u7c7b \\(neutral~class\\) \u8bb0\u4f5c \\(\\mathcal{E} ~=~ \\{\\epsilon \\}\\)\uff0c\u5176OGF\u4e3a \\(E(z) ~=~ 1\\)</li> </ul> </li> <li> <ul> <li>\u539f\u5b50\u5bf9\u8c61 \\(atom~object\\) \u8bb0\u4f5c \\(\\circ \u6216 \\bullet\\) \uff0c\u5176\u5927\u5c0f\u4e3a1\uff1b\u539f\u5b50\u7c7b \\(atom~class\\) \u8bb0\u4f5c $\\mathcal{Z_{\\circ}} = {\\circ} \u6216 \\mathcal{Z_{\\bullet}} = {\\bullet} \u6216 \\mathcal{Z} $\uff0c\u5176OGF\u4e3a \\(Z(z) ~=~ z\\)</li> </ul> </li> </ul> <p>\u5bf9\u4e8e\u4e24\u4e2a\u7ec4\u5408\u7c7b \\(\\mathcal{A}\\) \u548c \\(\\mathcal{B}\\) \u5728\u7ec4\u5408\u610f\u4e49\u4e0a\u540c\u6784\u4e3a \\(\\mathcal{A=B}\\) \u6216 \\(\\mathcal{A\\cong B}\\)\uff0c\u4f46\u4ec5\u5f53\u8be5\u540c\u6784\u4e0d\u5e73\u51e1\u65f6\u624d\u4f7f\u7528\u540e\u8005\u7684\u8bb0\u53f7</p> <p>\uff08\u7ec4\u5408\u7c7b\uff1f\u7ec4\u5408\u5bf9\u8c61\uff1f\u540c\u6784\uff1f\u4e0d\u5e73\u51e1\uff1f\uff09</p> <p>\u6211\u4eec\u6709\uff1a \\(\\mathcal{A}\\cong\\mathcal{E}\\times \\mathcal{A}\\cong\\mathcal{A}\\times\\mathcal{E}\\)</p> <p>\uff08\u5176\u4e2d \\(\\times\\) \u4e3a\u4e8c\u5143\u8fd0\u7b97\uff0c\u8868\u793a\u96c6\u5408\u7684\u7b1b\u5361\u5c14\u79ef\uff09</p> <ul> <li>1\uff0c\u00a0\u96c6\u5408\u7684\uff08\u4e0d\u76f8\u4ea4\uff09\u5e76\u6784\u9020</li> </ul> <p>\u5bf9\u4e8e\u7c7b \\(\\mathcal{A}\\) \u548c \\(\\mathcal{B}\\) \u7684\u5e76\u8bb0\u4e3a\uff1a\\(\\mathcal{A}+\\mathcal{B}=(\\mathcal{E}_{1}\\times\\mathcal{A})+(\\mathcal{E}_2\\times\\mathcal{B})\\)</p> <p></p> <p>\u5bf9\u5e94\u7684OGF\u4e3a\uff1a \\(A(z)+B(z)\\)</p> <p>\u8003\u8651 \\(A(z)+B(z)=\\sum _ {\\alpha\\in\\mathcal{A}}z^{\\lvert \\alpha\\rvert} + \\sum _ {\\beta\\in\\mathcal{B}}z^{\\lvert \\beta\\rvert}=\\sum_{n\\geq 0}(a_n+b_n)z^n\\)</p> <p>\uff08\u5bf9\u5e94\u5f62\u5f0f\u5e42\u7ea7\u6570\u7684\u52a0\u6cd5\uff09</p> <ul> <li>2\uff0c\u96c6\u5408\u7684\u7b1b\u5361\u5c14\u79ef\u6784\u9020</li> </ul> <p>\u5bf9\u4e8e\u7c7b \\(\\mathcal{A}\\) \u548c \\(\\mathcal{B}\\) \u7684\u7b1b\u5361\u5c14\u79ef\u8bb0\u4e3a\uff1a\\(\\mathcal{A}\\times \\mathcal{B}=\\left\\lbrace (\\alpha, \\beta)\\mid \\alpha \\in \\mathcal{A},\\beta\\in\\mathcal{B}\\right\\rbrace\\)</p> <p>\u5bf9\u5e94 OGF \u4e3a\uff1a\\(A(z)\\cdot B(z)\\)</p> <p>\u6211\u4eec\u5b9a\u4e49 \\((\\alpha,~\\beta)\\) \u7684\u5927\u5c0f\u4e3a\u5176\u7ec4\u6210\u90e8\u5206\u7684\u5927\u5c0f\u4e4b\u548c\uff0c\u90a3\u4e48\u663e\u7136\u4e5f\u6709\uff1a\\(\\gamma =(\\alpha_1,\\alpha_2,\\dots ,\\alpha_n)\\implies \\lvert \\gamma\\rvert =\\lvert \\alpha_1\\rvert +\\lvert \\alpha_2\\rvert +\\cdots +\\lvert \\alpha_n\\rvert\\)</p> <p>\u6240\u4ee5\uff1a\\(\\displaystyle A(z)\\cdot B(z)=\\left(\\sum _ {\\alpha\\in\\mathcal{A}}z^{\\lvert \\alpha\\rvert}\\right)\\left(\\sum _ {\\beta\\in\\mathcal{B}}z^{\\lvert \\beta\\rvert}\\right)=\\sum _ {(\\alpha, \\beta)\\in(\\mathcal{A}\\times \\mathcal{B})}z^{\\lvert \\alpha\\rvert +\\lvert \\beta\\rvert}=\\sum_{n\\geq 0}\\sum_{i+j=n}a_ib_jz^n\\)</p> <p>\uff08\u5bf9\u5e94\u5f62\u5f0f\u5e42\u7ea7\u6570\u7684\u4e58\u6cd5\uff09</p> <ul> <li>3\uff0c\u96c6\u5408\u7684 Sequence \u6784\u9020</li> </ul> <p></p> <p></p> <p></p> <p></p> <p>\uff08\u5f00\u6446\uff01\uff01\u5929\u4e66\uff01\uff01\uff1f\uff09</p> <ul> <li>4\uff0c\u96c6\u5408\u7684 Multiset \u6784\u9020</li> </ul> <p></p> <p></p> <p></p> <p></p> <ul> <li> <ul> <li>#6268. \u5206\u62c6\u6570 - \u9898\u76ee - LibreOJ (loj.ac)</li> </ul> </li> <li> <p>P4389 \u4ed8\u516c\u4e3b\u7684\u80cc\u5305 - \u6d1b\u8c37 | \u8ba1\u7b97\u673a\u79d1\u5b66\u6559\u80b2\u65b0\u751f\u6001 (luogu.com.cn)</p> </li> <li> <p>P5900 \u65e0\u6807\u53f7\u65e0\u6839\u6811\u8ba1\u6570 - \u6d1b\u8c37 | \u8ba1\u7b97\u673a\u79d1\u5b66\u6559\u80b2\u65b0\u751f\u6001 (luogu.com.cn)</p> </li> </ul> <p>s</p> <ul> <li>5\uff0c\u96c6\u5408\u7684 Powerset \u6784\u9020</li> </ul>"},{"location":"oiwiki-%E6%95%B0%E5%AD%A6/%E7%BE%A4%E8%AE%BA/#1_1","title":"1\u3001\u7fa4","text":""},{"location":"oiwiki-%E6%95%B0%E5%AD%A6/%E7%BE%A4%E8%AE%BA/#_1","title":"\u5b9a\u4e49","text":"<p>\u5b9a\u4e49\u96c6\u5408\u00a0G\u00a0\u548c\u4f5c\u7528\u4e0e\u96c6\u5408\u00a0G\u00a0\u7684\u4e8c\u5143\u8fd0\u7b97\u00a0\u00d7</p> <p>\u82e5\u5176\u6ee1\u8db3\u4ee5\u4e0b\u00a04\u00a0\u4e2a\u6027\u8d28\uff0c\u5219\u79f0\u5176\u4e3a\u4e00\u4e2a\u7fa4(Group)\uff0c\u8bb0\u4e3a\u00a0( G,\u00d7 )\uff1a</p> <p>\u5c01\u95ed\u6027\\(Closure\\)\u3001\u7ed3\u5408\u5f8b\\(Associativity\\)\u3001\u5355\u4f4d\u5143\\(Identity\\)\uff08\u552f\u4e00\uff09\u3001\u9006\u5143\\(Reverse\\)</p>"},{"location":"oiwiki-%E6%95%B0%E5%AD%A6/%E7%BE%A4%E8%AE%BA/#_2","title":"\u5b50\u7fa4","text":""},{"location":"oiwiki-%E6%95%B0%E5%AD%A6/%E7%BE%A4%E8%AE%BA/#_3","title":"\u966a\u96c6","text":"<ul> <li> <p>\u6027\u8d28\uff08\u4ec5\u8ba8\u8bba\u53f3\u966a\u96c6\uff09</p> </li> <li> <ul> <li>1\uff0c\\(g\\in G,~|H| ~=~ |Hg|\\)</li> </ul> </li> </ul> <p></p> <ul> <li> <ul> <li>2\uff0c\\(\\forall g\\in G,~g\\in Hg\\)</li> </ul> </li> </ul> <p></p> <ul> <li> <ul> <li>3\uff0c\\(Hg = H ~\\iff~ g\\in H\\)</li> </ul> </li> </ul> <p></p> <p>\uff08\u7ed3\u5408\u5b9a\u4e49\\(Hg ~=~ \\{ h\\times g ~|~ h\\in H \\},~ g\\in G\\) \u548c \u7fa4\u7684\u7ed3\u5408\u6027\u53ef\u8bc1\u5f97\uff09</p> <ul> <li> <ul> <li>4\uff0c\\(Ha ~=~ Hb \\iff a\\times b^{-1}\\in H\\)</li> </ul> </li> </ul> <p></p> <ul> <li> <ul> <li>5\uff0c\\(Ha ~\\cap~ Hb ~\\ne~ \\empty \\implies Ha = Hb\\)\uff08\u91cd\u8981\uff09</li> </ul> </li> </ul> <p></p> <ul> <li> <ul> <li>6\uff0c\\(H\\)\u7684\u5168\u4f53\u53f3\u500d\u96c6\u7684\u5e76\u4e3a\\(G\\)</li> </ul> </li> </ul> <p></p> <p></p>"},{"location":"oiwiki-%E6%95%B0%E5%AD%A6/%E7%BE%A4%E8%AE%BA/#2_1","title":"2\u3001\u7f6e\u6362","text":""},{"location":"oiwiki-%E6%95%B0%E5%AD%A6/%E7%BE%A4%E8%AE%BA/#1_2","title":"1\u3001\u7fa4\u8bba","text":"<ul> <li>\u7fa4</li> </ul> <ul> <li>\u7fa4\u7684\u884d\u751f\u7ed3\u6784</li> </ul>"},{"location":"oiwiki-%E6%95%B0%E5%AD%A6/%E7%BE%A4%E8%AE%BA/#2_2","title":"2\u3001\u73af","text":"<ul> <li>\u73af\u7684\u884d\u751f\u7ed3\u6784</li> </ul>"},{"location":"oiwiki-%E6%95%B0%E5%AD%A6/%E7%BE%A4%E8%AE%BA/#3","title":"3\u3001\u57df\uff08\u5373\u4ea4\u6362\u9664\u73af\uff09","text":""},{"location":"oiwiki-%E6%95%B0%E5%AD%A6/%E7%BE%A4%E8%AE%BA/#4","title":"4\u3001\u7fa4\u7684\u57fa\u672c\u6982\u5ff5","text":"<ul> <li>\u7fa4\u540c\u6001\\(group~homomorphism\\)</li> </ul> <ul> <li>\u5b50\u7fa4\\(subgroup\\)</li> </ul> <ul> <li>\u966a\u96c6\\(coset\\)</li> </ul> <ul> <li>\u5546\u7fa4\\(quotient~group\\)</li> </ul> <ul> <li>\u5171\u8f6d\\(conjugate\\)</li> </ul> <ul> <li>\u9636\\(order\\)</li> </ul> <ul> <li>\u5b9a\u74060\uff1a\u7fa4\u4e2d\u4efb\u610f\u4e00\u4e2a\u5143\u7d20\u7684\u9636\uff0c\u4e00\u5b9a\u6574\u9664\u7fa4\u7684\u9636</li> </ul> <p>\\(element~order ~\\mid~ group~order\\)</p> <ul> <li>\u5b9a\u74061\uff1a\u5982\u679c\u7fa4\\(G\\)\u4e2d\u5b58\u5728\u4e24\u4e2a\u5143\u7d20\\(a\\)\u3001\\(b\\)\u7684\u9636\\(m\\)\u3001\\(n\\)\u4e92\u7d20\uff0c\u90a3\u4e48 \\(a^s\\cdot b^t = e \\iff a^s=e,~b^t=e\\)</li> </ul> <p></p> <ul> <li>\u5b9a\u74062\uff1a\u5982\u679c\u7fa4 \\(G\\) \u4e2d\u5b58\u5728\u4e24\u4e2a\u5143\u7d20 \\(x_1\\)\u3001\\(x_2\\) \u7684\u9636\u662f \\(d_1\\)\u3001\\(d_2\\)\uff0c\u90a3\u4e48 \\(G\\) \u4e2d\u4e00\u5b9a\u5b58\u5728\u5143\u7d20 \\(x\\)\uff0c\u9636\u4e3a \\(d=lcm(d_1,~d_2)\\)</li> </ul> <p></p>"},{"location":"oiwiki-%E6%95%B0%E5%AD%A6/%E7%BE%A4%E8%AE%BA/#5","title":"5\u3001\u7fa4\u7684\u4e3b\u8981\u7c7b\u522b","text":"<ul> <li>\u7f6e\u6362\u7fa4\\(permutation~group\\)</li> </ul> <ul> <li>\u5faa\u73af\u7fa4</li> </ul> <ul> <li> <ul> <li>\u5b9a\u74060</li> </ul> </li> </ul> <ul> <li> <ul> <li>\u5b9a\u74061</li> </ul> </li> </ul> <ul> <li>\u77e9\u9635\u7fa4\\(matrix~group\\)\uff08\u7ebf\u6027\u7fa4\\(linear~group\\)\uff09</li> </ul> <ul> <li>\u53d8\u6362\u7fa4\\(transformation~group\\)</li> </ul> <ul> <li>\u62bd\u8c61\u7fa4\\(abstract~group\\)</li> </ul>"},{"location":"oiwiki-%E6%95%B0%E5%AD%A6/%E7%BE%A4%E8%AE%BA/#6","title":"6\u3001\u7f6e\u6362\u7fa4","text":"<ul> <li>\u7f6e\u6362\uff08\u4e00\u79cd\u6620\u5c04\u5173\u7cfb\uff09</li> </ul> <ul> <li>\u7f6e\u6362\u7684\u4e58\u6cd5</li> </ul> <ul> <li>\u7f6e\u6362\u7fa4</li> </ul> <ul> <li>\u5faa\u73af\u7f6e\u6362</li> </ul>"},{"location":"oiwiki-%E6%95%B0%E5%AD%A6/%E7%BE%A4%E8%AE%BA/#7burnside","title":"7\u3001Burnside\u5b9a\u7406","text":"<p>\uff08\u79bb\u6563\u6570\u5b66\u7684\u77e5\u8bc6\u56de\u987e\uff1a\u7b49\u4ef7\u7c7b\u548c\u5546\u96c6\uff0c\uff08\u778e\u56de\u987e\uff09\uff09</p> <p>\\(|X/G| ~=~ \\frac{\\sum\\limits_{g\\in G}|X^g|}{|G|}\\)</p> <ul> <li>\u4e3e\u4f8b\uff08\u7f6e\u6362\u7fa4 - OI Wiki (oi-wiki.org)\uff09</li> </ul> <p></p> <ul> <li>\u8bc1\u660e\u7565\uff08\u8f68\u9053\u7a33\u5b9a\u5b50\u5b9a\u7406\\(Orbit-Stabilizer~Theorem\\)\uff09</li> </ul>"},{"location":"oiwiki-%E6%95%B0%E5%AD%A6/%E7%BE%A4%E8%AE%BA/#8polya","title":"8\u3001p\u00f3lya\u5b9a\u7406","text":"<p>\uff08\\(c_g\\)\u4e5f\u79f0\u4e3a\u5faa\u73af\u8282\u6570\uff09</p> <ul> <li> <p>\u9898\u76ee</p> </li> <li> <p>P4980 \u3010\u6a21\u677f\u3011P\u00f3lya \u5b9a\u7406 - \u6d1b\u8c37 | \u8ba1\u7b97\u673a\u79d1\u5b66\u6559\u80b2\u65b0\u751f\u6001 (luogu.com.cn)</p> </li> <li> <p>P4727 [HNOI2009]\u56fe\u7684\u540c\u6784\u8ba1\u6570 - \u6d1b\u8c37 | \u8ba1\u7b97\u673a\u79d1\u5b66\u6559\u80b2\u65b0\u751f\u6001 (luogu.com.cn)</p> </li> <li> <p>P4128 [SHOI2006] \u6709\u8272\u56fe - \u6d1b\u8c37 | \u8ba1\u7b97\u673a\u79d1\u5b66\u6559\u80b2\u65b0\u751f\u6001 (luogu.com.cn)</p> </li> <li> <p>P6597 \u70ef\u70c3\u8ba1\u6570 - \u6d1b\u8c37 | \u8ba1\u7b97\u673a\u79d1\u5b66\u6559\u80b2\u65b0\u751f\u6001 (luogu.com.cn)</p> </li> <li> <p>P5900 \u65e0\u6807\u53f7\u65e0\u6839\u6811\u8ba1\u6570 - \u6d1b\u8c37 | \u8ba1\u7b97\u673a\u79d1\u5b66\u6559\u80b2\u65b0\u751f\u6001 (luogu.com.cn)</p> </li> <li> <p>#6538. \u70f7\u57fa\u8ba1\u6570 \u52a0\u5f3a\u7248 \u52a0\u5f3a\u7248 - \u9898\u76ee - LibreOJ (loj.ac)</p> </li> <li> <p>#6512. \u300c\u96c5\u793c\u96c6\u8bad 2018 Day8\u300dC - \u9898\u76ee - LibreOJ (loj.ac)</p> </li> </ul>"},{"location":"oiwiki-%E6%95%B0%E5%AD%A6/%E7%BE%A4%E8%AE%BA/#9bursidepolya","title":"9\u3001\u5e38\u89c1\u7684\u5faa\u73af\u8282\u6570\uff08\u7ed3\u5408Burside\u6216p\u00f3lya\uff0c\u5f88\u91cd\u8981\uff01\uff01\uff09","text":"<p>\u300c\u7b97\u6cd5\u7b14\u8bb0\u300dPolya \u5b9a\u7406 - maoyiting - \u535a\u5ba2\u56ed (cnblogs.com)</p>"},{"location":"%E5%88%B7%E9%A2%98/1.%E6%95%B0%E8%AE%BA/","title":"1.\u6570\u8bba","text":"<p>\u6613\u9519\u70b9\uff1a</p> <p>1\uff09\u7ebf\u6027\u7b5b\uff1a\\(int~st[]\\) \u5728\\(c++17\\) \u4e0d\u53ef\u4ee5\u7528 \\(bool\\) \u8d4b\u503c\uff1b\\(st[0]=st[1]=true\\) \u52a1\u5fc5\u52a0\u4e0a</p> <p>2\uff09\\(gcd(),~exgcd(),~fp(),~log()\\) \u5fc5\u5f00 \\(long~long\\) \uff0c\u5426\u5219\u5bb9\u6613 \\(RE\\)</p> <p>3\uff09\u6709 \\(P=1e9+7\\) \u6216 \\(n&lt; 2^{31}\\)  \u7b49\u6807\u5fd7 \u5fc5\u987b\u5f00 \\(long~long\\) </p> <p>\uff08\u6bd4\u8f83\u96be\u7684\u9898\uff1a\\(B,~P,~Q,~X\\)\uff1b</p> <p>\u7591\u4f3c\u83ab\u6bd4\u4e4c\u65af\u53cd\u6f14\u4f46\u53c8\u4e0d\u662f\uff1a\\(H,~O,~Y\\)\uff09</p>"},{"location":"%E5%88%B7%E9%A2%98/1.%E6%95%B0%E8%AE%BA/#a-n-a_i-a_i","title":"A\uff0c\u7ed9\u5b9a \\(n\\) \u4e2a\u6570\uff0c\\(a_i\\) \u7684\u8d21\u732e\u662f\u4e0d\u5c0f\u4e8e \\(a_i\\) \u7684\u6b27\u62c9\u51fd\u6570\u503c\u7684\u4e0b\u6807\uff0c\u6c42\u603b\u8d21\u732e","text":"<p>\u8bb0 \\(f\\) \u4e3a\u6b27\u62c9\u51fd\u6570</p> <p>\\(f_i\\le i-1,~f_{p}=p-1 \\implies f_i\\le p-2\\le f_p-1,~i=1..p-1\\)</p> <p>\\(\\implies i\\le f_p, i=1..p-1\\)</p>"},{"location":"%E5%88%B7%E9%A2%98/1.%E6%95%B0%E8%AE%BA/#b","title":"B\uff0c\u6700\u5927\u72ec\u7acb\u96c6\uff08\u4e24\u4e24\u4e4b\u5546\u4e0d\u4e3a\u7d20\u6570\uff08\u8981\u6c42\u6574\u9664\uff09\uff09;","text":"<p>\u524d\u7f6e\uff1a\u4e8c\u5206\u56fe\uff0c\u56fe\u7684\u5339\u914d</p>"},{"location":"%E5%88%B7%E9%A2%98/1.%E6%95%B0%E8%AE%BA/#c","title":"C\uff0c\u6c42\u6ee1\u8db3\u6761\u4ef6\u7684\u201c\u4e58\u6cd5\u5171\u8f6d\u56e0\u5b50\u5bf9\u201d\u7684\u5bf9\u6570","text":"<p>\u5373\u6ee1\u8db3 \\(n~=~x\\times y\\) \uff0c\\(~x,y\\ge k\\)\uff0c\\(k\\le n\\le 1e12\\) \u7684\u4e8c\u5143\u7ec4 \\((x,~y)\\) \u5bf9\u6570</p> <p>\u7531\u4e8e\u6570\u7ec4\u7ec4\u6570 \\(T\\le 1e4\\)\uff0c\u76f4\u63a5\u8bd5\u9664\u6cd5 \\(O(\\sqrt{n})\\) \u4f1a\u8d85\u65f6</p> <p>\u8003\u8651\u7ebf\u6027\u7b5b\u9884\u5904\u7406\u7d20\u6570\uff0c\u518d\u505a\u5206\u89e3\u8d28\u56e0\u5b50\u6c42\u5f97\u56e0\u5b50\u603b\u6570 \\(d_n\\)\uff0c\u590d\u6742\u5ea6\uff1a$O(\\frac{\\sqrt{n}}{\\ln{\\sqrt{n}}}) $\uff08\u778e\u731c\u7684\u590d\u6742\u5ea6\uff09</p> <p>\u7531\u4e8e \u56e0\u5b50\u603b\u6570 \\(d\\) \u548c \u201c\u5171\u8f6d\u56e0\u5b50\u5bf9\u6570\u201d \\(m\\) \u7684\u5173\u7cfb\u4e3a\uff1a\\(m = \\lfloor\\frac12\\times\\Sigma\\rfloor\\)</p> <p>\u6700\u540e\u66b4\u529b \\(O(k)\\) \u6392\u9664\u4e0d\u6ee1\u8db3 \\(x,y\\ge k\\) \u7684\u5bf9\u6570</p> <p>\u603b\u590d\u6742\u5ea6\uff1a\\(O(\\frac{\\sqrt{n}}{\\ln{\\sqrt{n}}}+k)\\) \uff08\\(k\\le \\sqrt{n}\\)\uff0c\u5426\u5219\u7b54\u6848\u662f \\(0\\)\uff09</p> <p>\uff08\u5206\u89e3\u8d28\u56e0\u5b50\u7684\u7b97\u6cd5\u7684\u57fa\u672c\u7406\u8bba\u79f0 \u552f\u4e00\u5206\u89e3\u5b9a\u7406\uff09</p> <p>\uff08\u56e0\u5b50\u603b\u6570\uff1a $\\displaystyle d_n = \\prod_{i=1}^k(\\alpha_i+1) $ \uff09</p> <p>\u5355\u6b21\u6c42\u56e0\u5b50\u6570\u7b97\u6cd5\u7684\u5fae\u8c03\uff1a\uff08\u5206\u89e3\u5b9a\u7406\u52a0\u901f\uff09</p> <pre><code>int gd(int n){\nint ans = 1;\nfor(int i=1; i&lt;=idx &amp;&amp; p[i]*p[i]&lt;=n; ++i){\nif(n % p[i]);\nint alpha = 0;\nfor(; !(n % p[i]); n /= p[i]) ++ alpha;\nans *= alpha + 1;\n}\nif(n &gt; 1) ans *= 2;\nreturn ans;\n}\n</code></pre>"},{"location":"%E5%88%B7%E9%A2%98/1.%E6%95%B0%E8%AE%BA/#dsumlimits_i1nsigma_if","title":"D\uff0c\u6c42\\(\\sum\\limits_{i=1}^n[\\sigma_i=F]\\)","text":"<p>\u9898\u76ee\u7ed9\u51fa\u7ea6\u6570\u548c\u516c\u5f0f\uff08\u8bef\u5bfc\u5411\uff09\uff1a$ \\displaystyle \\sigma_n = \\prod_{i=1}k\\sum_{j=0}p_i^j = \\prod_{i=1}k\\frac{p_i-1}{p_i-1}$</p> <ul> <li>1\uff0c\u5f15\u5165\u5947\u5076\u7684\u6027\u8d28</li> </ul> <p>\u8bbe \\(T\\) \u4e3a\u5947\uff0c \\(F\\) \u4e3a\u5076\uff0c \\(f_n\\) \u4e3a\u5947\u5076\u6027\u51fd\u6570</p> <p>\uff08\\(T\uff0cF\\) \u5206\u522b\u5bf9\u5e94\u4e8c\u8fdb\u5236\u7684 \\(1,~0\\)\uff1b\u53ef\u5bf9\u5176\u8fdb\u884c \u5f02\u6216 \u6216\u8005 \u4e0e \u8fd0\u7b97\uff09</p> <p>\\(f_n := (n==T)=(n==T~?~T~:~F)\\)</p> <p>\\(f_a\\pm f_b=a\\) ^ \\(b\\) \uff0c\u7b80\u8bb0\u4e3a \\(a+b\\)</p> <p>\\(f_a\\times f_b=a~\\&amp;~b\\)\uff0c\u7b80\u8bb0\u4e3a \\(a\\times b\\)</p> <ul> <li> <ul> <li>\\(T^k=T,~F^k=F,~k\\ge 1\\implies f_n^k=f_n,~k\\ge 1\\)</li> </ul> </li> <li> <ul> <li>\\(T^0~=~F^0~=~T\\)</li> </ul> </li> <li> <ul> <li>\u4e58\u6cd5\u5355\u4f4d\u5143\uff1a\\(T\\times f_n ~=~ f_n\\times T ~=~ f_n\\)</li> </ul> </li> <li> <ul> <li>\u5f02\u6216\u5355\u4f4d\u5143\uff1a\\(F+f_n ~=~ f_n+F ~=~ f_n\\)</li> </ul> </li> <li> <ul> <li>\\(n\\times T=f_n\\times T=f_n\\)</li> </ul> </li> <li> <ul> <li>\\(n\\times F=F\\)</li> </ul> </li> <li> <p>2\uff0c \\(\\sigma_n=\\prod\\limits_{i=1}^k\\sum\\limits_{j=0}^{a_i}p_i^j\\)</p> </li> </ul> <p>\u7531\u4e8e \\(\\sigma_n\\) \u662f\u7531\u4e00\u4e2a\u4e58\u79ef\u7684\u5f62\u5f0f\u5f97\u5230\uff0c\u6240\u4ee5\u7edf\u8ba1 \\((\\sigma_n==T)\\) \u65b9\u4fbf\u8ba1\u7b97\uff0c\u6700\u540e\u53ea\u8981\u5bb9\u65a5\u4e00\u4e0b</p> <p>\u4f7f\u7528\u201c\u771f\u503c\u8868\u201d \u201c\u9012\u5f52\u5730\u201d\u5316\u7b80\uff1a</p> \\(\\sum\\limits_{j=0}^{a_1}2^j\\) \\(2^0\\) \\(2^j,~j\\ge1\\) \\(T+a_1\\times F\\) \\(T\\) \\(F\\) \\(T\\) \\(\\sum\\limits_{j=0}^{a_i}p_i^j,~i\\ge2\\) \\(p_i^0\\) \\(p_i^j,~j\\ge 1\\) \\(T\\times(a_i+1)\\) \\(T\\) \\(T\\) \\((a_i==F)\\) <p>\u4e8e\u662f \\(\\sigma_n=\\prod\\limits_{i=1}^k\\sum\\limits_{j=0}^{a_i}p_i^j=T\\times \\prod\\limits_{i=2}^k(a_i==F)\\)</p> <p>\\(\\sigma_n=T\\iff a_i=F,~i\\ge2\\)</p> <p>\u6240\u4ee5 \\(\\sigma_n=2^{a_1}\\times x^2,~a_1\\ge0\\)</p> <p>\u5f53 \\(a_1=0\\) \u65f6\uff0c \\(\\sigma_n=x^2\\)\uff0c \u4e3a\u5b8c\u5168\u5e73\u65b9\u6570</p> <p>\u5f53 \\(a_1\\ge 1\\) \u65f6\uff0c\\(\\sigma_n=2^{a_1}\\times x^2 =\\begin{cases}2\\times (2^{\\frac{a_1-1}{2}}\\times x)^2 &amp; a_1=T\\\\(2^{\\frac{a_1}{2}}\\times x)^2 &amp; a_1=F\\end{cases}\\)</p> <p>\u7efc\u4e0a \\(n=x^2~\u6216~2\\times x^2\\) \u65f6\uff0c \\(\\sigma_n=F\\)</p> <p>\uff08\u8bc1\u660e\uff1a\u4e00\u4e2a\u6570\u4e0d\u53ef\u80fd\u540c\u65f6\u7b49\u4e8e \\(x^2\\) \u6216 \\(2\\times x^2\\)\uff0c\\(x\\ge 1\\)</p> <p>\u8bc1\uff1a\u95ee\u9898\u7b49\u4ef7\u4e8e \\(x^2=2\\times y^2\\) \u6709\u6839</p> <p>\u89e3\uff1a\\(x=\\sqrt2\\times y\\) \u6216 \\(x=-\\sqrt2\\times y\\)</p> <p>\u53ea\u6709\u4e00\u4e2a\u6574\u6570\u89e3\uff1a \\(x=0,~y=0\\)\uff08\u4e0d\u6ee1\u8db3\\(x\\ge 1\\)\uff09\uff0c\u5f97\u8bc1\uff09</p>"},{"location":"%E5%88%B7%E9%A2%98/1.%E6%95%B0%E8%AE%BA/#e-nk","title":"E\uff0c\u8f93\u51fa \\(n^k\\) \u7684\u9ad8\u4e09\u4f4d\u548c\u4f4e\u4e09\u4f4d\u6570\u5b57","text":"<p>\uff08\u8981\u8865 \u540e\u5bfc\u96f6 \u548c \u524d\u5bfc\u96f6\uff09</p> <p>\u5173\u952e\u5728\u4e8e\u7b2c\u4e00\u95ee\uff1a\u8f93\u51fa\u9ad8\u4e09\u4f4d</p> <p>\u7531\u4e8e\u76f4\u63a5\u641e\u53ef\u80fd\u6ea2\u51fa\uff0c\u53c2\u8003\\(fft\\) \u7684\u624b\u6bb5\u5148\u5bf9 \\(n\\) \u53d610\u4e3a\u5e95\u7684\u5bf9\u6570\uff08\u6b63\u53d8\u6362\uff09\uff0c\u6b21\u65b9\u5c31\u53d8\u6210\u4e86\u4e58\u6cd5\uff0c\u5e76\u4e14\u9664\u53bb\u6574\u6570\u90e8\u5206\uff08\u5bf9\u5e94ans\u7684\u4f4d\u6570\uff09\u7559\u4e0b\u5c0f\u6570\u90e8\u5206\uff0c\u518d\u52a0\u4e0a\\((3-1)\\)\uff0c\u7136\u540e\u53d610\u4e3a\u5e95\u7684\u6b21\u65b9\uff08\u9006\u53d8\u6362\uff1b\u5f97\u5230\u6700\u9ad8\u4e3a\u4e2a\u4f4d\u7684\u6d6e\u70b9\u6570\uff09\uff0c\u5411\u4e0b\u53d6\u6574</p> <p>\u6570\u5b66\u8868\u793a\uff1a</p> <p>\\(n^k ~=~ (10^{log_{10}(n)})^k ~=~ 10^{k\\times log_{10}(n)}\\)</p> <p>\uff08\\(log_{10}(n)\\) \u53ef\u4ee5\u8868\u793a\u6210 \\(a~e~b\\) \uff0c\\(a\\) \u662f\u6700\u9ad8\u4f4d\u4e3a\u4e2a\u4f4d\u7684\u6d6e\u70b9\u6570\uff0c\u5bf9\\(log_{10}(n)\\) \u8fdb\u884c\u6a211\u64cd\u4f5c\u53ef\u4ee5\u628a \\(b\\) \u7f6e\u96f6\uff09</p>"},{"location":"%E5%88%B7%E9%A2%98/1.%E6%95%B0%E8%AE%BA/#fgoldbachs-conjecture","title":"F\uff0cGoldbach's conjecture\uff08\u5df4\u8d6b\u731c\u60f3\uff09","text":"<p>\u6570\u636e\u91cf\uff1a \\(n=4e7\uff0cT=300\\)</p> <p>\u8ba1\u7b97\u6ee1\u8db3 \\(n = x + y\\)\uff0c\\(x,y\\in~prime,~x\\le y\\) \u7684\u5143\u7ec4 \\((x~,y)\\) \u7684\u4e2a\u6570\uff0c\u7ebf\u6027\u7b5b\u6c42\u51fa\u8d28\u6570\u548c\u8d28\u6570\u5224\u65ad\u8868\uff0c\u5c06\u679a\u4e3e\u4f18\u5316\u5230 \\(O(\\frac{n}{\\ln{n}})\\) </p> <p>\uff08\u201c\u52a0\u6cd5\u5171\u8f6d\u56e0\u5b50\u5bf9\u201d\uff09</p>"},{"location":"%E5%88%B7%E9%A2%98/1.%E6%95%B0%E8%AE%BA/#g","title":"G\uff0c\u5206\u5757","text":""},{"location":"%E5%88%B7%E9%A2%98/1.%E6%95%B0%E8%AE%BA/#h-sumlimits_i1nsumlimits_jinijn-n1e14","title":"H\uff0c\u8ba1\u7b97  \\(\\sum\\limits_{i=1}^n\\sum\\limits_{j=i}^n[[i,~j]=n]\\) \uff08n=1e14\uff09","text":"<p>\uff08\u5206\u89e3\u8d28\u56e0\u5b50\u53ef\u4ee5\u7528\u4e8e \u201c\u7ea6\u6570\u6784\u9020\u201d \uff1f\uff09</p> <p>\u5373\u8ba1\u7b97 \u6ee1\u8db3 \\([x,~y]=n\\)\uff0c\\(x\\le y\\) \u7684\u5143\u7ec4 \\((x,~y)\\) \u7684\u4e2a\u6570</p> <p>\u5206\u89e3\u8d28\u56e0\u5b50\uff1a</p> <p>\\(\\displaystyle n ~=~ \\prod_{i=1}^k p_i^{e_i},~~ e_i=max\\{ \\alpha_i,~\\beta_i \\} \\\\ x~=~ \\prod_{i=1}^k p_i^{\\alpha_i} \\\\ y ~=~ \\prod_{i=1}^k p_i^{\\beta_i}\\)</p> <p>\uff08warning\uff1a\u5bf9 \\(x,~y\\) \u7684\u5206\u89e3\u662f\u4e0d\u4e25\u683c\u7684\uff0c\u56e0\u4e3a\u6709\u53ef\u80fd \\(\\alpha_i,~b_i=0\\)\uff09</p> <p>1\uff09\\(a_i=0~..~e_i,~b_i=e_i\\)\uff0c\u8d21\u732e\uff1a\\(e_i+1\\)</p> <p>2\uff09\\(a_i=e_i,~b_i=0~..~e_i-1\\)\uff0c\u8d21\u732e\uff1a\\(e_i\\)</p> <p>\u6240\u4ee5\u5bf9\u4e8e \\(p_i\\)\uff0c\u6709 \\(2\\times e_i+1\\) \u79cd\u65b9\u6848</p> <p>\u6839\u636e\u4e58\u6cd5\u539f\u7406\uff0c\\([x,~y]=n\\) \u7684\u65b9\u6848\u6570\u4e3a \\(\\prod\\limits_{i=1}^k(2\\times e_i+1)\\)</p> <p>\u5bf9\u4e8e \\([x,y]=n,x=y\\)\uff0c\u65b9\u6848\u6570\u4e3a 1 \uff08\u5373 \\((n,~n)\\)\uff09</p> <p>\u5bf9\u4e8e \\([x,~y]=n,x&lt;y\\)\uff0c\u53d1\u6848\u6570\u4e3a \\(\\lfloor\\frac{\\prod\\limits_{i=1}^k(2\\times e_i+1)}{2}\\rfloor\\)</p> <p>\u5bf9\u4e8e \\([x,~y]=n,x\\le y\\)\uff0c\u65b9\u6848\u6570\u4e3a \\(\\lfloor\\frac{\\prod\\limits_{i=1}^k(2\\times e_i+1)}{2}\\rfloor+1\\)</p> <p>\uff08\u7ebf\u6027\u7b5b\u52a0\u901f\u8d28\u56e0\u5b50\u5206\u89e3\uff0c\u590d\u6742\u5ea6\u4e3a\\(O(\\frac{\\sqrt{n}}{\\log{\\sqrt{n}}})\\)\uff1b</p> <p>\u4ee4 \\(f_n=\\frac{\\sqrt{n}}{\\log{\\sqrt{n}}}\\)\uff0c\\(f_{1e14}=5e5\\)\uff0c\\(f_{1e18}=3e7\\)\uff09</p> <p>\uff08\\(n=1e16\\)\u7684\u6781\u9650\u60c5\u51b5\u4e0b\uff0c\u53ef\u4ee5\u628a\u66b4\u529b\u7684 \\(1e32\\) \u964d\u5230 \\(3e7\\)\uff09</p>"},{"location":"%E5%88%B7%E9%A2%98/1.%E6%95%B0%E8%AE%BA/#iharmonic-number","title":"I\uff0cHarmonic Number","text":"<p>\u8c03\u548c\u7ea7\u6570 $H_n = \\sum\\limits_{i=1}^n \\frac{1}{i} = \\ln{n} + 1.0/(2\\times n) + r $</p> <p>\\(r=0.57721566490153286060651209\\)</p> <p>\uff08\\(r\\) \u53ea\u9700\u8981\u77e5\u9053\u524d10\u4f4d\uff0c\u800c\u4e14 \\(r\\) \u4e0d\u7528\u8bb0\uff0c\u9760 \\(n=1e8\\) \u7684\u6837\u4f8b\u53cd\u63a8\u5373\u53ef\uff1b</p> <p>\u6ce8\u610f\uff1a\u4e3a\u4e86\u5f97\u5230\u8f83\u5927\u7684\u7cbe\u5ea6\uff0c\\(n\\) \u5c0f\u4e8e\\(1e6\\) \u65f6\u5e94\u7528\u524d\u7f00\u548c\u67e5\u8be2\uff0c\u653e\u4e4b\u7528\u516c\u5f0f\u67e5\u8be2\uff09</p>"},{"location":"%E5%88%B7%E9%A2%98/1.%E6%95%B0%E8%AE%BA/#j-nbpnbpin-z-p","title":"J\uff0c\u6ee1\u8db3 \\(n=b^p,~n,b,p\\in Z\\) \u7684 \\(p\\) \u6700\u5927\u503c","text":"<p>\uff08\u6ce8\u610f\uff1a\\(n\\) \u53ef\u4ee5\u662f\u8d1f\u6570\uff09</p> <p>\u4e3b\u8981\u662f \\(n\\) \u5206\u89e3\u540e\u6b21\u6570\u7684\u6700\u5927\u516c\u7ea6\u6570\uff0c\u5982\u679c \\(n\\) \u662f\u8d1f\u6570\uff0c\u5219\u628a \\(ans\\) \u53d8\u6210\u5947\u6570</p> <p>\u8d1f\u6570\u7684\u60c5\u51b5\u53ef\u8868\u793a\u4e3a\uff1a\\(-n = (-b)^p,~n,~b,~p\\in Z^+\\implies p~is~odd\\)</p> <p>\uff08\u4e0d\u5927\u4e8e \\(n\\) \u7684\u6700\u5927\u5947\u6570\u4e3a\uff1a\\(\\frac{n\\&amp;-n}{n}\\)\uff09</p>"},{"location":"%E5%88%B7%E9%A2%98/1.%E6%95%B0%E8%AE%BA/#k32","title":"K\uff0c\u5224\u65ad\u5927\u6570\u662f\u5426\u88ab32\u4f4d\u6570\u6574\u9664","text":""},{"location":"%E5%88%B7%E9%A2%98/1.%E6%95%B0%E8%AE%BA/#l","title":"L\uff0c\u8ba1\u7b97 \u8d21\u732e\u5f0f","text":"<p>\\(\\displaystyle \\sum_{a_1=0}^{n-1}\\sum_{a_2=0}^{n-1}\\dots\\sum_{a_k=0}^{n-1}(A_{a_1}+A_{a_2}+\\dots + A_{a_k})\\pmod{p}\\)</p> <p>\uff08\\(\\sum\\limits_{i=1}^n\\sum\\limits_{j=1}^m(f_i+g_j) = m\\times\\sum\\limits_{i=1}^n f_i+n\\times\\sum\\limits_{j=1}^m g_j\\)\uff09</p> <p>\\(= \\displaystyle n^{k-1}\\times \\sum_{a_1=0}^{n-1}A_{a_1}+n\\sum_{a_2=0}^{n-1}\\dots\\sum_{a_k=0}^{n-1}(A_{a_2}+\\dots + A_{a_k})\\pmod{p}\\)</p> <p>$= \\dots $</p> <p>\\(\\displaystyle = k\\times n^{k-1}\\times\\sum_{i=0}^n A_i\\)</p>"},{"location":"%E5%88%B7%E9%A2%98/1.%E6%95%B0%E8%AE%BA/#m","title":"M\uff0c\u7b5b\u533a\u95f4\u8d28\u6570","text":"<p>\u7531\u4e8e \\(len\\le 1e5\\)\uff0c\u8003\u8651\u57c3\u6c0f\u7b5b</p> <p>\u5148\u7b5b \\(\\sqrt{n}\\) \u4ee5\u5185\u7684\u8d28\u6570\uff08\u56e0\u4e3a\u4e0d\u5c0f\u4e8e \\(\\sqrt{n}\\) \u7684\u6570\u4e00\u5b9a\u4e0d\u6574\u9664 \\(n\\)\uff09</p> <p>\u7136\u540e\u679a\u4e3e\u4e0d\u5927\u4e8e \\(\\sqrt{ub}\\) \u7684\u8d28\u6570 \\(p\\)\uff0c\u7b5b\u53bb \\(k\\times p\\)\uff0c\\(~k\\ge 2,~k\\times p \\ge lb\\)</p> <p>\u6700\u540e\u7edf\u8ba1\u672a\u88ab\u7b5b\u7684\u6570</p> <p>\uff08warning\uff1a\u57c3\u6c0f\u7b5b \u6216\u662f \u7ebf\u6027\u7b5b \u90fd\u4e0d\u80fd\u7b5b\u6389 \\(0\\) \u548c \\(1\\)\uff0c\u5fc5\u987b\u7279\u5224\uff01\uff01\uff01\uff09</p>"},{"location":"%E5%88%B7%E9%A2%98/1.%E6%95%B0%E8%AE%BA/#n-q-n-n","title":"N\uff0c\u6c42 \u5c3e\u968f\u96f6\u4e3a \\(Q\\)\u4e2a \u7684 \\(n!\\) \u5bf9\u5e94\u7684\u6700\u5c0f\u7684 \\(n\\)","text":"<p>\\(n!\\) \u8d8a\u5927\uff0c\u5c3e\u968f\u96f6\u5c31\u8d8a\u5927\uff08\u5f53\u7136\u6837\u4f8b\u4e5f\u53ef\u4ee5\u7c97\u7565\u8bc1\u660e\uff09</p> <p>\\(n!\\) \u7684\u5c3e\u968f\u96f6\u7b97\u6cd5\uff1a\\(\\displaystyle min\\{\\sum\\limits_{i=1}^{\\infin}\\lfloor\\frac{n}{2^i}\\rfloor,~\\sum\\limits_{i=1}^{\\infin}\\lfloor\\frac{n}{5^i}\\rfloor\\}=\\sum\\limits_{i=1}^{\\infin}\\lfloor\\frac{n}{5^i}\\rfloor\\)</p> <p>\u7531\u4e8e\u6ee1\u8db3\u5355\u8c03\u6027\uff0c\u4e8c\u5206\u7b54\u6848\u5373\u53ef</p>"},{"location":"%E5%88%B7%E9%A2%98/1.%E6%95%B0%E8%AE%BA/#odisplaystylesum_i1n-1sum_ji1nij","title":"O\uff0c\\(\\displaystyle\\sum_{i=1}^{n-1}\\sum_{j=i+1}^n(i,j)\\)","text":"<p>\u8303\u56f4\uff1a\\(n\\le 4e6\\)\uff0c \\(100\\) \u7ec4\u6570\u636e</p> <p>\u53c2\u8003\u5de8\u5de8\u7684\u9898\u89e3\uff1aUVA11426 \u62ff\u884c\u674e\uff08\u6781\u9650\u7248\uff09 GCD - Extreme (II) - \u6d1b\u8c37 | \u8ba1\u7b97\u673a\u79d1\u5b66\u6559\u80b2\u65b0\u751f\u6001 (luogu.com.cn)</p> <p></p> <p>\u6b63\u786e\u63a8\u5bfc\uff1a \\(\\displaystyle \\sum_{i=1}^{n-1}\\sum_{j=i+1}^n(i,~j)=\\sum_{j=2}^n\\sum_{i=1}^{j-1}(i,~j)=\\sum_{j=2}^n(\\sum_{i=1}^{j}(i,~j) - (j,~j))\\\\=\\sum_{j=2}^n\\sum_{i=1}^j(i,~j)-\\sum_{j=2}^n j = \\sum_{j=2}^n\\sum_{d|j}\\phi_{\\frac{j}{d}}\\times d-\\frac{n\\times (n+1)}{2}+1\\)</p> <p>\u9884\u5904\u7406\u524d\u4e00\u90e8\u5206\u7684\u524d\u7f00\u548c\u5373\u53ef\uff0c\u590d\u6742\u5ea6\\(O(n\\times log_n)\\to O(1)\\)</p> <p>\uff08\u5b9e\u9645\u4e0a\u53ef\u4ee5\u7528\u7ebf\u6027\u7b5b\u4f18\u5316 \u9884\u5904\u7406\u7684\u90e8\u5206\u5230 \\(O(n)\\) \uff09\u00a0\u00a0\u00a0\u00a0</p>"},{"location":"%E5%88%B7%E9%A2%98/1.%E6%95%B0%E8%AE%BA/#p","title":"P\uff0c\u201d\u4ee3\u7801\u76db\u5bb4\u201c\uff08\u96be\u9898\uff09","text":"<p>\u7ed9\u5b9a\u65b9\u7a0b \\(x \\equiv a_i\\pmod{b_i},~a_i=A_{i,~j},~j=1..k_i\\)\uff0c\u6c42\u65b9\u7a0b\u7684\u524d \\(m\\) \u4e2a\u89e3</p> <p>\u60c5\u51b51\uff1a\u82e5\\(\\prod\\limits_{i=1}^n k_i\\le 1e4\\)\uff0c\u5219\u66b4\u529b\u679a\u4e3e\u6bcf\u4e00\u7ec4\u65b9\u7a0b\u7684 \\(a_i\\) \u7684\u6240\u6709\u60c5\u51b5\uff0c\u7528\u4e2d\u56fd\u5269\u4f59\u5b9a\u7406\u89e3\u51fa\u6240\u6709\u6700\u5c0f\u6b63\u6574\u6570\u89e3\uff08\\(&lt; pb\\)\uff09\uff0c\u6392\u5e8f\uff0c\u8f93\u51fa\uff08\u82e5 \\(m\\ge n\\) \u5219\uff0c\u5bf9\u6240\u6709\u6b63\u6574\u6570\u89e3\u52a0\u4e0a \\(t\\times pb,~t\\ge 1\\)\uff0c\u663e\u7136\u8fd9\u4e9b\u89e3 \\(\\ge t\\times pb\\)\uff09</p> <p>\uff08\u590d\u6742\u5ea6\uff1a\\(O(1e4\\times n)\\)\uff09</p> <pre><code>#define int long long\nint n, m;\nint a[10][100], k[10], b[10];\nint exgcd(int a, int b, int &amp;x, int &amp;y){\nif(!b) return x = 1, y = 0, a;\nint d = exgcd(b, a % b, x, y), x1 = x;\nreturn x = y, y = x1 - a / b * y, d;\n}\nint crt(int n, int a[], int b[]){\nint ans = 0, pb = 1;\nfor(int i=0; i&lt;n; ++i) pb *= b[i];\nfor(int i=0; i&lt;n; ++i){\nint b1 = pb/b[i], ib1, d = exgcd(b1, b[i], ib1, d);\nans = (ans + b1 * ib1 % pb * a[i] % pb + pb) % pb;\n}\nreturn ans;\n}\nint len, ans[10000];\nint A[10];\nvoid dfs(int u){\nif(u == n) return void(ans[len ++ ] = crt(n, A, b));\nfor(int i=0; i&lt;k[u]; ++i){\nA[u] = a[u][i];\ndfs(u + 1);\n}\n}\nvoid case1(){\nlen = 0, dfs(0);\nsort(ans, ans+len);\nint pb = 1;\nfor(int i=0; i&lt;n; ++i) pb *= b[i];\nfor(int t=0; m; ++t){\nfor(int i=0; i&lt;len; ++i){\nint x = ans[i] + t * pb;\nif(!x) continue;\n-- m, cout &lt;&lt; x &lt;&lt; '\\n';\nif(!m) return ;\n}\n}\n}\n</code></pre> <p>\u60c5\u51b52\uff1a\\(\\prod\\limits_{i=1}^n k_i &gt; 1e4\\)\uff0c\u5219\u627e\u51fa \\(min\\{\\frac{k_i}{b_i}\\}\\)\uff0c\u4ee4 \\(best=i\\) \uff0c\u53ef\u4ee5\u8bc1\u660e\uff08\uff1f\uff09 \\(A_{best,~j}\\%b_j\\) \u662f\u524d\u51e0\u4e2a\u6700\u5c0f\u6b63\u6574\u6570\u89e3\uff0c\u5bf9 \\(A_{best,~j}\\) \u6392\u5e8f\uff0c\u8f93\u51fa \\((A_{best,~j}+t\\times b_j)\\%b_j\\)\uff08\u8f93\u51fa\u524d\u9700\u8981\u5224\u65ad\u8be5\u89e3\u662f\u5426\u662f\u5176\u4ed6\u6240\u6709\u65b9\u7a0b\u7ec4\u7684\u7279\u89e3\\(A_{i,~j}\\% b_i\\) \uff0c\u5e76\u4e14\u540c\u4e00\u4e2a\u65b9\u7a0b\u7ec4\u5185\u53ea\u9700\u5b58\u5728\u4e00\u4e2a\u7279\u89e3\uff09</p> <p>\u590d\u6742\u5ea6\uff1a\\(\\ge O(m\\times n\\times \\log{k})\\)</p> <p>\uff08\u4e0d\u7528scanf\uff0cprintf\uff0c\u6570\u7ec4\u5b58 \\(A[~][~]\\) \u5fc5TLE\uff09</p> <pre><code>// n \u4e2a\u5269\u4f59\u7cfb \nvector&lt;set&lt;int&gt;&gt; mp;\nvoid case2(int best){\nmp.clear(), mp.resize(n);\nfor(int i=0; i&lt;n; ++i){\nif(i == best) continue;\nfor(int j=0; j&lt;k[i]; ++j){\nmp[i].insert(a[i][j] % b[i]);\n}\n}\nsort(a[best], a[best]+k[best]);\nfor(int t=0; m; ++t){\nfor(int j=0; j&lt;k[best]; ++j){\nint x = a[best][j] + t * b[best];\nif(!x) continue;\nbool ok = true;\nfor(int i=0; i&lt;n; ++i){\nif(i == best) continue;\nif(!mp[i].count(x % b[i])){\nok = false;\nbreak;\n}\n}\nif(ok) -- m, cout &lt;&lt; x &lt;&lt; '\\n';\nif(!m) return ;\n}\n}\n}\n</code></pre>"},{"location":"%E5%88%B7%E9%A2%98/1.%E6%95%B0%E8%AE%BA/#q","title":"Q\uff0c\u77e9\u9635\u7740\u8272","text":"<p>\u5bf9 \\(n\\times m\\) \u7684\u77e9\u9635\u7740\u8272 \\(k\\) \u79cd\u989c\u8272\uff0c\u8981\u6c423\u540c\u4e00\u5217\u4e2d\u4e0a\u4e0b\u4e24\u4e2a\u76f8\u90bb\u7684\u683c\u5b50\u4e0d\u540c\u8272\uff0c\u5e76\u4e14\u7ed9\u5b9a \\(b\\) \u4e2a\u4e0d\u53ef\u7740\u8272\u7684\u683c\u5b50\\((x_i,~y_i)\\)\uff0c\u5176\u65b9\u6848\u6570\u4e3a \\(r\\)</p> <p>\u5df2\u77e5 \\(m,~k,~b,~r\\)\uff0c\u548c \\((x_i,~y_i),~i=1..b\\)\uff0c\u6c42 \\(n\\) \u7684\u6700\u5c0f\u6b63\u6574\u6570\u89e3</p>"},{"location":"%E5%88%B7%E9%A2%98/1.%E6%95%B0%E8%AE%BA/#r","title":"R\uff0c\u9752\u86d9\uff08\u5f85\u6df1\u5165\u7814\u7a76\uff09","text":""},{"location":"%E5%88%B7%E9%A2%98/1.%E6%95%B0%E8%AE%BA/#s","title":"S\uff0c\u5faa\u73af","text":""},{"location":"%E5%88%B7%E9%A2%98/1.%E6%95%B0%E8%AE%BA/#t","title":"T\uff0c\u6590\u6ce2\u90a3\u5951\u57fa\u6570\uff08\u6a21\u62df\uff0c\u8d2a\u5fc3\uff0c\u8f93\u51fa\u683c\u5f0f\uff09","text":""},{"location":"%E5%88%B7%E9%A2%98/1.%E6%95%B0%E8%AE%BA/#uforce","title":"U\uff0c\u5224\u8d28\u6c34\u9898\uff08force\uff09","text":""},{"location":"%E5%88%B7%E9%A2%98/1.%E6%95%B0%E8%AE%BA/#vgcdforce","title":"V\uff0cgcd\uff08force\uff09","text":"<p>\u7c7b\u4f3c\u6c34\u9898</p> <p>CF1370A Maximum GCD - \u6d1b\u8c37 | \u8ba1\u7b97\u673a\u79d1\u5b66\u6559\u80b2\u65b0\u751f\u6001 (luogu.com.cn)</p>"},{"location":"%E5%88%B7%E9%A2%98/1.%E6%95%B0%E8%AE%BA/#wforcesuf","title":"W\uff0c\u533a\u95f4\u5224\u8d28\uff08force\uff0csuf\uff0c\u6d6e\u70b9\u9ad8\u7cbe\u5ea6\uff09","text":"<p>\uff08\u7ed3\u679c\u4e0d\u52a0 \\(1e-8\\) \u5fc5 \\(wa\\)\uff09</p>"},{"location":"%E5%88%B7%E9%A2%98/1.%E6%95%B0%E8%AE%BA/#x","title":"X\uff0c\u7ebf\u6027\u540c\u4f59\u65b9\u7a0b\uff08\u7537\uff09","text":"<p>\uff08\u4e0d\u540c\u7684\u53d6\u6574\u65b9\u6cd5\uff1a</p> <p>\u5411\u96f6\u53d6\u6574\uff1a\\(int(1.0\\times\\frac{x}{y}),~int(1.0\\times\\frac{x+y-1}{y})\\)</p> <p>\u5411\u8d1f\u65e0\u7a77\u53d6\u6574\uff1a\\(floor(1.0\\times\\frac{x}{y}),~ceil(1.0\\times\\frac{x}{y})\\)\uff09 </p>"},{"location":"%E5%88%B7%E9%A2%98/1.%E6%95%B0%E8%AE%BA/#ysumlimits_i1nsumlimits_ji1nij1","title":"Y\uff0c\\(\\sum\\limits_{i=1}^n\\sum\\limits_{j=i+1}^n[(i,~j)=1]\\)","text":"<p>\\(n\\le 1e6\\)\uff0c\u591a\u7ec4\u6570\u636e</p> <p>\\(=\\sum\\limits_{j=2}^n\\sum\\limits_{i=1}^{j-1}[(i,~j)=1] = \\sum\\limits_{j=2}^n\\phi_{j}\\)</p>"},{"location":"%E5%88%B7%E9%A2%98/1.%E6%95%B0%E8%AE%BA/#z-1264-1","title":"Z\uff0c\u6253\u5370 \\(1\\)~\\(2^{64}-1\\) \u4ee5\u5185\u7684\u201c\u8d85\u7ea7\u5e42\u201d","text":"<p>\u201c\u8d85\u7ea7\u5e42\u201d\u7684\u5b9a\u4e49\uff1a\\(n\\) \u81f3\u5c11\u53ef\u8868\u793a\u4e24\u79cd \\(n = m^k\\) \u6b64\u7c7b\u5f62\u5f0f</p> <p>\uff08\u7279\u6b8a\u60c5\u51b5\uff1a\u5f53 \\(n=1\\) \u65f6\uff0c\\(n\\) \u4e5f\u662f\u8d85\u7ea7\u5e42\uff09</p> <p>\u4e00\u4e2a\u6570\u4e3a\u201c\u8d85\u7ea7\u5e42\u201d\u7684\u7b49\u4ef7\u6761\u4ef6\uff1a\\(x=a^b,~a\\ge 2,~b\\ge 4,~b~is~not~prime\\) \u6216 \\(x=1\\)</p> <p>\u7531\u4e8e \\(x=a^b&lt; 2^{64}\\)\uff0c\u6240\u4ee5\u679a\u4e3e\u8fc7\u7a0b\u4e2d\u6781\u6613\u6ea2\u51fa\uff0c\u800c\u89c2\u5bdf \\(a,~b\\) \u53ef\u6709\u6548\u5730\u9632\u6b62\u6ea2\u51fa</p> <p>\u7531 \\(b\\ge 4\\implies a&lt; (2^{64})^{\\frac{1}{4}}=2^{16}\\)\uff08 \\(a\\) \u7684\u7edd\u5bf9\u4e0a\u754c\uff09</p> <p>\u800c \\(b&lt;\\log_{a}{2^{64}}\\) \uff08\\(b\\) \u7684\u7cbe\u786e\u4e0a\u754c\uff09</p> <p>\u6240\u4ee5\uff0c\\(2\\le a&lt; 2^{16},~4\\le b&lt; \\log_{a}{2^{64}},~\\) \u53ef\u7b5b\u51fa \u975e \\(1\\) \u7684\u201c\u8d85\u7ea7\u5e42\u201d\uff0c\u4f46\u9700\u8981\u53bb\u91cd</p>"},{"location":"%E5%88%B7%E9%A2%98/10.kmp/","title":"10.kmp","text":"<p>\u76f8\u5173\u7b97\u6cd5\uff1adp\uff0c\u4e8c\u5206</p>"},{"location":"%E5%88%B7%E9%A2%98/10.kmp/#b","title":"B\uff0c\u7ed9\u5b9a\u5b57\u7b26\u4e32\uff0c\u6309\u7167\u5176\u5448\u5468\u671f\u6027\u7684\u5b50\u4e32\u538b\u7f29\u4e3a\u5927\u5c0f\u4e3a\u6700\u5c0f\u6b63\u5468\u671f\u7684\u65b0\u5b50\u4e32\uff0c\u4f46\u4e0d\u540c\u7684\u538b\u7f29\u65b9\u6848\u6700\u7ec8\u5f97\u5230\u7684\u5b57\u7b26\u4e32\u5927\u5c0f\u4e0d\u540c\uff0c\u6c42\u5b57\u7b26\u4e32\u538b\u7f29\u540e\u7684\u6700\u5c0f\u957f\u5ea6","text":"<p>\u8003\u8651\u533a\u95f4dp\uff08\u57fa\u7840\u590d\u6742\u5ea6\u4e3a \\(O(n^2)\\)\uff09</p> <p>\u5bf9\u6bcf\u4e2a\u5f85\u5408\u5e76\u7684\u533a\u95f4 \\(f_{lb,~ub}\\)\uff0c\u6709\u4e24\u79cd\u51b3\u7b56\uff1a</p> <p>1\uff09\u5e38\u7528\u505a\u6cd5\uff1a\u679a\u4e3e\u5206\u5272\u70b9 \\(mid=lb..ub-1\\)\uff0c\u5212\u5206\u4e3a\u4e24\u4e2a\u533a\u95f4 \\([lb,~mid],~[mid+1,ub]\\)\uff0c\u5c06\u4e24\u8005\u5408\u5e76\uff0c\u590d\u6742\u5ea6\uff1a \\(O(n)\\)</p> <p>2\uff09\u533a\u95f4 \\([lb,~ub]\\) \u5177\u6709\u5468\u671f\u6027\uff0c\u6700\u5c0f\u6b63\u5468\u671f\u4e3a \\(m\\)\uff0c \u5219\u66f4\u65b0\u4e3a \\([lb,~lb+m-1]\\)</p> <p>\u6700\u7ec8\u590d\u6742\u5ea6\uff1a\\(O(n^3)\\)</p>"},{"location":"%E5%88%B7%E9%A2%98/10.kmp/#c8","title":"C\uff0c\u7ed9\u5b9a\u5b57\u7b26\u4e32\uff0c\u67d0\u4e2a\u524d\u7f00\u5fc5\u6709\u5468\u671f\u6027\uff0c\u89c4\u5b9a\u5176\u5468\u671f\u6027\u4e3a\u6700\u5927\u5468\u671f\uff0c\u8f93\u51fa\u5b57\u7b26\u4e32\u540e\u5e8f\u76848\u4e2a\u5b57\u7b26","text":"<p>\u6309\u524d\u7f00\u957f\u5ea6\u4ece\u5927\u5230\u5c0f\u8d2a\u5fc3\u5730\u8ba1\u7b97\u6bcf\u4e2a\u524d\u7f00\u7684\u6700\u5c0f\u5468\u671f\u5373\u53ef</p>"},{"location":"%E5%88%B7%E9%A2%98/10.kmp/#d-a-s-tk0a-1-a-t-a-s-s-t","title":"D\uff0c\u7ed9\u5b9a \u5b57\u7b26\u96c6 \\(A\\)\uff0c\u6a21\u5f0f\u4e32 \\(S\\)\uff0c\u6587\u672c\u4e32 \\(T\\)\uff0c\\(k=0..|A|-1\\) \u6b21\u5faa\u73af\u53f3\u79fb \\(A\\) \uff0c \\(T\\) \u4e2d\u7684\u5b57\u7b26\u4e5f\u76f8\u5e94\u7684\u6539\u53d8\uff08\u6bcf\u4e2a\u5b57\u7b26\u59cb\u7ec8\u6620\u5c04\u5230 \\(A\\) \u4e2d\u7684\u67d0\u4e2a\u4f4d\u7f6e\uff09\uff0c\u800c \\(S\\) \u4e0d\u53d8\uff1b\u7edf\u8ba1\u53f3\u79fb\u540e \" \\(S\\) \u5728 \\(T\\)\u4e2d\u4ec5\u51fa\u73b0\u4e00\u6b21\u201d \u7684\u4e2a\u6570","text":"<p>\u5178\u578b\u7684\u6a21\u5f0f\u5339\u914d\uff0c\u6784\u9020\u5b57\u7b26\u4e32 \\(S+'\\#'+T\\) \u8ba1\u7b97\u6ee1\u8db3\u524d\u7f00\u51fd\u6570 \\(=|S|\\) \u7684\u4e2a\u6570\u5373\u53ef</p>"},{"location":"%E5%88%B7%E9%A2%98/10.kmp/#e-ss","title":"E\uff0c\u7ed9\u5b9a\u4e00\u4e2a\u5b57\u7b26\u4e32 \\(S\\)\uff0c\\(S\\) \u7684\u67d0\u4e2a\u524d\u7f00\u7684\u7ffb\u8f6c\u4e32\u79f0\u4e3a \u201c\u5bc6\u8bed\u201d\uff0c\u6c42\u6700\u957f\u7684 \u201c\u5bc6\u8bed\u201d","text":"<p>\\(S\\) \u4f5c\u4e3a\u6a21\u5f0f\u4e32\uff0c\u8bbe\u5176\u7ffb\u8f6c\u4e32\u4e3a \\(S'\\) \uff0c\u6784\u9020 \\(K=S+'\\#'+S'\\) \uff0c\u6c42\u524d\u7f00\u51fd\u6570\uff0c\u7136\u540e\u8ba1\u7b97 \\(\\max\\limits_{i=|s|+2..|K|}\\pi_{i}\\) \u5373\u53ef</p> <p>\u597d\u50cf\u4e8c\u5206\u80fd\u505a\uff1f</p>"},{"location":"%E5%88%B7%E9%A2%98/10.kmp/#fac","title":"F\uff0cAC\u81ea\u52a8\u673a","text":""},{"location":"%E5%88%B7%E9%A2%98/10.kmp/#g","title":"G\uff0c\u5b57\u7b26\u4e32\u5339\u914d\uff08\u6c34\uff09","text":""},{"location":"%E5%88%B7%E9%A2%98/10.kmp/#hdpkmp","title":"H\uff0cdp+kmp","text":"<p>CodeForces 808 G. Anthem of Berland - Beginner2670 - \u535a\u5ba2\u56ed (cnblogs.com)</p> <p>Codeforces 808G Anthem of Berland\u3010KMP\u3011\u3010DP\u3011 - Dream_maker_yk - \u535a\u5ba2\u56ed (cnblogs.com)</p>"},{"location":"%E5%88%B7%E9%A2%98/10.kmp/#i","title":"I\uff0c","text":""},{"location":"%E5%88%B7%E9%A2%98/11.%E5%8C%BA%E9%97%B4dp/","title":"11.\u533a\u95f4dp","text":"<ul> <li> <p>\u4e24\u4e2a\u95ee\u9898\uff1a\u8fb9\u754c\u5904\u7684\u53d6\u503c\uff08\u5982 \\(len=1/2..\\) \u65f6\uff09\uff0c\u5982\u4f55\u51b3\u7b56\uff08\u590d\u6742\u5ea6\u4f18\u5316\u7684\u5173\u952e\uff09</p> </li> <li> <p>\u533a\u95f4dp\u590d\u6742\u5ea6\u7684\u4e0b\u9650\u4e3a \\(O(n^2)\\)\uff0c</p> </li> </ul> <p>(50\u6761\u6d88\u606f) \u533a\u95f4dp\u5165\u95e8\u2014\u2014\u603b\u7ed3+\u4e60\u9898+\u89e3\u6790_mumei314\u7684\u535a\u5ba2-CSDN\u535a\u5ba2_\u533a\u95f4dp\u590d\u6742\u5ea6</p>"},{"location":"%E5%88%B7%E9%A2%98/2.%E6%A0%91%E7%8A%B6%E6%95%B0%E7%BB%84/","title":"2.\u6811\u72b6\u6570\u7ec4","text":"<p>\u6811\u72b6\u6570\u7ec4\\(bug\\)\u641c\u67e5\uff1a</p> <ul> <li>\u9700\u521d\u59cb\u5316 \\(tr[~]\\)</li> <li>\u4e0b\u6807\u4e0d\u80fd\u5c0f\u4e8e \\(1\\) \uff08\u7279\u522b\u662f\u6743\u503c\u6811\u72b6\u6570\u7ec4\uff09</li> <li>\u6811\u72b6\u6570\u7ec4\u548c\u79bb\u6563\u5316\u7ecf\u5e38\u4e00\u8d77\u7528</li> <li>\u6811\u72b6\u6570\u7ec4\u7ed3\u5408map\u548c\u79bb\u6563\u5316\u53ef\u5904\u7406\u5927\u8303\u56f4\u7684\u6570\u636e\uff0c\u4f46\u7528map\u4f1a\u591a\u4e00\u4e2a \\(log\\) \u7684\u590d\u6742\u5ea6</li> <li>\u5e94\u7528\uff1a\u201c\u5177\u6709\u5c5e\u6027\u9650\u5236\u7684\u524d\u7f00\u548c\u95ee\u9898\u201d\uff0c\u9006\u5e8f\u5bf9\uff0c\u626b\u63cf\u7ebf\uff0c\u503c\u67e5\u6392\u540d\uff0c\u6392\u540d\u67e5\u503c\uff08\u4e8c\u5206\uff09</li> </ul>"},{"location":"%E5%88%B7%E9%A2%98/2.%E6%A0%91%E7%8A%B6%E6%95%B0%E7%BB%84/#a","title":"A\uff0c\u9006\u5e8f\u5bf9\u4e2a\u6570","text":"<p>\\(poj\\) \u4e0a\u6210\u529f\u7684 \\(wa\\) \u4e86\uff0c\u4e0d\u77e5\u9053\u51fa\u4e86\u795e\u9a6c\u79bb\u5947\u9519\u8bef</p>"},{"location":"%E5%88%B7%E9%A2%98/2.%E6%A0%91%E7%8A%B6%E6%95%B0%E7%BB%84/#b-n-x_iy_ii1nsumlimits_j1nx_iy_igex_jy_ji1n","title":"B\uff0c\u7ed9\u5b9a \\(n\\) \u4e2a\u4e8c\u5143\u7ec4 \\((x_i,~y_i),~i=1..n\\)\uff0c\u6c42\\(\\sum\\limits_{j=1}^n[(x_i,~y_i)\\ge(x_j,~y_j)],~i=1..n\\)","text":"<p>\u66b4\u529b\u505a\u590d\u6742\u5ea6\u5c31\u662f \\(O(n^2)\\)</p> <p>\u5bf9 \\(y\\) \u548c \\(x\\) \u5347\u5e8f\u6392\u5e8f\uff08\u8f93\u5165\u6570\u636e\u81ea\u7136\u6ee1\u8db3\uff0c\u6240\u4ee5\u4e0d\u7528\u5904\u7406\uff1b\\(y\\) \u4e3a\u7b2c\u4e00\u4f18\u5148\u7ea7\uff09 </p> <p>\u904d\u5386\u5143\u7ec4\uff0c\u90a3\u4e48\u4e4b\u524d\u904d\u5386\u8fc7\u7684\u5143\u7ec4 \\(y_{pre}\\le y_i\\)\uff0c\\(x_{pre}\\) \u4e0e \\(x_i\\) \u7684\u5927\u5c0f\u5173\u7cfb\u672a\u77e5\uff0c\u6240\u4ee5\u7528\u6743\u503c\u6811\u72b6\u6570\u7ec4\u7ef4\u62a4 \u7b2c\u4e8c\u4f18\u5148\u7ea7 \\(x\\)\uff0c\u6c42\u533a\u95f4 \\(1..x_i\\) \u7684\u5143\u7d20\u4e2a\u6570</p> <p>\uff08\u6ce8\u610f\uff1a\u4e3a\u4e86\u4e0d\u628a\u5f53\u524d\u5143\u7ec4 \\((x_i,~y_i)\\) \u52a0\u5165\u8ba1\u7b97\uff0c\u8981 \u67e5\u8be2\u540e\u518d\u63d2\u5165\uff09</p>"},{"location":"%E5%88%B7%E9%A2%98/2.%E6%A0%91%E7%8A%B6%E6%95%B0%E7%BB%84/#c","title":"C\uff0c\u6734\u7d20\u4e8c\u7ef4\u6811\u72b6\u6570\u7ec4","text":"<p>\uff08\u601d\u8003\uff1a\u6811\u72b6\u6570\u7ec4\u5982\u4f55\u786e\u4fdd\u4fee\u6539\u540e \u67d0\u4e2a\u5143\u7d20 \u7684\u503c\u4e0d\u8d85\u8fc7\u4e0a\u9650\u6216\u4e0b\u9650\uff1f\uff0c</p> <p>\u7136\u800c\u786e\u4fdd\u67d0\u6bb5\u533a\u95f4 \u7684\u4e0a\u4e0b\u9650\u662f\u5f88\u5bb9\u6613\u505a\u5230\u7684\uff09</p>"},{"location":"%E5%88%B7%E9%A2%98/2.%E6%A0%91%E7%8A%B6%E6%95%B0%E7%BB%84/#dn-sumlimits_j1nx_ige-x_jy_ile-y_jlen_ilen_ji1n","title":"D\uff0c\\(n\\) \u4e2a\u4e8c\u5143\u7ec4\uff0c\u6c42 \\(\\sum\\limits_{j=1}^n[x_i\\ge x_j,~y_i\\le y_j,~len_i&lt;len_j],~i=1..n\\)","text":"<p>\u5148\u8bb0\u5f55\u5143\u7ec4\u7684 \\(id\\) \uff01\uff01\uff08\u56e0\u4e3a\u6392\u5e8f\u540e\u4f1a\u5bfc\u81f4 \\(id\\) \u6df7\u4e71\uff09</p> <p>\u5bf9 \\(x\\) \u5347\u5e8f\uff0c\\(y\\) \u964d\u5e8f\uff08\\(x\\) \u4e3a\u7b2c\u4e00\u4f18\u5148\u7ea7\uff0c\u904d\u5386\u65f6 \\(x\\) \u81ea\u7136\u6ee1\u8db3 \\(x\\) \u7684\u9650\u5236 \\(x_i\\ge x_j\\)\uff09</p> <p>\u904d\u5386\u4e8c\u5143\u7ec4\uff0c\u4e3a\u4e86\u4e0d\u5c06\u5f53\u524d\u5143\u7ec4\u548c\u4e0e\u5f53\u524d\u5143\u7ec4\u76f8\u540c\u7684\u5143\u7ec4\u8ba1\u5165\u7b54\u6848\uff0c\u5e94\u8be5\u7279\u5224\u5f53\u524d\u5143\u7ec4\u8fc7\u53bb\u662f\u5426\u5df2\u51fa\u73b0\uff0c\u82e5\u51fa\u73b0\u8fc7\uff0c\u5219\u5f53\u524d \\(id\\) \u7684\u7b54\u6848\u662f\u4e0a\u4e00\u4e2a \\(id\\) \u7684\u7b54\u6848\uff0c\u5426\u5219\u67e5\u8be2\u533a\u95f4 \\(y..max\\)\uff0c\u628a\u7b54\u6848\u653e\u5165 \u5f53\u524d\\(id\\) \u5bf9\u5e94\u7684\u4f4d\u7f6e</p> <p>\uff08\u6ce8\u610f\uff1a\u5f53 \\(x_i\\ne x_{i-1}\\)\u6216 \\(~y_i\\ne y_{i-1}\\) \u65f6\uff0c\u9650\u5236 \\(len_i&lt; len_j\\) \u81ea\u7136\u6210\u7acb\uff09</p>"},{"location":"%E5%88%B7%E9%A2%98/2.%E6%A0%91%E7%8A%B6%E6%95%B0%E7%BB%84/#e-sumlimits_i1n-s_","title":"E\uff0c\u4e8c\u7ef4\u7684\u5e8f\u95ee\u9898\uff1a\u6c42 \\(\\sum\\limits_{i=1}^n S_{&lt;,~&gt;}\\)","text":"<ul> <li>\u8bbe\u96c6\u5408 \\(|\\displaystyle S_{x_i~OP_1~x_j,~y_i~OP_2~y_j}|\\) \u8868\u793a \u5faa\u73af\u904d\u5386\u5230\u7b2c \\(i\\) \u4e2a\u4e8c\u5143\u7ec4\u65f6\uff0c\u6ee1\u8db3\u8868\u8fbe\u5f0f \\(x_i~~OP_1~~x_j,~~y_i~~OP_2~y_j\\) \uff08\\(j=1..i-1\\)\uff09\u7684\u6811\u72b6\u6570\u7ec4\u4e2d\u7684\u4e8c\u5143\u7ec4\u7684\u4e2a\u6570\uff0c</li> </ul> <p>\u7b80\u8bb0\u4e3a \\(S_{OP_1,~OP_2}\\)\uff0c\u5982 \\(S_{&gt;,~&lt;}\\)</p> <ul> <li> <p>\u8bbe \\(|S|\\) \u4e3a\u5faa\u73af\u904d\u5386\u5230\u7b2c \\(i\\) \u4e2a\u4e8c\u5143\u7ec4\u65f6\uff0c\u524d \\(i-1\\) \u4e2a\u5143\u7ec4\u6784\u6210\u7684\u96c6\u5408\u4e2a\u6570\uff08\u5176\u5b9e\u5c31\u662f\\(i-1\\)\uff09\uff1b\u8bbe \\(|S_{~,~OP}|\\) \u8868\u793a\u5bf9 \\(S\\) \u96c6\u5408\u8fdb\u884c\u67e5\u8be2\u7684\u8fd4\u56de\u503c\uff0c\u5982 \\(S{~,~&gt;}\\) \u8868\u793a\u5bf9 \u96c6\u5408\\(S\\) \u67e5\u8be2\u6ee1\u8db3 \\(y_i&gt;y_j\\) \u7684\u4e8c\u5143\u7ec4\u4e2a\u6570\uff08\u6811\u72b6\u6570\u7ec4\u53ef\u4ee5\u76f4\u63a5\u67e5\u8be2\uff09\uff0c \\(|S_{OP,~}|\\) \u7c7b\u4f3c\uff08\u4e3a\u4e86\u65b9\u4fbf\uff0c\u53ea\u7528\u524d\u4e00\u79cd\u8868\u793a\uff0c\u4e5f\u53ef\u4ee5\u6c42\u51fa\u7b54\u6848\uff0c\u533a\u522b\u662f\u524d\u4e00\u79cd\u8868\u793a\u662f \u4ee5 \\(x\\) \u4e3a\u7b2c\u4e00\u4f18\u5148\u7ea7\uff0c\u5bf9 \\(y\\) \u8fdb\u884c\u67e5\u8be2\uff0c\u800c\u540e\u4e00\u79cd\u8868\u793a\u5219\u53cd\u4e4b\uff09</p> </li> <li> <p>\u6613\u77e5 \\(S = S_{=,~=} + S_{a,~} + S_{=,~b}\\) </p> </li> <li> <p>\\(S_{OP_1,~OP_2} = S_{OP_2,~OP_1}\\)\uff0c\u7b80\u8bb0 \\(S_{a,~b}=S_{b,~a}\\)</p> </li> </ul> <p>\u6b32\u6c42\uff1a\\(S_{&lt;,~&gt;}\\)</p> <p>\\(S = S_{=,~~=} + S_{a,~~} + S_{=,~b}\\)</p> <p>\\(S_{,~&gt;} = S_{=,~=~\\&amp;~&gt;} + S_{a,~&gt;} + S_{=,~b~\\&amp;~&gt;} = S_{a,~&gt;} + S_{=,~b~\\&amp;&gt;}\\)</p> <p>\u4ee4 \\(a\\) \u4e3a \\(&lt;\\) \uff0c\\(b\\) \u4e3a \\(&lt;\\)\uff08\u5bf9 \\(x\\) \u5347\u5e8f\uff0c \\(y\\) \u5347\u5e8f\uff09</p> <p>\\(S_{,~&gt;} = S_{&lt;,~&gt;}+S_{=,~&lt;~\\&amp;~&gt;} = S_{&lt;,~&gt;}\\) </p> <p>\u540c\u6837\u7684\uff0c\\(S_{,~&lt;} = S_{&gt;,~&lt;}\\) \uff08\u5bf9 \\(x\\) \u964d\u5e8f\uff0c \\(y\\) \u964d\u5e8f\uff09</p> <p>\uff08\u8fd9\u201d\u7406\u8bba\u201c\u4e0d\u592a\u53ef\u9760\uff0c\u60f3\u4e0d\u900f\uff0c\u522b\u6b7b\u78d5\uff01\uff01\uff09</p>"},{"location":"%E5%88%B7%E9%A2%98/2.%E6%A0%91%E7%8A%B6%E6%95%B0%E7%BB%84/#f","title":"F\uff0c\u5b9a\u957f\u5bbd \u6700\u5927\u5b50\u77e9\u9635\uff08\u975e\u8d1f\uff09","text":""},{"location":"%E5%88%B7%E9%A2%98/2.%E6%A0%91%E7%8A%B6%E6%95%B0%E7%BB%84/#g","title":"G\uff0c\u5355\u6539\u591a\u67e5\uff08\u6734\u7d20\u4e8c\u7ef4\uff09","text":""},{"location":"%E5%88%B7%E9%A2%98/2.%E6%A0%91%E7%8A%B6%E6%95%B0%E7%BB%84/#h","title":"H\uff0c\u591a\u6539\u5355\u67e5\uff08\u5dee\u5206\u4e8c\u7ef4\uff09","text":""},{"location":"%E5%88%B7%E9%A2%98/2.%E6%A0%91%E7%8A%B6%E6%95%B0%E7%BB%84/#idsf","title":"I\uff0cDSF\u5e8f + \u5355\u6539\u591a\u67e5","text":"<p>\u9898\u610f\uff1a\u8f93\u5165\u4e00\u68f5\u6811\uff0c\u4e00\u5f00\u59cb\u6240\u6709\u70b9\u6743\u4e3a1\uff0c\u6bcf\u6b21\u53ef\u4ee5\u5bf9\u67d0\u70b9 \u53d6\u53cd \u6216 \u6c42\u67d0\u70b9\u7684\u6240\u6709\u513f\u5b50\u7684\u70b9\u6743\u548c\uff08\u5305\u62ec\u81ea\u5df1\uff09</p> <p>\u4e00\u4e2a\u5b50\u6811\u5bf9\u5e94\u4e8e \\(dfs\\) \u5e8f\u4e2d\u7684\u4e00\u6bb5\u533a\u95f4\uff0c\u6362\u53e5\u8bdd\u8bf4\uff0c\\(dfs\\)\u5e8f\u7684\u67d0\u6bb5\u5408\u9002\u7684\u533a\u95f4\u53ef\u4ee5\u7ef4\u62a4\u4e00\u68f5\u5b50\u6811\u7684\u4fe1\u606f\uff08\u5b9e\u9645\u4e0a\u5c31\u662f \u975e\u7ebf\u6027\u7684\u4fe1\u606f \u6620\u5c04\u5230 \u7ebf\u6027\u7684\u4fe1\u606f \u4e0a\uff09</p> <p>\u4e8e\u662f\uff0c\u7528\\(dfs\\) \u8ba1\u7b97\u6bcf\u4e2a\u6839\u5bf9\u5e94 \\(dfs\\) \u7684\u5de6\u53f3\u7aef\u70b9 \\(lb,~ub\\) </p> <p>\u5176\u4e2d \\(lb_u\\) \u4ee3\u8868 \u6839\\(u\\) \u7684 \\(dfs\\)\u5e8f\u4e2d\u7684\u5de6\u7aef\u70b9 \u6216 \\(dfs\\)\u5e8f\u4e2d \u6839\\(u\\) \u7684\u4e0b\u6807</p> <pre><code>int id;\nvoid dfs(int u){\n++ id;\nlb[u] = id;\nfor(auto ed : e[u]) dfs(ed.v);\nub[u] = id;\n}\n</code></pre> <p>\uff08\u5176\u4ed6\u7ec6\u8282\uff1a\u8fd9\u91cc\u7684\u201c\u5355\u6539\u201d\u6307 \u53d6\u53cd \u64cd\u4f5c\uff0c\u5b58\u4e0b\u539f\u6570\u7ec4\u6765\u5224\u65ad\u662f\u52a0\u8fd8\u662f\u51cf\u5373\u53ef\uff09</p>"},{"location":"%E5%88%B7%E9%A2%98/2.%E6%A0%91%E7%8A%B6%E6%95%B0%E7%BB%84/#jdisplaystyle-sum_i1nsum_ji1n-maxa_ia_jtimes-b_i-b_j","title":"J\uff0c\\(\\displaystyle \\sum_{i=1}^n\\sum_{j=i+1}^n max\\{a_i,~a_j\\}\\times |b_i-b_j|\\)","text":"<p>\u5bf9 \\(a[~]\\) \u5347\u5e8f</p> <p>\\(\\displaystyle \\sum\\limits_{i=1}^n\\sum\\limits_{j=i+1}^n max\\{a_i,~a_j\\}\\times |b_i-b_j| \\\\ =\\sum\\limits_{i=1}^n\\sum\\limits_{j=i+1}^n a_j\\times|b_i-b_j|\\)</p> <p>\\(=\\sum\\limits_{j=1}^n a_j\\sum\\limits_{i=1}^{j-1}|b_i-b_j| \\\\ = \\sum\\limits_{j=1}^n a_j\\times(\\sum\\limits_{i=1}^{j-1}(b_i-b_j)[b_i &gt; b_j]~+~\\sum\\limits_{i=1}^{j-1}(b_j-b_i)[b_i &lt; b_j] ~+~ \\sum\\limits_{i=1}^{j-1}\\times 0[b_i = b_j])\\)</p> <p>\\(= \\sum\\limits_{j=1}^n a_j\\times (\\sum\\limits_{i=1}^{j-1}b_i[b_i &gt; b_j] ~-~ b_j\\times \\sum\\limits_{i=1}^{j-1}[b_i &gt; b_j] ~-~ \\sum\\limits_{i=1}^{j-1}b_i[b_i &lt; b_j] ~+~ b_j\\times \\sum\\limits_{i=1}^{j-1}[b_i &lt; b_j] )\\)</p> <p>\\(=\\sum\\limits_{j=1}^na_j\\times (greatersum_j-b_j\\times greaterNum_j-lesssum_j+b_j\\times lesssum_j)\\)</p> <p>\u4e0a\u9762\u7c7b\u4f3c \\(\\sum\\limits_{i=1}^{j-1}b_i[b_i &gt; b_j]\\)  \u7684\u5f0f\u5b50\u53ef\u4ee5\u7528\u6811\u72b6\u6570\u7ec4\u7ef4\u62a4</p> <p>\uff08\u603b\u7ed3\uff1a\\(\\displaystyle \\sum_{j=1}^n f_i\\sum_{i=1}^{j-1}g_i\\times [h_i&gt;h_j]\\) \u53ef\u4ee5\u7528\u6811\u72b6\u6570\u7ec4 \\(O(n\\log{n})\\) \u5185\u6c42\u51fa\uff09</p> <pre><code>#include&lt;iostream&gt;\n#include&lt;algorithm&gt;\nusing namespace std;\n#define int long long\nconst int N = 1e5+3;\n#define lb(u) (u&amp;-u)\nint num[N], sum[N];\nvoid add(int tr[], int u, int w){\nfor(int i=u; i&lt;N; i+=lb(i)) tr[i] += w;\n}\nint gsum(int tr[], int u){\nint ans = 0;\nfor(int i=u; i&gt;0; i-=lb(i)) ans += tr[i];\nreturn ans;\n}\nint gsum(int tr[], int lb, int ub){ return gsum(tr, ub) - gsum(tr, lb-1); }\nstruct nd{\nint x, y;\nbool operator&lt;(const nd&amp;t)const{ return x&lt;t.x; }\n}q[N];\nsigned main(){\nint n;\ncin &gt;&gt; n;\nfor(int i=1; i&lt;=n; ++i) scanf(\"%lld%lld\", &amp;q[i].x, &amp;q[i].y);\nsort(q + 1, q + n + 1);\nint ans = 0;\nfor(int i=1; i&lt;=n; ++i){\n// ln := less_num, gn := greater_num\nint ln = gsum(num, q[i].y-1), gn = gsum(num, q[i].y + 1, N-1);\n// ls := less_sum, gs := greater_sum\nint ls = gsum(sum, q[i].y-1), gs = gsum(sum, q[i].y + 1, N-1);\nans += q[i].x * ((ln * q[i].y - ls) - (gn * q[i].y - gs));\nadd(num, q[i].y, 1);\nadd(sum, q[i].y, q[i].y);\n}\nprintf(\"%lld\", ans);\n}\n</code></pre>"},{"location":"%E5%88%B7%E9%A2%98/2.%E6%A0%91%E7%8A%B6%E6%95%B0%E7%BB%84/#kdisplaystyle-sum_i1nsum_ji1n-maxa_ia_jtimes-b_i-b_j","title":"K\uff0c\u79bb\u6563\u5316+\\(\\displaystyle \\sum_{i=1}^n\\sum_{j=i+1}^n max\\{a_i,~a_j\\}\\times |b_i-b_j|\\)","text":"<p>\\(\\displaystyle \\sum_{i=1}^n\\sum_{j=i+1}^n max\\{a_i,~a_j\\}\\times |b_i-b_j| \\\\ =\\sum_{j=1}^n\\sum_{i=1}^{j-1}max\\{a_i,~a_j\\}\\times |b_i-b_j| \\\\ = \\sum_{j=1}^n(\\sum_{i=1}^{j-1}a_i\\times b_i([a_i &gt; a_j]-[a_i&lt;a_j])- a_j\\times \\sum_{i=1}^{j-1}b_i\\times(([a_i &gt; a_j]-[a_i&lt;a_j])))\\)</p> <p>\uff08\u8981\u5148\u5bf9 \\(b[~]\\) \u5347\u5e8f\uff09</p> <pre><code>#include&lt;bits/stdc++.h&gt;\nusing namespace std;\n#define int long long\nconst int N = 1e5+3;\nint n;\n#define lb(u) (u &amp; -u)\nint f[N], g[N];\nvoid add(int tr[], int u, int w){\nfor(int i=u; i&lt;N; i+=lb(i)) tr[i] += w;\n}\nint gsum(int tr[], int u){\nint ans = 0;\nfor(int i=u; i&gt;0; i-=lb(i)) ans += tr[i];\nreturn ans;\n}\nint gsum(int tr[], int lb, int ub){ return gsum(tr, ub) - gsum(tr, lb-1); }\nstruct nd{ int x, y; }q[N];\nbool cmp(nd a, nd b){ return a.x &lt; b.x; }\nbool cmp1(nd a, nd b){ return a.y &lt; b.y; }\nunordered_map&lt;int, int&gt; mp;\nint idx;\nsigned main(){\nwhile(~scanf(\"%lld\", &amp;n)){\nfor(int i=1; i&lt;=n; ++i) scanf(\"%lld%lld\", &amp;q[i].x, &amp;q[i].y);\n// \u5206\u522b\u5bf9 x, y \u8fdb\u884c\u79bb\u6563\u5316\uff08\u5f97\u5230 rank\uff09 \nsort(q + 1, q + n + 1, cmp);\nmp.clear(), idx = 0;\nfor(int i=1; i&lt;=n; ++i) if(++ idx, !mp.count(q[i].x)) mp[q[i].x] = idx;\nfor(int i=1; i&lt;=n; ++i) q[i].x = mp[q[i].x];\nsort(q + 1, q + n + 1, cmp1);\nmp.clear(), idx = 0;\nfor(int i=1; i&lt;=n; ++i) if(++ idx, !mp.count(q[i].y)) mp[q[i].y] = idx;\nfor(int i=1; i&lt;=n; ++i) q[i].y = mp[q[i].y];\n//        for(int i=1; i&lt;=n; ++i) cout &lt;&lt; q[i].x &lt;&lt; ' ';\n//        cout &lt;&lt; '\\n';\n//        for(int i=1; i&lt;=n; ++i) cout &lt;&lt; q[i].y &lt;&lt; ' ';\n//        cout &lt;&lt; '\\n';\nmemset(f, 0, sizeof f);\nmemset(g, 0, sizeof g);\nint ans = 0;\nfor(int i=1; i&lt;=n; ++i){\nans += (gsum(f, q[i].x+1, N-1) - gsum(f, q[i].x-1))\n- q[i].x  * (gsum(g, q[i].x+1, N-1) - gsum(g, q[i].x-1));\nadd(f, q[i].x, q[i].x * q[i].y);\nadd(g, q[i].x, q[i].y);\n}\nprintf(\"%lld\\n\", (int)ans);\n}\n}\n</code></pre>"},{"location":"%E5%88%B7%E9%A2%98/2.%E6%A0%91%E7%8A%B6%E6%95%B0%E7%BB%84/#l","title":"L\uff0c\u7ef4\u62a4\u652f\u6301\u4e09\u79cd\u64cd\u4f5c\u7684\u5bb9\u5668\uff08+\u4e8c\u5206\uff09","text":"<p>1\uff0c\u63d2\u5165\u5143\u7d20</p> <p>2\uff0c\u5f39\u51fa\u5143\u7d20\uff08\u542b\u5931\u8d25\u68c0\u67e5\uff09</p> <p>3\uff0c\u67e5\u8be2\u5927\u4e8e \\(w\\) \u7684\u7b2c \\(k\\) \u4e2a\u5143\u7d20\uff08\u542b\u5931\u8d25\u68c0\u67e5\uff09</p> <p>\u7b2c\u4e09\u79cd\u64cd\u4f5c\u7528\u4e8c\u5206</p>"},{"location":"%E5%88%B7%E9%A2%98/2.%E6%A0%91%E7%8A%B6%E6%95%B0%E7%BB%84/#m","title":"M\uff0c\u4e00\u7ef4\u5355\u6539\u591a\u67e5 +  \u521d\u59cb\u5316","text":""},{"location":"%E5%88%B7%E9%A2%98/2.%E6%A0%91%E7%8A%B6%E6%95%B0%E7%BB%84/#n","title":"N\uff0c\u4e00\u7ef4\u591a\u6539\u5355\u67e5","text":""},{"location":"%E5%88%B7%E9%A2%98/2.%E6%A0%91%E7%8A%B6%E6%95%B0%E7%BB%84/#o-1","title":"O\uff0c\u4e8c\u7ef4\u5355\u6539\u591a\u67e5 + \u5feb\u901f\u521d\u59cb\u5316\u4e3a1","text":"<p>\uff08\u6ce8\u610f\u6c42\u548c\u65f6\u4e24\u4e2a\u5bf9\u89d2\u70b9\u7684\u54ea\u4e2a\u662f\u5de6\u4e0a\u89d2\u54ea\u4e2a\u662f\u53f3\u4e0b\u89d2\uff09</p>"},{"location":"%E5%88%B7%E9%A2%98/2.%E6%A0%91%E7%8A%B6%E6%95%B0%E7%BB%84/#p","title":"P\uff0c\u4e8c\u7ef4\u5355\u6539\u591a\u67e5","text":"<p>\uff08\u201c\u67e5\u8be2\u53c2\u6570\u9a9a\u6270\u201d\uff09</p>"},{"location":"%E5%88%B7%E9%A2%98/2.%E6%A0%91%E7%8A%B6%E6%95%B0%E7%BB%84/#q","title":"Q\uff0c\u4e09\u7ef4\u591a\u6539\u5355\u67e5","text":"<p>\u66f4\u5177\u53ef\u8bfb\u6027\u7684\u6a21\u677f\uff1a</p> <pre><code>#define lb(u) (u&amp;-u)\nint tr[N][N][N];\nvoid add(int x, int y, int z, int w){\nfor(int i=x; i&lt;N; i+=lb(i))\nfor(int j=y; j&lt;N; j+=lb(j))\nfor(int k=z; k&lt;N; k+=lb(k))\ntr[i][j][k] += w;\n}\nvoid add(int lb, int lb1, int lb2, int ub, int ub1, int ub2, int w){\n++ ub, ++ ub1, ++ ub2;\nadd(ub, ub1, ub2, -w);\nadd(ub, ub1, lb2, w);\nadd(ub, lb1, ub2, w);\nadd(ub, lb1, lb2, -w);\nadd(lb, ub1, ub2, w);\nadd(lb, ub1, lb2, -w);\nadd(lb, lb1, ub2, -w);\nadd(lb, lb1, lb2, w);\n}\nint gsum(int x, int y, int z){\nint ans = 0;\nfor(int i=x; i&gt;0; i-=lb(i))\nfor(int j=y; j&gt;0; j-=lb(j))\nfor(int k=z; k&gt;0; k-=lb(k))\nans += tr[i][j][k];\nreturn ans;\n}\n</code></pre>"},{"location":"%E5%88%B7%E9%A2%98/2.%E6%A0%91%E7%8A%B6%E6%95%B0%E7%BB%84/#r-displaystyle-sum_j1nsum_i1j-1a_ia_ja_ia_j","title":"R\uff0c\u8ba1\u7b97 \\(\\displaystyle \\sum_{j=1}^n\\sum_{i=1}^{j-1}(a_i+a_j)[a_i&gt;a_j]\\)","text":"<p>\u8be5\u9898\u53ef\u4ee5\u4e0d\u6392\u5e8f</p> <p>\uff08\u4e00\u7ef4\u5355\u6539\u591a\u67e5\uff09</p>"},{"location":"%E5%88%B7%E9%A2%98/2.%E6%A0%91%E7%8A%B6%E6%95%B0%E7%BB%84/#s-displaystylemin_a_nii0n-sum_j1nsum_i1j-1a_ia_j","title":"S\uff0c \u8ba1\u7b97 \\(\\displaystyle\\min_{\\{a_{n}\\}&lt;&lt;i,~i=0..n}\\{ \\sum_{j=1}^n\\sum_{i=1}^{j-1}[a_i&gt;a_j]\\}\\)","text":"<p>\u5176\u4e2d \\(\\{a_{n}\\}&lt;&lt;i,~i=0..n\\)  \u8868\u793a \u539f\u6570\u7ec4 \\(a_n\\) \u5206\u522b\u5faa\u73af\u5de6\u79fb \\(i\\) \u6b21</p>"},{"location":"%E5%88%B7%E9%A2%98/2.%E6%A0%91%E7%8A%B6%E6%95%B0%E7%BB%84/#t-displaystyle-sum_j1nsum_i1j-1a_ia_j","title":"T\uff0c\u52a8\u6001\u8ba1\u7b97 \\(\\displaystyle \\sum_{j=1}^n\\sum_{i=1}^{j-1}[a_i&lt;a_j]\\)","text":"<p>\\(1e4\\) \u4e2a\u8be2\u95ee\uff0c\u53ef\u4ee5\u5faa\u73af\u5de6\u79fb\u533a\u95f4 \\([lb,~ub],~ub-lb\\le 1e3\\)\uff0c\u66b4\u529b\u590d\u6742\u5ea6\uff1a\\(O(1e7)\\)\uff0c</p> <p>\u4f46\u662f\uff0c\u8fd9\u7adf\u7136\u80fd\u8fc7\uff1f\uff1f</p>"},{"location":"%E5%88%B7%E9%A2%98/2.%E6%A0%91%E7%8A%B6%E6%95%B0%E7%BB%84/#u","title":"U\uff0c\u9006\u5e8f\u5bf9\u6c42\u201c\u539f\u6570\u7ec4\u201d\uff08+ \u4e8c\u5206\uff01\uff09","text":""},{"location":"%E5%88%B7%E9%A2%98/2.%E6%A0%91%E7%8A%B6%E6%95%B0%E7%BB%84/#v","title":"V\uff0c\u652f\u6301\u4e09\u79cd\u64cd\u4f5c\u7684\u5bb9\u5668 + \u67d0\u4e9b\u6570\u8bba","text":"<p>\u4e09\u79cd\u52a8\u6001\u64cd\u4f5c\u5373\uff1a\u589e\uff0c\u5220\uff0c\u6309\u67d0\u5143\u7d20\u7684\u67d0\u79cd\u5c5e\u6027a\u7684\u6392\u540d \\(k\\) \u67e5\u8be2 \u53e6\u4e00\u79cd\u5c5e\u6027b\u7684\u524d\u7f00\u548c</p> <p>\u8003\u8651\u6743\u503c\u6811\u72b6\u6570\u7ec4\uff0c</p> <p>\u201c01\u6743\u503c\u6811\u72b6\u6570\u7ec4\u201d \u53ef\u4ee5\u76f4\u63a5 \u6309\u5c5e\u6027a\u7684\u503c\u67e5\u8be2\u6392\u540d\uff0c\u6545\u53ef\u5229\u7528\u4e8c\u5206 \u6309\u6392\u540d\u67e5\u503c</p> <p>\uff08\u4e5f\u53ef\u4ee5\u5148\u5bf9\u5c5e\u6027a\u79bb\u6563\u5316\uff0c\u5373\u5c06 \u201c\u6743\u503c\u4f5c\u4e3a\u4e0b\u6807\u201d \u8f6c\u5316\u4e3a \u201c\u6309\u6392\u540d\u4e3a\u4e0b\u6807\u201d\uff0c\u5bf9\u4e8e\u79bb\u6563\u5316\uff0c\u61c2\u7684\u90fd\u61c2\uff09</p> <p>\u201c\u5e38\u89c4\u6743\u503c\u6811\u72b6\u6570\u7ec4\u201d\u5219\u7ef4\u62a4 \u5c5e\u6027b </p>"},{"location":"%E5%88%B7%E9%A2%98/2.%E6%A0%91%E7%8A%B6%E6%95%B0%E7%BB%84/#w","title":"W\uff0c\u626b\u63cf\u7ebf","text":"<p>\u4e0d\u4f1a\u3002\u3002\u6ca1\u5b8c\u5168\u7406\u89e3\u9898\u610f\uff0c\u4ee5\u540e\u8865</p>"},{"location":"%E5%88%B7%E9%A2%98/3.%E5%B9%B6%E6%9F%A5%E9%9B%86/","title":"3.\u5e76\u67e5\u96c6","text":"<p>\u907f\u96f7\uff08bug\uff09\u65b9\u6848\uff1a</p> <p>1\uff0c\u521d\u59cb\u5316\uff08\u6ce8\u610f\u96c6\u5408\u6807\u8bc6\u7684\u79bb\u6563\u5316\uff09</p> <p>2\uff0c\u5e76\u67e5\u96c6\u7ef4\u62a4\u6709\u5411\u73af\uff0c\u5224\u65ad\u73af\u7684\u5b58\u5728\u6027</p> <p>3\uff0c\u5e76\u67e5\u96c6\u7ef4\u62a4\u56fe\u7684\u6240\u6709\u8fde\u901a\u5206\u91cf\u6570\u91cf</p> <p>4\uff0c\u5e76\u67e5\u96c6\u7ef4\u62a4\u67d0\u4e00\u8fde\u901a\u5206\u91cf\u5185\u7684\u4f18\u5148\u7ea7\u6700\u9ad8\u7684\u70b9\uff08\u5373\u7956\u5148\uff09</p> <p>\uff08\u5e76\u67e5\u96c6\u591a\u7528\u4e8e\u903b\u8f91\u5173\u7cfb\u7684\u5224\u65ad\uff1b\u5e26\u6743\u5e76\u67e5\u96c6\u5173\u6ce8\u7684\u4e0d\u662f\u5143\u7d20\u7684\u5c5e\u6027\uff0c\u800c\u662f\u5143\u7d20\u4e4b\u95f4\u7684\u5173\u7cfb\uff1b\u5e76\u67e5\u96c6\u662f \u72ed\u4e49\u4e0a\u7684\u65e0\u5411\u56fe\uff09</p> <p>\uff08\u7537\u9898\uff1a\\(F\\)\uff09</p>"},{"location":"%E5%88%B7%E9%A2%98/3.%E5%B9%B6%E6%9F%A5%E9%9B%86/#a","title":"A\uff0c\u52a8\u6001\u5408\u5e76+\u67e5\u8be2","text":""},{"location":"%E5%88%B7%E9%A2%98/3.%E5%B9%B6%E6%9F%A5%E9%9B%86/#b","title":"B\uff0c\u7ef4\u62a4\u5e76\u67e5\u96c6\u5927\u5c0f","text":""},{"location":"%E5%88%B7%E9%A2%98/3.%E5%B9%B6%E6%9F%A5%E9%9B%86/#c","title":"C\uff0c\u67e5\u8be2\u5e76\u67e5\u96c6\u68ee\u6797\u7684\u6570\u76ee","text":""},{"location":"%E5%88%B7%E9%A2%98/3.%E5%B9%B6%E6%9F%A5%E9%9B%86/#d","title":"D\uff0c\u5e26\u6743\u5e76\u67e5\u96c6\u7ef4\u62a4\u533a\u95f4\u548c\uff08\u5224\u73af\u95ee\u9898\uff09","text":"<p>\uff08\\(w_u\\) \u53ef\u4ee5\u770b\u4f5c\u662f \\(u\\) \u5230 \u7956\u5b97 \\(f\\) \u7684\u5411\u91cf\uff09</p> <p>\u5de6\u95ed\u53f3\u5f00 \u6216 \u5de6\u5f00\u53f3\u95ed \u533a\u95f4\u53ef\u4ee5\u6ee1\u8db3 \u201c\u53ef\u52a0\u6027\u201d\uff0c\u4f8b\u5982\\([1,~4)+[4,~7)=[1,~7)\\)</p> <p>\u4ee5\u4e0b\u4ee3\u7801\u53ef\u6ee1\u8db3\u4e4b\u524d\u6240\u6784\u5efa\u7684\u6240\u6709\u5173\u7cfb\u7684\u60c5\u51b5\u4e0b\uff0c\u5173\u7cfb \\(w_{u\\to v}\\) \u662f\u5426\u6b63\u786e\uff0c\u53e6\u5916\u5982\u679c \\(u,~v\\) \u4e4b\u95f4\u662f\u72ec\u7acb\u7684\uff0c\u90a3\u4e48\u5229\u7528 \\(w_{u\\to v}\\) \u6784\u5efa \\(u,~v\\) \u4e4b\u95f4\u7684\u5173\u7cfb</p> <pre><code>bool add(int u, int v, int rel){\nint x = find(u), y = find(v);\nif(x == y) return rel == w[u] - w[v];\nfa[x] = y;\nw[x] = rel + w[v] - w[u];\nreturn true;\n}\n</code></pre>"},{"location":"%E5%88%B7%E9%A2%98/3.%E5%B9%B6%E6%9F%A5%E9%9B%86/#ep","title":"E\uff0c\u201c\u79cd\u7c7b\u201d\u5e76\u67e5\u96c6\uff0c\u53ef\u4ee5\u7528\u5e26\u6743\u5e76\u67e5\u96c6\u89e3\u51b3\uff08\u201d\u6a21P\u610f\u4e49\u4e0b\u7684\u52a0\u6cd5\u7fa4\u201c\uff09","text":"<pre><code>int find(int u){\nint f = fa[u];\nif(f == u) return u;\nint f1 = find(f);\nw[u] = (w[u] + w[f]) % P;\nreturn fa[u] = f1;\n}\nbool add(int u, int v, int rel){\nint x = find(u), y = find(v);\n//  \u6b64\u5904\u5fc5\u987b\u6a21P\uff0c\u800c\u5176\u4ed6\u5730\u65b9\u5728\u4e0d\u6ea2\u51fa\u7684\u60c5\u51b5\u4e0b\u53ef\u4ee5\u4e0d\u6a21P\nif(x == y) return rel % P == (w[u] - w[v] + P) % P;\nw[x] = (rel + w[v] - w[u] + P) % P;\nfa[x] = y;\nreturn true;\n}\n</code></pre>"},{"location":"%E5%88%B7%E9%A2%98/3.%E5%B9%B6%E6%9F%A5%E9%9B%86/#f-dp","title":"F\uff0c\u201c\u79cd\u7c7b\u201d\u5e76\u67e5\u96c6 + \u8ba1\u6570\u80cc\u5305dp\uff08+  \u65b9\u6848\uff09","text":"<p>\u6709\u4e24\u7c7b\u4eba\uff0c\u597d\u4eba\u548c\u574f\u4eba\uff0c\u5206\u522b\u6709 \\(a\\)\uff0c\\(b\\) \u4e2a</p> <p>\u7ed9\u51fa \\(m\\) \u6761\u4fe1\u606f\u63cf\u8ff0\uff1a \\(u\\) \u8bf4 \\(v\\) \u662f\u597d\u4eba\u6216\u574f\u4eba\uff08\u597d\u4eba\u8bf4\u8bdd\u4e0d\u4f1a\u8bf4\u8c0e\uff0c\u800c\u574f\u4eba\u5fc5\u7136\u4f1a\u8bf4\u8c0e</p> <p>\u8fd9\u4e9b\u63cf\u8ff0\u5176\u5b9e\u53ef\u4ee5\u53cd\u6620 \\(u\\) \u548c \\(v\\) \u7684\u5173\u7cfb\uff0c\u5373 \\(u\\) \u548c \\(v\\) \u7684\u6027\u8d28\u7684\u5173\u7cfb\uff08\u6b64\u9898\u662f\u6a212\u52a0\u6cd5\u7fa4\uff0c\u53ea\u6709\u76f8\u540c \u6216 \u76f8\u5f02 \u5173\u7cfb\uff1b\u4f46\u8fd9\u4e9b\u63cf\u8ff0\u4e0d\u4f1a\u53cd\u6620 \\(u\\) \u6216 \\(v\\) \u662f\u597d\u4eba\u8fd8\u662f\u574f\u4eba\uff09</p> <p>\u601d\u8def\uff1a\u901a\u8fc7\u63cf\u8ff0\u6784\u5efa\u5b8c\u5e76\u67e5\u96c6\u68ee\u6797\u540e\uff0c\u6211\u4eec\u77e5\u9053\u6bcf\u4e2a\u5e76\u67e5\u96c6\u53c8\u5206\u4e3a \\(P=2\\) \u4e2a\u5b50\u96c6\uff0c\u6bcf\u4e2a\u5b50\u96c6\u4e3a \u201c\u597d\u4eba\u96c6\u5408\u201d \u6216 \u201c\u574f\u4eba\u96c6\u5408\u201d\uff0c\u7528\u4eba\u6570\u6807\u8bc6\uff0c\u5f97\u5230\u4e8c\u7ef4\u6570\u7ec4 \\(num[cnt][P]\\)\uff08\\(cnt\\) \u4e3a\u5e76\u67e5\u96c6\u6570\u91cf\uff0c\\(P=2\\)\uff09\uff0c\u8981\u5224\u65ad \\(a=\\sum\\limits_{i=1}^{cnt}num_{i,~op}\\) \u662f\u5426\u552f\u4e00\uff0c\u53ef\u4ee5\u8003\u8651\u7528 \"\u8ba1\u6570\u7c7b\"\u7684\u80cc\u5305dp\uff08\u6211\u79f0\u4e4b\u4e3a \u201c1 2\u80cc\u5305\u201d\uff09</p> <p>\u58f0\u660e\uff1a</p> <pre><code>int idx, mp[N], num[N][2];\n// g[] \u8bb0\u5f55 f[][] \u7684 \"\u8def\u5f84\"\uff0c\u503c\u57df\u8bb0\u5f55 f\u7684\u7b2c\u4e8c\u7ef4\uff0c\u76f8\u5f53\u4e8e\u964d\u4e00\u4e2a\u7ef4\u5ea6\nint f[N][N], g[N];\n</code></pre> <p>1\uff09dp\u4e4b\u95f4\u8fdb\u884c \u79bb\u6563\u5316 + \u6784\u9020 \\(num\\) \u6570\u7ec4\uff1a</p> <p>\uff08\u79bb\u6563\u5316\u662f\u8f6c\u5316\u4e3adp\u95ee\u9898\u7684\u63a5\u53e3\uff01\uff01\uff09</p> <pre><code>idx = 0, memset(mp, 0, sizeof mp);\nmemset(num, 0, sizeof num);\nfor(int i=1; i&lt;=n; ++i){\nint f = find(i);\nif(!mp[f]) mp[f] = ++ idx;\n++ num[mp[f]][w[i]];\n}\n</code></pre> <p>2\uff09\u201d1 2\u8ba1\u6570dp\u201c</p> <pre><code>memset(f, 0, sizeof f);\nmemset(g, 0, sizeof g);\nf[0][0] = 1;\nfor(int i=1; i&lt;=idx; ++i){\nfor(int j=0; j&lt;=a; ++j){\nif(j &gt;= num[i][0]) f[i][j] = f[i-1][j-num[i][0]];\nif(j &gt;= num[i][1]) f[i][j] += f[i-1][j-num[i][1]];\n}\n}\n</code></pre> <p>3\uff09\u56de\u6eaf \u552f\u4e00\u65b9\u6848</p> <pre><code>// \u65b9\u6848\u4e0d\u552f\u4e00\uff0c\u5219\u9000\u51fa\nif(f[idx][a] != 1){\nputs(\"no\");\ncontinue;\n}\nint j = a;\nfor(int i=idx; i&gt;=1; --i){\nif(f[i-1][j-num[i][0]] == 1) j -= num[i][0], g[i] = 0;\nelse j -= num[i][1], g[i] = 1;\n}\nfor(int i=1; i&lt;=n; ++i){\nint f = find(i);\nif(w[i] == g[mp[f]]) printf(\"%d\\n\", i);\n}\n</code></pre>"},{"location":"%E5%88%B7%E9%A2%98/3.%E5%B9%B6%E6%9F%A5%E9%9B%86/#g","title":"G\uff0c\u8d2a\u5fc3 + \u5e76\u67e5\u96c6\u4f18\u5316\u6807\u8bb0\u6570\u7ec4","text":"<p>\u7ed9\u5b9a \\(n\\) \u4e2a\u5546\u54c1\uff0c\u5177\u6709 \u4ef7\u503c \\(v\\) \u548c \u8fc7\u671f\u65f6\u95f4 \\(t\\)\uff08\u4ee5\u5929\u4e3a\u5355\u4f4d\uff09\uff0c\u4e00\u5929\u53ea\u80fd\u5356\u4e00\u4e2a\u5546\u54c1\uff0c\u6c42\u6700\u5927\u5316\u6536\u76ca</p> <p>\u8d2a\u5fc3\u7b56\u7565\uff08\u4e0d\u4f1a\u8bc1\u3002\u3002\uff09\uff1a\u5bf9\u4ef7\u503c\u964d\u5e8f\uff0c\u6bcf\u6b21\u9009\u62e9\u4e0d\u5927\u4e8e \\(t_i\\) \u7684\u6700\u63a5\u8fd1 \\(t_i\\) \u7684\u4e00\u5929\u5356\u6389\u7269\u54c1 \\(i\\)\uff0c\u53ef\u5b9e\u73b0\u6700\u5927\u5229\u6da6</p> <p>\u5e76\u67e5\u96c6\u4f18\u5316\u6807\u8bb0\u6570\u7ec4\uff1a\u56e0\u4e3a \\(0\\) \u662f\u4e0d\u5408\u6cd5\u7684\u5929\u6570\uff0c\u6240\u6709\u67e5\u8be2\u5230 \u5929\u6570\\(t_i\\) \u548c \\(0\\) \u662f\u540c\u4e00\u4e2a\u5e76\u67e5\u96c6\u65f6\uff0c\u610f\u5473\u7740 \u7269\u54c1\\(i\\) \u4e0d\u53ef\u5356\u4e86\uff0c\u5426\u5219\u67e5\u8be2\u5230\u7684\u5929\u6570 \\(f\\)\uff0c\u7269\u54c1\u5c06\u5728 \u7b2c \\(f\\) \u5929\u5356\u51fa</p> <p>\u5176\u4ed6\u4f18\u5316\uff1a\u5355\u8c03\u961f\u5217</p>"},{"location":"%E5%88%B7%E9%A2%98/3.%E5%B9%B6%E6%9F%A5%E9%9B%86/#h","title":"H\uff0c\"\u6743\u503c\u533a\u95f4\"\u5e76\u67e5\u96c6 + \u79bb\u6563\u5316","text":"<p>\u6ce8\uff1a\u6a212\u7684\u52a0\u6cd5\u7fa4\u7684 \u52a0\u6cd5\u8fd0\u7b97 \u76f8\u5f53\u4e8e \u5f02\u6216\u8fd0\u7b97</p>"},{"location":"%E5%88%B7%E9%A2%98/3.%E5%B9%B6%E6%9F%A5%E9%9B%86/#i-x-y","title":"I\uff0c\u6743\u503c\u5e76\u67e5\u96c6\uff08\u7ef4\u62a4\u4e24\u79cd\u6743\u503c x \u548c y\u5750\u6807\u7684\u4f4d\u79fb\uff09","text":"<p>\u6ce8\u610f\uff1a\u6b64\u6743\u503c\u662f \u4e00\u79cd\u5411\u91cf\uff0c\u800c\u975e x\u6216y \u7684\u771f\u5b9e\u5750\u6807\uff0c\u6362\u53e5\u8bdd\u8bf4\uff0c\u6743\u503c\u5e76\u67e5\u96c6\u7ef4\u62a4\u7684\u662f\u67d0\u4e9b\u70b9\u7684\u5c5e\u6027\u4e4b\u95f4\u7684\u5173\u7cfb</p> <pre><code>int fa[N], wx[N], wy[N];\nvoid init(int n){\nfor(int i=0; i&lt;=n; ++i){\nfa[i] = i;\nwx[i] = wy[i] = 0;\n}\n}\nint find(int u){\nint f = fa[u];\nif(f == u) return u;\nint f1 = find(f);\nwx[u] += wx[f];\nwy[u] += wy[f];\nreturn fa[u] = f1;\n}\nbool add(int u, int v, int relx, int rely){\nint x = find(u), y = find(v);\nif(x == y) return relx == wx[u] - wx[v] &amp;&amp; rely == wy[u] - wy[v];\nfa[x] = y;\nwx[x] = relx + wx[v] - wx[u];\nwy[x] = rely + wy[v] - wy[u];\nreturn true;\n}\n// \u83b7\u53d6 u, v \u4e24\u70b9\u7684\u54c8\u5bc6\u987f\u8def\u5f84\nint get(int u, int v){\nint x = find(u), y = find(v);\n//    cout &lt;&lt; x &lt;&lt; ' ' &lt;&lt; y &lt;&lt; '\\n';\n//  u, v \u4e4b\u95f4\u53ef\u4ee5\u786e\u5b9a\u54c8\u5bc6\u987f\u8def\u5f84\u7684\u5fc5\u8981\u6761\u4ef6\uff1au \u4e0e v \u4e0d\u72ec\u7acb\nif(x == y) return abs(wx[u] - wx[v]) + abs(wy[u] - wy[v]);\nreturn -1;\n}\n</code></pre>"},{"location":"%E5%88%B7%E9%A2%98/3.%E5%B9%B6%E6%9F%A5%E9%9B%86/#j","title":"J\uff0c\u5e38\u89c4\u5e26\u6743\u5e76\u67e5\u96c6","text":""},{"location":"%E5%88%B7%E9%A2%98/3.%E5%B9%B6%E6%9F%A5%E9%9B%86/#k","title":"K\uff0c\u5e26\u6743\u5e76\u67e5\u96c6 + \u679a\u4e3e","text":"<p>\u9898\u610f\uff1a\u4e00\u7fa4\u4eba\u8fdb\u884c\u6e38\u620f\uff0c\u8fd9\u7fa4\u4eba\u5206\u4e3a4\u7c7b\u4eba\uff1a1\u4e2a\\(judge\\) \u548c \u5176\u4ed63\u7c7b\u4eba\uff0c</p> <p>\u5176\u4e2d \\(judge\\) \u548c \u5c5e\u6027\u4f1a\u6539\u53d8\uff0c\u800c\u5176\u4ed6\u4e09\u7c7b\u4eba\u7684\u5c5e\u6027\u4e0d\u4f1a\u6539\u53d8\uff0c\u6362\u53e5\u8bdd\u8bf4\uff0c\u4e09\u7c7b\u4eba\u4e92\u76f8\u4e4b\u95f4\u7684\u80dc\u8d1f\u5173\u7cfb\u4e0d\u4f1a\u6539\u53d8\uff0c\u800c \\(judge\\) \u548c\u4e09\u7c7b\u4eba\u7684\u80dc\u8d1f\u5173\u7cfb\u53ef\u80fd\u4e0d\u552f\u4e00</p> <p>\u7ed9\u5b9a \\(m\\) \u573a\u6bd4\u8d5b\u7684\u63cf\u8ff0\uff0c\u8bd5\u5224\u65ad \\(judge\\) \u662f\u8c01\uff0c\u82e5\u5b58\u5728\u4e14\u552f\u4e00\uff0c\u8f93\u51fa\u81f3\u5c11\u9700\u8981\u591a\u5c11\u573a\u6bd4\u8d5b\u80fd\u591f\u5224\u65ad</p> <p>\u5206\u6790\uff1a\u5206\u4e3a\u4e09\u79cd\u60c5\u51b5</p> <p>1\uff09\u6ca1\u6709 \\(judge\\) </p> <p>2\uff09\u67092\u4e2a\u4ee5\u4e0a\u7684 \\(judge\\)</p> <p>3\uff09\u4ec5\u6709\u4e00\u4e2a \\(judge\\)</p> <p>\u505a\u6cd5\uff1a\u4f9d\u6b21\u679a\u4e3e\\(judge\\) \u7684\\(id\\)\uff0c\u82e5\u4e0e\u6b64\u4eba\u4e0d\u76f8\u5173\u7684\u6bd4\u8d5b\u7684\u80fd\u4f7f \\(add()\\) \u8fd4\u56de \\(true\\)\uff0c\u8868\u660e\u8be5\u4eba\u53ef\u4ee5\u662f \\(judge\\)\uff0c\u7d2f\u52a0 \\(judge\\) \u7684\u4e2a\u6570 \\(cnt\\)</p> <p>\u82e5 \\(judge\\)\u552f\u4e00\uff0c\u5219\u6bd4\u8d5b\u7684\u8f6e\u6570\u4e3a\u5047\u8bbe\u5176\u4ed6\u4eba\u4e3a\u88c1\u5224\u65f6\uff08\u5b9e\u9645\u4e0a\u4e0d\u662f\uff09\u4f7f\u5f97\u5173\u7cfb\u7684\u4f53\u7cfb\u4e0d\u878d\u6d3d\u7684\u6700\u5927\u6bd4\u8d5b\u573a\u6b21\uff08\u4e0d\u4f1a\u8bc1\uff01\uff01\uff01\u8278\uff09</p> <p>\uff08poj\u4f1a\u628a RE \u5f53\u6210 WA\uff0c\u5b9e\u5728\u662fdiao\uff09</p>"},{"location":"%E5%88%B7%E9%A2%98/3.%E5%B9%B6%E6%9F%A5%E9%9B%86/#l","title":"L\uff0c\u52a8\u6001\u5220\u8fb9 + \u67e5\u8be2\u8fde\u901a\u70b9\u5185\u4f18\u5148\u7ea7\u6700\u9ad8\u7684\u70b9\uff08\u79bb\u7ebf\u5e76\u67e5\u96c6\uff09","text":"<p>\u5e76\u67e5\u96c6\u4e0d\u9002\u5408\u5220\u8fb9\uff0c\u5374\u9002\u5408\u6b64\u7c7b\u67e5\u8be2</p> <p>\u201d\u5f15\u7406\u201c\uff1aset\u5b9e\u73b0\u7684\u90bb\u63a5\u8868\u53ef\u4ee5\u65b9\u4fbf\u5730 \u5220\u8fb9\uff08\u672c\u9898\u5c0f\u91cd\u70b9\uff09 \u6216 \u5220\u70b9</p> <p>\u5220\u8fb9\u64cd\u4f5c\uff1a\u9996\u5148\u7528\u90bb\u63a5\u8868\u5efa \u521d\u59cb\u56fe\uff0c\u7136\u540e\u9010\u6b65\u5220\u8fb9\uff0c\u5f97\u5230 \u672b\u72b6\u6001\u56fe \uff08\u90bb\u63a5\u8868\uff09\uff1b\u4f7f\u7528\u672b\u72b6\u6001\u7684\u90bb\u63a5\u8868\u5efa\u7acb \u672b\u72b6\u6001\u7684\u5e76\u67e5\u96c6\uff1b\u79bb\u7ebf\u5b58\u50a8\u8be2\u95ee\uff1b\u7136\u540e\u53cd\u5411\u904d\u5386 \u6240\u6709\u8be2\u95ee\uff0c\u4e8e\u662f\u5220\u8fb9\u64cd\u4f5c\u5c31\u7b49\u4ef7\u4e8e\u52a0\u8fb9\u64cd\u4f5c\u4e86</p> <p>\uff08\u6ce8\u610f\uff1a\u4e0a\u8ff0\u7684\u6240\u8ff0\u7684\u8fb9\u662f\u65e0\u5411\u8fb9\uff01\uff01\uff1b\u5f15\u5165\u90bb\u63a5\u8868\u7684\u76ee\u7684\u662f\u65b9\u4fbf\u5e76\u67e5\u96c6\u7684\u5efa\u56fe\uff09</p> <p>\u67e5\u8be2\u64cd\u4f5c\uff1a\u8981\u4f7f\u67d0\u4e2a\u70b9\u67e5\u8be2\u540e\u8fd4\u56de\u6700\u4f18\u7684\u70b9\uff0c\u5c31\u9700\u8981\u5408\u7406\u5904\u7406\u5408\u5e76\u64cd\u4f5c\uff0c\u4f7f\u7528\"\u542f\u53d1\u5f0f\u5408\u5e76\"\uff0c\u5982\u679c \\(u\\) \u7684\u6839 \\(x\\) \u7684\u4f18\u5148\u7ea7\u6bd4 \\(v\\) \u7684\u6839 \\(y\\) \u7684\u4f18\u5148\u7ea7\u5927\uff0c\u5219\u4ea4\u6362 \\(x\\) \u548c \\(y\\)\uff0c\u4f7f\u5f97\u5c06 \\(x\\) \u5408\u5e76\u5230\u4f18\u5148\u7ea7\u66f4\u9ad8\u7684 \\(y\\) \u5f53\u4e2d</p>"},{"location":"%E5%88%B7%E9%A2%98/3.%E5%B9%B6%E6%9F%A5%E9%9B%86/#m-n","title":"M / N\uff0c\u5224\u65ad\u7ed9\u5b9a\u8fb9\u6784\u6210\u7684\u56fe\u662f\u5426\u4e3a\u4e00\u9897\u6811","text":"<p>\u6709\u4e24\u79cd\u60c5\u51b5\uff1a</p> <p>1\uff09\u56fe\u4e3a\u7a7a\uff0c\u5219\u8be5\u56fe\u4e3a\u6811</p> <p>2\uff09\u8be5\u56fe\u53ea\u6709\u4e00\u4e2a\u8fde\u901a\u5206\u91cf\uff0c\u800c\u4e14\u8be5\u56fe\u4e0d\u5b58\u5728\u8fb9\u6570 \\(\\ge 2\\) \u7684\u73af\uff08\u5373\u5305\u62ec\u81ea\u73af\uff09 </p> <p>\u5e76\u67e5\u96c6\u7684 \\(add()\\) \u8fd4\u56de \\(false\\) \u610f\u5473\u7740 \\(u,~v\\) \u4e4b\u95f4\u5b58\u5728\u8fb9\u6570 \\(\\ge 2\\) \u7684\u73af</p> <pre><code>bool add(int u, int v){\nint x = find(u), y = find(v);\nif(x == y) return false;\nfa[x] = y;\nreturn true;\n}\n</code></pre>"},{"location":"%E5%88%B7%E9%A2%98/4.%E7%9F%A9%E9%98%B5/","title":"4.\u77e9\u9635","text":"<p>\u907f\u5751\u65b9\u6848\uff1a</p> <p>1\uff09\u8f83\u5927\u7684\u521d\u59cb\u9759\u6001\u77e9\u9635 \u53ef\u4ee5\u4f7f\u7528 \u4e8c\u7ef4\u9759\u6001\u6570\u7ec4\u8868\u793a\u77e9\u9635\uff1b\u521d\u59cb\u77e9\u9635\u52a8\u6001 \u6216\u8005 \u77e9\u9635\u4e0d\u603b\u662f\u65b9\u9635\uff0c\u5219\u4f18\u5148\u4f7f\u7528 \u7ed3\u6784\u4f53\u5c01\u88c5\u4e8c\u7ef4vector\uff0c\u91cd\u8f7d \u4e58\u6cd5 \u548c \u6b21\u65b9\u8fd0\u7b97\uff08\u6700\u4f18\u7684\u8868\u793a\u65b9\u6cd5\uff0c\u771f\u503c\u652f\u6301\u9759\u6001\u6570\u7ec4\u521d\u59cb\u5316\uff09</p> <p>\uff08\u6bd4\u8f83\u6709\u610f\u4e49\u7684\u9898\uff1a B\uff0cC\uff0cD\uff0cE\uff0cH\uff0c\uff09</p> <p>\uff08\u7537\u9898\uff1a\\(D,~J,~L,~N,~O\\)\uff09</p>"},{"location":"%E5%88%B7%E9%A2%98/4.%E7%9F%A9%E9%98%B5/#af_1xf_2yforalliige-2f_if_i-1f_i1","title":"A\uff0c\\(f_1=x,~f_2=y;~\\forall~i(i\\ge 2)f_i=f_{i-1}+f_{i+1}\\)","text":"<p>\u5e38\u89c4\u9898</p>"},{"location":"%E5%88%B7%E9%A2%98/4.%E7%9F%A9%E9%98%B5/#b-n-mnle-10mle-1e9","title":"B\uff0c\u7ed9\u5b9a \\(n, m(~n\\le 10,~m\\le 1e9)\\)  \uff08\u5411\u91cf\u77e9\u9635\u53d8\u6362\uff09","text":"<p>\u8fd9\u662f\u4e00\u4e2a \\((n+1)\\times (m+1)\\) \u7684\u77e9\u9635\uff0c\u4e0b\u6807\u4ece 0 \u5f00\u59cb</p> <p>\u7ed9\u5b9a \\(A_{1,~0},~A_{2,~0},..,~A_{n,~0}\\)\uff0c\\(A_{0,~1}=233,~A_{0,~2}=2333,..,~~A_{0,~m}=233333..3\\)</p> <p>\u5e76\u4e14 \\(A_{i,~j} = A_{i-1,~j}+A_{i,~j-1},~(i,~j\\ne 0)\\)</p> <p>\u601d\u8def\uff1a\u7531\u4e8e \\(n\\) \u5f88\u5c0f\uff0c\\(m\\) \u5f88\u5927\uff0c\u6570\u636e\u53ef\u80fd\u5728\u6697\u793a\u53ef\u4ee5\u5c06\u67d0\u4e00\u5217\u5411\u53f3\u9012\u63a8</p> <p>1\uff09\\(2333=233\\times 10 + 3\\)\uff0c\u8fd9\u610f\u5473\u7740\u7b2c0\u884c\u53ef\u4ee5\u9012\u63a8</p> <p>2\uff09\\(A_{i,~j}=A_{i-1,~j}+A_{i,~j-1} = (A_{i-2,~j}+A_{i-1,~j-1})+A_{i,~j-1}\\\\ = ((A_{i-3,~j}+A_{i-2,~j-1})+A_{i-1,~j-1})+A_{i,~j-1}=...\\\\=A_{0,~j}+\\sum\\limits_{k=1}^iA_{k,~j-1} \\\\ =10\\times A_{0,~j-1}+3+\\sum\\limits_{k=1}^iA_{k,~j-1}\\)</p> <p>\u5c06 \\(A_{i,~j}\\) \u8bb0\u4e3a \\(A_{i}\\)\uff0c \\(A_{i,~j-1}\\) \u8bb0\u4e3a \\(A'_{i}\\)</p> <p>\u5373 \\(A_{i} = 10\\times A'_{0}+3+\\sum\\limits_{k=1}^i A'_{k}\\)</p> <p>\\((A_n,~A_{n-1},~...,~A_1,~A_0,~3) = (A'_n,~~A'_{n-1},~~...,~~A'_1,~~A'_0,~3)\\times M\\)</p> <p>\\(M=\\begin{bmatrix}1&amp;0&amp;0&amp;...&amp;0&amp;0&amp;0\\\\1&amp;1&amp;0&amp;...&amp;0&amp;0&amp;0\\\\1&amp;1&amp;1&amp;...&amp;0&amp;0&amp;0\\\\\\vdots&amp;&amp;&amp;\\vdots\\\\ 1&amp;1&amp;1&amp;\\cdots&amp;1&amp;0&amp;0\\\\10&amp;10&amp;10&amp;\\cdots&amp;10&amp;10&amp;10\\\\1&amp;1&amp;1&amp;\\cdots&amp;1&amp;1&amp;1\\end{bmatrix}\\)</p> <p>\\(F=[a_n,~a_{n-1},~...,~a_{1},~23,~1]\\)</p> <p>\uff08\\(M\\) \u548c \\(F\\) \u7684\u77e9\u9635\u4e0d\u662f\u552f\u4e00\u7684\uff0c\u4f46\u662f\u53ef\u4ee5\u5316\u7b80\uff0c\u6bd4\u5982\u6700\u540e\u4e24\u884c\u9664\u4e86\u6700\u53f3\u8fb9\u7684\u4e24\u5217\uff09</p>"},{"location":"%E5%88%B7%E9%A2%98/4.%E7%9F%A9%E9%98%B5/#cnisoddf_n2times-f_n-11elsef_n2times-f_n-1","title":"C\uff0c\\(n~is~odd:~f_n=2\\times f_{n-1}+1,~else:~f_n=2\\times f_{n-1}\\)","text":""},{"location":"%E5%88%B7%E9%A2%98/4.%E7%9F%A9%E9%98%B5/#dbase-score-basescore","title":"D\uff0c\u7ed9\u5b9a\u57fa\u6570base \u548c score\uff0c\u6c42\u6ee1\u8db3\u9650\u5236\u4e0b \u4ee5base\u4e3a\u57fa\u6570\u7684\u6570\u7684\u201c\u5f97\u5206\u201d\u4e3ascore\u7684\u4e2a\u6570\uff08\u7537\u9898\uff09","text":"<p>\u9650\u5236\uff1a\u6ca1\u6709\u524d\u5bfc\u96f6\uff0c\u76f8\u90bb\u4f4d\u4e0d\u540c\uff1b\u201c\u5f97\u5206\u201d\u4e3a\u5404\u4e2a\u76f8\u90bb\u4f4d\u7684\u5dee\u7684\u5e73\u65b9\u548c</p> <p>\u4e0d\u4f1a\u505a\uff01\uff01\uff0c\u5e02\u9762\u4e0a\u6709\u4e24\u79cd\u505a\u6cd5\uff1a</p> <p>1\uff09dp+\u77e9\u9635\u5feb\u901f\u5e42\uff1a\u4ee3\u7801\u957f\uff08100\u884c\uff09\uff0c\u800c\u4e14\u6548\u7387\u8f83\u4f4e</p> <p>2\uff09\u76f4\u63a5\u77e9\u9635\u5feb\u901f\u5e42\uff1a\u4ee3\u7801\u77ed\uff0850\u884c\uff09\uff0c\u6548\u7387\u9ad8</p>"},{"location":"%E5%88%B7%E9%A2%98/4.%E7%9F%A9%E9%98%B5/#e-a_ntimes-mtimes-b_mtimes-nntimes-n6","title":"E\uff0c\u8ba1\u7b97 \\((A_{n\\times m}\\times B_{m\\times n})^{(n\\times n)}\\)\uff08\u8ba1\u7b97\u8fc7\u7a0b\u6a216\uff09\uff0c\u7d2f\u52a0\u6240\u5f97\u5230\u7684\u77e9\u9635\u7684\u6240\u6709\u9879\u7684\u548c","text":"<p>\u8303\u56f4\uff1a\\(n\\le 1e3,~m\\le 6\\)\uff0c\u77e9\u9635 \\(C = A\\times B\\) \u662f \\(n\\times n\\) \u7684\uff0c\u6240\u4ee5\u76f4\u63a5\u5bf9 \\(C\\) \u77e9\u9635\u5feb\u901f\u5e42\u5fc5\u7136\u8d85\u65f6</p> <p>\u5316\u7b80\u8ba1\u7b97\uff1a \\((A\\times B)^{n\\times n}=A\\times (B\\times A)^{n\\times n-1}\\times B\\)</p> <p>\u6b64\u65f6\uff0c \\(D=B\\times A\\) \u662f\u4e00\u4e2a \\(m\\times m\\) \u7684\u77e9\u9635\uff0c\u8ba1\u7b97\u77e9\u9635\u5feb\u901f\u5e42\u7279\u522b\u5feb</p> <p>\u975e\u65b9\u9635\u7684\u77e9\u9635\u53ef\u4ee5\u5f88\u65b9\u4fbf\u7684\u7528\u6b64\u6a21\u677f\u8868\u793a\uff1a</p> <pre><code>struct mat{\nvector&lt;vector&lt;int&gt;&gt; w;\nint r, c;\nmat(int r, int c):r(r), c(c) { w.resize(r, vector&lt;int&gt;(c)); }\nvector&lt;int&gt;&amp; operator[](int i){ return w[i]; }\n};\nmat operator*(mat a, mat b){\nmat ans(a.r, b.c);\nfor(int i=0; i&lt;a.r; ++i) for(int k=0; k&lt;a.c; ++k)\nif(a[i][k]) for(int j=0; j&lt;b.c; ++j)\nans[i][j] = (ans[i][j] + a[i][k] * b[k][j]) % P;\nreturn ans;\n}\nmat operator^(mat a, int n){\nmat ans = a;\nfor(--n; n; n &gt;&gt;= 1, a = a * a) if(n &amp; 1) ans = ans * a;\nreturn ans;\n}\n</code></pre>"},{"location":"%E5%88%B7%E9%A2%98/4.%E7%9F%A9%E9%98%B5/#f-a_1times-ntimes-b_ntimes-nm","title":"F\uff0c\u5e38\u89c4\u9898 \\(A_{1\\times n}\\times (B_{n\\times n})^m\\)","text":""},{"location":"%E5%88%B7%E9%A2%98/4.%E7%9F%A9%E9%98%B5/#g","title":"G\uff0c\u6590\u6ce2\u90a3\u5951\u6539\u7248\uff08\u6c34\uff09","text":""},{"location":"%E5%88%B7%E9%A2%98/4.%E7%9F%A9%E9%98%B5/#h-aa2a3am","title":"H\uff0c\u8ba1\u7b97 \\(A+A^2+A^3+...+A^m\\)","text":"<p>\u4e24\u79cd\u5fc5\u7136TLE\u7684\u65b9\u6cd5\uff1a</p> <p>1\uff09\u66b4\u529b\u7528\u77e9\u9635\u5feb\u901f\u5e42\uff1a\\(O(m\\times (n^3\\times\\log{m}))\\)</p> <p>2\uff09\u524d\u7f00\u548c\u601d\u60f3\uff1a\\(O(m\\times n^3)\\)</p> <p>\uff08\\(n\\le 40,~m\\le 1e5\\)\uff09</p> <p>\u6b63\u89e3\uff1a\u77e9\u9635\u500d\u589e \u6216 \u77e9\u9635\u4e8c\u5206\u5e42</p> <p>\\(A+A^2+...+A^n=A+A^2+...+A^{[\\frac{n}{2}]}+(A+A^2+...+A^{[\\frac{n}{2}]})\\times A^{[\\frac{n}{2}]}+[n~is~odd]\\times A^{n}\\)</p> <pre><code>int P = 10;\nstruct mat{\nint r, c;\nvector&lt;vector&lt;int&gt;&gt; w;\nvector&lt;int&gt; &amp; operator[](int i){ return w[i]; }\nmat(int r, int c):r(r), c(c){ w.resize(r, vector&lt;int&gt;(c)); }\n};\nmat operator*(mat a, mat b){\nmat ans(a.r, b.c);\nfor(int i=0; i&lt;a.r; ++i) for(int k=0; k&lt;a.c; ++k) if(a[i][k]) for(int j=0; j&lt;b.c; ++j)\nans[i][j] = (ans[i][j] + a[i][k] * b[k][j]) % P;\nreturn ans;\n}\nmat operator^(mat a, int n){\nmat ans = a;\nfor(--n; n; n&gt;&gt;=1, a = a * a) if(n &amp; 1) ans = ans * a;\nreturn ans;\n}\nmat operator+(mat a, mat b){\nmat ans = a;\nfor(int i=0; i&lt;b.r; ++i) for(int j=0; j&lt;b.c; ++j) ans[i][j] = (ans[i][j] + b[i][j]) % P;\nreturn ans;\n}\nmat dfs(mat a, int k){\nif(k == 1) return a;\nmat ans = dfs(a, k / 2);\nans = ans * (a ^ (k / 2)) + ans;\nif(k &amp; 1) ans = ans + (a ^ k);\nreturn ans;\n}\n</code></pre>"},{"location":"%E5%88%B7%E9%A2%98/4.%E7%9F%A9%E9%98%B5/#i-abatimes-bn-anbn","title":"I\uff0c\u7ed9\u5b9a \\(a+b,~a\\times b,~n\\) \u7684\u503c\uff0c\u6c42 \\(a^n+b^n\\)","text":"<p>\u8bb0 \\(f_n=a^n+b^n\\)</p> <p>\\((a+b)\\times f_n=a^{n+1}+b^{n+1}+b\\times a^n+a\\times b^n=f_{n+1}+b\\times a^n+a\\times b^n\\)</p> <p>\u53c8 \\(\\because a\\times b\\times f_{n-1}=b\\times a^n+a\\times b^n\\)</p> <p>\\(\\therefore (a+b)\\times f_n=f_{n+1}+(a\\times b)\\times f_{n-1} \\\\ \\implies f_{n+1}=(a+b)\\times f_{n}+(a\\times b)\\times f_{n-1}\\)</p> <p>\u5f97\u5230\u7684\u7ebf\u6027\u9012\u63a8\u5f0f\uff0c\u6240\u4ee5\u53ef\u4ee5\u7528\u77e9\u9635\u5feb\u901f\u5e42</p> <p>\uff08\u6ce8\u610f\uff1a\\(n\\ge 0\\)\uff0c\u5373 \\(n\\) \u53ef\u4ee5\u53d60\uff0c\\(f_0=2\\)\uff1b\u8fd9\u9053\u9898\u4e5f\u4e0d\u592a\u597d\u60f3\u5f97\u5230\u7528\u77e9\u9635\u5feb\u901f\u5e42\uff09</p>"},{"location":"%E5%88%B7%E9%A2%98/4.%E7%9F%A9%E9%98%B5/#j","title":"J\uff0c\u5faa\u73af\u77e9\u9635\u5feb\u901f\u5e42","text":"<p>\u5faa\u73af\u77e9\u9635\u7684\u6027\u8d28\uff1a\u53ef\u4ee5\u7528\u4e00\u7ef4\u6570\u7ec4\u5b58\u50a8\uff0c\u77e9\u9635\u4e58\u6cd5\u4e3a\\(O(n^2)\\)\uff1b\u77e9\u9635\u4e58\u6cd5 \u6216 \u77e9\u9635\u52a0\u6cd5 \u540e\u8fd8\u662f\u5faa\u73af\u77e9\u9635</p> <p>\u5faa\u73af\u77e9\u9635\u5feb\u901f\u5e42\u53ef\u4ee5 \\(n=5e2\\) \u751a\u81f3 \\(n=1e3\\) \u7684\u6570\u636e</p> <p>\uff08\u76f4\u63a5\u7528\u4e8c\u7ef4\u6570\u7ec4\u505a\u4f1a\u8d85\u65f6\uff09</p>"},{"location":"%E5%88%B7%E9%A2%98/4.%E7%9F%A9%E9%98%B5/#k","title":"K\uff0c\u6590\u6ce2\u90a3\u5951\u5c0f\u6269\u5c55","text":""},{"location":"%E5%88%B7%E9%A2%98/4.%E7%9F%A9%E9%98%B5/#l","title":"L\uff0c\u7384\u5b66\u6590\u6ce2\u90a3\u5951\uff08\u7537\uff01\u4e0d\u4f1a\uff01\uff09","text":"<p>\u4e2a\u4eba\u8bad\u7ec3\u8d5b--\u77e9\u9635 - Virtual Judge (csgrandeur.cn)</p>"},{"location":"%E5%88%B7%E9%A2%98/4.%E7%9F%A9%E9%98%B5/#ms_nlceilasqrt-bnrceilmod-pa-12-b-a2","title":"M\uff0c[\u65e0\u7406\u6570\u9012\u63a8]\uff1a\\(S_n=\\lceil(a+\\sqrt b)^n\\rceil\\mod P,~(a-1)^2&lt; b&lt; a^2\\)","text":"<p>\u4ee4\\(A_n=(a+\\sqrt b)^n,~A^*_n=(a-\\sqrt b)^n\\)\uff0c\\(f_n=A_n+A_{n}^*=(a+\\sqrt b)^n+(a-\\sqrt b)^n\\)</p> <p>\u5176\u4e2d \\(A_n\\) \u4e0e \\(A_n^*\\) \u7684 \u548c \u6216 \u79ef \u90fd\u662f\u6574\u6570\uff1b\\(S_n=\\lceil A_n\\rceil\\)</p> <p>\u53c8\u56e0\u4e3a \\(A_n^*&lt;1\\)\uff0c\u800c\u4e14 \\(f_n\\) \u662f\u6574\u6570\uff0c\u6240\u4ee5 \\(f_n=\\lceil A_n\\rceil=S_n\\)</p> <p>\uff08\u4e00\u4e2a\u6570\u4e0e\u53e6\u4e00\u4e2a\u5c0f\u4e8e1\u7684\u6570\u7684\u548c\u53ef\u4ee5\u88ab\u8868\u793a\u4e3a\u8fd9\u4e2a\u6570\u7684\u5411\u4e0a\u53d6\u6574\uff09</p> <p>\\(((a+\\sqrt b)+(a-\\sqrt b))\\times f_n=((a+\\sqrt b)+(a-\\sqrt b))\\times((a+\\sqrt b)^n+(a-\\sqrt b)^n)\\\\ 2\\times a\\times f_n=(a+\\sqrt b)^{n+1}+(a-\\sqrt b)^{n+1}+(a+\\sqrt b)\\times(a-\\sqrt b)((a+\\sqrt b)^{n-1}+(a-\\sqrt b)^{n-1})\\\\2\\times a\\times f_n=f_{n+1}+(a^2-b)\\times f_{n-1}\\\\f_{n+1}=2\\times a\\times f_n+(b-a^2)\\times f_{n-1}\\)</p>"},{"location":"%E5%88%B7%E9%A2%98/4.%E7%9F%A9%E9%98%B5/#nnksumlimits_i1n-f_itimes-ikf_n","title":"N\uff0c\u7ed9\u5b9a\\(n,~k\\)\uff0c\u6c42\\(\\sum\\limits_{i=1}^n f_i\\times i^k\\)\uff08\\(f_n\\) \u4e3a\u6590\u6ce2\u90a3\u5951\u6570\u5217\uff09","text":"<p>Codeforces 392C. Yet Another Number Sequence - MyWither - \u535a\u5ba2\u56ed (cnblogs.com)</p>"},{"location":"%E5%88%B7%E9%A2%98/4.%E7%9F%A9%E9%98%B5/#o","title":"O\uff0c\u6a21\u62df\u5728\u4e8c\u7ef4\u5faa\u73af\u5730\u56fe\u4e2d\u7684\u5750\u6807\u53d8\u6362\uff08\u6709\u610f\u601d\uff09","text":""},{"location":"%E5%88%B7%E9%A2%98/4.%E7%9F%A9%E9%98%B5/#psn-sntimes-sn","title":"P\uff0c\u8ba1\u7b97\u6590\u6ce2\u90a3\u5951\u524d\u7f00\u548csn\uff0c\u7136\u540e\u6784\u9020 \\(sn\\times sn\\) \u77e9\u9635\uff0c\u4f7f\u5f97\u6bcf\u884c\u6216\u6bcf\u5217\u4e4b\u548c\u4e0d\u76f8\u7b49","text":"<p>\u8fd9\u9898\u4ea4\u4e0d\u4e86\uff01</p>"},{"location":"%E5%88%B7%E9%A2%98/4.%E7%9F%A9%E9%98%B5/#qf_nf_n-1f_n-21nge2f_0f_11","title":"Q\uff0c\\(f_n=f_{n-1}+f_{n-2}+1~~(n\\ge2),~f_0=f_1=1\\)","text":"<p>\uff08\u9012\u5f52\u6c42\u6590\u6ce2\u90a3\u5951\u7684\u51fd\u6570\u8c03\u7528\u4e2a\u6570\uff09</p>"},{"location":"%E5%88%B7%E9%A2%98/4.%E7%9F%A9%E9%98%B5/#rf_nf_n-1times-f_n-2nge-2f_0af_1b","title":"R\uff0c\\(f_n=f_{n-1}\\times f_{n-2}~~(n\\ge 2),~f_0=a,~f_1=b\\)","text":""},{"location":"%E5%88%B7%E9%A2%98/4.%E7%9F%A9%E9%98%B5/#sf_nsumlimits_i0n-1a_itimes-b_ia_ia_i-1times-axayb_ib_i-1times-bxbya_0a0b_0b0","title":"S\uff0c\\(f_n=\\sum\\limits_{i=0}^{n-1}a_i\\times b_i,~a_i=a_{i-1}\\times AX+AY,~b_i=b_{i-1}\\times BX+BY,~a_0=A0,~b_0=B0\\)","text":"<p>\uff08\u5927\u5199\u6807\u8bc6\u7684\u91cf\u662f\u5e38\u91cf</p> <p>\uff09</p>"},{"location":"%E5%88%B7%E9%A2%98/5.%E6%95%B0%E8%AE%BA/","title":"5.\u6570\u8bba","text":""},{"location":"%E5%88%B7%E9%A2%98/5.%E6%95%B0%E8%AE%BA/#a","title":"A\uff0c\u201d\u770b\u7f51\u683c\u627e\u89c4\u5f8b\u201c","text":"<p>\u9898\u610f\uff1a\u7ed9\u5b9a\u4e00\u4e2a\u6570 \\(w\\)\uff0c\u6c42\u51fa\u5176\u5728\u7f51\u683c\u4e2d\u7684\u5750\u6807</p> <p>\u8bb0 \\(f_n\\) \u4e3a \\(n\\times n\\) \u7684\u7f51\u683c\u7684\u53f3\u4e0a\u89d2\u6743\u503c</p> <p>\u5bb9\u6613\u53d1\u73b0 \\(f_n=f_{n-1}+2\\times(n-1)\\)\uff0c\\(f_n\\) \u7c7b\u4f3c\u4e8e \\(2\\times(n-1)\\) \u7684\u524d\u7f00\u548c\uff0c</p> <p>\u5b9e\u9645\u4e0a \\(f_n=\\) \\(2(n-1)\\) \u7684\u524d\u7f00\u548c+1</p> <p>\u6240\u4ee5 \\(f_n=2\\times \\frac{n\\times(n+1)}{2}-2\\times n+1=n^2-n+1\\) </p> <p>\u627e\u5230\u7b2c\u4e00\u4e2a\u4e0d\u5927\u4e8e \\(w\\) \u7684 \\(f_n\\)\uff0c\u7136\u540e\u518d\u5206\u4e24\u7c7b\u60c5\u51b5\u8ba8\u8bba\u5373\u53ef</p>"},{"location":"%E5%88%B7%E9%A2%98/5.%E6%95%B0%E8%AE%BA/#bntimes-m","title":"B\uff0c\\(n\\times m\\)\u7f51\u683c\u4e2d\u6700\u591a\u80fd\u653e\u7684\u9a6c\u7684\u6570\u91cf\uff08\u7384\uff09","text":"<p>\u8bb0\\(n\\le m\\)</p> <p>1\uff09\\(n=1\\implies m\\) </p> <p>2\uff09$n=2\\implies $</p> <p>3\uff09\\(n\\ge 3\\implies (n\\times m+1)/2\\)</p>"},{"location":"%E5%88%B7%E9%A2%98/5.%E6%95%B0%E8%AE%BA/#c","title":"C\uff0c\u7b80\u5355\u5df4\u4ec0\u535a\u5955","text":"<p>\u7ed9 \\(n\\) \u4e2a\u77f3\u5934\uff0c\u4e24\u4eba\u8f6e\u6d41\u53d6 \\(1\\) \u5230 \\(2\\) \u4e2a\u77f3\u5b50</p> <p>1\uff09alice\u5148\u53d6\uff0c\u6700\u540e\u4e00\u4e2a\u53d6\u5b8c\u77f3\u5b50\u7684\u8f93\uff08\u9700\u8981\u8f6c\u6362\u7684\u5df4\u4ec0\u535a\u5955\uff09</p> <p>2\uff09bob\u5148\u53d6\uff0c\u6700\u540e\u4e00\u4e2a\u53d6\u5b8c\u77f3\u5b50\u7684\u8d62\uff08\u6807\u51c6\u5df4\u4ec0\u535a\u5955\uff09</p>"},{"location":"%E5%88%B7%E9%A2%98/5.%E6%95%B0%E8%AE%BA/#d-nm-1le-mle9-m-n-k","title":"D\uff0c\u7ed9\u5b9a n\uff0cm \\((1\\le m\\le9)\\) \uff0c\u6c42\u6700\u5c0f\u7684\u8fde\u7eed\u7684m\u6784\u6210\u7684\u6570\u4e14\u80fd\u88ab n \u6574\u9664\u7684\u4f4d\u6570 k","text":"<p>\uff08\u4fdd\u8bc1 \\(n\\) \u4e0d\u662f 2 \u6216 5 \u7684\u500d\u6570\uff09</p> <p>\u6bd4\u5982 n = 39\uff0cm = 3\uff0c\u7531\u4e8e \\(39\\mid 333333\\)\uff0c\u6240\u4ee5 \\(k=6\\)</p>"},{"location":"%E5%88%B7%E9%A2%98/5.%E6%95%B0%E8%AE%BA/#e","title":"E\uff0c","text":""},{"location":"%E5%88%B7%E9%A2%98/5.%E6%95%B0%E8%AE%BA/#f-n-a_i-i","title":"F\uff0c\u9547\u4e0a \\(n\\) \u4e2a\u4eba\u90fd\u6709\u6743\u503c \\(a_i\\)\uff0c\u8868\u793a i \u6240\u5728\u56fd\u5bb6\u7684\u51fa\u81ea\u5df1\u4e4b\u5916\u7684\u4eba\u6570\uff0c\u6c42\u4e16\u754c\u4eba\u53e3\u6700\u5c0f\u503c","text":"<p>\uff08\u4e00\u4e2a\u4eba\u53ea\u5c5e\u4e8e\u4e00\u4e2a\u56fd\u5bb6\uff09</p>"},{"location":"%E5%88%B7%E9%A2%98/5.%E6%95%B0%E8%AE%BA/#g","title":"G\uff0c\u6c42 \u7ea6\u745f\u592b\u73af \u5e78\u5b58\u8005\u7684\u4e0b\u6807","text":"<p>\u9012\u63a8\u5f0f\uff1a\\(f_{n}=(f_{n-1}+m)~\\%~n\\)</p> <p>\u7ea6\u745f\u592b\u73af\u2014\u2014\u516c\u5f0f\u6cd5\uff08\u9012\u63a8\u516c\u5f0f\uff09_\u9648\u6d45\u58a8\u7684\u535a\u5ba2-CSDN\u535a\u5ba2_\u7ea6\u745f\u592b\u73af\u516c\u5f0f</p>"},{"location":"%E5%88%B7%E9%A2%98/5.%E6%95%B0%E8%AE%BA/#h","title":"H\uff0c\u4e00\u5143\u4e8c\u6b21\u51fd\u6570\u6700\u503c","text":""},{"location":"%E5%88%B7%E9%A2%98/5.%E6%95%B0%E8%AE%BA/#i","title":"I\uff0c\u777f\u667a\u9898","text":""},{"location":"%E5%88%B7%E9%A2%98/5.%E6%95%B0%E8%AE%BA/#j","title":"J\uff0c\u4e00\u5143\u4e09\u6b21\u51fd\u6570\u6781\u503c","text":"<p>\u5148\u6c42\u5bfc\uff0c\u518d\u5bf9\u5f97\u5230\u7684\u4e8c\u5143\u4e00\u6b21\u65b9\u7a0b\u6c42\u6839\uff0c\u8fd9\u4e2a\u6839\u5c31\u662f\u6781\u503c\u7684\u4f4d\u7f6e</p> <p>\u53ef\u4ee5\u7528\u4e09\u5206\u6cd5\u6c42\u6839\uff0c\u6216\u8005\u516c\u5f0f\u6c42\u6839</p> <p>\uff08\u725b\u987f\u8fed\u4ee3\u6cd5\u4f1a \\(wa...\\)\uff0c\u539f\u56e0\u4e0d\u660e\uff09</p>"},{"location":"%E5%88%B7%E9%A2%98/5.%E6%95%B0%E8%AE%BA/#k","title":"K\uff0c\u6839\u636e\u7269\u7406\u516c\u5f0f\u6c42\u4e00\u5143\u4e00\u6b21\u65b9\u7a0b","text":""},{"location":"%E5%88%B7%E9%A2%98/5.%E6%95%B0%E8%AE%BA/#lltimes-w-n-k-n-nwneswse","title":"L\uff0c\u7ed9\u5b9a\u7f51\u683c\u5927\u5c0f\uff08\\(L\\times W\\)\uff09\uff0c\u8d28\u70b9\u6570 n \uff0c\u8d28\u70b9\u201d\u53d8\u6362\u201c\u6b21\u6570 k\uff0c\u4ee5\u53ca n \u4e2a\u8d28\u70b9\u7684 \u521d\u59cb\u5750\u6807 \u548c \u65b9\u5411\uff08\u53ea\u6709 \\(NW,~NE,~SW,~SE\\) \u56db\u79cd\uff09\uff0c\u5176\u4e2d\u5141\u8bb8 \u8d28\u70b9\u548c\u8d28\u70b9 \u6216 \u8d28\u70b9\u548c\u5899\u58c1 \u7684\u78b0\u649e\uff08\u8d28\u70b9\u4ee5\u539f\u901f\u5ea6\u671d\u53cd\u65b9\u5411\u8fd0\u52a8\uff09\uff1b\u53d8\u6362\u4e4b\u540e\u6392\u5e8f\u8f93\u51fa\u6bcf\u4e2a\u8d28\u70b9\u7684\u5750\u6807","text":"<p>\uff08\u8d28\u70b9\u662f\u5411\u7740\u5bf9\u89d2\u7ebf\u8fd0\u52a8\u7684\uff0c\u6bd4\u5982\u65b9\u5411\u4e3a\\(NW\\)\u7684\u67d0\u6b21\u53d8\u6362\uff1a \\((x,~y)-&gt;(x-1,~y+1)\\)\uff09</p> <p>1\uff09\u56e0\u4e3a\u6700\u540e\u53ea\u662f\u8f93\u51fa\u8fd9\u4e9b\u5750\u6807\u53d8\u6362\u5e76\u4e14\u6392\u5e8f\u540e\u7684\u5750\u6807\uff0c\u53ef\u4ee5\u5ffd\u89c6\u8d28\u70b9\u5750\u6807\u7684\\(id\\)\uff0c\u6240\u4ee5\u53ef\u4ee5\u5c06\u8d28\u70b9\u95f4\u7684\u78b0\u649e\u5ffd\u7565\u6389\uff0c\u4e5f\u5c31\u662f\u8bf4 \u67d0\u8d28\u70b9 \\(a\\) \u4e0e\u53e6\u4e00\u8d28\u70b9 \\(b\\) \u78b0\u649e\u540e\uff0c\u53ef\u5c06\u8d28\u70b9 \\(b\\) \u770b\u4f5c\u662f\u8d28\u70b9 \\(a\\)</p> <p>2\uff09\u5728\"1)\"\u7684\u57fa\u7840\u4e0a\uff0c\u53ef\u4ee5\u5c06\u4e8c\u7ef4\u5750\u6807\u5206\u89e3\u4e3a \\(x,~y\\) \u5750\u6807\u5206\u522b\u72ec\u7acb\u8ba8\u8bba</p> <p>\uff08\u6280\u5de7\uff1a\u5c06\u8303\u56f4\u4e3a \\(0..n\\) \u7684\u5750\u6807 \\(x\\) \"\u7ffb\u8f6c\"\u540e \u4e3a \\(n-x\\)\uff09</p>"},{"location":"%E5%88%B7%E9%A2%98/5.%E6%95%B0%E8%AE%BA/#m-displaystyle-min_k1n-sum_i1nx_k-x_iy_k-y_itimes-w_i-x_ky_k","title":"M\uff0c\u6c42 \\(\\displaystyle \\min_{k=1..n}\\{ \\sum_{i=1}^n(|x_k-x_i|+|y_k-y_i|)\\times w_i \\}\\) \u4e2d\u7684 \\((x_k,~y_k)\\)","text":"<p>\\(x,~y\\) \u53ef\u4ee5\u5206\u522b\u72ec\u7acb\u8ba8\u8bba\uff0c</p> <p>\u5bf9\u4e8e\u67d0\u4e2a\u5206\u91cf \\(x\\) \u6765\u8bf4\uff0c\u6c42 \\(x_i\\) \u7684\u201c\u5e26\u6743\u4e2d\u4f4d\u6570\u201c\u5373\u53ef\uff08\u5206\u91cf \\(y\\) \u540c\u7406\uff09</p> <p>1\uff09\u666e\u901a\u4e2d\u4f4d\u6570\u6c42\u6cd5\uff1a</p> <p>\u5bf9 \\(\\{x_i\\}\\) \u5347\u5e8f\uff0c\\(n\\) \u4e3a\u5947\u6570\u65f6\uff0c\\(ans = x_{\\lceil\\frac{n}{2}\\rceil}\\)\uff1b\\(n\\) \u4e3a\u5076\u6570\u65f6\uff0c\\(ans=(x_{\\frac{n}{2}}+x_{\\frac{n}{2}+1})/2\\)</p> <p>2\uff09\u5e26\u6743\u4e2d\u4f4d\u6570\u6c42\u6cd5\uff1a</p> <p>\u7c7b\u4f3c\uff08\u7cbe\u786e\u8ba8\u8bba\u597d\u50cf\u6709\u70b9\u9ebb\u70e6\uff0c\u9e3d\u4e86\uff09</p>"},{"location":"%E5%88%B7%E9%A2%98/5.%E6%95%B0%E8%AE%BA/#n","title":"N\uff0c\u4e8c\u8fdb\u5236\u8f6c\u5341\u8fdb\u5236\u6c34\u9898","text":""},{"location":"%E5%88%B7%E9%A2%98/5.%E6%95%B0%E8%AE%BA/#o","title":"O\uff0c\u7b80\u5355\u7684\u6c42\u548c\u63a8\u5bfc","text":""},{"location":"%E5%88%B7%E9%A2%98/5.%E6%95%B0%E8%AE%BA/#p-n-n-n","title":"P\uff0c\u7ed9\u5b9a \\(n\\) \u4e2a\u4eba\u7684\u4e8c\u7ef4\u5750\u6807\uff0c\u6bcf\u4eba\u7684\u542c\u529b\u4e00\u6837\uff0c\u5206\u522b\u53ea\u5f00\u4e00\u53d1\u67aa\uff0c\u6700\u540e\u4e00\u4e2a\u4eba\u5f00\u5b8c\u67aa\u540e\uff0c\u6bcf\u4e2a\u4eba\u8bf4\u51fa\u81ea\u5df1\u542c\u5230\u7684\u67aa\u58f0\uff08\u9664\u81ea\u5df1\u7684\u67aa\u58f0\u5916\uff09\uff0c\\(n\\) \u4e2a\u4eba\u8868\u8fbe\u7684\u89c2\u70b9\u5bf9\u5e94\u7740\u4e00\u79cd\u65b9\u6848\uff08\u56e0\u4e3a\u542c\u529b\u7684\u8303\u56f4\u4e0d\u786e\u5b9a\uff0c\u6240\u4ee5\u4f1a\u6709\u5f88\u591a\u65b9\u6848\uff09\uff0c\u6c42\u5408\u6cd5\u65b9\u6848\u6570\uff08n\u4e2a\u4eba\u7684\u89c2\u70b9\u7b26\u5408\u903b\u8f91\uff09","text":"<p>1\uff09\u8fd9 \\(n\\) \u4e2a\u4eba\u7684\u542c\u529b\u8303\u56f4\u7684\u5927\u5c0f\u53ef\u4ee5\u5bf9\u5e94\u4e00\u4e2a\u5408\u6cd5\u65b9\u6848</p> <p>2\uff09\u679a\u4e3e\u4efb\u610f\u4e24\u4eba\u7684\u4e8c\u7ef4\u8ddd\u79bb\u5e76\u53bb\u91cd\uff0c\u8be5\u6570\u91cf\u7b49\u4e8e\u5b58\u5728\u4e00\u4e2a\u4eba\u542c\u5230\u4e00\u4e2a\u4ee5\u4e0a\u67aa\u58f0\u7684\u65b9\u6848\u6570\uff0c\u6240\u4ee5\u6700\u540e\u52a0\u4e0a\u4efb\u4f55\u4eba\u90fd\u542c\u4e0d\u5230\u67aa\u58f0\u7684\u65b9\u6848\u5373\u53ef</p>"},{"location":"%E5%88%B7%E9%A2%98/5.%E6%95%B0%E8%AE%BA/#q","title":"Q\uff0c\u4e24\u4e2a\u65e5\u671f\u4e4b\u95f4\u7684\u95f0\u5e74\u603b\u6570","text":"<p>\u7f51\u4e0a\u7684\u9898\u89e3\u90fd\u6ca1\u6709\u5206\u6790\u8fc7\u7a0b\u53ea\u6709\u7ed3\u8bba\u3002\u3002</p> <p>LightOJ-1414-February 29--\u603b\u5171\u591a\u5c11\u4e2a\u95f0\u65e5\uff1f--\u4e24\u79cd\u89e3\u6cd5 - \u4ee3\u7801\u5148\u950b\u7f51 (codeleading.com)</p>"},{"location":"%E5%88%B7%E9%A2%98/5.%E6%95%B0%E8%AE%BA/#rhhsslbublbub","title":"R\uff0c\u7ed9\u5b9a\u201d\u5bf9\u79f0\u8f74\u65f6\u95f4\u201c\uff08hhss\uff09\uff0c\u5f00\u59cb\u65f6\u95f4\\(lb\\)\uff0c\u7ed3\u675f\u65f6\u95f4\\(ub\\)\uff0c\u6c42\u51fa\u6240\u6709\u5728\u65f6\u95f4\u8303\u56f4\\([lb,~ub]\\)\u5185\u65f6\u9488\u548c\u5206\u9488\u5173\u4e8e\u201c\u5bf9\u79f0\u8f74\u65f6\u95f4\u201d\u7684\u65f6\u9488\u5bf9\u79f0\u7684\u65f6\u95f4\uff08\u7537\u9898\uff09","text":"<p>\\(it~is~a~bit~of~sh*t\\)\uff08\u4e3b\u8981\u662f\u6ca1\u4ec0\u4e48\u4eba\u5199\u9898\u89e3\u3002\u3002\uff09</p>"},{"location":"%E5%88%B7%E9%A2%98/5.%E6%95%B0%E8%AE%BA/#sn","title":"S\uff0c\\(n\\) \u4e2a\u6570\u7684\u6700\u5927\u516c\u500d\u6570 + \u9ad8\u7cbe\u5ea6\u4e58","text":""},{"location":"%E5%88%B7%E9%A2%98/5.%E6%95%B0%E8%AE%BA/#txa_ipmodb_ii1nb_iisprime","title":"T\uff0c\\(x=a_i\\pmod{b_i}\uff0c~i=1..n\uff0c~b_i~is~prime\\)\uff0c\u5178\u578b\u7684\u4e2d\u56fd\u5269\u4f59\u5b9a\u7406","text":""},{"location":"%E5%88%B7%E9%A2%98/5.%E6%95%B0%E8%AE%BA/#antimes-n-chessboard-k","title":"A\uff0c\\(n\\times n\\) chessboard \u6446\u653e \\(k\\) \u4e2a\u8f66 \u7684\u65b9\u6848\u6570","text":"<p>\\(\\frac{n!}{(n-k)!}\\times C_n^k=\\frac{\uff08n!/(n-k)!)^2}{k!}\\)</p> <p>\uff08\u6ce8\u610f\u5206\u5b50\u4f1a\u7206long long\uff0c\u89e3\u51b3\u65b9\u6848\u662f\u7528__int128 \u6216 \u5148\u9664 \\(k!\\) \u63a5\u7740\u518d\u4e58\u4e0a\\(n!/(n-k)!\\)\uff09</p>"},{"location":"%E5%88%B7%E9%A2%98/5.%E6%95%B0%E8%AE%BA/#bn","title":"B\uff0c\u7ed9\u5b9a\\(n\\)\u4e2a\u4e8c\u7ef4\u5750\u6807\uff0c\u6c42\u6700\u5c0f\u5750\u6807\u80fd\u7ec4\u6210\u5e73\u884c\u56db\u8fb9\u5f62\u7684\u4e2a\u6570","text":""},{"location":"%E5%88%B7%E9%A2%98/5.%E6%95%B0%E8%AE%BA/#c_1","title":"C\uff0c\u7ec4\u5408\u6570","text":"<p>\u53ef\u4ee5\u7528\u7ebf\u6027\u6c42\u9636\u4e58\uff0c\u9636\u4e58\u9006\u5143\u7684\u65b9\u6cd5</p>"},{"location":"%E5%88%B7%E9%A2%98/5.%E6%95%B0%E8%AE%BA/#d-n-1n-m-k","title":"D\uff0c\u7ed9\u5b9a \\(n\\) \u4e2a\u4e0d\u540c\u5143\u7d20\u7684\u6392\u5217 \\(1..n\\)\uff0c\u524d \\(m\\) \u4e2a\u5143\u7d20\u4e2d \\(k\\) \u4e2a\u5143\u7d20\u9519\u6392\uff0c\u6c42\u91cd\u65b0\u6392\u5217\u540e\u7684\u65b9\u6848\u6570","text":""},{"location":"%E5%88%B7%E9%A2%98/5.%E6%95%B0%E8%AE%BA/#e2e6","title":"E\uff0c\u9694\u677f\u5927\u6cd5\uff08\u6ce8\u610f\u6570\u7ec4\u8981\u5f00\\(2e6\\)\uff09","text":""},{"location":"%E5%88%B7%E9%A2%98/5.%E6%95%B0%E8%AE%BA/#fxinlbub-x-0dp","title":"F\uff0c\u7edf\u8ba1\\(x\\in[lb,~ub]\\) \uff0c\\(x\\) \u672b\u5c3e\u51fa\u73b0\u76840\u7684\u603b\u548c\uff08\u6570\u4f4ddp\uff1b\u7537\u554a\uff09","text":""},{"location":"%E5%88%B7%E9%A2%98/5.%E6%95%B0%E8%AE%BA/#glbub-perfect-numberababge-2bst","title":"G\uff0c\u503c\u5728\\((lb,~ub)\\) \u5185\u7684\"perfect number\"\uff08\\(a^b(a,~b\\ge 2)\\)\uff09\u6784\u6210BST\u7684\u65b9\u6848\u6570","text":"<p>\\(n\\) \u4e2a\u7ed3\u70b9\u6784\u6210\u7684BST\u7684\u65b9\u6848\u6570\u4e3a \\(Catalan_n\\)</p>"},{"location":"%E5%88%B7%E9%A2%98/5.%E6%95%B0%E8%AE%BA/#h-nm-1n-a_m-x_1a_m-x_1-x_2-1-dp","title":"H\uff0c\u7ed9\u5b9a \\(n,~m\\)\uff0c\u8868\u793a \\(1..n\\) \u9012\u589e\u7684\u5e8f\u5217\uff0c\u6c42\u6ee1\u8db3 \\(a_m\\) \u4f4d\u4e8e\u961f\u9996(\u8bb0 \\(x_1=a_m\\))\uff0c\u5e76\u4e14 \\(x_1 &gt; x_2\\)  \uff08\u65e0\u6cd5\u6ee1\u8db3\uff0c\u5219\u8fd4\u56de 1\uff09\u7684\u65b9\u6848\u6570  \uff08\u8ba1\u6570\u7c7bdp\uff0c\u7537\u554a\uff09","text":""},{"location":"%E5%88%B7%E9%A2%98/5.%E6%95%B0%E8%AE%BA/#i-n-a_i-i-i1","title":"I\uff0c\u7ed9\u5b9a \\(n\\) \u4e2a\u4efb\u52a1\u7ed9\u5904\u7406\u673a\u5904\u7406\uff0c\u6bcf\u4e2a\u4efb\u52a1\u6709 \\(a_i\\) \u4e2a\u5b50\u4efb\u52a1\uff0c\u5e76\u4e14 \u4efb\u52a1\\(i\\) \u5fc5\u987b\u5728 \u4efb\u52a1\\(i+1\\) \u5b8c\u5168\u7ed3\u675f\u4e4b\u524d \u5b8c\u5168\u7ed3\u675f\uff0c\u6c42\u65b9\u6848\u6570","text":"<p>\u6709\u4e00\u4e2a\u6027\u8d28\uff1a\u6700\u540e\u4e00\u4e2a\u4efb\u52a1\u7684 \u7b2c \\(a_n\\) \u4e2a\u5b50\u4efb\u52a1\u4e00\u5b9a\u662f\u6700\u540e\u5904\u7406</p> <p>dp\u65b9\u6cd5\uff1a\\(f_i\\) \u8868\u793a \u524d \\(i\\) \u4e2a\u4efb\u52a1 \u5b8c\u5168\u7ed3\u675f\u7684\u65b9\u6848\u6570\uff0c\u5c06 \\(s_{i-1}\\) \u4e2a\u4efb\u52a1\u4fdd\u6301\u539f\u5e8f \u91cd\u65b0\u5206\u914d\u5230 \\(s_{i}-1\\) \u4e2a\u4f4d\u7f6e\uff0c\u7b2c \\(s_i\\) \u4e2a\u4f4d\u7f6e\u7559\u7ed9 \u4efb\u52a1\\(i\\) \u7684\u6700\u540e\u4e00\u4e2a\u5b50\u4efb\u52a1\uff0c\u6700\u540e\u4efb\u52a1\\(i\\) \u7684\u5b50\u4efb\u52a1 \\(1..a_i-1\\) \u4eba\u914d\u5230\u5269\u4f59\u4f4d\u7f6e\u4e0a\uff0c \u5f97\u5230 \\(\\displaystyle f_i=f_{i-1}\\times C^{S_{i-1}}_{S_i-1}\\)</p> <p>\uff08\u8bb0 \\(s_i\\) \u4e3a \\(a_i\\) \u7684\u524d\u7f00\u548c\uff0c\u5904\u7406\u673a\u5904\u7406\u6bcf\u4e2a\u539f\u5b50\u4efb\u52a1\u7684\u65f6\u95f4\u53ef\u8868\u793a\u4e3a \\(t=1~..~s_n\\)\uff09</p> <p>\u6700\u540e\uff0c\\(f_0=1\\)</p>"},{"location":"%E5%88%B7%E9%A2%98/5.%E6%95%B0%E8%AE%BA/#j-ntimes-m-k","title":"J\uff0c\u7ed9\u5b9a \\(n\\times m\\) \u7f51\u683c\uff0ck\u79cd\u989c\u8272\uff1b\u4e24\u4e2a\u54c8\u5bc6\u987f\u8ddd\u79bb\u4e3a\u5076\u6570\u7684\u5355\u5143\u683c\u4e0d\u5141\u8bb8\u6d82\u540c\u6837\u7684\u989c\u8272\uff0c\u5141\u8bb8\u4e0d\u4f7f\u7528\u67d0\u79cd\u989c\u8272\uff0c\u4f46\u6bcf\u4e2a\u5355\u5143\u683c\u90fd\u5fc5\u987b\u88ab\u67d3\u8272\uff0c\u6c42\u67d3\u8272\u65b9\u6848\u6570\uff08\u9012\u63a8\u5f0f\u7537\u6c42\uff01\uff01\uff09","text":"<p>\u53ef\u4ee5\u53d1\u73b0\uff0c\u4e0e\\((1,~1)\\) \u7684\u54c8\u5bc6\u987f\u8ddd\u79bb\u4e3a \u5947\u6570 \u6216 \u5076\u6570 \u53ef\u4ee5\u6784\u6210\u7684\u70b9\u96c6 \\(A,~B\\)\uff0c\u5176\u4e2d \\(A\\) \u548c \\(B\\) \u662f\u539f\u56fe\u7684\u4e00\u4e2a\u5212\u5206\uff0c\u800c\u4e14 \\(A\\) \u6216 \\(B\\) \u5185\u7684\u70b9\u4e4b\u95f4\u7684\u67d3\u8272\u662f\u72ec\u7acb\u7684</p> <p>\uff08\u53ef\u4ee5\u5f62\u8c61\u7684\u79f0\u6b64\u79cd\u5212\u5206 \u4e3a \u9ed1\u767d\u68cb\uff09</p> <p>\u8bb0 \\(a=|A|,~b=|B|\\)\uff0c\\(f_{i,~j} :=\\) \\(i\\) \u4e2a\u683c\u5b50\u6070\u597d\u67d3 \\(j\\) \u79cd\u989c\u8272\u7684\u65b9\u6848\u6570</p> <p>\uff08\u7b26\u53f7\u5b9a\u4e49 \\(f_{i,~j} :=\\) \\(O_{1..i} = Color_{1..j}\\) \u5e76\u4e14 \\(O_{1..i}\\) \u8986\u76d6\u6240\u6709\u989c\u8272 \u7684\u65b9\u6848\uff09</p> <p>\u53ef\u8bc1\uff1a \\(f_{i,~j} = C_{j}^1 \\times (f_{i-1,~j-1}+f_{i-1,~j})\\)</p> <p>\uff08\\(O_i\\)  \u67d3 \\(j\\) \u79cd\u989c\u8272\u4e4b\u4e00\uff0c\\(O_{1..i-1}\\) \u67d3 \\(j\\) \u79cd \u6216 \\(j-1\\) \u79cd\u989c\u8272 \uff09</p> <p>\uff08\u6839\u636e\u5b9a\u4e49\uff0c\uff09</p> <p>\u6240\u4ee5\u7b54\u6848\u4e3a\uff1a\\(\\displaystyle \\sum_{i=1}^{k}\\sum_{j=1}^{k-i}C_{k}^i\\times C_{k-i}^j\\times f_{a,~i}\\times f_{b,~j}\\)</p> <p>\uff08\u5176\u4e2d \\(i\\) \u4e3a \\(A\\) \u7684\u989c\u8272\u79cd\u6570\uff0c \\(j\\) \u4e3a \\(B\\) \u7684\u989c\u8272\u79cd\u6570\uff0c\u4ee5\u53ca \\(k-i-j\\) \u4e3a\u4e0d\u7528\u4e8e\u67d3\u8272\u7684\u989c\u8272\u79cd\u6570\uff09</p>"},{"location":"%E5%88%B7%E9%A2%98/5.%E6%95%B0%E8%AE%BA/#k_1","title":"K\uff0c","text":""},{"location":"%E5%88%B7%E9%A2%98/7.%E4%BA%8C%E5%88%86%26%E5%B0%BA%E5%8F%96/","title":"7.\u4e8c\u5206&\u5c3a\u53d6","text":"<p>CWXU-\u6691\u5047\u96c6\u8bad-\u4e8c\u5206\u4e13\u9898 - Virtual Judge (csgrandeur.cn)</p> <p>\u6700\u5c0f\u503c\u6700\u5927\u5316\uff1aPOJ 1264 POJ 2456 \u6700\u5927\u5316\u6700\u5c0f\u503c:POJ 3273 POJ3104 \u6700\u5927\u5316\u5e73\u5747\u503c(01\u5206\u6570\u89c4\u5212):POJ 2976 POJ 3111 \u67e5\u627e\u7b2cK\u5927\u7684\u503c:POJ 3579 POJ 3685</p> <p>\uff08\u4e8c\u5206\u7684\u5b9e\u8d28\u5c31\u662f\u66b4\u529b\uff0c\u53ea\u4e0d\u8fc7\u590d\u6742\u5ea6\u7531O(N)\u53d8\u4e3a\u4e86O(logN)\uff09</p>"},{"location":"%E5%88%B7%E9%A2%98/7.%E4%BA%8C%E5%88%86%26%E5%B0%BA%E5%8F%96/#11064-cable-master-pojorg","title":"1\u30011064 -- Cable master (poj.org)","text":"<p>\u9898\u610f\uff1an\u4e2a\u68cd\u5b50\uff0c\u957f\u5ea6\u5206\u522b\u4e3a\\(a_i\\)\uff08double\uff09\uff0c\u5c06\u8fd9n\u4e2a\u68cd\u5b50\u5207\u5272\u6210m\u6839\u7b49\u957f\u68cd\u5b50\uff0c\u6c42\u68cd\u5b50\u7684\u6700\u5927\u957f\u5ea6</p> <p>\u6570\u636e\uff1a\\(n=1e4\uff0ca_i=1e5\uff0ck=1e4\\)</p> <p>\u5206\u6790\uff1a\u8bbe\u68cd\u5b50\u6700\u5927\u957f\u5ea6\u4e3ak\uff0ck\u8d8a\u5927\\(\\implies\\)\u80fd\u5206\u7684\u68cd\u5b50\u6570\u91cf\u8d8a\u5c11</p> <p>\u56e0\u6b64\u8be5\u9898\u7c7b\u4f3c\u4e8e\u9012\u51cf\u5e8f\u5217\u4e2d\u641c\u7d22\u7279\u5b9a\u503c\uff0c\u4f46\u6309\u7406\u6765\u8bf4ub\u5e94\u8be5\u6536\u655b\u4e8e\u4e0d\u6ee1\u8db3\u6761\u4ef6\u7684\u8fb9\u754c\uff0clb\u6536\u655b\u4e8e\u6ee1\u8db3\u6761\u4ef6\u7684\u8fb9\u754c\uff0c\u800c\u8fd4\u56deub\u624d\u80fdac\uff01</p> <pre><code>#include&lt;iostream&gt;\n#include&lt;cmath&gt;\n#include&lt;cstdio&gt;\nusing namespace std;\nconst int N = 1e4+3;\nint n, m;\ndouble a[N];\nbool check(double k){\nint sum = 0;\nfor(int i=1; i&lt;=n; i++) sum += (int)(a[i] / k);\nreturn sum &gt;= m;\n}\ndouble find(double lb, double ub){\nwhile(lb + 1e-3 &lt; ub){\ndouble mid = (lb + ub) / 2;\nif(check(mid)) lb = mid;\nelse ub = mid;\n}\nreturn ub;\n}\nsigned main(){\nscanf(\"%d%d\", &amp;n, &amp;m);\nfor(int i=1; i&lt;=n; i++) scanf(\"%lf\", &amp;a[i]);\n// \u871c\u6c41\u64cd\u4f5c\uff01\uff01\nprintf(\"%.2f\", floor(find(0, 1e5+3) * 100) / 100);\n}\n</code></pre>"},{"location":"%E5%88%B7%E9%A2%98/7.%E4%BA%8C%E5%88%86%26%E5%B0%BA%E5%8F%96/#22456-aggressive-cows-pojorg","title":"2\u30012456 -- Aggressive cows (poj.org)","text":"<p>\u9898\u610f\uff1a\u6709n\u4e2a\u755c\u680fstall\uff08\u5750\u6807\u4e3a\\(x_i\\)\uff09\uff0cm\u5934\u725b\uff0c\u8fd9\u4e9b\u725b\u7279\u522b\u597d\u6597\uff0c\u4ee5\u81f3\u4e8e\u4e24\u5934\u725b\u4e0d\u53ef\u653e\u5728\u4e00\u4e2a\u755c\u680f\u91cc\uff0c\u6c42m\u5934\u725b\u7684\uff08\u6ee1\u8db3\u9650\u5236\u7684\uff09\u653e\u7f6e\u65b9\u6848\u4e2d\u76f8\u90bb\u4e24\u5934\u725b\u7684\u95f4\u8ddd\u7684\u6700\u5927\u503c\uff08\u76f8\u90bb\u610f\u5473\u7740\u201c\u6700\u5c0f\u503c\u201d\uff0c\u8be5\u9898\u5c31\u662f\u6240\u8c13\u7684\u201c\u6700\u5c0f\u503c\u6700\u5927\u5316\u201d\uff0ctnnd\uff09</p> <p>\u6570\u636e\uff1a\\(n = 1e5\uff0cx_i = 1e9\uff0cm \\le n\\)</p> <p>\u5206\u6790\uff1a\u641c\u7d22\u95f4\u8ddd\u7684\u6700\u5927\u503ck\uff0ck\u4e0e\u6ee1\u8db3\u9898\u76ee\u9650\u5236\u7684\u5173\u7cfb\u5982\u4e0b\u56fe\uff08\u81ea\u79f0\u4e3a1 0\u6a21\u578b\uff09\uff1a</p> <p></p> <p>\u5224\u5b9amid\u6ee1\u8db3\u9650\u5236\u65f6\uff0c\u66f4\u65b0\\(lb = mid\\)\uff08mid\u4e0d\u6ee1\u8db3\u6761\u4ef6\u65f6\u540c\u7406\uff09</p> <p></p> <pre><code>#include&lt;iostream&gt;\n#include&lt;algorithm&gt;\n#include&lt;cstdio&gt;\nusing namespace std;\nconst int N = 1e5+3;\nint n, m;\nint a[N];\nbool check(int k){\nint cnt = 0;\nint pre = -2e9;\nfor(int i=1; i&lt;=n; i++){\nif(pre + k &lt;= a[i]){\npre = a[i];\nif( ++ cnt == m) return true;\n}\n}\nreturn false;\n}\nint find(int lb, int ub){\nint ans;\nwhile(lb + 1 &lt; ub){\nint mid = lb + (ub - lb &gt;&gt; 1);\nif(check(mid)) lb = mid;\nelse ub = mid;\n}\nreturn lb;\n}\nint main(){\ncin &gt;&gt; n &gt;&gt; m;\nfor(int i=1; i&lt;=n; i++) scanf(\"%d\", &amp;a[i]);\nsort(a + 1, a + n + 1);\ncout &lt;&lt; find(0, a[n] - a[1]) &lt;&lt; '\\n';\n}\n</code></pre>"},{"location":"%E5%88%B7%E9%A2%98/7.%E4%BA%8C%E5%88%86%26%E5%B0%BA%E5%8F%96/#33273-monthly-expense-pojorg","title":"3\u30013273 -- Monthly Expense (poj.org)","text":"<p>\u9898\u610f\uff1a</p> <p>\u6570\u636e\uff1a</p> <p>\u5206\u6790\uff1a</p> <pre><code>#include&lt;iostream&gt;\n#include&lt;cstdio&gt;\nusing namespace std;\nconst int N = 1e5+3;\nint n, m;\nint a[N];\nint check(int x){\nfor(int i=1; i&lt;=n; i++) if(a[i] &gt; x) return false;\nint sum = a[1], group = 1;\nfor(int i=2; i&lt;=n; ++i){\nif(sum + a[i] &lt;= x) sum += a[i];\nelse sum = a[i], ++ group;\n}\nreturn group &lt;= m;\n}\nint find(int lb, int ub){\nwhile(lb + 1 &lt; ub){\nint mid = lb + (ub - lb &gt;&gt; 1);\nif(!check(mid)) lb = mid;\nelse ub = mid;\n}\n//    cout &lt;&lt; lb &lt;&lt; ' ' &lt;&lt; ub &lt;&lt; '\\n';\nreturn ub;\n}\nsigned main(){\ncin &gt;&gt; n &gt;&gt; m;\nfor(int i=1; i&lt;=n; ++i) scanf(\"%d\", &amp;a[i]);\ncout &lt;&lt; find(0, 1e9) &lt;&lt; '\\n';\n}\n</code></pre>"},{"location":"%E5%88%B7%E9%A2%98/7.%E4%BA%8C%E5%88%86%26%E5%B0%BA%E5%8F%96/#43104-drying-pojorg","title":"4\u30013104 -- Drying (poj.org)","text":"<p>\u9898\u610f\uff1a</p> <p>\u6570\u636e\uff1a</p> <p>\u5206\u6790\uff1a</p> <pre><code>#include&lt;iostream&gt;\n#include&lt;cstdio&gt;\nusing namespace std;\nconst int N = 1e5+3;\nint n, k;\nint a[N];\nbool check(int x){\nlong long machineTime = 0;\nfor(int i=1; i&lt;=n; i++){\nif(a[i] &gt; x){\nmachineTime += (a[i] - x + k - 2) / (k - 1);\n}\n}\nreturn machineTime &lt;= x;\n}\nint find(int lb, int ub){\nwhile(lb + 1 &lt; ub){\nint mid = lb + (ub - lb &gt;&gt; 1);\nif(!check(mid)) lb = mid;\nelse ub = mid;\n}\nreturn ub;\n}\nsigned main(){\ncin &gt;&gt; n;\nint ub = 0;\nfor(int i=1; i&lt;=n; i++) scanf(\"%d\", &amp;a[i]), ub = max(ub, a[i]);\ncin &gt;&gt; k;\n// \u4e0d\u7279\u5224k == 1\u4f1a RE\uff1f\uff1f\nif(k == 1) cout &lt;&lt; ub &lt;&lt; '\\n';\nelse cout &lt;&lt; find(0, ub + 1) &lt;&lt; '\\n';\n}\n</code></pre>"},{"location":"%E5%88%B7%E9%A2%98/7.%E4%BA%8C%E5%88%86%26%E5%B0%BA%E5%8F%96/#52976-dropping-tests-pojorg","title":"5\u30012976 -- Dropping tests (poj.org)","text":"<p>\u9898\u610f\uff1a</p> <p>\u6570\u636e\uff1a</p> <p>\u5206\u6790\uff1a</p> <pre><code>#include &lt;cstdio&gt;\n#include &lt;cstring&gt;\n#include &lt;iostream&gt;\n#include &lt;algorithm&gt;\n#define eps 1e-7\nusing namespace std;\nconst int N = 2e3+3;\nint n, m;\ndouble a[N], b[N];\ndouble t[N];\ndouble check(double mid){\nfor(int i=0;i&lt;n;i++) t[i] = a[i] - mid*b[i];\nsort(t, t + n);\ndouble ans=0;\nfor(int i=m;i&lt;n;i++) ans+=t[i];\nreturn ans &gt; 0;\n}\nint main(){\nwhile(~scanf(\"%d%d\", &amp;n, &amp;m)){\nif(n + m == 0) break;\nfor(int i=0; i&lt;n; i++) scanf(\"%lf\",&amp;a[i]);\nfor(int i=0; i&lt;n; i++) scanf(\"%lf\",&amp;b[i]);\ndouble lb = 0.0, ub = 1.0, mid;\nwhile(ub - lb &gt; eps){\nmid = (lb+ub) / 2;\nif(check(mid)) lb = mid;\nelse ub = mid;\n}\nprintf(\"%1.f\\n\", lb *100);\n}\n}\n</code></pre>"},{"location":"%E5%88%B7%E9%A2%98/7.%E4%BA%8C%E5%88%86%26%E5%B0%BA%E5%8F%96/#63111-k-best-pojorg","title":"6\u30013111 -- K Best (poj.org)","text":"<p>\u9898\u610f\uff1a</p> <p>\u6570\u636e\uff1a</p> <p>\u5206\u6790\uff1a</p> <pre><code>#include&lt;cstdio&gt;\n#include&lt;algorithm&gt;\n#include&lt;cstring&gt;\nusing namespace std;\n#define EPS 1e-9\nint n,k;\nstruct wp{\nint v,w,id;\ndouble y;\nbool operator &lt;(const wp&amp; rhs)const{return y&gt;rhs.y;}\n}a[2000001];\nbool ok(double d){\nfor(int i=1;i&lt;=n;++i)a[i].y=a[i].v-a[i].w*d;\nsort(a+1,a+n+1);\ndouble ans=0;\nfor(int i=1;i&lt;=k;++i)ans+=a[i].y;\nreturn ans&gt;=0;\n}\nint main(){\nscanf(\"%d%d\",&amp;n,&amp;k);\nfor(int i=1;i&lt;=n;++i)\nscanf(\"%d%d\",&amp;a[i].v,&amp;a[i].w),a[i].id=i;\ndouble l=0,r=1e13+1;\nwhile(r-l&gt;EPS){\ndouble mid=(l+r)/2;\nif(ok(mid))l=mid;else r=mid;\n}\nfor(int i=1;i&lt;=k;++i)printf(\"%d \",a[i].id);\nprintf(\"\\n\");\nreturn 0;\n}\n</code></pre>"},{"location":"%E5%88%B7%E9%A2%98/7.%E4%BA%8C%E5%88%86%26%E5%B0%BA%E5%8F%96/#73579-median-pojorg","title":"7\u30013579 -- Median (poj.org)","text":"<p>\u9898\u610f\uff1a</p> <p>\u6570\u636e\uff1a</p> <p>\u5206\u6790\uff1a</p> <pre><code>#include&lt;iostream&gt;\n#include&lt;cstdio&gt;\n#include&lt;algorithm&gt;\nusing namespace std;\nconst int N = 1e5+3;\nint n, m;\nint a[N];\nint findi(int lb, int ub, int s){\nwhile(lb &lt; ub){\nint mid = lb + (ub - lb &gt;&gt; 1);\nif(a[mid] &gt;= s) ub = mid;\nelse lb = mid + 1;\n}\nreturn lb;\n}\nbool check(int mid){\nlong long sum = 0;\nfor(int i=1; i&lt;=n; i++){\nsum += 1ll * i - findi(1, i, a[i] - mid);\nif(sum &gt;= m) return true;\n}\nreturn false;\n}\nint find(int lb, int ub){\nwhile(lb &lt; ub){\nint mid = lb + (ub - lb &gt;&gt; 1);\nif(check(mid)) ub = mid;\nelse lb = mid + 1;\n}\nreturn lb;\n}\nint main(){\nwhile(cin &gt;&gt; n){\nfor(int i=1; i&lt;=n; i++) scanf(\"%d\", &amp;a[i]);\nm = (1ll * n * (n - 1) / 2 + 1) / 2;\nsort(a + 1, a + n + 1);\ncout &lt;&lt; find(0, a[n]) &lt;&lt; '\\n';\n}\n}\n</code></pre>"},{"location":"%E5%88%B7%E9%A2%98/7.%E4%BA%8C%E5%88%86%26%E5%B0%BA%E5%8F%96/#83685-matrix-pojorg","title":"8\u30013685 -- Matrix (poj.org)","text":"<p>\u9898\u610f\uff1a</p> <p>\u6570\u636e\uff1a</p> <p>\u5206\u6790\uff1a</p> <pre><code>#include &lt;iostream&gt;\n#include &lt;cstdio&gt;\n#include &lt;algorithm&gt;\nusing namespace std;\n#define int long long\nconst int MAX = 1e15;\nint T;\nint n, m;\nint f(int x, int y) {\nreturn x*x + 100000 * (x - y) + x*y + y*y;\n}\nbool c(int x) {\nint cnt = 0;\nfor (int j = 1; j &lt;= n; ++j) {\nint lb = 0, ub = n + 1;\nwhile (ub - lb &gt; 1) {\nint mid = (lb + ub) &gt;&gt; 1;\nif (f(mid, j) &lt; x) lb = mid;\nelse ub = mid;\n}\ncnt += lb;\n}\nreturn cnt &lt; m;\n}\nvoid solve() {\nint lb = f(0, n), ub = f(n, 0) + 1;\nwhile (ub - lb &gt; 1) {\nint mid = (ub + lb) &gt;&gt; 1;\nif (c(mid)) lb = mid;\nelse ub = mid;\n}\ncout &lt;&lt; lb &lt;&lt; endl;\n}\nsigned main() {\ncin &gt;&gt; T;\nwhile (T--) {\ncin &gt;&gt; n &gt;&gt; m;\nsolve();\n}\n}\n</code></pre>"},{"location":"%E5%88%B7%E9%A2%98/8.%E5%AE%B9%E6%96%A5%26%E8%8E%AB%E6%AF%94%E4%B9%8C%E6%96%AF%E5%8F%8D%E6%BC%94/","title":"8.\u5bb9\u65a5&\u83ab\u6bd4\u4e4c\u65af\u53cd\u6f14","text":"<p>1\uff0c\u7ed3\u8bba1\uff1a</p> <p>\uff08\\(k\\ge 1\\)\uff09</p> <p>\u8bb0\uff1a\\(\\displaystyle f_{n,~~m,~~k}=\\sum\\limits_{i=1}^{n}\\sum\\limits_{j=1}^m[(i,~j)=k]\\)\uff08\\(n\\le m\\)\uff09</p> <ul> <li> <p>\\(\\displaystyle f_{n,~~m,~~k}=f_{\\lfloor\\frac{n}{k}\\rfloor,~~\\lfloor\\frac{m}{k}\\rfloor,~~1}\\)</p> </li> <li> <p>\\(\\displaystyle f_{n,~~m,~~1}=\\sum\\limits_{i=1}^n\\mu_{i}\\times \\lfloor\\frac{n}{i}\\rfloor\\times \\lfloor\\frac{m}{i}\\rfloor\\)</p> </li> <li> <p>\\(\\displaystyle f_{n,~~n,~~1}=2\\times S\\phi_{n}-1\\)</p> </li> </ul> <p>\u8bb0\uff1a\\(\\displaystyle g_{n,~~m,~~k}= \\sum\\limits_{i=1}^{n}\\sum\\limits_{j=i+1}^m[(i,~j)=k]\\) \uff08\\(n\\le m\\)\uff09</p> <ul> <li> <p>\\(g_{n,~m,~k}=g_{\\lfloor\\frac{n}{k}\\rfloor,~~\\lfloor\\frac{m}{k}\\rfloor,~~1}\\)</p> </li> <li> <p>\\(\\displaystyle g_{n,~n,~1}=S\\phi_{n}-1\\)</p> </li> <li> <p>\\(g_{n,~m,~1}=g_{n,~n,~1}~+~(f_{n,~m,~1}-f_{n,~n,~1})=f_{n,~m,~1}-S\\phi_{n}\\)</p> </li> </ul> <p>\uff08 \u7528\u7b49\u5f0f\u53f3\u8fb9\u6765\u6c42  \\(g_{n,~m,~1}\\) \u65f6\uff0c\u7279\u6b8a\u5b9a\u4e49 \\(\\phi_0=1\\) \uff09</p> <p>2\uff0c\u7ed3\u8bba2\uff1a</p> <p>\u6c42\u548c\u5f0f\u53d8\u6362</p> <p>\\(\\displaystyle \\sum_{d\\mid x}^{x\\le n}f_{x} \\iff \\sum_{i=1}^{\\lfloor\\frac{n}{d}\\rfloor}f_{i\\times d}\\)</p> <p>\\(\\displaystyle \\sum_{i=1}^n\\sum_{i\\mid x}^{x\\le n} \\iff \\sum_{x=1}^n\\sum_{i\\mid x}\\)</p> <p>\\(\\displaystyle \\sum_{i=1}^n\\sum_{x\\mid i} \\iff \\sum_{x=1}^n\\sum_{x\\mid i}^{i\\le n}\\)</p> <p>\\(\\displaystyle \\sum_{i=1}^n\\sum_{x^2\\mid i} \\iff \\sum_{x=1}^{\\sqrt n}\\sum_{x^2\\mid i}^{i\\le n}\\)</p>"},{"location":"%E5%88%B7%E9%A2%98/8.%E5%AE%B9%E6%96%A5%26%E8%8E%AB%E6%AF%94%E4%B9%8C%E6%96%AF%E5%8F%8D%E6%BC%94/#a-ntimes-ntimes-n-000","title":"A\uff0c\u7ed9\u5b9a \\(n\\times n\\times n\\) \u7684\u7f51\u683c\u8ba1\u7b97\u89c6\u7ebf\u4ece \\((0,~0,~0)\\) \u51fa\u53d1\uff0c\u80fd\u770b\u5230\u7684\u70b9\u7684\u4e2a\u6570","text":"<p>\u524d\u7f6e\u7ed3\u8bba\uff1a\\(\\displaystyle \\sum_{i=1}^{n}\\sum_{j=1}^m[(i,~j)=1] = \\sum_{i=1}^n\\mu_{i}\\times \\lfloor\\frac{n}{i}\\rfloor\\times \\lfloor\\frac{m}{i}\\rfloor \\\\ \\sum_{i=1}^{n}\\sum_{j=1}^m\\sum_{k=1}^o[(i,~j)=1] = \\sum_{i=1}^n\\mu_{i}\\times \\lfloor\\frac{n}{i}\\rfloor\\times \\lfloor\\frac{m}{i}\\rfloor\\times \\lfloor\\frac{o}{i}\\rfloor\\)\uff0c\u4ee5\u6b64\u7c7b\u63a8</p> <p>\u8bb0\u80fd\u770b\u5230\u7684\u70b9\u4e3a \\((x,~y,~z)\\)</p> <p>\u6709\u4e09\u79cd\u70b9\uff1a</p> <p>1\uff09\u4ec5\u6709\u4e24\u4e2a\u5750\u6807\u662f0 $\\implies $ \u8d21\u732e\u4e3a 3 \uff08\u5373 \\((0,0,1),~(0,1,0),~(1,0,0)\\)\uff09</p> <p>2\uff09\u4ec5\u6709\u4e00\u4e2a\u5750\u6807\u662f0 $\\implies $ \u8d21\u732e\u4e3a \\(\\displaystyle 3\\times \\sum_{i=1}^{n}\\sum_{j=1}^n[(i,~j)=1]\\)</p> <p>3\uff09\u6bcf\u4e2a\u5750\u6807\u5747 $\\ge 1 \\implies $  \u8d21\u732e\u4e3a \\(\\displaystyle \\sum_{i=1}^{n}\\sum_{j=1}^n\\sum_{k=1}^n[(i,~j,~k)=1]\\)</p> <p>\\(ans=\\displaystyle 3 + 3\\times \\sum_{i=1}^{n}\\sum_{j=1}^n[(i,~j)=1] + \\sum_{i=1}^{n}\\sum_{j=1}^n\\sum_{k=1}^n[(i,~~j,~~k)=1]\\)</p> <p>\\(\\displaystyle =3+3\\times\\sum_{i=1}^n\\mu_i\\times \\lfloor\\frac{n}{i}\\rfloor\\times \\lfloor\\frac{n}{i}\\rfloor + \\sum_{i=1}^n\\mu_i\\times \\lfloor\\frac{n}{i}\\rfloor\\times \\lfloor\\frac{n}{i}\\rfloor\\times \\lfloor\\frac{n}{i}\\rfloor\\)</p> <p>\\(\\displaystyle =3 + \\sum_{i=1}^n\\mu_i\\times \\lfloor\\frac{n}{i}\\rfloor\\times \\lfloor\\frac{n}{i}\\rfloor\\times (\\lfloor\\frac{n}{i}\\rfloor + 3)\\)</p>"},{"location":"%E5%88%B7%E9%A2%98/8.%E5%AE%B9%E6%96%A5%26%E8%8E%AB%E6%AF%94%E4%B9%8C%E6%96%AF%E5%8F%8D%E6%BC%94/#b-displaystyle-sum_i1nsum_ji1mijk-nle-m","title":"B\uff0c\u5b9e\u8d28\u4e0a\u662f\u8ba1\u7b97 \\(\\displaystyle \\sum_{i=1}^n\\sum_{j=i+1}^m[(i,~j)=k]\\) \uff08 \\(n\\le m\\)\uff09","text":"<p>\u201c\u7ed3\u8bba1\u201d\u4e2d\u5df2\u7ed9\u51fa\u7ed3\u8bba</p>"},{"location":"%E5%88%B7%E9%A2%98/8.%E5%AE%B9%E6%96%A5%26%E8%8E%AB%E6%AF%94%E4%B9%8C%E6%96%AF%E5%8F%8D%E6%BC%94/#c","title":"C\uff0c","text":"<p>(47\u6761\u6d88\u606f) \u83ab\u6bd4\u4e4c\u65af\u53cd\u6f14 - Mophues - HDU 4746_njuptACMcxk\u7684\u535a\u5ba2-CSDN\u535a\u5ba2</p>"},{"location":"%E5%88%B7%E9%A2%98/8.%E5%AE%B9%E6%96%A5%26%E8%8E%AB%E6%AF%94%E4%B9%8C%E6%96%AF%E5%8F%8D%E6%BC%94/#j","title":"J\uff0c","text":"<p>(59\u6761\u6d88\u606f) SQFREE - Square-free integers_weixin_34235457\u7684\u535a\u5ba2-CSDN\u535a\u5ba2</p>"},{"location":"%E5%88%B7%E9%A2%98/9.%E5%8D%95%E8%B0%83%E6%A0%88%26%E5%8D%95%E8%B0%83%E9%98%9F%E5%88%97/","title":"9.\u5355\u8c03\u6808&\u5355\u8c03\u961f\u5217","text":"<p>\u3010\u6808 &amp;&amp; \u5355\u8c03\u6808\u3011\u6d45\u8c08\u5355\u8c03\u6808\u4e0e\u5355\u8c03\u6808\u7684\u7406\u89e3 - Mr.XuAMis.Liu - \u535a\u5ba2\u56ed (cnblogs.com)</p>"},{"location":"%E5%88%B7%E9%A2%98/9.%E5%8D%95%E8%B0%83%E6%A0%88%26%E5%8D%95%E8%B0%83%E9%98%9F%E5%88%97/#aa_n-a_ii1n-a_i-0","title":"A\uff0c\u7ed9\u5b9a\\(\\{a_n\\}\\)\uff0c\u8f93\u51fa \\(a_i,~i=1..n\\) \u5de6\u8fb9 \u548c \u53f3\u8fb9 \u6bd4 \\(a_i\\) \u4e25\u683c\u5927\u7684\u5143\u7d20\u7684\u4e0b\u6807\uff0c\u4e0d\u5b58\u5728\u5219\u4e3a 0","text":""},{"location":"%E5%88%B7%E9%A2%98/9.%E5%8D%95%E8%B0%83%E6%A0%88%26%E5%8D%95%E8%B0%83%E9%98%9F%E5%88%97/#bn","title":"B\uff0c\u5c06\u57ce\u5e02\u7167\u7247\u6309\u9ad8\u5ea6\u7684\u4e0d\u540c\u5206\u6210n\u4e2a\u90e8\u5206\uff0c\u5373\u6bcf\u4e2a\u90e8\u5206\u7531\u5176\u9ad8\u5ea6\u4f5c\u4e3a\u6807\u8bc6\uff0c\u7531\u4e8e\u6bcf\u4e2a\u5efa\u7b51\u53ef\u80fd\u6a2a\u8de8\u591a\u4e2a\u90e8\u5206\uff0c\u63a8\u7406\u51fa\u7167\u7247\u4e2d\u53ef\u80fd\u7684\u6700\u5c11\u7684\u5efa\u7b51\u6570\u91cf","text":"<p>\\(ans = \\displaystyle \\sum_{i=1}^n[\u627e\u5230a_i\u5de6\u8fb9\u6700\u8fd1\u7684\u4e0d\u5927\u4e8ea_i\u7684a_j~\\&amp;\\&amp;~a_i\\ne a_j ~||~a_i\u5de6\u8fb9\u6ca1\u6709\u4e0d\u5927\u4e8ea_i\u7684\u6570]\\)</p> <p>\uff08 \\(i\\) \u53cd\u5e8f\u904d\u5386 \u4e5f\u53ef\u4ee5\u5f97\u5230\u76f8\u540c\u7ed3\u679c\uff09</p> <p>\u6ce8\u610f\uff1a\u82e5 \\(a_i=0\\)\uff0c\u5219\u8868\u793a\u6b64\u5904\u4e3a\u7a7a\u5730\uff0c\u5e94\u6e05\u9664\u6808\uff0c\u76f4\u63a5\u8fdb\u5165\u4e0b\u4e00\u4e2a\u5faa\u73af</p> <pre><code>int ans = 0;\nt = 0;\n// for(int i=n; i&gt;=1; --i){    // \u7b49\u4ef7\u5199\u6cd5\nfor(int i=1; i&lt;=n; ++i){\nif(!a[i]){\nt = 0;\ncontinue;\n}\nfor(; t &amp;&amp; st[t] &gt; a[i]; -- t);\nif(t &amp;&amp; st[t] == a[i]) continue;\n++ ans, st[ ++ t] = a[i];\n}\n</code></pre>"},{"location":"%E5%88%B7%E9%A2%98/9.%E5%8D%95%E8%B0%83%E6%A0%88%26%E5%8D%95%E8%B0%83%E9%98%9F%E5%88%97/#cn","title":"C\uff0c\u7ed9\u5b9an\u4e2a\u76f8\u90bb\u7b49\u5bbd\u4e0d\u540c\u9ad8\u7684\u77e9\u5f62\uff0c\u8fd9\u4e9b\u77e9\u5f62\u540c\u5728\u4e00\u4e2a\u57fa\u51c6\u7ebf\u4e0a\uff0c\u6c42\u4ee5\u57fa\u51c6\u7ebf\u4e3a\u5e95\u7684\u77e9\u5f62\u6700\u5927\u9762\u79ef","text":"<p>\u53ef\u4ee5\u7528dp \u6216 \u5355\u8c03\u6808</p> <p>(48\u6761\u6d88\u606f) HDU 1506 Largest Rectangle in a Histogram(DP)_fcbruce\u7684\u535a\u5ba2-CSDN\u535a\u5ba2</p> <p>\u5355\u8c03\u6808\u505a\u6cd5\uff1a\u7ef4\u62a4\u5de6\u53f3\u4e24\u8fb9\u4e25\u683c\u5c0f\u4e8e \\(a_i\\) \u7684 \\(a_j\\) \u7684\u201c\u540e\u4e00\u4e2a\u201d\u4e0b\u6807 \\(j+1\\) \u6216 \\(j-1\\)\uff0c\u82e5 \\(a_j\\) \u4e0d\u5b58\u5728\uff08\u6808\u7a7a\u65f6\uff09\uff0c\u5219\u8fd4\u56de \\(1\\) \u6216 \\(n\\)</p>"},{"location":"%E5%88%B7%E9%A2%98/9.%E5%8D%95%E8%B0%83%E6%A0%88%26%E5%8D%95%E8%B0%83%E9%98%9F%E5%88%97/#d","title":"D\uff0c","text":""},{"location":"%E5%88%B7%E9%A2%98/9.%E5%8D%95%E8%B0%83%E6%A0%88%26%E5%8D%95%E8%B0%83%E9%98%9F%E5%88%97/#e-lb-ub","title":"E\uff0c\u7ed9\u5b9a\u4e00\u4e2a\u5e8f\u5217\uff0c\u6c42\u6ee1\u8db3 \"\u6700\u5927\u503c - \u6700\u5c0f\u503c\" \u4e0d\u5c0f\u4e8e \\(lb\\)\uff0c\u4e0d\u5927\u4e8e \\(ub\\) \u7684\u6700\u957f\u5b50\u5e8f\u5217","text":"<p>\u597d\u9898\uff0c\u4f46\u4e0d\u592a\u4f1a</p>"},{"location":"%E5%88%B7%E9%A2%98/9.%E5%8D%95%E8%B0%83%E6%A0%88%26%E5%8D%95%E8%B0%83%E9%98%9F%E5%88%97/#f","title":"F\uff0c\u6ed1\u52a8\u533a\u95f4\u6700\u503c\uff08\u6a21\u677f\u9898\uff09","text":""},{"location":"%E5%88%B7%E9%A2%98/9.%E5%8D%95%E8%B0%83%E6%A0%88%26%E5%8D%95%E8%B0%83%E9%98%9F%E5%88%97/#g","title":"G\uff0c","text":""},{"location":"%E5%88%B7%E9%A2%98/9.%E5%8D%95%E8%B0%83%E6%A0%88%26%E5%8D%95%E8%B0%83%E9%98%9F%E5%88%97/#h","title":"H\uff0c\u6700\u5927\u5b50\u6bb5\u548c","text":"<p>\uff08\u5b50\u6bb5\uff1a\u6570\u5b57\u5e8f\u5217\u7684\u5b50\u8fde\u7eed\u90e8\u5206\uff09</p>"},{"location":"%E5%88%B7%E9%A2%98/9.%E5%8D%95%E8%B0%83%E6%A0%88%26%E5%8D%95%E8%B0%83%E9%98%9F%E5%88%97/#iccpc","title":"I\uff0cccpc\u7f51\u7edc\u8d5b","text":"<p>(49\u6761\u6d88\u606f) \u5faa\u73af\u8282_\u6770\u4ee3\u7684\u535a\u5ba2-CSDN\u535a\u5ba2</p> <p>\u5faa\u73af\u8282\uff01\uff01\u662f\u54a9\u554a</p> <p>hdu 6444 Neko's loop \u5355\u8c03\u961f\u5217\u4f18\u5316DP - Draymonder - \u535a\u5ba2\u56ed (cnblogs.com)s</p> <p>\u76f8\u5173\u5185\u5bb9\uff1a\u88f4\u8700\u5b9a\u7406\uff0c\u6700\u5927\u5b50\u6bb5\u548c\uff0c\u5faa\u73af\u8282\uff08\u6770\uff09</p>"},{"location":"%E5%88%B7%E9%A2%98/lqb/","title":"Lqb","text":"<p>\u53c2\u8003</p> <p>\u771f\u9898</p> <p>\u5206\u6790</p> <p>\u6ce8\u610f\u70b9</p> <ul> <li>\u9884\u5b9a\u4e49\u6a21\u677f\uff1a<code>tools -&gt; editor options -&gt; snippets -&gt; default source</code>\uff1a<ul> <li>\u5934\uff1a<code>&lt;bits/stdc++.h&gt;, &lt;vector&gt;, &lt;map&gt;, &lt;algorithm&gt;, &lt;sstream&gt;</code></li> <li>\u5faa\u73af\uff1a<code>FOR(i, bg, ed) for(int i=bg; i&lt;=ed; ++i)</code>\uff0c<code>IFOR(i, bg, ed) for(int i=ed; i&gt;=bg; --i)</code></li> <li>\u9ad8\u7cbe\u5ea6\uff1a<code>int long long</code> \u6216 <code>int __int128</code></li> <li>\u5feb\u8bfb/\u5199\uff1a<code>void prt(__int128 x){ if(!x) return ; if(x) prt(x/10); putchar(x%10+'0'); }</code>\uff0c<code>ios::sync_with_stdio(false);</code>\uff0c<code>cin.tie(0), cout.tie(0);</code></li> <li>solve()</li> </ul> </li> <li>\u6280\u5de7<ul> <li>\u4e0d\u8981\u8001\u60f3\u7740 ac\uff0c\u6570\u636e\u89c4\u6a21\u5927\u53ef\u4ee5\u8bd5\u8bd5\u66b4\u529b\u7b97\u6cd5\uff0c\u72d7\u4e9b\u90e8\u5206\u5206\u4e5f\u884c</li> <li>\u6ce8\u610f\u53d8\u91cf\u7684\u8303\u56f4\u9650\u5236\uff0c\u5982 \\(x\\in[low_bound, up_bound]\\) \\(\\implies\\) \\(\\max\\{low_bound, \\min\\{ up_bound, x \\}\\}\\)</li> <li>2022 B\u7c7b \u7ec6\u8282\u9898\u591a\uff0c\u6ce8\u610f\u7ec6\u8282\u95ee\u9898\uff0c\u559c\u6b22\u5361\u5e38\uff0c\u5361\u7cbe\u5ea6\uff0c\u559c\u6b22\u8003\u65e0\u5173\u7684\u5e38\u8bc6(\u6bcf\u6708\u7684\u5929\u6570\uff0c\u95f0\u5e74, \u6587\u5b66)</li> </ul> </li> </ul> <p>\u65e5\u671f</p> <ul> <li>\u8ba1\u7b97 0001-01-00 \u4e0e a-b-c \u4e4b\u95f4\u7684\u65f6\u95f4\u5dee\uff1a     <pre><code>int f[13] = {0, 31, 28, 31, 30, 31, 30, \n              31, 31, 30, 31, 30, 31};\nbool ok(int y){ return y%400==0 || y%100 &amp;&amp; y%4==0; }\nint to(int a, int b, int c){\n    int ans = 0;\n    for(int i=1; i&lt;a; ++i) ans += (365 + ok(i));\n    for(int i=1; i&lt;b; ++i) ans += f[i];\n    ans += c;\n    if(b &gt; 2 &amp;&amp; ok(a)) ++ ans;\n    return ans;\n}\n</code></pre></li> <li>\u8f93\u5165 0001-01-00 \u4e0e a-b-c \u4e4b\u95f4\u7684\u65f6\u95f4\u5dee x\uff0c\u5f97\u5230 a\uff0cb\uff0cc     <pre><code>void ot(int x){\n    int a = 0, y;\n    for(y=0; ++a, y += 365 + ok(a), y&lt;=x; );\n    x -= y -= 365 + ok(a);\n\n    int b = 0;\n    for(y=0; ++b, y += f[b] + (b==2&amp;&amp;ok(a)), y&lt;=x; );\n    x -= y -= f[b] + (b==2&amp;&amp;ok(a));\n\n    cout &lt;&lt; a &lt;&lt; ' ' &lt;&lt; b &lt;&lt; ' ' &lt;&lt; x &lt;&lt; '\\n';\n}\n</code></pre></li> <li></li> </ul> <p>13\u5e74</p> <ul> <li>A\uff1a\u7ed9\u5b9a\u521d\u59cb\u65e5\u671f a-b-c\uff0c\u4ee5\u53ca \u672b\u65f6\u95f4 a'-b'-c' \u4e0e \u521d\u59cb\u65e5\u671f \u4e4b\u95f4\u7684\u5929\u6570 delta\uff0c\u8ba1\u7b97 \u672b\u65e5\u671f<ul> <li>\u672b\u65e5\u671f - \u521d\u59cb\u65e5\u671f + 1 = delta \\(\\implies\\) \u672b\u65e5\u671f = delta + \u521d\u59cb\u65e5\u671f - 1</li> </ul> </li> <li>B\uff1a\u627e\u5230\u5982\u4e0b\u6ee1\u8db3\u6761\u4ef6\u7684 6 \u4f4d\u5341\u8fdb\u5236\u6570 x \uff1ax \u4e0a\u7684\u6bcf\u4e2a\u6570\u4f4d\u90fd\u4e0d\u540c\uff0c\\(x^2\\) \u7684\u6570\u4f4d\u96c6\u5408 \u4e0e x \u7684\u6570\u4f4d\u96c6\u5408 \u4e0d\u76f8\u4ea4\uff0c\u5373 \\(S_x \\cap S_{x^2} = \\emptyset\\)<ul> <li>n\u7684\u6570\u4f4d\u96c6\u5408\u904d\u5386\uff1a<code>for(int i=n; i; i/=10) i%10</code></li> </ul> </li> <li>C\uff1a\u7ed9\u5b9a \u4e00\u4e2a\u5b57\u7b26\u77e9\u9635(\\(n\\times m\\)) \u548c \u4e00\u4e2a\u5b57\u7b26\u4e32 s(\u957f\u4e3a \\(n+m-1\\))\uff1b\u8ba1\u7b97\u4ece\u5de6\u4e0a\u89d2 (1, 1) \u5f00\u59cb\u8df3\u8dc3\u5230\u53f3\u4e0b\u89d2 (n, m) \u7684\u65b9\u6848\u6570\uff0c\u9650\u5236\uff1a\u53ea\u80fd \u5f80\u4e0b \u6216 \u5f80\u53f3 \u8df3\u8dc3\uff0c\u8df3\u8dc3\u8def\u5f84\u4e0e\u5b57\u7b26\u4e32 s \u5339\u914d</li> <li>D\uff1a\\(\\Delta_a = a'-a \\in (-300, -200], \\Delta_b = b'-b \\in [800, 900), \\Delta_a + \\Delta_b = 558\\)\uff0c\\(a \\in [10^3, 10^4)\\)\uff0c\u5176\u4e2d a' \u4e3a\u6ee1\u8db3 a \u7684\u5404\u4f4d\u6570\u5b57 \u5de6\u53f3 \u548c \u4e0a\u4e0b \u90fd\u7ffb\u8f6c\u540e\uff0c\u6ca1\u6709\u524d\u7f00 0 \u5e76\u4e14 \u5012\u7740\u8bfb\u5408\u6cd5(\u6ce8\uff1a\u6570\u4f4d 0, 1, 2, 5, 6, 8, 9 \u90fd\u53ef\u5012\u7740\u8bfb) \u7684\u6570\u5b57</li> <li>E\uff1a\u7ed9\u5b9a\u5b57\u7b26\u4e32\u524d\u7f00\u5224\u65ad\u7684\u7a0b\u5e8f\uff0c\u8865\u5168\u4ee3\u7801<ul> <li>\u6ce8\uff1a\u8bbe\u8ba1c++\u7279\u6709\u7684\u9a9a\u64cd\u4f5c</li> </ul> </li> <li>F\uff1a\u9006\u6ce2\u5170\u8868\u8fbe\u5f0f\u8865\u5168</li> <li>G\uff1a\u7ed9 n \u884c\u957f\u5ea6\u4e0d\u5b9a\u7684\u6574\u6570\uff0c\u627e\u51fa\u8fd9\u4e9b\u6574\u6570\u4e2d \u91cd\u590d\u7684\u6574\u6570 x \u548c \u6ee1\u8db3 \\(y\\in[\\min\\{ a_i \\}, \\max\\{ a_i \\}]\\) \u4f46\u4e0d\u5728\u7ed9\u5b9a\u7684\u6574\u6570\u96c6\u5408\u4e2d \u7684\u6574\u6570 y\uff0c\u5176\u4e2d \\(y \\ne \\min\\{ a_i \\}, y \\ne \\max\\{ a_i \\}\\)</li> <li>H\uff1a\u6c42\u51fa a \u548c b \u6700\u5927\u4e0d\u80fd\u51d1\u51fa\u7684\u6570\uff0c\u5373 \\(a\\cdot x + b\\cdot y \\ne ans, \\max\\{ ans \\}\\) (\\(a, b, x, y \\in N^+\\))<ul> <li><code>a * b - a - b</code></li> </ul> </li> <li>I\uff1a\u7ed9\u5b9a\\(m\\times n\\)\u77e9\u9635\uff0c\u5206\u5272\u4e24\u4e2a\u8fde\u901a\u5757 A \u548c B \uff0c\u4f7f\u5f97\u4e24\u4e2a\u8fde\u901a\u5757\u6743\u503c\u4e4b\u548c\u76f8\u7b49 \u5e76 \u6700\u5c0f\u5316\u5176\u4e2d\u4e4b\u4e00\u7684\u5143\u7d20\u6570\u91cf\uff0c\u5373 \\(\\sum\\limits_{x\\in A} a_x = \\sum\\limits_{y\\in B} a_y, ans = \\min\\{ |A| \\} \u6216 n\\time m -\\max\\{ |A| \\}\\)<ul> <li>\u4ece (1, 1) \u51fa\u53d1\uff0c\u5212\u5206\u8fd9\u4e2a\u56fe\u4e3a\u4e24\u4e2a\u5b50\u56fe\u5373\u53ef\uff0c\u5176\u4e2d\u5b50\u56fe\u5185\u90e8\u7684\u70b9\u5fc5\u987b\u8fde\u901a\uff08\u610f\u5473\u7740\u53ef\u4ee5\u4ece 4 \u76f8\u90bb\u7684\u70b9\u5ef6\u4f38\u641c\u7d22\uff09</li> </ul> </li> <li>J\uff1a</li> </ul> <p>22A</p> <ul> <li>A\uff1a</li> <li>B\uff1a\u7ed9\u5b9a\u4e00\u4e2a\u5148\u624b\u7b2c\u4e00\u6b21\u8f6c\u79fb\u540e\u7684\u5c40\u9762\uff08\u5373\u540e\u624b\u7684\u5c40\u9762\uff09\uff0c\u5224\u65ad\u5148\u624b\u5fc5\u80dc\u8fd8\u662f\u5fc5\u8d25\uff08\u6e38\u620f\u53cc\u65b9\u90fd\u662f\u9009\u62e9\u6700\u4f18\u7b56\u7565\uff09<ul> <li>\u5b9a\u7406(\u7528\u4e8e\u6df1\u641c-\u6269\u5c55)\uff1a\u82e5 \u5f53\u524d\u72b6\u6001 \u80fd\u8f6c\u79fb\u5230\u7684\u81f3\u5c11\u4e00\u4e2a \u5fc5\u8d25\u6001\uff0c\u90a3\u4e48\u5148\u624b\u5fc5\u80dc\uff0c\u5426\u5219\u5148\u624b\u5fc5\u8d25</li> <li>\u63a8\u8bba(\u7528\u4e8e\u7b54\u6848\u7684\u5224\u65ad)\uff1a\u5bf9\u4e8e\u9898\u76ee\u6240\u7ed9\u7684\u5c40\u9762\uff0c\u82e5\u662f\u5fc5\u8d25\u6001(\u5373 \u540e\u624b\u5fc5\u8d25\u6001)\uff0c\u5219\u5148\u624b\u5fc5\u80dc\uff0c\u5426\u5219\u5148\u624b\u5fc5\u8d25</li> <li>\u82e5\u9898\u76ee\u6307\u51fa \u5fc5\u8d25\u6001 \u6216 \u5fc5\u80dc\u6001 \u7684\u6807\u5fd7\uff0c\u5219\u6697\u793a \u6df1\u641c\u7684\u51fa\u53e3</li> </ul> </li> <li>C\uff1a\u8ba1\u7b97 \\(\\sum\\limits_{i=1}^n\\sum\\limits_{j=1}^{i-1} a_i\\cdot a_j\\)</li> <li>D\uff1a\u7ed9\u5b9a n \u4e2a\u6570 \\(a_i\\)\uff0c\u4e00\u4e2a\u6570 x\uff0c\u4ee5\u53ca m \u6b21\u67e5\u8be2 \\([l_i, r_i]\\) \u4e2d \u662f\u5426\u5b58\u5728 \u4efb\u53d6\u4e24\u4e2a\u6570 \\(a_i, a_j\\)\uff0c\u4f7f\u5f97 \\(a ^ b = x\\)</li> <li>E\uff1a\u6709 n+1 \u4e2a\u4f4d\u7f6e \\(x=i, i\\in[0,n]\\)\uff0c\u521a\u5f00\u59cb\u4f4d\u4e8e \\(x = 0\\) \u5904\uff0c\u5047\u8bbe\u4ece \\(x = i-1\\) \u5904\u8df3\u8dc3\u5230 \\(x = i\\) \u7684\u6982\u7387\u4e3a \\(p_i\\)\uff08\\(p_i \\equiv \\frac {a_i}{b_i} \\pmod {998244353}\\)\uff09\uff0c\u5426\u5219\u4f1a\u8df3\u56de \\(x = 0\\) \u5904\uff1b\u8ba1\u7b97\u4ece \\(x=0\\) \u5904\u8df3\u8dc3\u5230 \\(x_n\\) \u7684\u8df3\u8dc3\u671f\u671b<ul> <li>\u6709\u5f85\u5206\u6790</li> </ul> </li> <li>F\uff1a\u7ed9\u5b9a n-1 \u4e2a\u8fde\u7eed\u70b9\u4ee5\u53ca\u8fb9\u754c\u70b9 id=0, id=n\uff0c\u9664\u8fb9\u754c\u70b9\u5916\u70b9\u7684\u9ad8\u5ea6\u4e3a \\(h_i, i\\in[0,n)\\) (\\(h_i &gt; 0\\) \u65f6\u5408\u6cd5)\uff0c\u6bcf\u6b21\u80fd\u8df3\u8dc3\u7684\u6700\u5927\u8ddd\u79bb\u4e3a m (\u672a\u77e5)\uff0c\u800c\u4e14\u9664\u4e86\u8fb9\u754c\u70b9\u5916 \u8df3\u8dc3\u8d77\u70b9\u7684\u9ad8\u5ea6\u51cf 1\uff1b\u5728 id=0 \u548c id=n \u5904\u5f80\u8fd4 2x \u6b21\uff0c\u6700\u5c0f\u5316\u4e00\u6b21\u80fd\u8df3\u8dc3\u7684\u6700\u5927\u8ddd\u79bb m<ul> <li></li> </ul> </li> <li>G\uff1aLIS<ul> <li>\u76f8\u5173\u9898</li> </ul> </li> <li>H\uff1a</li> <li>I\uff1a\u7ed9\u5b9a n \u4e2a\u6570 \\(a[ ]\\)\uff0c\u5224\u65ad\u662f\u5426\u6ee1\u8db3 \\(a_i = x_1^{y_1}\\cdot x_2^{y_2}, y_1,y_2\\ge 2, s\\le 10^{18}\\)<ul> <li>\u7ed3\u8bba\uff1f\uff1a\\(a_i\\) \u6ee1\u8db3 \\(a_i = x^2\\cdot y^3, x,y&gt;1\\)</li> </ul> </li> <li>J\uff1a\u5047\u8bbe\u6570\u7ec4 \\(a[ ]\\) \u957f\u5ea6\u4e3a n\uff0c\u7ed9\u5b9a m \u4e2a\u533a\u95f4\u548c \\(\\sum\\limits_{i=l}^l a_i = v\\)\uff0c\u67e5\u8be2 q \u6b21 \u533a\u95f4\u548c \\([l, r]\\)<ul> <li>\u5e26\u6743\u5e76\u67e5\u96c6\u7ef4\u62a4\u533a\u95f4\u548c\u5173\u7cfb\uff0cl \u548c r+1 \u5728\u540c\u4e00\u4e2a\u5e76\u67e5\u96c6\u4e0a\u5219\u8868\u793a [l, r] \u7684\u533a\u95f4\u548c\u53ef\u4ee5\u63a8\u7406\u51fa</li> </ul> </li> </ul> <p>22B</p> <ul> <li>A\uff1a\u4e5d\u8fdb\u5236\u8f6c\u5341\u8fdb\u5236<ul> <li><code>for(int i=n, x=1; i; i/=10, x*=9) m += i%10 * x;</code></li> <li>\u6ce8\u610f\uff1a\u7ed9\u5b9a\u7684\u6b63\u6574\u6570\u8981\u7528 10 \u6765\u505a\u9664\u6cd5\u6216\u53d6\u4f59</li> </ul> </li> <li>B\uff1a\u65e5\u671f\u6784\u6210\u7684 8 \u4f4d\u5b57\u7b26\u4e32\u4e2d\uff0c\u5b58\u5728 3 \u4f4d\u8fde\u7eed\u9012\u589e \u6216 \u8fde\u7eed\u9012\u51cf \u5b50\u4e32\u79f0\u4e3a\u987a\u5b50\u65e5\u671f\uff0c\u6c42 2022\u5e74\u8fd9 365 \u5929\u4e2d\u987a\u5b50\u65e5\u671f\u7684\u4e2a\u6570<ul> <li>\u6ce8\u610f\uff1a\u5bf9\u4e8e\u65e5\u671f\u586b\u7a7a\u9898\uff0c\u5efa\u8bae \u7528 3 \u4e2a\u53d8\u91cf\u5b58\u65e5\u671f\u7684\u5404\u4e2a\u201c\u5b50\u65e5\u671f\u201d\u6765\u65b9\u4fbf\u8fed\u4ee3\uff0c\u624b\u52a8\u8ba9\u65e5\u671f\u8fdb\u4f4d\uff0c\u66b4\u529b\u5dee\u5206\u6210\u5b57\u7b26\u4e32\u6765\u8bb0\u5f55\u4fe1\u606f</li> <li>\u5012\u7740\u6765\u4e0d\u7b97\u201c\u987a\u5b50\u201d</li> </ul> </li> <li>C\uff1a\u5468\u4e00\u5230\u5468\u4e94\u6bcf\u5929\u8d21\u732e\u4e3a a\uff0c\u5468\u516d\u5468\u65e5\u6bcf\u5929\u8d21\u732e\u4e3a b\uff1b\u4ece\u5468\u4e00\u5f00\u59cb\uff0c\u8ba1\u7b97\u6ee1\u8db3\u8d21\u732e\u4e4b\u548c\u4e0d\u5c0f\u4e8e n \u65f6\u6700\u5c11\u7ecf\u8fc7\u7684\u5929\u6570<ul> <li>\u6027\u8d28\uff1a\u5047\u8bbe x \u4e3a\u7ecf\u8fc7\u7684\u5468\u6570\uff0cy \u548c z \u5206\u522b\u4e3a\u6700\u540e x+1 \u5468 \u5de5\u4f5c\u65e5 \u6216 \u53cc\u4f11\u65e5 \u7ecf\u8fc7\u7684\u5929\u6570\uff0c\u90a3\u4e48 \\((5a+2b)\\cdot x + a\\cdot y + b\\cdot z \\ge n\\)\uff0c\u7b54\u6848\u4e3a \\(7x+y+z\\)<ul> <li>\\(x = \\lceil \\frac {n}{5a+2b} \\rceil, y = \\lceil \\frac {n-(5a+2b)\\cdot x}{a} \\rceil, z = \\lceil \\frac {n-(5a+2b)\\cdot x - a\\cdot y}{b} \\rceil, y\\in [0, 5], z\\in [0, 2]\\)</li> </ul> </li> <li>\u6ce8\u610f\uff1a\u5411\u4e0a\u53d6\u6574\uff0c\u8303\u56f4\u9650\u5236</li> </ul> </li> <li>D\uff1a\u521a\u5f00\u59cb\u6709 n \u4e2a\u9ad8\u5ea6\u4e3a 0 \u7684\u704c\u6728\uff0c\u704c\u6728\u6bcf\u5929 \u65e9\u4e0a \u4f1a\u7a81\u7136\u957f\u9ad8 1\u7c73\uff0c\u6bcf\u5929 \u665a\u4e0a \u4f1a\u5bf9\u8fd9\u4e9b\u704c\u6728\u4ece\u5de6\u5230\u53f3\u5f00\u59cb\u5faa\u73af\u5f80\u590d\u4fee\u526a\uff0c\u6bcf\u6b21\u4fee\u526a\u90fd\u4f1a\u4f7f\u704c\u6728 \\(h_i = 0\\)\uff1b\u5047\u8bbe\u521a\u5f00\u59cb\u5728\u6700\u5de6\u4fa7\u4fee\u526a\uff0c\u8ba1\u7b97\u5bf9\u4e8e id=i \u7684\u704c\u6728\uff0c\\(\\max\\{ h_i \\}\\) \u4e3a\u591a\u5c11<ul> <li>\u6ce8\u610f\uff1a\u6bcf\u5929\u6709 \u65e9\u4e0a \u548c \u665a\u4e0a \u4e24\u4e2a\u72b6\u6001\uff0c\u5206\u522b\u7528\u4e8e \u751f\u957f \u548c \u4fee\u526a</li> <li>\u6211\u4eec\u53d1\u73b0\u53ea\u8981\u8ba1\u7b97\u5bf9\u4e8e id=i \u7684\u704c\u6728\uff0c\u6700\u8fd1\u4e24\u6b21\u4fee\u526a\u8be5\u704c\u6728\u7684\u591c\u665a\u4e4b\u95f4\u7ecf\u8fc7\u7684\u65e9\u6668\u6570\u91cf\u7684\u6700\u5927\u503c\u5373\u4e3a\u7b54\u6848<ul> <li>id=i \u7684\u5de6\u4fa7\u6a21\u62df\u4f1a\u5f97\u5230 \\(h_i = \\sum\\limits_{j=i-1}^1 1 + \\sum\\limits_{j=2}^{i} 1 = 2(i-1)\\)</li> <li>\u540c\u7406\uff0c\u5411\u5de6\u4fa7\u6a21\u62df\u5219\u6709 \\(h_i = \\sum\\limits_{j=i+1}^n 1 + \\sum\\limits_{j=n-1}^i = 2(n-i)\\)</li> </ul> </li> </ul> </li> <li>E\uff1a\u67d0\u79cd\u8fdb\u5236\u6570\u53ef\u8868\u793a\u4e3a \\(n = \\sum\\limits_{i=1}^n a_i\\cdot \\prod\\limits_{j=1}^{i-1}x_j\\)\uff08\u5bf9\u6bd4\u4e00\u4e0b\u5341\u8fdb\u5236\uff1a\\(n = \\sum\\limits_{i=1}^n a_i\\cdot 10^{i-1}\\)\uff09\uff0c\u5176\u4e2d \\(x_j \\in[2, k]\\)\uff1b\u6700\u5c0f\u5316 \\(a - b\\) \u7684\u503c<ul> <li>\u8d2a\u5fc3\uff1a\\(x_j = \\max\\{2, \\min\\{k, \\max\\{a_j, b_j\\}+1\\}\\}\\)</li> </ul> </li> <li>F\uff1a\u7ed9\u5b9a \\(n\\times m\\) \u7684\u975e\u8d1f\u77e9\u9635\uff0c\u8ba1\u7b97\u77e9\u9635\u5185\u5143\u7d20\u548c\u4e0d\u5927\u4e8e k \u7684\u5b50\u77e9\u9635\u4e2a\u6570<ul> <li>\u7528 l\uff0cr \u679a\u4e3e\u5b50\u77e9\u9635\u5de6\u53f3\u8fb9\u754c (\\(l\\le r\\))\uff0cx \u548c y \u679a\u4e3e\u4e0a\u4e0b\u8fb9\u754c (\\(x\\le y\\))\uff0c\u590d\u6742\u5ea6\u4e3a \\(O(n^4)\\)</li> <li>\u6ce8\u610f\u5230\u77e9\u9635\u5185\u7684\u5143\u7d20\u662f\u975e\u8d1f\u7684\uff0c\u6240\u4ee5\u51cf\u5c0f\u67d0\u4e2a\u77e9\u9635\u7684\u5bbd\u5ea6\uff0c\u4f1a\u4f7f\u5f97\u77e9\u9635\u548c\u5355\u8c03\u4e0d\u589e\uff0c\u5bf9\u6700\u540e\u4e00\u4e2a\u53d8\u91cf\u7684\u679a\u4e3e\u4f7f\u7528\u53cc\u6307\u9488\u964d\u4f4e \\(O(n)\\) \u7684\u590d\u6742\u5ea6</li> </ul> </li> <li>G\uff1a\u7ed9\u5b9a \\(2\\times n\\) \u7684\u79ef\u6728\u753b\uff0c\u4ee5\u53ca\u82e5\u5e72 I \u578b \u548c L \u578b\u79ef\u6728 (\u53ef\u4ee5\u65cb\u8f6c \\(0/90/180/270\u00b0\\))\uff0c\u8ba1\u7b97\u79ef\u6728\u586b\u6ee1\u79ef\u6728\u753b\u7684\u65b9\u6848\u6570<ul> <li>\u89c2\u5bdf\u89c4\u5f8b \\(f_i = f_{i-1} + f_{i-2} + 2\\sum\\limits_{j=i-3}^0 f_j\\)\uff0c\\(f_{i-1} = f_{i-2} + f_{i-3} + 2\\sum\\limits_{j=i-4}^0 f_j\\)</li> <li>\u5f97\u5230\uff1a\\(f_i = 2f_{i-1} + f_{i-1}\\)</li> </ul> </li> <li>H\uff1a<ul> <li>\u54c8\u5e0c\uff1a\u79bb\u7ebf\u5904\u7406\uff0c\u4ee5\u5feb\u901f\u67e5\u627e\u7279\u5b9a\u201c\u503c\u201d\uff08\u5982\uff1a\u6574\u6570\uff0c\u6d6e\u70b9\u6570\uff0c\u70b9\u5750\u6807\uff09 \u5bf9\u4e8e\u7684 \u76f8\u5173\u4fe1\u606f\uff08\u5982\uff1aid\uff0c\u591a\u4e2aid(\u5982\u679c\u539f\u51fd\u6570\u4e0d\u662f\u5355\u5c04\u51fd\u6570)\uff0c\u7b26\u5408\u6761\u4ef6\u7684\u6570\u91cf\uff0c\uff09</li> </ul> </li> <li>I\uff1a\u6709 n + m \u5929\uff0c\u82e5\u7b2c i(\\(i\\ge 1\\)) \u5929\u9047\u5230\u72b6\u6001 A\uff0c\u5219\u8d21\u732e\u500d\u589e (\u4e582)\uff0c\u82e5\u9047\u5230\u72b6\u6001 B\uff0c\u5219\u8d21\u732e -1\uff1b\u5047\u8bbe\u7b2c 0 \u5929\u8d21\u732e\u4e3a 2\uff0c\u6c42\u7b2c n+m \u5929 \u72b6\u6001\u4e3a B\uff0c\u8d21\u732e\u4e3a 0 \u7684\u65b9\u6848\u6570<ul> <li>\u8bb0 \\(f_{i, j, k}\\) \u4e3a\u524d i \u5929\u9047\u5230\u8fc7 j \u4e2a B \u72b6\u6001\uff0c\u8d21\u732e\u4e3a k \u7684\u65b9\u6848\u6570\uff1b\u4f46\u662f\u5f53\u524d\u72b6\u6001\u662f\u4e0d\u663e\u7136\u7684\uff0c\u7136\u800c\u4f46\u6211\u4eec\u5206\u6790\u51fa\u8f6c\u79fb\u65b9\u7a0b\u540e\uff0c\u81ea\u7136\u53ef\u4ee5\u77e5\u9053 (i, j, k) \u65b9\u6848\u7531\u54ea\u4e9b\u72b6\u6001\u7684\u9009\u62e9\u8f6c\u79fb\u800c\u6765\uff08\u6211\u4eec\u8fc7\u6ee4\u51fa\u6ee1\u8db3\u6211\u4eec\u9700\u8981\u7684\u8f6c\u79fb\u6570\u91cf\u5373\u53ef\uff09</li> <li>\\(f_{i, j, k} = CNT\\begin{cases} f_{i-1,j-1,k+1} &amp; \u7531\u72b6\u6001 B \u8f6c\u79fb\u800c\u6765 \\\\ f_{i-1,j,k/2} [2\\mid k] &amp; \u7531\u72b6\u6001 A \u8f6c\u79fb\u800c\u6765 \\end{cases}\\)<ul> <li>\u6211\u4eec\u9700\u8981\u7684\u662f \\(f_{n+m, m, 0}\\) \u4e2d\u4ece\u72b6\u6001 A \u8f6c\u79fb\u7684\u90a3\u4e00\u90e8\u5206\uff0c\u6839\u636e\u8f6c\u79fb\u65b9\u7a0b\u53ef\u77e5\uff1a\u8fd9\u4e00\u90e8\u5206\u4e3a \\(f_{n+m-1, m-1, 1}\\)</li> </ul> </li> <li>\u6ce8\u610f\uff1a\u6c42\u65b9\u6848\u6570\u7684 dp \u9700\u8981\u5173\u6ce8\u8fb9\u754c\u7684\u65b9\u6848\u6570\uff08\u8fd9\u91cc \\(f_{0,0,2}\\) \u663e\u7136\u662f 1\uff09</li> </ul> </li> <li>J\uff1a\u7ed9\u5b9a n \u4e2a\u7af9\u5b50\uff0c\u9ad8\u5ea6\u4e3a \\(h_i(\\le 10^{18})\\)\uff0c\u6bcf\u6b21\u5c06\u4e00\u6bb5\u8fde\u7eed\u7684 \u9ad8\u5ea6\u76f8\u540c \u7684\u7af9\u5b50\u8fdb\u884c\u957f\u5ea6\u7684\u53d8\u6362\u5373 \\(h_i = \\lfloor\\sqrt {\\lfloor\\frac {h_i}2\\rfloor + 1}\\rfloor\\)\uff1b\u6c42\u80fd\u4f7f\u7af9\u5b50\u957f\u5ea6\u90fd\u53d8\u6362\u4e3a 1 \u4e2d\uff0c\u6700\u5c11\u7684\u53d8\u6362\u6b21\u6570<ul> <li>\u6027\u8d28\uff1a\\(10^{18}\\) \u6700\u591a\u53ef\u7ecf\u8fc7 6 \u6b21\u53d8\u6362</li> </ul> </li> </ul>"},{"location":"%E5%88%B7%E9%A2%98/tmp/","title":"Divide and Conquer DP","text":"<p>Divide and Conquer is a dynamic programming optimization.</p>","tags":["Original"]},{"location":"%E5%88%B7%E9%A2%98/tmp/#preconditions","title":"Preconditions","text":"<p>Some dynamic programming problems have a recurrence of this form: </p> \\[ dp(i, j) = \\min_{0 \\leq k \\leq j} \\\\{ dp(i - 1, k - 1) + C(k, j) \\\\} \\] <p>where \\(C(k, j)\\) is a cost function and \\(dp(i, j) = 0\\) when \\(j \\lt 0\\). </p> <p>Say \\(0 \\leq i \\lt m\\) and \\(0 \\leq j \\lt n\\), and evaluating \\(C\\) takes \\(O(1)\\) time. Then the straightforward evaluation of the above recurrence is \\(O(m n^2)\\). There are \\(m \\times n\\) states, and \\(n\\) transitions for each state.</p> <p>Let \\(opt(i, j)\\) be the value of \\(k\\) that minimizes the above expression. Assuming that the  cost function satisfies the qudrangle inequality, we can show that  \\(opt(i, j) \\leq opt(i, j + 1)\\) for all \\(i, j\\). This is known as the monotonicity condition.  Then, we can apply divide and conquer DP. The optimal \"splitting point\" for a fixed \\(i\\) increases as \\(j\\) increases.</p> <p>This lets us solve for all states more efficiently. Say we compute \\(opt(i, j)\\) for some fixed \\(i\\) and \\(j\\). Then for any \\(j' &lt; j\\) we know that \\(opt(i, j') \\leq opt(i, j)\\). This means when computing \\(opt(i, j')\\), we don't have to consider as many splitting points!</p> <p>To minimize the runtime, we apply the idea behind divide and conquer. First, compute \\(opt(i, n / 2)\\). Then, compute \\(opt(i, n / 4)\\), knowing that it is less than or equal to \\(opt(i, n / 2)\\) and \\(opt(i, 3 n / 4)\\) knowing that it is greater than or equal to \\(opt(i, n / 2)\\). By recursively keeping track of the lower and upper bounds on \\(opt\\), we reach a \\(O(m n \\log n)\\) runtime. Each possible value of \\(opt(i, j)\\) only appears in \\(\\log n\\) different nodes.</p> <p>Note that it doesn't matter how \"balanced\" \\(opt(i, j)\\) is. Across a fixed level, each value of \\(k\\) is used at most twice, and there are at most \\(\\log n\\) levels.</p>","tags":["Original"]},{"location":"%E5%88%B7%E9%A2%98/tmp/#generic-implementation","title":"Generic implementation","text":"<p>Even though implementation varies based on problem, here's a fairly generic template. The function <code>compute</code> computes one row \\(i\\) of states <code>dp_cur</code>, given the previous row \\(i-1\\) of states <code>dp_before</code>. It has to be called with <code>compute(0, n-1, 0, n-1)</code>. The function <code>solve</code> computes <code>m</code> rows and returns the result.</p> <pre><code>int m, n;\nvector&lt;long long&gt; dp_before(n), dp_cur(n);\nlong long C(int i, int j);\n// compute dp_cur[l], ... dp_cur[r] (inclusive)\nvoid compute(int l, int r, int optl, int optr) {\nif (l &gt; r)\nreturn;\nint mid = (l + r) &gt;&gt; 1;\npair&lt;long long, int&gt; best = {LLONG_MAX, -1};\nfor (int k = optl; k &lt;= min(mid, optr); k++) {\nbest = min(best, {(k ? dp_before[k - 1] : 0) + C(k, mid), k});\n}\ndp_cur[mid] = best.first;\nint opt = best.second;\ncompute(l, mid - 1, optl, opt);\ncompute(mid + 1, r, opt, optr);\n}\nint solve() {\nfor (int i = 0; i &lt; n; i++)\ndp_before[i] = C(0, i);\nfor (int i = 1; i &lt; m; i++) {\ncompute(0, n - 1, 0, n - 1);\ndp_before = dp_cur;\n}\nreturn dp_before[n - 1];\n}\n</code></pre>","tags":["Original"]},{"location":"%E5%88%B7%E9%A2%98/tmp/#things-to-look-out-for","title":"Things to look out for","text":"<p>The greatest difficulty with Divide and Conquer DP problems is proving the monotonicity of \\(opt\\). One special case where this is true is when the cost function satisfies the quadrangle inequality, i.e., \\(C(a, c) + C(b, d) \\leq C(a, d) + C(b, c)\\) for all \\(a \\leq b \\leq c \\leq d\\).  Many Divide and Conquer DP problems can also be solved with the Convex Hull trick or vice-versa. It is useful to know and understand both! </p>","tags":["Original"]},{"location":"%E5%88%B7%E9%A2%98/tmp/#practice-problems","title":"Practice Problems","text":"<ul> <li>AtCoder - Yakiniku Restaurants</li> <li>CodeForces - Ciel and Gondolas (Be careful with I/O!)</li> <li>CodeForces - Levels And Regions</li> <li>CodeForces - Partition Game</li> <li>CodeForces - The Bakery</li> <li>CodeForces - Yet Another Minimization Problem</li> <li>Codechef - CHEFAOR</li> <li>CodeForces - GUARDS (This is the exact problem in this article.)</li> <li>Hackerrank - Guardians of the Lunatics</li> <li>Hackerrank - Mining</li> <li>Kattis - Money (ACM ICPC World Finals 2017)</li> <li>SPOJ - ADAMOLD</li> <li>SPOJ - LARMY</li> <li>SPOJ - NKLEAVES</li> <li>Timus - Bicolored Horses</li> <li>USACO - Circular Barn</li> <li>UVA - Arranging Heaps</li> <li>UVA - Naming Babies</li> </ul>","tags":["Original"]},{"location":"%E5%88%B7%E9%A2%98/tmp/#references","title":"References","text":"<ul> <li>Quora Answer by Michael Levin</li> <li>Video Tutorial by \"Sothe\" the Algorithm Wolf</li> </ul>","tags":["Original"]},{"location":"%E5%88%B7%E9%A2%98/%E5%8C%BA%E9%97%B4dp/","title":"\u533a\u95f4dp","text":"<p>1\u3001CWXU-\u6691\u671f\u96c6\u8bad-\u533a\u95f4dp - Virtual Judge (csgrandeur.cn)</p> <p>\u9898\u610f\uff1a\u7ed9\u5b9a\u8981\u5220\u9664\u7684\u5e8f\u5217\uff0c\u6bcf\u6b21\u80fd\u5220\u9664\u4e00\u4e2a\u56de\u6587\u5b50\u4e32\uff0c\u6c42\u5220\u9664\u6b21\u6570\u7684\u6700\u5c0f\u503c</p> <p>2\u3001CWXU-\u6691\u671f\u96c6\u8bad-\u533a\u95f4dp - Virtual Judge (csgrandeur.cn)</p> <p>\u9898\u610f\uff1a\u53c2\u52a0n\u573a\u6d3e\u5bf9\uff0c\u6bcf\u573a\u6d3e\u5bf9\u9700\u8981\u7a7f\u5bf9\u5e94\u8863\u670d\uff0c\u53c2\u52a0\u4e00\u573a\u6d3e\u5bf9\u524d\u6709\u4e24\u79cd\u9009\u62e9\uff1a\u8131\u6389\u591a\u4ef6\u8863\u670d\uff08\u8131\u6389\u7684\u4e0d\u53ef\u91cd\u7528\uff09\u6216\u7a7f\u4e0a\u5bf9\u5e94\u7684\u8863\u670d\uff0c\u6c42\u9700\u8981\u7684\u6700\u5c11\u8863\u670d\u6570</p> <p>\u66f4\u5f62\u8c61\u7684\u63cf\u8ff0\uff1a\u4f60\u6709\u4e00\u4e2a\u7a7a\u6808\u3002\u4ece\u660e\u5929\u5f00\u59cb\u7684 n \u5929\uff0c\u4f60\u90fd\u8981\u4fdd\u8bc1\u6808\u9876\u5143\u7d20\u4e3a ai\u200b\u3002\u4f60\u53ef\u4ee5\u5728\u6bcf\u4e00\u5929\u7684\u524d\u5929\u665a\u4e0a\u5bf9\u6808\u8fdb\u884c\u4efb\u610f\u7684\u5165\u6808\u3001\u51fa\u6808\u64cd\u4f5c\u3002\u8bf7\u95ee\uff1a\u4f60\u81f3\u5c11\u9700\u8981\u5165\u6808\u591a\u5c11\u6b21\uff1f</p> <pre><code>for(int d=0; d&lt;n; ++d){\nfor(int lb = 1, ub; (ub = lb + d) &lt;= n; ++ lb){\nif(!d) { f[lb][ub] = 1; continue; }\nf[lb][ub] = f[lb + 1][ub] + 1;\n//                f[lb][ub] = f[lb][ub - 1] + 1;\nfor(int mid = lb; mid &lt; ub; ++mid){\nif(a[lb] == a[mid + 1]) f[lb][ub] = min(f[lb][ub], f[lb + 1][mid] + f[mid + 1][ub]);\n//                    if(a[mid] == a[ub]) f[lb][ub] = min(f[lb][ub], f[lb][mid] + f[mid + 1][ub - 1]);\n}\n}\n}\n</code></pre> <p>3\uff0cCWXU-\u6691\u671f\u96c6\u8bad-\u533a\u95f4dp - Virtual Judge (csgrandeur.cn)</p> <p>\u9898\u610f\uff1a\u6700\u957f\u5b50\u62ec\u53f7\u5b50\u5e8f\u5217</p> <pre><code>for(int d=0; d&lt;s.size(); ++d){\nfor(int lb = 0, ub; (ub = lb + d) &lt; s.size(); ++lb){\nif(!d){ f[lb][ub] = 0; continue; }\nf[lb][ub] = (s[lb] == '(' &amp;&amp; s[ub] == ')' || s[lb] == '[' &amp;&amp; s[ub] == ']') ? f[lb + 1][ub - 1] + 2 : 0;\nfor(int mid = lb; mid &lt; ub; ++ mid){\nf[lb][ub] = max(f[lb][ub], f[lb][mid] + f[mid + 1][ub]);\n}\n}\n}\n</code></pre> <p>4\uff0cCWXU-\u6691\u671f\u96c6\u8bad-\u533a\u95f4dp - Virtual Judge (csgrandeur.cn)\uff08\u533a\u95f4dp + \u72b6\u6001\u673a + \u62ec\u53f7\u5e8f\u5217\u5904\u7406\uff09</p> <p>\u9898\u610f\uff1a</p> <p>\u7ed9\u51fa\u4e00\u4e2a\u914d\u5bf9\u7684\u62ec\u53f7\u5e8f\u5217\uff08\u5982 \u201c(())()\u201d\u3001\u201c()\u201d \u7b49\uff0c\u201c)()\u201d\u3001\u201c(()\u201d\u662f\u4e0d\u7b26\u5408\u8981\u6c42\u7684\uff09\uff0c\u5bf9\u8be5\u5e8f\u5217\u6309\u7167\u4ee5\u4e0b\u65b9\u6cd5\u67d3\u8272\u3002</p> <ol> <li>\u4e00\u4e2a\u62ec\u53f7\u53ef\u4ee5\u67d3\u6210\u7ea2\u8272\u3001\u84dd\u8272\u6216\u8005\u4e0d\u67d3\u8272\u3002</li> <li>\u4e00\u5bf9\u5339\u914d\u7684\u62ec\u53f7\u9700\u8981\u4e14\u53ea\u80fd\u5c06\u5176\u4e2d\u4e00\u4e2a\u67d3\u8272\u3002</li> <li>\u76f8\u90bb\u4e24\u4e2a\u62ec\u53f7\u989c\u8272\u4e0d\u80fd\u76f8\u540c\uff08\u4f46\u90fd\u53ef\u4ee5\u4e0d\u67d3\u8272\uff09\u3002</li> </ol> <p>\u6c42\u7b26\u5408\u6761\u4ef6\u7684\u67d3\u8272\u65b9\u6848\u6570\uff0c\u5bf9\u00a01000000007\u00a0\u53d6\u6a21\u3002</p> <pre><code>#include&lt;iostream&gt;\n#include&lt;string&gt;\nusing namespace std;\nint P = 1e9+7;\nstring s;\nint st[700], tt, mat[700];\nlong long f[700][700][3][3];\n#define rep(i, lb, ub) for(int i=lb; i&lt;ub; ++i)\n#define f0 f[lb][ub]\n#define f1 f[lb+1][ub-1]\n#define f2 f[lb][ mat[lb] ]\n#define f3 f[ mat[lb] + 1][ub]\nvoid dfs(int lb, int ub){\nif(lb &gt;= ub){\nputs(\"WA\");\nreturn ;\n}\nif(lb + 1 == ub){\nf0[0][1] = f0[0][2] = f0[1][0] = f0[2][0] = 1;\nreturn ;\n}\nif(mat[lb] == ub){\ndfs(lb + 1, ub - 1);\nrep(i, 0, 3) rep(j, 0, 3){\nif(i != 1) f0[1][0] = (f0[1][0] + f1[i][j]) % P;\nif(i != 2) f0[2][0] = (f0[2][0] + f1[i][j]) % P;\nif(j != 1) f0[0][1] = (f0[0][1] + f1[i][j]) % P;\nif(j != 2) f0[0][2] = (f0[0][2] + f1[i][j]) % P;\n}\nreturn ;\n}\ndfs(lb, mat[lb]), dfs(mat[lb] + 1, ub);\nrep(i, 0, 3) rep(j, 0, 3) rep(u, 0, 3) rep(v, 0, 3){\nif(j == u &amp;&amp; j + u) continue;\n// \u5408\u5e76\u4e24\u4e2a\u533a\u95f4\uff0c\u4f7f\u7528\u4e58\u6cd5\u539f\u7406 \nf0[i][v] = (f0[i][v] + f2[i][j] * f3[u][v] % P ) % P;\n}\n}\nint main(){\ncin &gt;&gt; s;\nrep(i, 0, s.size())\nif(s[i] == '(') st[ ++ tt] = i;\nelse mat[ st[tt--] ] = i;\ndfs(0, s.size()-1);\nlong long ans = 0;\nrep(i, 0, 3) rep(j, 0, 3)\nans = (ans + f[0][s.size() - 1][i][j]) % P;\ncout &lt;&lt; ans &lt;&lt; '\\n';\n}\n</code></pre> <p>5\uff0cCWXU-\u6691\u671f\u96c6\u8bad-\u533a\u95f4dp - Virtual Judge (csgrandeur.cn)</p> <p>\u7531\u4e8e\u5e8f\u5217\u4e24\u7aef\u4e0d\u80fd\u53d6\u6570\uff0c\u6545\u5c06\u533a\u95f4\u5b9a\u4e49\u4e3a\u5f00\u533a\u95f4</p> <pre><code>#include&lt;iostream&gt;\nusing namespace std;\nconst int N = 1e2+3, inf = 0x3f3f3f3f;\nint n, a[N], f[N][N];\nint main(){\ncin &gt;&gt; n;\nfor(int i=1; i&lt;=n; ++i) cin &gt;&gt; a[i];\nfor(int d=2; d&lt;n; ++d){\nfor(int lb = 1, ub; (ub = lb + d) &lt;= n; ++ lb){\nf[lb][ub] = inf;\nfor(int mid = lb + 1; mid &lt; ub; ++ mid){\nf[lb][ub] = min(f[lb][ub], f[lb][mid] + f[mid][ub] + a[lb] * a[mid] * a[ub]);\n}\n}\n}\ncout &lt;&lt; f[1][n] &lt;&lt; '\\n';\n}\n</code></pre> <p>6\uff0cCWXU-\u6691\u671f\u96c6\u8bad-\u533a\u95f4dp - Virtual Judge (csgrandeur.cn)</p> <p>\u9898\u610f\uff1a\u5feb\u9012\u5458\u4e00\u5f00\u59cb\u5728x\u5904\uff0c\u5176\u9001\u5feb\u9012\u901f\u5ea6\u4e3a \\(v^{-1}\\)\uff08\u901f\u5ea6v\u7684\u9006\u5143\uff09\uff0c\u6709n\u540d\u987e\u5ba2\u540c\u65f6\u4e0b\u5355\uff0c\u987e\u5ba2\u6709\u53c2\u6570\uff1a\u5750\u6807x \u548c \u6bcf\u5206\u949f\u7684\u4e0d\u9ad8\u5174\u6307\u6807b\uff0c\u6c42\u4e0d\u9ad8\u5174\u6307\u6807\u4e4b\u548c\u7684\u6700\u5c0f\u503c</p> <p>\u601d\u8def\uff1a\u5feb\u9012\u4e0d\u4f1a\u5ffd\u7565\u8def\u8fc7\u7684\u5e76\u4e14\u672a\u5403\u4e0a\u996d\u7684\u987e\u5ba2\uff0c\u5426\u5219\u4e0d\u4f1a\u83b7\u5f97\u6700\u4f18\u89e3</p> <p>\u56e0\u6b64\u9001\u5feb\u9012\u53ef\u4ee5\u62bd\u8c61\u4e3a\u4e00\u4e2a\u201c\u6709\u5411\u533a\u95f4\u201d\uff0c\u4ec5\u679a\u4e3e\u533a\u95f4\u7684\u5de6\u53f3\u7aef\u70b9\u4ee5\u8f6c\u79fb\u72b6\u6001\uff08\u5373\u72b6\u6001\u673a\uff09</p> <pre><code>#include&lt;iostream&gt;\n#include&lt;cmath&gt;\n#include&lt;algorithm&gt;\nusing namespace std;\nconst int N = 1e3+3, inf = 0x3f3f3f3f;\nint n, v, x, f[N][N][2];\nstruct nd{\nint x, b;\nbool operator&lt;(const nd &amp;t)const{ return x &lt; t.x; }\n}a[N];\nint main(){\nwhile(cin &gt;&gt; n &gt;&gt; v &gt;&gt; x){\nfor(int i=1; i&lt;=n; ++i) cin &gt;&gt; a[i].x &gt;&gt; a[i].b;\nsort(a + 1, a + n + 1);\nfor(int i=1; i&lt;=n; ++i) a[i].b += a[i-1].b;\n#define f0 f[lb][ub]\n#define f1 f[lb + 1][ub]\n#define f2 f[lb][ub - 1]\nfor(int d=0; d&lt;n; ++d){\nfor(int lb=1, ub; (ub = lb + d) &lt;= n; ++ lb){\nauto val = [a, lb, ub](int u, int v){\nreturn abs(a[u].x - a[v].x) * (a[n].b - (a[ub].b - a[lb+1 -1].b));\n};\nauto val1 = [a, lb, ub](int u, int v){\nreturn abs(a[u].x - a[v].x) * (a[n].b - (a[ub-1].b - a[lb -1].b));\n};\nif(!d) { f0[0] = f0[1] = abs(a[lb].x - x) * a[n].b; continue; }\n// \u5feb\u9012\u5458\u6700\u540e\u5230\u8fbe lb \uff0c \u5c06 lb \u4e0e [lb + 1, ub] \u5408\u5e76\n// \u6709\u4e24\u4e2a\u8def\u7ebf\uff1alb+1 -&gt; lb \u6216  ub -&gt; lb\nf0[0] = min(f1[0] + val(lb + 1, lb), f1[1] + val(ub, lb));\nf0[1] = min(f2[0] + val1(lb, ub), f2[1] + val1(ub - 1, ub));\n}\n}\ncout &lt;&lt; min(f[1][n][0], f[1][n][1]) * v &lt;&lt; '\\n';\n}\n}\n</code></pre> <p>7\u3001CWXU-\u6691\u671f\u96c6\u8bad-\u533a\u95f4dp - Virtual Judge (csgrandeur.cn)</p> <p>\u9898\u610f\uff1a</p> <p>8\u3001CWXU-\u6691\u671f\u96c6\u8bad-\u533a\u95f4dp - Virtual Judge (csgrandeur.cn)</p>"},{"location":"%E5%88%B7%E9%A2%98/%E6%80%9D%E7%BB%B4/","title":"\u601d\u7ef4","text":""},{"location":"%E5%88%B7%E9%A2%98/%E6%80%9D%E7%BB%B4/#a-max-maxa_ijtimes-mina_ij-i1nji1n","title":"A\uff0c\u8ba1\u7b97 \\(max\\{ max\\{a_{i..j}\\}\\times min\\{a_{i..j}\\} \\}\\)\uff0c\\(i=1..n,~j=i+1..n\\)","text":"<ul> <li>max \u548c min \u7684\u8fd0\u7b97\u6027\u8d28\uff1a</li> </ul> <p>\\(min\\{S\\} \\le min\\{T\\},~T\\in S\\)</p> <p>\\(max\\{S\\}\\ge max\\{T\\},~T\\in S\\)</p> <ul> <li>\u5206\u6790\uff1a</li> </ul> <p>\u6784\u9020\u4e00\u79cd \u8986\u76d6 \u65b9\u6cd5\uff1a\u4ee5 \\(a_i\\) \u4e3a\u6700\u5927\u503c\u7684\u5b50\u533a\u95f4\u96c6\u5408\uff0c\\(i=1..n\\) </p> <p>\\(\\displaystyle \\{\\{a_{l..i..r,}\\mid l=1..i,~r=i..n,~a_i~is~max\\}\\mid~i=1..n\\}\\) </p> <p>\u5047\u8bbe \\(a_i\\) \u4e3a\u4ee3\u8868\u7684\u533a\u95f4\u96c6\u5408\u4e2d\u6700\u5927\u7684\u533a\u95f4\u662f \\(a_{l..i..r}\\)\uff0c\u5bf9 \\(a_{l..i..r}\\) \u53d6\u6700\u5c0f\u7684\u5b50\u96c6 \\(a_{l_1,~r_1}\\)\uff0c\u800c\u6700\u5c0f\u5b50\u96c6\u7684\u957f\u5ea6\u4e3a2\uff0c\u6240\u4ee5\u6709\u4e24\u79cd\u60c5\u51b5\uff1a\\(a_{i-1,~i}\\) \u548c \\(a_{i,~i+1}\\)\uff0c\u6b64\u65f6 \\(max\\{a_{l_1..r_1}\\}=max\\{a_{l..i..r}\\},~min\\{a_{l_1..r_1}\\}\\ge min\\{a_{l..i..r}\\}\\)\uff0c\u8fdb\u800c</p> <p>\\(max\\{a_{l_1..r_1}\\}\\times min\\{a_{l_1..r_1}\\}\\ge max\\{a_{l..i..r}\\}\\times min\\{a_{l..i..r}\\}\\)</p> <p>\uff08\\(max\\) \u6216 \\(min\\) \u662f\u53ef\u91cd\u590d\u8d21\u732e\u7684\u8fd0\u7b97\uff0c\u6240\u4ee5\u6269\u5927\u9898\u76ee\u7684 \u5212\u5206 \u65b9\u5f0f\uff0c\u53d8\u4e3a \u8986\u76d6\uff09</p> <p>\u56e0\u6b64\uff0c\u7b54\u6848\u5c31\u662f \\(max\\{max\\{a_{i-1..i}\\}\\times min\\{a_{i-1..i}\\},~~max\\{a_{i..i+1}\\}\\times min\\{a_{i..i+1}\\}\\}\\)\uff0c\\(i=1..n,~a_i\\ge a_{i-1}\\) \u6216 \\(a_i\\ge a_{i+1}\\)</p>"},{"location":"%E5%88%B7%E9%A2%98/%E6%80%9D%E7%BB%B4/#b-maxitimes-j-ktimesa_ia_ji1nji1n","title":"B\uff0c\u8ba1\u7b97 \\(max\\{i\\times j-k\\times(a_i~|~a_j)\\},~i=1..n,~j=i+1..n\\)","text":"<p>\u7384\u5b66\u66b4\u529b</p>"},{"location":"%E5%88%B7%E9%A2%98/%E6%80%9D%E7%BB%B4/#c","title":"C\uff0c\u54c8\u5bc6\u987f\u8ddd\u79bb+\u7279\u5224","text":""},{"location":"%E5%88%B7%E9%A2%98/%E6%80%9D%E7%BB%B4/#d","title":"D\uff0c\u53cc\u6307\u9488","text":""},{"location":"%E5%88%B7%E9%A2%98/%E6%80%9D%E7%BB%B4/#e","title":"E\uff0c\u7384\u5b66\u4f18\u5316\u66b4\u529b\u5faa\u73af","text":""},{"location":"%E5%88%B7%E9%A2%98/%E6%80%9D%E7%BB%B4/#f","title":"F\uff0c\u4e24\u4e2a\u6570\u6210\u5bf9\u53d6\u53cd\u7684\u64cd\u4f5c","text":"<p>\u56fa\u5b9a6\u6b21\u662f\u53ef\u884c\u7684\u89e3\uff0c\u6bcf\u4e2a\u6570\u5e73\u57473\u6b21</p>"},{"location":"%E5%88%B7%E9%A2%98/%E6%80%9D%E7%BB%B4/#g","title":"G\uff0c","text":""},{"location":"%E5%88%B7%E9%A2%98/%E6%80%9D%E7%BB%B4/#h-a-x-b-y-gcdx-y-c","title":"H\uff0c\u6784\u9020 a \u4f4d\u7684 x \uff0cb \u4f4d\u7684 y\uff0c\u4f7f\u5f97 gcd(x, y) \u4e3a c\u4f4d","text":"<p>\u6570\u636e\u8303\u56f4\uff1a \\(a,~b\\le 9,~c\\le min\\{a,~b\\}\\)</p> <ul> <li>\u5f15\u7406\uff1a\\((10^{x-1},~10^{y}-1)=1\\)</li> </ul> <p>\u8bc1\uff1a\\(10^{x-1}\\) \u7684\u8d28\u56e0\u5b50\u53ea\u6709 \\(2\\) \u548c \\(5\\)\uff1b\\(10^{y}-1\\)\u7684\u8d28\u56e0\u5b50\u53ea\u6709 \\(3\\) \u548c \\(111..11\\)</p> <p>\u4e24\u4e2a\u6570\u4e4b\u95f4\u7684\u8d28\u56e0\u5b50\u96c6\u5408\"\u6ca1\u6709\u4ea4\u96c6\"\uff0c\u6240\u4ee5\u4e92\u8d28</p> <p>\uff08\u53ef\u4ee5\u6784\u9020 \\(x\\)\u4f4d \u548c \\(y\\)\u4f4d \u7684\u4e92\u8d28\u5bf9\u6570\uff09</p> <ul> <li>\u5206\u6790\uff1a</li> </ul> <p>\\(d = (x,~y)\\implies (\\frac{x}{d},~\\frac{y}{d})=1\\) </p> <p>\u663e\u7136\u53ef\u4ee5\u6784\u9020 \\(d=10^{c-1}\\)</p> <p>\u90a3\u4e48\u53ea\u8981\u4ee4 \\((\\frac{x}{10^{c-1}},~\\frac{y}{10^{c-1}})=1\\)\uff0c\u7b80\u8bb0\u4e3a \\((x',~y')=1\\)</p> <p>\u5176\u4e2d \\(x',~y'\\) \u7684\u4f4d\u6570\u5206\u522b\u662f \\(a-(c-1),~b-(c-1)\\) \u4f4d</p> <p>\u6784\u9020 \\(x',~y'\\) \u5206\u522b\u4e3a \\(10^{a-(c-1)-1},~10^{b-(c-1)}-1\\)</p>"},{"location":"%E5%88%B7%E9%A2%98/%E6%95%B0%E8%AE%BA/","title":"\u6570\u8bba","text":"<p>\u6613\u9519\u70b9\uff1a</p> <p>1\uff09\u7ebf\u6027\u7b5b\uff1a\\(int~st[]\\) \u5728\\(c++17\\) \u4e0d\u53ef\u4ee5\u7528 \\(bool\\) \u8d4b\u503c\uff1b\\(st[0]=st[1]=true\\) \u52a1\u5fc5\u52a0\u4e0a</p> <p>2\uff09\\(gcd(),~exgcd(),~fp(),~log()\\) \u5fc5\u5f00 \\(long~long\\) \uff0c\u5426\u5219\u5bb9\u6613 \\(RE\\)</p> <p>3\uff09\u6709 \\(P=1e9+7\\) \u6216 \\(n&lt; 2^{31}\\)  \u7b49\u6807\u5fd7 \u5fc5\u987b\u5f00 \\(long~long\\) </p> <p>\uff08\u6bd4\u8f83\u96be\u7684\u9898\uff1a\\(B,~P,~Q,~X\\)\uff1b</p> <p>\u7591\u4f3c\u83ab\u6bd4\u4e4c\u65af\u53cd\u6f14\u4f46\u53c8\u4e0d\u662f\uff1a\\(H,~O,~Y\\)\uff09</p>"},{"location":"%E5%88%B7%E9%A2%98/%E6%95%B0%E8%AE%BA/#a-n-a_i-a_i","title":"A\uff0c\u7ed9\u5b9a \\(n\\) \u4e2a\u6570\uff0c\\(a_i\\) \u7684\u8d21\u732e\u662f\u4e0d\u5c0f\u4e8e \\(a_i\\) \u7684\u6b27\u62c9\u51fd\u6570\u503c\u7684\u4e0b\u6807\uff0c\u6c42\u603b\u8d21\u732e","text":"<p>\u8bb0 \\(f\\) \u4e3a\u6b27\u62c9\u51fd\u6570</p> <p>\\(f_i\\le i-1,~f_{p}=p-1 \\implies f_i\\le p-2\\le f_p-1,~i=1..p-1\\)</p> <p>\\(\\implies i\\le f_p, i=1..p-1\\)</p>"},{"location":"%E5%88%B7%E9%A2%98/%E6%95%B0%E8%AE%BA/#b","title":"B\uff0c\u6700\u5927\u72ec\u7acb\u96c6\uff08\u4e24\u4e24\u4e4b\u5546\u4e0d\u4e3a\u7d20\u6570\uff08\u8981\u6c42\u6574\u9664\uff09\uff09;","text":"<p>\u524d\u7f6e\uff1a\u4e8c\u5206\u56fe\uff0c\u56fe\u7684\u5339\u914d</p>"},{"location":"%E5%88%B7%E9%A2%98/%E6%95%B0%E8%AE%BA/#c","title":"C\uff0c\u6c42\u6ee1\u8db3\u6761\u4ef6\u7684\u201c\u4e58\u6cd5\u5171\u8f6d\u56e0\u5b50\u5bf9\u201d\u7684\u5bf9\u6570","text":"<p>\u5373\u6ee1\u8db3 \\(n~=~x\\times y\\) \uff0c\\(~x,y\\ge k\\)\uff0c\\(k\\le n\\le 1e12\\) \u7684\u4e8c\u5143\u7ec4 \\((x,~y)\\) \u5bf9\u6570</p> <p>\u7531\u4e8e\u6570\u7ec4\u7ec4\u6570 \\(T\\le 1e4\\)\uff0c\u76f4\u63a5\u8bd5\u9664\u6cd5 \\(O(\\sqrt{n})\\) \u4f1a\u8d85\u65f6</p> <p>\u8003\u8651\u7ebf\u6027\u7b5b\u9884\u5904\u7406\u7d20\u6570\uff0c\u518d\u505a\u5206\u89e3\u8d28\u56e0\u5b50\u6c42\u5f97\u56e0\u5b50\u603b\u6570 \\(d_n\\)\uff0c\u590d\u6742\u5ea6\uff1a$O(\\frac{\\sqrt{n}}{\\ln{\\sqrt{n}}}) $\uff08\u778e\u731c\u7684\u590d\u6742\u5ea6\uff09</p> <p>\u7531\u4e8e \u56e0\u5b50\u603b\u6570 \\(d\\) \u548c \u201c\u5171\u8f6d\u56e0\u5b50\u5bf9\u6570\u201d \\(m\\) \u7684\u5173\u7cfb\u4e3a\uff1a\\(m = \\lfloor\\frac12\\times\\Sigma\\rfloor\\)</p> <p>\u6700\u540e\u66b4\u529b \\(O(k)\\) \u6392\u9664\u4e0d\u6ee1\u8db3 \\(x,y\\ge k\\) \u7684\u5bf9\u6570</p> <p>\u603b\u590d\u6742\u5ea6\uff1a\\(O(\\frac{\\sqrt{n}}{\\ln{\\sqrt{n}}}+k)\\) \uff08\\(k\\le \\sqrt{n}\\)\uff0c\u5426\u5219\u7b54\u6848\u662f \\(0\\)\uff09</p> <p>\uff08\u5206\u89e3\u8d28\u56e0\u5b50\u7684\u7b97\u6cd5\u7684\u57fa\u672c\u7406\u8bba\u79f0 \u552f\u4e00\u5206\u89e3\u5b9a\u7406\uff09</p> <p>\uff08\u56e0\u5b50\u603b\u6570\uff1a $\\displaystyle d_n = \\prod_{i=1}^k(\\alpha_i+1) $ \uff09</p> <p>\u5355\u6b21\u6c42\u56e0\u5b50\u6570\u7b97\u6cd5\u7684\u5fae\u8c03\uff1a\uff08\u5206\u89e3\u5b9a\u7406\u52a0\u901f\uff09</p> <pre><code>int gd(int n){\nint ans = 1;\nfor(int i=1; i&lt;=idx &amp;&amp; p[i]*p[i]&lt;=n; ++i){\nif(n % p[i]);\nint alpha = 0;\nfor(; !(n % p[i]); n /= p[i]) ++ alpha;\nans *= alpha + 1;\n}\nif(n &gt; 1) ans *= 2;\nreturn ans;\n}\n</code></pre>"},{"location":"%E5%88%B7%E9%A2%98/%E6%95%B0%E8%AE%BA/#dsumlimits_i1nsigma_if","title":"D\uff0c\u6c42\\(\\sum\\limits_{i=1}^n[\\sigma_i=F]\\)","text":"<p>\u9898\u76ee\u7ed9\u51fa\u7ea6\u6570\u548c\u516c\u5f0f\uff08\u8bef\u5bfc\u5411\uff09\uff1a$ \\displaystyle \\sigma_n = \\prod_{i=1}k\\sum_{j=0}p_i^j = \\prod_{i=1}k\\frac{p_i-1}{p_i-1}$</p> <ul> <li>1\uff0c\u5f15\u5165\u5947\u5076\u7684\u6027\u8d28</li> </ul> <p>\u8bbe \\(T\\) \u4e3a\u5947\uff0c \\(F\\) \u4e3a\u5076\uff0c \\(f_n\\) \u4e3a\u5947\u5076\u6027\u51fd\u6570</p> <p>\uff08\\(T\uff0cF\\) \u5206\u522b\u5bf9\u5e94\u4e8c\u8fdb\u5236\u7684 \\(1,~0\\)\uff1b\u53ef\u5bf9\u5176\u8fdb\u884c \u5f02\u6216 \u6216\u8005 \u4e0e \u8fd0\u7b97\uff09</p> <p>\\(f_n := (n==T)=(n==T~?~T~:~F)\\)</p> <p>\\(f_a\\pm f_b=a\\) ^ \\(b\\) \uff0c\u7b80\u8bb0\u4e3a \\(a+b\\)</p> <p>\\(f_a\\times f_b=a~\\&amp;~b\\)\uff0c\u7b80\u8bb0\u4e3a \\(a\\times b\\)</p> <ul> <li> <ul> <li>\\(T^k=T,~F^k=F,~k\\ge 1\\implies f_n^k=f_n,~k\\ge 1\\)</li> </ul> </li> <li> <ul> <li>\\(T^0~=~F^0~=~T\\)</li> </ul> </li> <li> <ul> <li>\u4e58\u6cd5\u5355\u4f4d\u5143\uff1a\\(T\\times f_n ~=~ f_n\\times T ~=~ f_n\\)</li> </ul> </li> <li> <ul> <li>\u5f02\u6216\u5355\u4f4d\u5143\uff1a\\(F+f_n ~=~ f_n+F ~=~ f_n\\)</li> </ul> </li> <li> <ul> <li>\\(n\\times T=f_n\\times T=f_n\\)</li> </ul> </li> <li> <ul> <li>\\(n\\times F=F\\)</li> </ul> </li> <li> <p>2\uff0c \\(\\sigma_n=\\prod\\limits_{i=1}^k\\sum\\limits_{j=0}^{a_i}p_i^j\\)</p> </li> </ul> <p>\u7531\u4e8e \\(\\sigma_n\\) \u662f\u7531\u4e00\u4e2a\u4e58\u79ef\u7684\u5f62\u5f0f\u5f97\u5230\uff0c\u6240\u4ee5\u7edf\u8ba1 \\((\\sigma_n==T)\\) \u65b9\u4fbf\u8ba1\u7b97\uff0c\u6700\u540e\u53ea\u8981\u5bb9\u65a5\u4e00\u4e0b</p> <p>\u4f7f\u7528\u201c\u771f\u503c\u8868\u201d \u201c\u9012\u5f52\u5730\u201d\u5316\u7b80\uff1a</p> \\(\\sum\\limits_{j=0}^{a_1}2^j\\) \\(2^0\\) \\(2^j,~j\\ge1\\) \\(T+a_1\\times F\\) \\(T\\) \\(F\\) \\(T\\) \\(\\sum\\limits_{j=0}^{a_i}p_i^j,~i\\ge2\\) \\(p_i^0\\) \\(p_i^j,~j\\ge 1\\) \\(T\\times(a_i+1)\\) \\(T\\) \\(T\\) \\((a_i==F)\\) <p>\u4e8e\u662f \\(\\sigma_n=\\prod\\limits_{i=1}^k\\sum\\limits_{j=0}^{a_i}p_i^j=T\\times \\prod\\limits_{i=2}^k(a_i==F)\\)</p> <p>\\(\\sigma_n=T\\iff a_i=F,~i\\ge2\\)</p> <p>\u6240\u4ee5 \\(\\sigma_n=2^{a_1}\\times x^2,~a_1\\ge0\\)</p> <p>\u5f53 \\(a_1=0\\) \u65f6\uff0c \\(\\sigma_n=x^2\\)\uff0c \u4e3a\u5b8c\u5168\u5e73\u65b9\u6570</p> <p>\u5f53 \\(a_1\\ge 1\\) \u65f6\uff0c\\(\\sigma_n=2^{a_1}\\times x^2 =\\begin{cases}2\\times (2^{\\frac{a_1-1}{2}}\\times x)^2 &amp; a_1=T\\\\(2^{\\frac{a_1}{2}}\\times x)^2 &amp; a_1=F\\end{cases}\\)</p> <p>\u7efc\u4e0a \\(n=x^2~\u6216~2\\times x^2\\) \u65f6\uff0c \\(\\sigma_n=F\\)</p> <p>\uff08\u8bc1\u660e\uff1a\u4e00\u4e2a\u6570\u4e0d\u53ef\u80fd\u540c\u65f6\u7b49\u4e8e \\(x^2\\) \u6216 \\(2\\times x^2\\)\uff0c\\(x\\ge 1\\)</p> <p>\u8bc1\uff1a\u95ee\u9898\u7b49\u4ef7\u4e8e \\(x^2=2\\times y^2\\) \u6709\u6839</p> <p>\u89e3\uff1a\\(x=\\sqrt2\\times y\\) \u6216 \\(x=-\\sqrt2\\times y\\)</p> <p>\u53ea\u6709\u4e00\u4e2a\u6574\u6570\u89e3\uff1a \\(x=0,~y=0\\)\uff08\u4e0d\u6ee1\u8db3\\(x\\ge 1\\)\uff09\uff0c\u5f97\u8bc1\uff09</p>"},{"location":"%E5%88%B7%E9%A2%98/%E6%95%B0%E8%AE%BA/#e-nk","title":"E\uff0c\u8f93\u51fa \\(n^k\\) \u7684\u9ad8\u4e09\u4f4d\u548c\u4f4e\u4e09\u4f4d\u6570\u5b57","text":"<p>\uff08\u8981\u8865 \u540e\u5bfc\u96f6 \u548c \u524d\u5bfc\u96f6\uff09</p> <p>\u5173\u952e\u5728\u4e8e\u7b2c\u4e00\u95ee\uff1a\u8f93\u51fa\u9ad8\u4e09\u4f4d</p> <p>\u7531\u4e8e\u76f4\u63a5\u641e\u53ef\u80fd\u6ea2\u51fa\uff0c\u53c2\u8003\\(fft\\) \u7684\u624b\u6bb5\u5148\u5bf9 \\(n\\) \u53d610\u4e3a\u5e95\u7684\u5bf9\u6570\uff08\u6b63\u53d8\u6362\uff09\uff0c\u6b21\u65b9\u5c31\u53d8\u6210\u4e86\u4e58\u6cd5\uff0c\u5e76\u4e14\u9664\u53bb\u6574\u6570\u90e8\u5206\uff08\u5bf9\u5e94ans\u7684\u4f4d\u6570\uff09\u7559\u4e0b\u5c0f\u6570\u90e8\u5206\uff0c\u518d\u52a0\u4e0a\\((3-1)\\)\uff0c\u7136\u540e\u53d610\u4e3a\u5e95\u7684\u6b21\u65b9\uff08\u9006\u53d8\u6362\uff1b\u5f97\u5230\u6700\u9ad8\u4e3a\u4e2a\u4f4d\u7684\u6d6e\u70b9\u6570\uff09\uff0c\u5411\u4e0b\u53d6\u6574</p> <p>\u6570\u5b66\u8868\u793a\uff1a</p> <p>\\(n^k ~=~ (10^{log_{10}(n)})^k ~=~ 10^{k\\times log_{10}(n)}\\)</p> <p>\uff08\\(log_{10}(n)\\) \u53ef\u4ee5\u8868\u793a\u6210 \\(a~e~b\\) \uff0c\\(a\\) \u662f\u6700\u9ad8\u4f4d\u4e3a\u4e2a\u4f4d\u7684\u6d6e\u70b9\u6570\uff0c\u5bf9\\(log_{10}(n)\\) \u8fdb\u884c\u6a211\u64cd\u4f5c\u53ef\u4ee5\u628a \\(b\\) \u7f6e\u96f6\uff09</p>"},{"location":"%E5%88%B7%E9%A2%98/%E6%95%B0%E8%AE%BA/#fgoldbachs-conjecture","title":"F\uff0cGoldbach's conjecture\uff08\u5df4\u8d6b\u731c\u60f3\uff09","text":"<p>\u6570\u636e\u91cf\uff1a \\(n=4e7\uff0cT=300\\)</p> <p>\u8ba1\u7b97\u6ee1\u8db3 \\(n = x + y\\)\uff0c\\(x,y\\in~prime,~x\\le y\\) \u7684\u5143\u7ec4 \\((x~,y)\\) \u7684\u4e2a\u6570\uff0c\u7ebf\u6027\u7b5b\u6c42\u51fa\u8d28\u6570\u548c\u8d28\u6570\u5224\u65ad\u8868\uff0c\u5c06\u679a\u4e3e\u4f18\u5316\u5230 \\(O(\\frac{n}{\\ln{n}})\\) </p> <p>\uff08\u201c\u52a0\u6cd5\u5171\u8f6d\u56e0\u5b50\u5bf9\u201d\uff09</p>"},{"location":"%E5%88%B7%E9%A2%98/%E6%95%B0%E8%AE%BA/#g","title":"G\uff0c\u5206\u5757","text":""},{"location":"%E5%88%B7%E9%A2%98/%E6%95%B0%E8%AE%BA/#h-sumlimits_i1nsumlimits_jinijn-n1e14","title":"H\uff0c\u8ba1\u7b97  \\(\\sum\\limits_{i=1}^n\\sum\\limits_{j=i}^n[[i,~j]=n]\\) \uff08n=1e14\uff09","text":"<p>\uff08\u5206\u89e3\u8d28\u56e0\u5b50\u53ef\u4ee5\u7528\u4e8e \u201c\u7ea6\u6570\u6784\u9020\u201d \uff1f\uff09</p> <p>\u5373\u8ba1\u7b97 \u6ee1\u8db3 \\([x,~y]=n\\)\uff0c\\(x\\le y\\) \u7684\u5143\u7ec4 \\((x,~y)\\) \u7684\u4e2a\u6570</p> <p>\u5206\u89e3\u8d28\u56e0\u5b50\uff1a</p> <p>\\(\\displaystyle n ~=~ \\prod_{i=1}^k p_i^{e_i},~~ e_i=max\\{ \\alpha_i,~\\beta_i \\} \\\\ x~=~ \\prod_{i=1}^k p_i^{\\alpha_i} \\\\ y ~=~ \\prod_{i=1}^k p_i^{\\beta_i}\\)</p> <p>\uff08warning\uff1a\u5bf9 \\(x,~y\\) \u7684\u5206\u89e3\u662f\u4e0d\u4e25\u683c\u7684\uff0c\u56e0\u4e3a\u6709\u53ef\u80fd \\(\\alpha_i,~b_i=0\\)\uff09</p> <p>1\uff09\\(a_i=0~..~e_i,~b_i=e_i\\)\uff0c\u8d21\u732e\uff1a\\(e_i+1\\)</p> <p>2\uff09\\(a_i=e_i,~b_i=0~..~e_i-1\\)\uff0c\u8d21\u732e\uff1a\\(e_i\\)</p> <p>\u6240\u4ee5\u5bf9\u4e8e \\(p_i\\)\uff0c\u6709 \\(2\\times e_i+1\\) \u79cd\u65b9\u6848</p> <p>\u6839\u636e\u4e58\u6cd5\u539f\u7406\uff0c\\([x,~y]=n\\) \u7684\u65b9\u6848\u6570\u4e3a \\(\\prod\\limits_{i=1}^k(2\\times e_i+1)\\)</p> <p>\u5bf9\u4e8e \\([x,y]=n,x=y\\)\uff0c\u65b9\u6848\u6570\u4e3a 1 \uff08\u5373 \\((n,~n)\\)\uff09</p> <p>\u5bf9\u4e8e \\([x,~y]=n,x&lt;y\\)\uff0c\u53d1\u6848\u6570\u4e3a \\(\\lfloor\\frac{\\prod\\limits_{i=1}^k(2\\times e_i+1)}{2}\\rfloor\\)</p> <p>\u5bf9\u4e8e \\([x,~y]=n,x\\le y\\)\uff0c\u65b9\u6848\u6570\u4e3a \\(\\lfloor\\frac{\\prod\\limits_{i=1}^k(2\\times e_i+1)}{2}\\rfloor+1\\)</p> <p>\uff08\u7ebf\u6027\u7b5b\u52a0\u901f\u8d28\u56e0\u5b50\u5206\u89e3\uff0c\u590d\u6742\u5ea6\u4e3a\\(O(\\frac{\\sqrt{n}}{\\log{\\sqrt{n}}})\\)\uff1b</p> <p>\u4ee4 \\(f_n=\\frac{\\sqrt{n}}{\\log{\\sqrt{n}}}\\)\uff0c\\(f_{1e14}=5e5\\)\uff0c\\(f_{1e18}=3e7\\)\uff09</p> <p>\uff08\\(n=1e16\\)\u7684\u6781\u9650\u60c5\u51b5\u4e0b\uff0c\u53ef\u4ee5\u628a\u66b4\u529b\u7684 \\(1e32\\) \u964d\u5230 \\(3e7\\)\uff09</p>"},{"location":"%E5%88%B7%E9%A2%98/%E6%95%B0%E8%AE%BA/#iharmonic-number","title":"I\uff0cHarmonic Number","text":"<p>\u8c03\u548c\u7ea7\u6570 $H_n = \\sum\\limits_{i=1}^n \\frac{1}{i} = \\ln{n} + 1.0/(2\\times n) + r $</p> <p>\\(r=0.57721566490153286060651209\\)</p> <p>\uff08\\(r\\) \u53ea\u9700\u8981\u77e5\u9053\u524d10\u4f4d\uff0c\u800c\u4e14 \\(r\\) \u4e0d\u7528\u8bb0\uff0c\u9760 \\(n=1e8\\) \u7684\u6837\u4f8b\u53cd\u63a8\u5373\u53ef\uff1b</p> <p>\u6ce8\u610f\uff1a\u4e3a\u4e86\u5f97\u5230\u8f83\u5927\u7684\u7cbe\u5ea6\uff0c\\(n\\) \u5c0f\u4e8e\\(1e6\\) \u65f6\u5e94\u7528\u524d\u7f00\u548c\u67e5\u8be2\uff0c\u653e\u4e4b\u7528\u516c\u5f0f\u67e5\u8be2\uff09</p>"},{"location":"%E5%88%B7%E9%A2%98/%E6%95%B0%E8%AE%BA/#j-nbpnbpin-z-p","title":"J\uff0c\u6ee1\u8db3 \\(n=b^p,~n,b,p\\in Z\\) \u7684 \\(p\\) \u6700\u5927\u503c","text":"<p>\uff08\u6ce8\u610f\uff1a\\(n\\) \u53ef\u4ee5\u662f\u8d1f\u6570\uff09</p> <p>\u4e3b\u8981\u662f \\(n\\) \u5206\u89e3\u540e\u6b21\u6570\u7684\u6700\u5927\u516c\u7ea6\u6570\uff0c\u5982\u679c \\(n\\) \u662f\u8d1f\u6570\uff0c\u5219\u628a \\(ans\\) \u53d8\u6210\u5947\u6570</p> <p>\u8d1f\u6570\u7684\u60c5\u51b5\u53ef\u8868\u793a\u4e3a\uff1a\\(-n = (-b)^p,~n,~b,~p\\in Z^+\\implies p~is~odd\\)</p> <p>\uff08\u4e0d\u5927\u4e8e \\(n\\) \u7684\u6700\u5927\u5947\u6570\u4e3a\uff1a\\(\\frac{n\\&amp;-n}{n}\\)\uff09</p>"},{"location":"%E5%88%B7%E9%A2%98/%E6%95%B0%E8%AE%BA/#k32","title":"K\uff0c\u5224\u65ad\u5927\u6570\u662f\u5426\u88ab32\u4f4d\u6570\u6574\u9664","text":""},{"location":"%E5%88%B7%E9%A2%98/%E6%95%B0%E8%AE%BA/#l","title":"L\uff0c\u8ba1\u7b97 \u8d21\u732e\u5f0f","text":"<p>\\(\\displaystyle \\sum_{a_1=0}^{n-1}\\sum_{a_2=0}^{n-1}\\dots\\sum_{a_k=0}^{n-1}(A_{a_1}+A_{a_2}+\\dots + A_{a_k})\\pmod{p}\\)</p> <p>\uff08\\(\\sum\\limits_{i=1}^n\\sum\\limits_{j=1}^m(f_i+g_j) = m\\times\\sum\\limits_{i=1}^n f_i+n\\times\\sum\\limits_{j=1}^m g_j\\)\uff09</p> <p>\\(= \\displaystyle n^{k-1}\\times \\sum_{a_1=0}^{n-1}A_{a_1}+n\\sum_{a_2=0}^{n-1}\\dots\\sum_{a_k=0}^{n-1}(A_{a_2}+\\dots + A_{a_k})\\pmod{p}\\)</p> <p>$= \\dots $</p> <p>\\(\\displaystyle = k\\times n^{k-1}\\times\\sum_{i=0}^n A_i\\)</p>"},{"location":"%E5%88%B7%E9%A2%98/%E6%95%B0%E8%AE%BA/#m","title":"M\uff0c\u7b5b\u533a\u95f4\u8d28\u6570","text":"<p>\u7531\u4e8e \\(len\\le 1e5\\)\uff0c\u8003\u8651\u57c3\u6c0f\u7b5b</p> <p>\u5148\u7b5b \\(\\sqrt{n}\\) \u4ee5\u5185\u7684\u8d28\u6570\uff08\u56e0\u4e3a\u4e0d\u5c0f\u4e8e \\(\\sqrt{n}\\) \u7684\u6570\u4e00\u5b9a\u4e0d\u6574\u9664 \\(n\\)\uff09</p> <p>\u7136\u540e\u679a\u4e3e\u4e0d\u5927\u4e8e \\(\\sqrt{ub}\\) \u7684\u8d28\u6570 \\(p\\)\uff0c\u7b5b\u53bb \\(k\\times p\\)\uff0c\\(~k\\ge 2,~k\\times p \\ge lb\\)</p> <p>\u6700\u540e\u7edf\u8ba1\u672a\u88ab\u7b5b\u7684\u6570</p> <p>\uff08warning\uff1a\u57c3\u6c0f\u7b5b \u6216\u662f \u7ebf\u6027\u7b5b \u90fd\u4e0d\u80fd\u7b5b\u6389 \\(0\\) \u548c \\(1\\)\uff0c\u5fc5\u987b\u7279\u5224\uff01\uff01\uff01\uff09</p>"},{"location":"%E5%88%B7%E9%A2%98/%E6%95%B0%E8%AE%BA/#n-q-n-n","title":"N\uff0c\u6c42 \u5c3e\u968f\u96f6\u4e3a \\(Q\\)\u4e2a \u7684 \\(n!\\) \u5bf9\u5e94\u7684\u6700\u5c0f\u7684 \\(n\\)","text":"<p>\\(n!\\) \u8d8a\u5927\uff0c\u5c3e\u968f\u96f6\u5c31\u8d8a\u5927\uff08\u5f53\u7136\u6837\u4f8b\u4e5f\u53ef\u4ee5\u7c97\u7565\u8bc1\u660e\uff09</p> <p>\\(n!\\) \u7684\u5c3e\u968f\u96f6\u7b97\u6cd5\uff1a\\(\\displaystyle min\\{\\sum\\limits_{i=1}^{\\infin}\\lfloor\\frac{n}{2^i}\\rfloor,~\\sum\\limits_{i=1}^{\\infin}\\lfloor\\frac{n}{5^i}\\rfloor\\}=\\sum\\limits_{i=1}^{\\infin}\\lfloor\\frac{n}{5^i}\\rfloor\\)</p> <p>\u7531\u4e8e\u6ee1\u8db3\u5355\u8c03\u6027\uff0c\u4e8c\u5206\u7b54\u6848\u5373\u53ef</p>"},{"location":"%E5%88%B7%E9%A2%98/%E6%95%B0%E8%AE%BA/#odisplaystylesum_i1n-1sum_ji1nij","title":"O\uff0c\\(\\displaystyle\\sum_{i=1}^{n-1}\\sum_{j=i+1}^n(i,j)\\)","text":"<p>\u8303\u56f4\uff1a\\(n\\le 4e6\\)\uff0c \\(100\\) \u7ec4\u6570\u636e</p> <p>\u53c2\u8003\u5de8\u5de8\u7684\u9898\u89e3\uff1aUVA11426 \u62ff\u884c\u674e\uff08\u6781\u9650\u7248\uff09 GCD - Extreme (II) - \u6d1b\u8c37 | \u8ba1\u7b97\u673a\u79d1\u5b66\u6559\u80b2\u65b0\u751f\u6001 (luogu.com.cn)</p> <p></p> <p>\u6b63\u786e\u63a8\u5bfc\uff1a \\(\\displaystyle \\sum_{i=1}^{n-1}\\sum_{j=i+1}^n(i,~j)=\\sum_{j=2}^n\\sum_{i=1}^{j-1}(i,~j)=\\sum_{j=2}^n(\\sum_{i=1}^{j}(i,~j) - (j,~j))\\\\=\\sum_{j=2}^n\\sum_{i=1}^j(i,~j)-\\sum_{j=2}^n j = \\sum_{j=2}^n\\sum_{d|j}\\phi_{\\frac{j}{d}}\\times d-\\frac{n\\times (n+1)}{2}+1\\)</p> <p>\u9884\u5904\u7406\u524d\u4e00\u90e8\u5206\u7684\u524d\u7f00\u548c\u5373\u53ef\uff0c\u590d\u6742\u5ea6\\(O(n\\times log_n)\\to O(1)\\)</p> <p>\uff08\u5b9e\u9645\u4e0a\u53ef\u4ee5\u7528\u7ebf\u6027\u7b5b\u4f18\u5316 \u9884\u5904\u7406\u7684\u90e8\u5206\u5230 \\(O(n)\\) \uff09\u00a0\u00a0\u00a0\u00a0</p>"},{"location":"%E5%88%B7%E9%A2%98/%E6%95%B0%E8%AE%BA/#p","title":"P\uff0c\u201d\u4ee3\u7801\u76db\u5bb4\u201c\uff08\u96be\u9898\uff09","text":"<p>\u7ed9\u5b9a\u65b9\u7a0b \\(x \\equiv a_i\\pmod{b_i},~a_i=A_{i,~j},~j=1..k_i\\)\uff0c\u6c42\u65b9\u7a0b\u7684\u524d \\(m\\) \u4e2a\u89e3</p> <p>\u60c5\u51b51\uff1a\u82e5\\(\\prod\\limits_{i=1}^n k_i\\le 1e4\\)\uff0c\u5219\u66b4\u529b\u679a\u4e3e\u6bcf\u4e00\u7ec4\u65b9\u7a0b\u7684 \\(a_i\\) \u7684\u6240\u6709\u60c5\u51b5\uff0c\u7528\u4e2d\u56fd\u5269\u4f59\u5b9a\u7406\u89e3\u51fa\u6240\u6709\u6700\u5c0f\u6b63\u6574\u6570\u89e3\uff08\\(&lt; pb\\)\uff09\uff0c\u6392\u5e8f\uff0c\u8f93\u51fa\uff08\u82e5 \\(m\\ge n\\) \u5219\uff0c\u5bf9\u6240\u6709\u6b63\u6574\u6570\u89e3\u52a0\u4e0a \\(t\\times pb,~t\\ge 1\\)\uff0c\u663e\u7136\u8fd9\u4e9b\u89e3 \\(\\ge t\\times pb\\)\uff09</p> <p>\uff08\u590d\u6742\u5ea6\uff1a\\(O(1e4\\times n)\\)\uff09</p> <pre><code>#define int long long\nint n, m;\nint a[10][100], k[10], b[10];\nint exgcd(int a, int b, int &amp;x, int &amp;y){\nif(!b) return x = 1, y = 0, a;\nint d = exgcd(b, a % b, x, y), x1 = x;\nreturn x = y, y = x1 - a / b * y, d;\n}\nint crt(int n, int a[], int b[]){\nint ans = 0, pb = 1;\nfor(int i=0; i&lt;n; ++i) pb *= b[i];\nfor(int i=0; i&lt;n; ++i){\nint b1 = pb/b[i], ib1, d = exgcd(b1, b[i], ib1, d);\nans = (ans + b1 * ib1 % pb * a[i] % pb + pb) % pb;\n}\nreturn ans;\n}\nint len, ans[10000];\nint A[10];\nvoid dfs(int u){\nif(u == n) return void(ans[len ++ ] = crt(n, A, b));\nfor(int i=0; i&lt;k[u]; ++i){\nA[u] = a[u][i];\ndfs(u + 1);\n}\n}\nvoid case1(){\nlen = 0, dfs(0);\nsort(ans, ans+len);\nint pb = 1;\nfor(int i=0; i&lt;n; ++i) pb *= b[i];\nfor(int t=0; m; ++t){\nfor(int i=0; i&lt;len; ++i){\nint x = ans[i] + t * pb;\nif(!x) continue;\n-- m, cout &lt;&lt; x &lt;&lt; '\\n';\nif(!m) return ;\n}\n}\n}\n</code></pre> <p>\u60c5\u51b52\uff1a\\(\\prod\\limits_{i=1}^n k_i &gt; 1e4\\)\uff0c\u5219\u627e\u51fa \\(min\\{\\frac{k_i}{b_i}\\}\\)\uff0c\u4ee4 \\(best=i\\) \uff0c\u53ef\u4ee5\u8bc1\u660e\uff08\uff1f\uff09 \\(A_{best,~j}\\%b_j\\) \u662f\u524d\u51e0\u4e2a\u6700\u5c0f\u6b63\u6574\u6570\u89e3\uff0c\u5bf9 \\(A_{best,~j}\\) \u6392\u5e8f\uff0c\u8f93\u51fa \\((A_{best,~j}+t\\times b_j)\\%b_j\\)\uff08\u8f93\u51fa\u524d\u9700\u8981\u5224\u65ad\u8be5\u89e3\u662f\u5426\u662f\u5176\u4ed6\u6240\u6709\u65b9\u7a0b\u7ec4\u7684\u7279\u89e3\\(A_{i,~j}\\% b_i\\) \uff0c\u5e76\u4e14\u540c\u4e00\u4e2a\u65b9\u7a0b\u7ec4\u5185\u53ea\u9700\u5b58\u5728\u4e00\u4e2a\u7279\u89e3\uff09</p> <p>\u590d\u6742\u5ea6\uff1a\\(\\ge O(m\\times n\\times \\log{k})\\)</p> <p>\uff08\u4e0d\u7528scanf\uff0cprintf\uff0c\u6570\u7ec4\u5b58 \\(A[~][~]\\) \u5fc5TLE\uff09</p> <pre><code>// n \u4e2a\u5269\u4f59\u7cfb \nvector&lt;set&lt;int&gt;&gt; mp;\nvoid case2(int best){\nmp.clear(), mp.resize(n);\nfor(int i=0; i&lt;n; ++i){\nif(i == best) continue;\nfor(int j=0; j&lt;k[i]; ++j){\nmp[i].insert(a[i][j] % b[i]);\n}\n}\nsort(a[best], a[best]+k[best]);\nfor(int t=0; m; ++t){\nfor(int j=0; j&lt;k[best]; ++j){\nint x = a[best][j] + t * b[best];\nif(!x) continue;\nbool ok = true;\nfor(int i=0; i&lt;n; ++i){\nif(i == best) continue;\nif(!mp[i].count(x % b[i])){\nok = false;\nbreak;\n}\n}\nif(ok) -- m, cout &lt;&lt; x &lt;&lt; '\\n';\nif(!m) return ;\n}\n}\n}\n</code></pre>"},{"location":"%E5%88%B7%E9%A2%98/%E6%95%B0%E8%AE%BA/#q","title":"Q\uff0c\u77e9\u9635\u7740\u8272","text":"<p>\u5bf9 \\(n\\times m\\) \u7684\u77e9\u9635\u7740\u8272 \\(k\\) \u79cd\u989c\u8272\uff0c\u8981\u6c423\u540c\u4e00\u5217\u4e2d\u4e0a\u4e0b\u4e24\u4e2a\u76f8\u90bb\u7684\u683c\u5b50\u4e0d\u540c\u8272\uff0c\u5e76\u4e14\u7ed9\u5b9a \\(b\\) \u4e2a\u4e0d\u53ef\u7740\u8272\u7684\u683c\u5b50\\((x_i,~y_i)\\)\uff0c\u5176\u65b9\u6848\u6570\u4e3a \\(r\\)</p> <p>\u5df2\u77e5 \\(m,~k,~b,~r\\)\uff0c\u548c \\((x_i,~y_i),~i=1..b\\)\uff0c\u6c42 \\(n\\) \u7684\u6700\u5c0f\u6b63\u6574\u6570\u89e3</p>"},{"location":"%E5%88%B7%E9%A2%98/%E6%95%B0%E8%AE%BA/#r","title":"R\uff0c\u9752\u86d9\uff08\u5f85\u6df1\u5165\u7814\u7a76\uff09","text":""},{"location":"%E5%88%B7%E9%A2%98/%E6%95%B0%E8%AE%BA/#s","title":"S\uff0c\u5faa\u73af","text":""},{"location":"%E5%88%B7%E9%A2%98/%E6%95%B0%E8%AE%BA/#t","title":"T\uff0c\u6590\u6ce2\u90a3\u5951\u57fa\u6570\uff08\u6a21\u62df\uff0c\u8d2a\u5fc3\uff0c\u8f93\u51fa\u683c\u5f0f\uff09","text":""},{"location":"%E5%88%B7%E9%A2%98/%E6%95%B0%E8%AE%BA/#uforce","title":"U\uff0c\u5224\u8d28\u6c34\u9898\uff08force\uff09","text":""},{"location":"%E5%88%B7%E9%A2%98/%E6%95%B0%E8%AE%BA/#vgcdforce","title":"V\uff0cgcd\uff08force\uff09","text":"<p>\u7c7b\u4f3c\u6c34\u9898</p> <p>CF1370A Maximum GCD - \u6d1b\u8c37 | \u8ba1\u7b97\u673a\u79d1\u5b66\u6559\u80b2\u65b0\u751f\u6001 (luogu.com.cn)</p>"},{"location":"%E5%88%B7%E9%A2%98/%E6%95%B0%E8%AE%BA/#wforcesuf","title":"W\uff0c\u533a\u95f4\u5224\u8d28\uff08force\uff0csuf\uff0c\u6d6e\u70b9\u9ad8\u7cbe\u5ea6\uff09","text":"<p>\uff08\u7ed3\u679c\u4e0d\u52a0 \\(1e-8\\) \u5fc5 \\(wa\\)\uff09</p>"},{"location":"%E5%88%B7%E9%A2%98/%E6%95%B0%E8%AE%BA/#x","title":"X\uff0c\u7ebf\u6027\u540c\u4f59\u65b9\u7a0b\uff08\u7537\uff09","text":"<p>\uff08\u4e0d\u540c\u7684\u53d6\u6574\u65b9\u6cd5\uff1a</p> <p>\u5411\u96f6\u53d6\u6574\uff1a\\(int(1.0\\times\\frac{x}{y}),~int(1.0\\times\\frac{x+y-1}{y})\\)</p> <p>\u5411\u8d1f\u65e0\u7a77\u53d6\u6574\uff1a\\(floor(1.0\\times\\frac{x}{y}),~ceil(1.0\\times\\frac{x}{y})\\)\uff09 </p>"},{"location":"%E5%88%B7%E9%A2%98/%E6%95%B0%E8%AE%BA/#ysumlimits_i1nsumlimits_ji1nij1","title":"Y\uff0c\\(\\sum\\limits_{i=1}^n\\sum\\limits_{j=i+1}^n[(i,~j)=1]\\)","text":"<p>\\(n\\le 1e6\\)\uff0c\u591a\u7ec4\u6570\u636e</p> <p>\\(=\\sum\\limits_{j=2}^n\\sum\\limits_{i=1}^{j-1}[(i,~j)=1] = \\sum\\limits_{j=2}^n\\phi_{j}\\)</p>"},{"location":"%E5%88%B7%E9%A2%98/%E6%95%B0%E8%AE%BA/#z-1264-1","title":"Z\uff0c\u6253\u5370 \\(1\\)~\\(2^{64}-1\\) \u4ee5\u5185\u7684\u201c\u8d85\u7ea7\u5e42\u201d","text":"<p>\u201c\u8d85\u7ea7\u5e42\u201d\u7684\u5b9a\u4e49\uff1a\\(n\\) \u81f3\u5c11\u53ef\u8868\u793a\u4e24\u79cd \\(n = m^k\\) \u6b64\u7c7b\u5f62\u5f0f</p> <p>\uff08\u7279\u6b8a\u60c5\u51b5\uff1a\u5f53 \\(n=1\\) \u65f6\uff0c\\(n\\) \u4e5f\u662f\u8d85\u7ea7\u5e42\uff09</p> <p>\u4e00\u4e2a\u6570\u4e3a\u201c\u8d85\u7ea7\u5e42\u201d\u7684\u7b49\u4ef7\u6761\u4ef6\uff1a\\(x=a^b,~a\\ge 2,~b\\ge 4,~b~is~not~prime\\) \u6216 \\(x=1\\)</p> <p>\u7531\u4e8e \\(x=a^b&lt; 2^{64}\\)\uff0c\u6240\u4ee5\u679a\u4e3e\u8fc7\u7a0b\u4e2d\u6781\u6613\u6ea2\u51fa\uff0c\u800c\u89c2\u5bdf \\(a,~b\\) \u53ef\u6709\u6548\u5730\u9632\u6b62\u6ea2\u51fa</p> <p>\u7531 \\(b\\ge 4\\implies a&lt; (2^{64})^{\\frac{1}{4}}=2^{16}\\)\uff08 \\(a\\) \u7684\u7edd\u5bf9\u4e0a\u754c\uff09</p> <p>\u800c \\(b&lt;\\log_{a}{2^{64}}\\) \uff08\\(b\\) \u7684\u7cbe\u786e\u4e0a\u754c\uff09</p> <p>\u6240\u4ee5\uff0c\\(2\\le a&lt; 2^{16},~4\\le b&lt; \\log_{a}{2^{64}},~\\) \u53ef\u7b5b\u51fa \u975e \\(1\\) \u7684\u201c\u8d85\u7ea7\u5e42\u201d\uff0c\u4f46\u9700\u8981\u53bb\u91cd</p>"},{"location":"%E5%88%B7%E9%A2%98/%E6%9C%80%E7%9F%AD%E8%B7%AF/","title":"\u6700\u77ed\u8def","text":""},{"location":"%E5%88%B7%E9%A2%98/%E6%9C%80%E7%9F%AD%E8%B7%AF/#a0-1","title":"A\uff0c0-1\u6743\u7684\u5355\u6e90\u6700\u77ed\u8def\uff08\u6709\u5411\uff09","text":""},{"location":"%E5%88%B7%E9%A2%98/%E6%9C%80%E7%9F%AD%E8%B7%AF/#b","title":"B\uff0c\u5224\u65ad\u6b63\u73af\uff1f","text":"<p>\u53ef\u4ee5\u7528 \\(floyd\\) \uff0c \\(dfs-spfa\\) \uff0c\\(bfs-spfa\\)</p> <p>\u4e0e\u7ecf\u5e38\u8bb2\u7684\u6700\u77ed\u8def\u4e0d\u540c\uff0c\u8fd9\u91cc\u6307\u6700</p> <p>\uff08\u6ce8\u610f\uff1a\u8d39\u7528\u662f \u6309\u6bd4\u4f8b\u6765\u7684\uff0c\u7c7b\u578b\u4e3a \\(double\\)\uff0c\\(f[]\\) \u4e5f\u8981\u521d\u59cb\u5316\u4e3a 0\uff0c\u6e90\u70b9\u521d\u59cb\u5316\\(f_s = 1\\)\uff09</p> <p>\\(dfs-spfa\\)</p> <pre><code>const int N = 1e5+3;\nint n, m, st[N];\ndouble f[N];\nstruct edge{ int v; double w; };\nvector&lt;vector&lt;edge&gt; &gt; e;\nbool spfa(int u){\nst[u] = true;\nfor(auto ed : e[u]){\nint v = ed.v; double w = ed.w;\nif(f[v] &lt; f[u] * w){\nf[v] = f[u] * w;\nif(st[v] || spfa(v)) return true;\n}\n}\nst[u] = false;\nreturn false;\n}\nbool super_source(){\nfor(int i=1; i&lt;=n; ++i){\nmemset(st, 0, sizeof st);\nmemset(f, 0, sizeof f);\nf[i] = 1.0;\nif(spfa(i)) return true;\n}\nreturn false;\n}\n</code></pre> <p>\\(floyd\\)</p> <pre><code>for(int k=1; k&lt;=n; ++k){\nfor(int i=1; i&lt;=n; ++i){\nfor(int j=1; j&lt;=n; ++j){\ng[i][j] = max(g[i][j], g[i][k] * g[k][j]);\n}\n}\n}\nbool ans = false;\nfor(int i=1; i&lt;=n; ++i){\nif(g[i][i] &gt; 1) ans = true;\n}\n</code></pre> <p>\uff08\u89e3\u6cd5\u5343\u5947\u767e\u602a\uff0c\u6211\u4e5f\u662f\u670d\u4e86\uff09</p>"},{"location":"%E5%88%B7%E9%A2%98/%E6%9C%80%E7%9F%AD%E8%B7%AF/#c","title":"C\uff0c","text":""},{"location":"%E5%88%B7%E9%A2%98/%E6%9C%80%E7%9F%AD%E8%B7%AF1/","title":"\u6700\u77ed\u8def1","text":""},{"location":"%E5%88%B7%E9%A2%98/%E6%9C%80%E7%9F%AD%E8%B7%AF1/#a0-1","title":"A\uff0c0-1\u6743\u7684\u5355\u6e90\u6700\u77ed\u8def\uff08\u6709\u5411\uff09","text":""},{"location":"%E5%88%B7%E9%A2%98/%E6%9C%80%E7%9F%AD%E8%B7%AF1/#b","title":"B\uff0c\u5224\u65ad\u6b63\u73af\uff1f","text":"<p>\u53ef\u4ee5\u7528 \\(floyd\\) \uff0c \\(dfs-spfa\\) \uff0c\\(bfs-spfa\\)</p> <p>\u4e0e\u7ecf\u5e38\u8bb2\u7684\u6700\u77ed\u8def\u4e0d\u540c\uff0c\u8fd9\u91cc\u6307\u6700</p> <p>\uff08\u6ce8\u610f\uff1a\u8d39\u7528\u662f \u6309\u6bd4\u4f8b\u6765\u7684\uff0c\u7c7b\u578b\u4e3a \\(double\\)\uff0c\\(f[]\\) \u4e5f\u8981\u521d\u59cb\u5316\u4e3a 0\uff0c\u6e90\u70b9\u521d\u59cb\u5316\\(f_s = 1\\)\uff09</p> <p>\\(dfs-spfa\\)</p> <pre><code>const int N = 1e5+3;\nint n, m, st[N];\ndouble f[N];\nstruct edge{ int v; double w; };\nvector&lt;vector&lt;edge&gt; &gt; e;\nbool spfa(int u){\nst[u] = true;\nfor(auto ed : e[u]){\nint v = ed.v; double w = ed.w;\nif(f[v] &lt; f[u] * w){\nf[v] = f[u] * w;\nif(st[v] || spfa(v)) return true;\n}\n}\nst[u] = false;\nreturn false;\n}\nbool super_source(){\nfor(int i=1; i&lt;=n; ++i){\nmemset(st, 0, sizeof st);\nmemset(f, 0, sizeof f);\nf[i] = 1.0;\nif(spfa(i)) return true;\n}\nreturn false;\n}\n</code></pre> <p>\\(floyd\\)</p> <pre><code>for(int k=1; k&lt;=n; ++k){\nfor(int i=1; i&lt;=n; ++i){\nfor(int j=1; j&lt;=n; ++j){\ng[i][j] = max(g[i][j], g[i][k] * g[k][j]);\n}\n}\n}\nbool ans = false;\nfor(int i=1; i&lt;=n; ++i){\nif(g[i][i] &gt; 1) ans = true;\n}\n</code></pre> <p>\uff08\u89e3\u6cd5\u5343\u5947\u767e\u602a\uff0c\u6211\u4e5f\u662f\u670d\u4e86\uff09</p>"},{"location":"%E5%88%B7%E9%A2%98/%E6%9C%80%E7%9F%AD%E8%B7%AF1/#c-1to-n-0","title":"C\uff0c\u5224\u65ad \\(1\\to n\\) \u662f\u5426\u6709\u524d\u7f00\u8def\u5f84\u548c\u5747\u5927\u4e8e0\u7684\u8def\u5f84","text":"<p>\uff08\u53ef\u80fd\u5b58\u5728\u73af\uff1b\u8be5\u9898\u5c5e\u4e8e\u6700\u957f\u8def\uff09</p> <p>\uff08\u5efa\u4e24\u4e2a\u56fe\uff1a\u77e9\u9635\u56fe\u7528\u4e8e \\(floyd\\) \u5224\u8def\u5f84\u5b58\u5728\u6027\uff0c\u90bb\u63a5\u8868\u7528\u4e8e \\(bf\u6216spfa\\) \u5224\u6b63\u73af\uff09</p> <p>1\uff09\\(s\\to t\\) \u5b58\u5728\u8def\u5f84</p> <p>2\uff09$\\forall $ \u524d\u7f00\u8def\u5f84\u548c \\(&gt; 0\\) \uff0c</p> <p>\u6216\u8005 \\(s..v\\) \u6240\u6709\u524d\u7f00\u8def\u5f84\u548c \\(&gt;0~~\\&amp;\\&amp;~~~v\\to t\\) \u5b58\u5728\u8def\u5f84 \\(\\&amp;\\&amp;~~~s\\to v\\) \u5b58\u5728\u73af</p> <pre><code>#include&lt;bits/stdc++.h&gt;\nusing namespace std;\nconst int N = 1e3+3;\n// \u90bb\u63a5\u77e9\u9635\nvector&lt;bitset&lt;N&gt; &gt; en;\nint n, m, f[N], st[N], cnt[N];\nstruct edge{ int v, w; };\nvector&lt;vector&lt;edge&gt; &gt; e;\nqueue&lt;int&gt; q;\nbool spfa(int s){\nwhile(q.size()) q.pop();\nmemset(f, 0x80, sizeof f);\nmemset(st, 0, sizeof st);\nmemset(cnt, 0, sizeof cnt);\nf[s] = 100;\nq.push(s), st[s] = true;\nwhile(q.size()){\nint u = q.front();\nq.pop(), st[u] = false;\nfor(auto ed : e[u]){\nint v = ed.v, w = ed.w;\n// \u6700\u957f\u8def \nif(f[v] &lt; f[u] + w){\nf[v] = f[u] + w;\n// \u8def\u5f84\u524d\u7f00\u548c\u4e0d\u5927\u4e8e0\uff0c\u5219\u4e0d\u8d70 v \nif(f[v] &lt;= 0) continue;\ncnt[v] = cnt[u] + 1;\n// s -&gt; v \u5b58\u5728\u6b63\u73af \nif(cnt[v] &gt;= n) return en[v][n];\nif(!st[v]) q.push(v), st[v] = true;\n}\n}\n}\n// \u65e0\u6b63\u73af\uff0c\u5224 s-&gt;n \u7684\u524d\u7f00\u8def\u5f84\u662f\u5426\u5927\u4e8e0 \nreturn f[n] &gt; 0;\n}\nvoid floyd(){\nfor(int k=1; k&lt;=n; ++k){\nfor(int i=1; i&lt;=n; ++i){\nif(en[i][k]) en[i] |= en[k];\n}\n}\n}\nsigned main(){\nwhile(cin &gt;&gt; n, ~n){\ne.clear(), e.resize(n + 1);\nen.clear(), en.resize(n + 1);\nfor(int i=1; i&lt;=n; ++i){\nint w, m, v;\ncin &gt;&gt; w &gt;&gt; m;\nfor(int j=0; j&lt;m; ++j){\ncin &gt;&gt; v;\ne[i].push_back({v, w});\nen[i][v] = true;\n}\n}\nfloyd();\ncout &lt;&lt; (en[1][n] &amp;&amp; spfa(1) ? \"winnable\" : \"hopeless\") &lt;&lt; '\\n';\n}\n}\n</code></pre>"},{"location":"%E5%88%B7%E9%A2%98/%E6%9C%80%E7%9F%AD%E8%B7%AF1/#d-s-s","title":"D\uff0c\u8ba1\u7b97 \u4eces\u5f00\u59cb\u7684\u5168\u90e8\u6700\u77ed\u8def\u5f84\u4e4b\u548c + \u4eces\u7ed3\u675f\u7684\u5168\u90e8\u6700\u77ed\u8def\u5f84\u4e4b\u548c","text":"<p>\u5efa\u7acb\u4e00\u4e2a\u6b63\u56fe\u548c\u4e00\u4e2a\u53cd\u56fe\u5206\u522b\u6c42\u6700\u77ed\u8def\uff0c\u7d2f\u8ba1\u8d21\u732e\u5373\u53ef</p> <p>\uff08 \\(spfa\\) \u7684\u590d\u6742\u5ea6\u660e\u660e\u662f \\(O(n\\times m)\\) \u5374\u80fd\u8dd1 \\(n=1e6\\) \u7684\u5c51\uff09</p>"},{"location":"%E5%88%B7%E9%A2%98/%E6%9C%80%E7%9F%AD%E8%B7%AF1/#es-t","title":"E\uff0c\\(s-&gt;t\\) \u7684\u6700\u77ed\u8def\uff0c\u5e76\u8f93\u51fa\u65b9\u6848","text":"<pre><code>#include&lt;bits/stdc++.h&gt;\nusing namespace std;\nconst int N = 1e2+3;\nint n, m, f[N], st[N], cnt[N], pre[N], idx, rec[N];\nstruct edge{ int v, w; };\nvector&lt;vector&lt;edge&gt; &gt; e;\nqueue&lt;int&gt; q;\nbool spfa(int s){\nwhile(q.size()) q.pop();\nmemset(f, 0x80, sizeof f);\nmemset(st, 0, sizeof st);\nmemset(cnt, 0, sizeof cnt);\n// 1\uff0c \nf[s] = 0, pre[s] = -1;\nq.push(s), st[s] = true;\nwhile(q.size()){\nint u = q.front();\nq.pop(), st[u] = false;\nfor(auto ed : e[u]){\nint v = ed.v, w = ed.w;\nif(f[v] &lt; f[u] + w){\nf[v] = f[u] + w;\ncnt[v] = cnt[u] + 1;\n// \u6ce8\u610f\u6709 n + 1 \u4e2a\u70b9\uff01\uff01 \nif(cnt[v] &gt;= n + 1) return true;;\n// 2\uff0c \npre[v] = u;\nif(!st[v]) q.push(v), st[v] = true;\n}\n}\n}\nreturn false;\n}\nint w[N];\nsigned main(){\nint T, TEST = 0;\ncin &gt;&gt; T;\nwhile(T--){\ncin &gt;&gt; n;\ne.clear(), e.resize(n + 2);\nfor(int i=1; i&lt;=n; ++i) cin &gt;&gt; w[i];\n// !!!!\nw[n + 1] = 0;\ncin &gt;&gt; m;\nfor(int i=0; i&lt;m; ++i){\nint u, v;\ncin &gt;&gt; u &gt;&gt; v;\ne[u].push_back({v, w[v]});\n}\nspfa(1);\nprintf(\"CASE %d#\\npoints : %d\\ncircuit : \", ++ TEST, f[n + 1]);\n// \u8f93\u51fa\u65b9\u6848 \nidx = 0;\nrec[ ++ idx] = 1;\nfor(int i=pre[n+1]; ~i; i=pre[i]) rec[ ++ idx] = i;\nfor(int i=idx; i&gt;=1; --i){\nif(i != idx) cout &lt;&lt; \"-&gt;\";\ncout &lt;&lt; rec[i];\n}\nputs(\"\");\nif(T) puts(\"\");\n}\n}\n</code></pre>"},{"location":"%E5%88%B7%E9%A2%98/%E6%9C%80%E7%9F%AD%E8%B7%AF1/#fbattle-city","title":"F\uff0c\"Battle City\"\u5766\u514b\u5927\u6218","text":"<p>\u7a20\u5bc6\u6700\u77ed\u8def\uff08\u5806\u4f18\u5316\uff09</p>"},{"location":"%E5%88%B7%E9%A2%98/%E6%9C%88%E8%B5%9B%E5%8F%8D%E6%80%9D/","title":"\u6708\u8d5b\u53cd\u601d","text":""},{"location":"%E5%88%B7%E9%A2%98/%E6%9C%88%E8%B5%9B%E5%8F%8D%E6%80%9D/#69","title":"\u725b\u5ba269","text":"<ol> <li>E/F\uff1a\u7ed9\u5b9a n \u4e2a\u4e8c\u7ef4\u5750\u6807\uff08\u4efb\u610f\u4e24\u70b9\u4e92\u4e0d\u76f8\u540c\uff09\uff0c\u8f93\u51fa\u7b49\u8170\u4e09\u89d2\u5f62\u4e2a\u6570<ul> <li>\u5224\u65ad\u4e09\u70b9\u5171\u7ebf\uff1a<ul> <li>\u5fc5\u8981\u6761\u4ef6\uff1a\\(\\frac {y_i-y_j}{x_i-x_j} = \\frac {y_i-y_k}{x_i-x_k}, x_i\\ne x_j, x_i\\ne x_k\\)</li> <li>\u5145\u8981\u6761\u4ef6\uff1a\\((x_i-x_j)(y_i-y_k) = (x_i-x_k)(y_i-y_j)\\)</li> </ul> </li> <li>\u5224\u65ad\u4e0d\u5171\u7ebf\u7684\u4e09\u70b9\u6784\u6210\u7b49\u8170\u4e09\u89d2\u5f62(\u8fb9\u5206\u522b\u4e3a a, b, c) \\(\\iff\\) \\(a=b || a=c || b==c\\) \\(\\iff\\) \\(a^2=b^2 || a^2=c^2 || b^2==c^2\\) \uff08\u82e5\u9898\u76ee\u7ed9\u51fa\u7684\u662f\u6574\u6570\u70b9\uff0c\u90a3\u4e48\u540e\u8005\u4e0d\u4f1a\u6709\u6d6e\u70b9\u7cbe\u5ea6\u95ee\u9898\uff09</li> <li>\u679a\u4e3e\u8ba1\u7b97\uff1a\\(\\sum\\limits_{i=1}^n\\sum\\limits_{j=1}^{i-1}\\sum\\limits_{k=1}^{j-1}[d_{i,j}=d_{j,k}\u6216d_{k,i}=d_{i,k}\u6216d_{k,i}=d_{i,j} ~~\\&amp;~~\u4e09\u70b9\u4e0d\u5171\u7ebf ]\\)</li> <li>\u4f18\u5316\u4e3a \\(\\sum\\limits_{i=1}^n\\sum\\limits_{j=1}^n[i\\ne j]\\sum\\limits_{k=1}^{j-1}[d_{i,j}=d_{i,k}] - \\frac 12\\sum\\limits_{i=1}^n\\sum\\limits_{j=1}^n[i\\ne j]\\sum\\limits_{k=1}^{j-1}[\\exist~ x_k=2\\cdot x_i-x_j, y_k=2\\cdot y_i-y_j]\\)</li> </ul> </li> <li>G\uff1a<code>(ax+by)^n%p</code> \u5927\u6a21\u62df</li> </ol>"},{"location":"%E5%88%B7%E9%A2%98/%E6%A0%91%E5%BD%A2dp/","title":"\u6811\u5f62dp","text":"<p>1\uff0cCWXU-\u6691\u671f\u96c6\u8bad-\u6811\u5f62dp - Virtual Judge (csgrandeur.cn)</p> <p>HDU2412 &amp;&amp; POJ3342:Party at Hali-Bula(\u6811\u5f62DP) - \u7f16\u7a0b\u730e\u4eba (programminghunter.com)</p>"},{"location":"%E5%88%B7%E9%A2%98/%E7%AD%96%E7%95%A5/","title":"\u7b56\u7565","text":""},{"location":"%E5%88%B7%E9%A2%98/%E7%AD%96%E7%95%A5/#_1","title":"\u7b56\u7565","text":"<p>vjudge \u9898\u5355</p> <ul> <li>kuangbin(\u53bb\u91cd)</li> <li>kuangbin</li> <li>\u300a\u7b97\u6cd5\u7ade\u8d5b\u300b\u9898\u5355</li> <li>cf\u96be\u5ea6\u9898(\u9898\u91cf\u5927\uff0c\u614e\u70b9)</li> <li>\u5218\u6c5d\u4f73\u7d2b\u4e66</li> <li>cf - dp</li> <li>poj\u9898\u76ee</li> <li>\u300a\u7b97\u6cd5\u7ade\u8d5b\u5165\u95e8\u5230\u8fdb\u9636\u300b \u9898\u5355</li> </ul>"},{"location":"%E5%88%B7%E9%A2%98/%E7%AE%97%E6%B3%95%E7%AB%9E%E8%B5%9B/","title":"\u7b97\u6cd5\u7ade\u8d5b","text":""},{"location":"%E5%88%B7%E9%A2%98/%E7%AE%97%E6%B3%95%E7%AB%9E%E8%B5%9B/#oi","title":"oi\u8d5b\u4e8b","text":"<p>\u4fe1\u606f\u5b66\u5965\u6797\u5339\u514b\u7ade\u8d5b\uff08Olympiad in Informatics\uff0c\u7b80\u79f0\uff1aOI\uff09\u5728\u4e2d\u5b66\u751f\u4e2d\u5e7f\u6cdb\u5f00\u5c55\u7684\u5b66\u79d1\u7ade\u8d5b\uff0c\u548c\u7269\u7406\u3001\u6570\u5b66\u7b49\u7ade\u8d5b\u6027\u8d28\u76f8\u540c\u3002OI \u8003\u5bdf\u7684\u5185\u5bb9\u662f\u53c2\u8d5b\u8005\u8fd0\u7528\u7b97\u6cd5\u3001\u6570\u636e\u7ed3\u6784\u548c\u6570\u5b66\u77e5\u8bc6\uff0c\u901a\u8fc7\u7f16\u5199\u8ba1\u7b97\u673a\u7a0b\u5e8f\u89e3\u51b3\u5b9e\u9645\u95ee\u9898\u7684\u80fd\u529b</p> <p>Oi</p> <ul> <li>\u56fd\u5185<ul> <li>\u5168\u56fd\u9752\u5c11\u5e74\u4fe1\u606f\u5b66\u5965\u6797\u5339\u514b\u8054\u8d5b\uff08NOIP\uff09</li> <li>\u5168\u56fd\u9752\u5c11\u5e74\u4fe1\u606f\u5b66\u5965\u6797\u5339\u514b\u7ade\u8d5b\uff08NOI\uff09</li> <li>\u5168\u56fd\u9752\u5c11\u5e74\u4fe1\u606f\u5b66\u5965\u6797\u5339\u514b\u7ade\u8d5b\u51ac\u4ee4\u8425\uff08WC\uff09</li> <li>\u56fd\u9645\u4fe1\u606f\u5b66\u5965\u6797\u5339\u514b\u7ade\u8d5b\u4e2d\u56fd\u961f\u9009\u62d4\u8d5b\uff08CTSC\uff09</li> </ul> </li> <li>\u56fd\u9645\u6027\uff1a<ul> <li>\u56fd\u9645\u4fe1\u606f\u5b66\u5965\u6797\u5339\u514b\uff08IOI\uff09</li> <li>\u7f8e\u56fd\u8ba1\u7b97\u673a\u5965\u6797\u5339\u514b\u7ade\u8d5b\uff08USACO\uff09</li> <li>\u65e5\u672c\u4fe1\u606f\u5b66\u5965\u6797\u5339\u514b\uff08JOI\uff09</li> <li>\u4e9a\u592a\u5730\u533a\u4fe1\u606f\u5b66\u5965\u6797\u5339\u514b\uff08APIO\uff09</li> </ul> </li> </ul> <p>\u5bf9\u4e8e\u5927\u90e8\u5206\u9009\u624b\u800c\u8a00\uff0c\u6bcf\u5e74\u7684\u65b0\u8d5b\u5b63\u4ece 10 \u6708\u7684 NOIP \u5f00\u59cb</p> <p>\u9898\u76ee\u7c7b\u578b</p> <ul> <li>\u4f20\u7edf\u9898\uff1a\u89c4\u5b9a\u8f93\u5165\u8f93\u51fa\u5230\u6587\u4ef6\u7684\u9898\u76ee</li> <li>\u975e\u4f20\u7edf\u9898\uff1a\u5982\u63d0\u4ea4\u7b54\u6848\u9898\uff0c\u4ea4\u4e92\u9898\uff0c\u8865\u5168\u4ee3\u7801</li> </ul> <p>\u8d5b\u5236</p> <ul> <li>OI<ul> <li> <ul> <li>5\u5c0f\u65f6\u89e3\u51b3\u4e09\u9053\u9898\uff1b\u4ec5\u6709\u4e00\u6b21\u63d0\u4ea4\u673a\u4f1a\uff0c\u6bd4\u8d5b\u65f6\u65e0\u6cd5\u770b\u5230\u8bc4\u6d4b\u7ed3\u679c\uff1b\u6309\u6d4b\u8bd5\u70b9\u7ed9\u5206(\u6bcf\u4e2a\u6d4b\u8bd5\u70b9\u8fd8\u53ef\u80fd\u4f1a\u6709\u90e8\u5206\u5206)</li> </ul> </li> <li>\u5982\uff1aNOIP\u3001NOI\u3001\u7701\u9009</li> </ul> </li> <li>IOI<ul> <li>\u6bd4\u8d5b\u65f6\u6709\u591a\u6b21\u63d0\u4ea4\u673a\u4f1a\uff0c\u5b9e\u65f6\u8bc4\u6d4b\u5e76\u8fd4\u56de\u7ed3\u679c\uff0c\u5982\u679c\u63d0\u4ea4\u7684\u7ed3\u679c\u662f\u9519\u8bef\u7684\uff0c\u4e0d\u4f1a\u6709\u4efb\u4f55\u60e9\u7f5a</li> <li>\u5982\uff1aAPIO\u3001IOI \u90fd\u662f IOI \u8d5b\u5236</li> </ul> </li> <li>Codeforces(CF)\u8d5b\u5236<ol> <li>\u6bd4\u8d5b\u8fc7\u7a0b\u4e2d\u53ea\u6d4b\u8bd5\u4e00\u90e8\u5206\u6570\u636e\uff08pretests\uff09\u800c\u5728\u6bd4\u8d5b\u7ed3\u675f\u540e\u8fd4\u56de\u5b8c\u6574\u7684\u6240\u6709\u6d4b\u8bd5\u70b9\u7684\u6d4b\u8bd5\u7ed3\u679c\uff08system tests\uff09<ul> <li>\u5141\u8bb8 hack \u522b\u4eba\u7684\u4ee3\u7801\uff0c\u4f46\u662f\u5728\u6b64\u4e4b\u524d\u9700\u8981\u9501\u5b9a\u81ea\u5df1\u7684\u4ee3\u7801\uff0c\u5373\u5728hack\u671f\u95f4\u65e0\u6cd5\u63d0\u4ea4\uff0c\u800c\u4e14\u503c\u5141\u8bb8\u4ee5\u56fe\u7247\u7684\u65b9\u5f0f\u67e5\u770b\u522b\u4eba\u7684\u6e90\u7801</li> </ul> </li> <li>ex ICPC\uff08extended ICPC\uff09<ul> <li>\u5728\u6bd4\u8d5b\u8fc7\u7a0b\u4e2d\u4f1a\u6d4b\u8bd5\u5168\u90e8\u6570\u636e\uff0c\u4f46\u6bd4\u8d5b\u7ed3\u675f\u4ee5\u540e\u4f1a\u6709 12 \u5c0f\u65f6\u7684\u5168\u7f51 hack \u65f6\u95f4</li> <li>Hack \u65f6\u5141\u8bb8\u5c06\u9009\u624b\u7a0b\u5e8f\u62f7\u8d1d\u5230\u672c\u5730\u8fdb\u884c\u6d4b\u8bd5</li> </ul> </li> </ol> </li> </ul>"},{"location":"%E5%88%B7%E9%A2%98/%E7%AE%97%E6%B3%95%E7%AB%9E%E8%B5%9B/#icpcccpc","title":"ICPC/CCPC\u8d5b\u4e8b","text":"<p>ICPC\uff08\u82f1\u6587\uff1aInternational Collegiate Programming Contest\uff0c\u4e2d\u6587\uff1a\u56fd\u9645\u5927\u5b66\u751f\u7a0b\u5e8f\u8bbe\u8ba1\u7ade\u8d5b\uff09\u7531 ICPC \u57fa\u91d1\u4f1a\uff08\u82f1\u6587\uff1aICPC Foundation\uff09\u4e3e\u529e\uff0c\u662f\u6700\u5177\u5f71\u54cd\u529b\u7684\u5927\u5b66\u751f\u8ba1\u7b97\u673a\u7ade\u8d5b\u3002\u7531\u4e8e\u4ee5\u524d ACM \u8d5e\u52a9\u8fd9\u4e2a\u7ade\u8d5b\uff0c\u4e5f\u6709\u5f88\u591a\u4eba\u4e60\u60ef\u53eb\u5b83 ACM \u7ade\u8d5b</p> <p>ICPC \u4e3b\u8981\u5206\u4e3a\u533a\u57df\u8d5b\uff08Regionals\uff09\u548c\u603b\u51b3\u8d5b\uff08World Finals\uff09\u4e24\u90e8\u5206</p>"},{"location":"%E5%88%B7%E9%A2%98/%E7%AE%97%E6%B3%95%E7%AB%9E%E8%B5%9B/#_1","title":"\u8d5b\u5236","text":"<ul> <li>\u4e09\u4e2a\u4eba\u7ec4\u6210\u4e00\u961f\u4f7f\u7528\u4e00\u53f0\u673a\u5668\uff0c\u5728\u6bd4\u8d5b\u65f6\u6709\u591a\u6b21\u63d0\u4ea4\u673a\u4f1a\u3002</li> <li>\u6bd4\u8d5b\u5b9e\u65f6\u8bc4\u6d4b\u5e76\u8fd4\u56de\u7ed3\u679c\uff0c\u5982\u679c\u63d0\u4ea4\u7684\u7ed3\u679c\u9519\u8bef\u4f1a\u6709 20 \u5206\u949f\u7684\u7f5a\u65f6\uff0c\u9519\u8bef\u6b21\u6570\u8d8a\u591a\uff0c\u52a0\u7f5a\u7684\u65f6\u95f4\u4e5f\u8d8a\u957f\u3002</li> <li>\u6bcf\u4e2a\u9898\u76ee\u53ea\u6709\u5728\u6240\u6709\u6570\u636e\u70b9\u5168\u90e8\u6b63\u786e\u540e\u624d\u80fd\u5f97\u5230\u5206\u6570\u3002</li> <li>\u6bd4\u8d5b\u6392\u540d\u6839\u636e\u505a\u9898\u6570\u6765\u8bc4\u5224\uff0c\u505a\u9898\u6570\u76f8\u540c\u7684\uff0c\u6839\u636e\u603b\u7528\u65f6\u6765\u8bc4\u5224\u3002\u603b\u7528\u65f6\u662f\u6bcf\u9898\u7528\u65f6\u7684\u548c\u3002\u6bcf\u9898\u7684\u7528\u65f6\u662f\u4ece\u6bd4\u8d5b\u5f00\u59cb\u5230\u505a\u51fa\u8be5\u9898\u7684\u5206\u949f\u6570\u4e0e\u8be5\u9898\u7684\u7f5a\u65f6\u4e4b\u548c \\(\\sum\\limits_{i=1}^n time_i \\times w_i\\)</li> </ul>"},{"location":"%E5%88%B7%E9%A2%98/%E7%AE%97%E6%B3%95%E7%AB%9E%E8%B5%9B/#_2","title":"\u65f6\u95f4","text":"<ul> <li>ICPC/CCPC \u7f51\u7edc\u8d5b\uff088 \u6708\u5e95\u81f3 9 \u6708\u521d\uff09</li> <li>ICPC/CCPC \u533a\u57df\u8d5b\uff089 \u6708\u5e95\u81f3 11 \u6708\u5e95\uff09</li> <li>ICPC EC Final/CCPC Final\uff0812 \u6708\u4e2d\u65ec\uff09</li> <li>ICPC World Finals\uff08\u6b21\u5e74 4 \u6708\u81f3 6 \u6708\uff09</li> </ul>"},{"location":"%E5%88%B7%E9%A2%98/%E7%AE%97%E6%B3%95%E7%AB%9E%E8%B5%9B/#_3","title":"\u8bad\u7ec3\u6307\u5357","text":"<ul> <li>hdu oj \u8bad\u7ec3\u8d5b - <code>Multi-University Training Contest</code>\uff0c\u6709\u5956\u91d1\uff0c\u9898\u76ee\u8d28\u91cf\u9ad8\uff0c\u5386\u7ecf\u591a\u5e74\u79ef\u7d2f\u5df2\u6709\u4e30\u5bcc\u8d44\u6e90 </li> <li>vjudge - \u7f51\u7ad9\u7684\u539f\u7406\u662f\u722c\u866b\uff0c\u722c\u53d6\u4e86\u51e0\u4e4e\u5168\u7f51\u7684\u7ade\u8d5b\u7f51\u7ad9\uff0c\u5f53\u7136\u4e5f\u5305\u62ec\u5927\u91cf\u7684\u9898\u76ee</li> <li>\u8bad\u7ec3\u8425<ul> <li>\u5bd2\u5047\u7684\u65f6\u5019\u5934\u6761/\u6e05\u534e/CCPC (Wannafly Camp) \u4e3e\u529e\u7684 Camp</li> <li>Wannafly Camp</li> </ul> </li> </ul>"},{"location":"%E5%88%B7%E9%A2%98/%E7%AE%97%E6%B3%95%E7%AB%9E%E8%B5%9B/#_4","title":"\u9898\u578b","text":"<p>\u53c2\u8003</p>"},{"location":"%E5%88%B7%E9%A2%98/%E7%AE%97%E6%B3%95%E7%AB%9E%E8%B5%9B/#_5","title":"\u8bad\u7ec3\u8d44\u6e90","text":"<p>\u53c2\u8003</p>"},{"location":"%E5%88%B7%E9%A2%98/%E7%AE%97%E6%B3%95%E7%AB%9E%E8%B5%9B/#_6","title":"\u8bad\u7ec3\u7684\u601d\u8def","text":"<p>\u8bad\u7ec3\u601d\u8def</p> <ol> <li>\u5237\u9898\u5355</li> <li>\u82e5\u9898\u5355\u6d89\u53ca\u7684\u7b97\u6cd5\u4e0d\u592a\u80fd\u61c2 \u6216 \u60f3\u4e0d\u7740\u5934\u8111\uff0c\u6709\u51e0\u79cd\u5efa\u8bae\uff1a<ul> <li>\u53c2\u8003\u7f51\u4e0a\u7684\u8d44\u6599\u5b66\u4e60\uff1a\u7f3a\u70b9\u662f\u6709\u4e9b\u8d44\u6e90\u53c2\u5dee\u4e0d\u9f50\uff0c\u6d45\u5c1d\u8f84\u6b62\uff0c\u4f46\u4e0d\u4e4f\u67d0\u4e9b\u8bb2\u7684\u8f83\u4e3a\u4f18\u79c0 \u6216 \u603b\u7ed3\u5730\u6bd4\u8f83\u5168\u9762\u7684\u535a\u5ba2\uff0c\u66f4\u4e3a\u91cd\u8981\u7684\u662f\u7f51\u4e0a\u68c0\u7d22\u8d44\u6e90\u6781\u6613\u4e8e\u53d1\u6563\u5b66\u4e60\u67d0\u4e9b\u65b0\u7b97\u6cd5\u7684\u9014\u5f84\uff1b\u4f46\u6700\u4e3a\u5173\u952e\u7684\u662f\uff0c\u7f51\u4e0a\u5b66\u4e60\u662f\u5927\u591a\u6570 acmer \u5b66\u4e60\u7b97\u6cd5\u7684\u4e3b\u8981\u65b9\u5f0f</li> <li>\u53c2\u8003\u4e66\u7c4d</li> </ul> </li> <li>\u505a\u8bb0\u5f55\uff1a\u8bb0\u5f55\u5f53\u524d\u6b63\u5728\u5b66\u7684\uff0c\u6ca1\u5f04\u660e\u767d\u7684\uff0c\u4ee5\u53ca\u6807\u8bb0\u5c06\u6765\u6253\u7b97\u6df1\u5165\u5b66\u4e60\u7684\u7b97\u6cd5\uff0c\u5305\u62ec \u5bf9\u7b97\u6cd5\u8f83\u4e3a\u76f4\u89c2\u7684\u81ea\u7136\u8bed\u8a00\u63cf\u8ff0 \u6216\u8005 \u5c06\u524d\u8005\u6df1\u5316\u4e3a\u8f83\u4e3a\u4e25\u683c\u7684\u8bc1\u660e\u8fc7\u7a0b<ul> <li>\u505a\u8bb0\u5f55\u7684\u8fc7\u7a0b\u4e0d\u4ec5\u9650\u4e8e \u624b\u5199\u7b14\u8bb0(\u4e0d\u63a8\u8350) \u6216 pc\u7aef\u8f6f\u4ef6(\u5982 \u601d\u7ef4\u5bfc\u56fe)\uff0c \u501f\u52a9\u535a\u5ba2 cnblog / csdn / \u4e2a\u4eba\u535a\u5ba2\u7f51\u7ad9</li> <li>\u5173\u4e8e\u8349\u7a3f\uff1a\u6570\u5b66\u516c\u5f0f</li> <li>\u7ea6\u5b9a<ul> <li>\u5408\u9002\u7684\u7b26\u53f7\uff1a\u4f7f\u7528\u5408\u9002\u7684\uff0c\u4fbf\u4e8e\u8bb0\u5fc6\u7684\u7b26\u53f7\u8bb0\u5f55\u7b97\u6cd5\u8fc7\u7a0b\uff08\u6ca1\u5fc5\u8981\u4e00\u6b21\u6027\u8bb0\u4f4f\u6240\u6709\u7b26\u53f7\uff09</li> <li>\u7b97\u6cd5\u5b9e\u73b0\u7684\u63cf\u8ff0\u5c3d\u91cf\u7528\u4f2a\u4ee3\u7801\uff0c\u5207\u5fcc\u5927\u91cf\u7c98\u8d34\u6e90\u4ee3\u7801\uff08\u5982\u5934\u6587\u4ef6\uff0c\u4e3b\u51fd\u6570\uff0c\u4e0e\u5173\u952e\u4ee3\u7801\u6beb\u65e0\u76f8\u5173\u7684\u51fd\u6570\u7b49\uff09</li> </ul> </li> </ul> </li> <li>\u53c2\u52a0\u6bd4\u8d5b\uff1a\u81ea\u5b9a\u4e49\u4e2a\u4eba\u6bd4\u8d5b(vjudge) \u6216 \u5468\u671f\u6027\u6bd4\u8d5b</li> <li>\u591a\u5b9e\u8df5(\u5237\u9898)\uff0c\u591a\u505a\u8bb0\u5f55(\u7b14\u8bb0)\uff0c\u7136\u540e\u518d\u53bb\u5b9e\u8df5\uff0c\u518d\u8bb0\u5f55\uff0c\u518d\u5b9e\u8df5(\u5237\u9898 / \u6bd4\u8d5b)</li> </ol> <p>\u6ce8\u610f</p> <p>\u5f53\u7136\u7f51\u7edc\u8d44\u6599\u53c2\u5dee\u4e0d\u9f50\u5bfc\u81f4\u67d0\u4e9b\u8f83\u504f\u4f46\u6709\u5f88\u6709\u7528\u7684\u7b97\u6cd5\u8f83\u96be\u638c\u63e1\uff1b\u9762\u5bf9\u8fd9\u6837\u7684\u5904\u5883\u5e38\u89c1\u7684\u6709\u4e24\u79cd\u505a\u6cd5\uff1a\u4e0d\u65ad\u8bb0\u5f55\u96f6\u6563\u7684\u77e5\u8bc6\uff0c\u4e0d\u65ad\u63a8\u7406\u603b\u7ed3\u4e3a\u81ea\u5df1\u80fd\u591f\u7406\u89e3\u7684\u5f62\u5f0f(\u76f4\u89c2\u7684\u81ea\u7136\u8bed\u8a00\u63cf\u8ff0 \u6216 \u56fe\u8868/\u52a8\u56fe \u6216 \u6570\u5b66\u516c\u5f0f)\uff1b\u53e6\u4e00\u79cd\u662f</p> <p>\u8f85\u52a9\u5de5\u5177</p> <ul> <li>\u6807\u8bb0\u8bed\u8a00\uff1amarkdown\uff0cLaTex\uff0cmermaid\uff0cMathJax</li> <li>\u6587\u6863\u6846\u67b6\uff1amkdocs</li> <li>\u601d\u7ef4\u5bfc\u56fe\uff1axmind</li> <li>\u56fe\u5e8a\u8f85\u52a9\uff1asharex</li> <li>\u7f16\u8f91\u5668\uff1adev\uff0cnotepad\uff0cmarkdownpad 2\uff0ctypora</li> <li>\u6570\u5b66\u7f51\u7ad9\uff1a</li> <li>\u7535\u5b50\u4e66\u8d44\u6e90\uff1azlib</li> <li>\u5176\u4ed6\uff1agithub\uff0cscreenToGif</li> </ul>"},{"location":"%E5%88%B7%E9%A2%98/%E7%AE%97%E6%B3%95%E7%AB%9E%E8%B5%9B/#-","title":"- \u6ce8\u91cd\u6570\u5b66\u601d\u7ef4","text":""},{"location":"%E5%88%B7%E9%A2%98/%E7%AE%97%E6%B3%95%E7%AB%9E%E8%B5%9B/#_7","title":"\u6280\u5de7","text":"<p>Note</p> <ul> <li>\u5b8f\u5b9a\u4e49</li> <li>\u8bfb\u5165\u3001\u8f93\u51fa\u4f18\u5316</li> </ul> <p>\u5206\u6bb5\u6253\u8868</p> <p>\u5e38\u89c1\u9519\u8bef</p> <p>\u5e38\u89c1\u6280\u5de7</p>"},{"location":"%E5%88%B7%E9%A2%98/%E7%AE%97%E6%B3%95%E7%AB%9E%E8%B5%9B/#_8","title":"\u51fa\u9898","text":""},{"location":"%E5%88%B7%E9%A2%98/%E7%AE%97%E6%B3%95%E7%AB%9E%E8%B5%9B/#_9","title":"\u9020\u6570\u636e","text":"<ul> <li><code>&lt;random&gt;</code>\uff1a<code>std::mt19937</code><ul> <li><code>srand()</code>\uff1a\u968f\u673a\u6570\u64ad\u79cd\uff0c\u5982 <code>srand(time(0))</code> (\u9700\u8981<code>&lt;ctime&gt;</code> \u5934)</li> <li><code>std::mt19937 rnd(&lt;seed&gt;)</code>\uff1a\u57fa\u4e8e 32 \u4f4d\u6885\u68ee\u7f20\u7ed5\u5668\uff0c\u7528\u4e8e\u6784\u9020 32 \u4f4d\u65e0\u7b26\u53f7\u6570\uff08\u662f\u4e00\u4e2a\u51fd\u6570\u6307\u9488\uff1f\uff09<ul> <li>seed \u53ef\u4ee5\u662f <code>time(0)</code></li> <li>\u8c03\u7528\u65b9\u6cd5\uff0c\u5982\uff1a<code>rnd()</code></li> </ul> </li> <li><code>std::mt19937_64 rnd_64(&lt;seed&gt;)</code>\uff1a\u7528\u4e8e\u6784\u9020 64 \u4f4d\u65e0\u7b26\u53f7\u6570</li> <li><code>minstd_rand0()</code>\uff1a\u57fa\u4e8e\u7ebf\u6027\u540c\u4f59\u7b97\u6cd5\uff0c\u5373 \\(s_i \\equiv s_{i-1}\\cdot A + C \\pmod {M}\\)\uff08A\uff0cC\uff0cM \u4e3a\u9884\u5b9a\u4e49\u5e38\u6570\uff09<ul> <li>\u5bf9\u4e8e <code>minstd_rand0()</code>\uff0cs \u7684\u7c7b\u578b\u53d6 32 \u4f4d\u65e0\u7b26\u53f7\u6574\u6570\uff0cA \u53d6 16807\uff0cC \u53d6 0\uff0cM \u53d6 2147483647</li> <li><code>minstd_rand()</code>\uff1as \u7684\u7c7b\u578b\u53d6 32 \u4f4d\u65e0\u7b26\u53f7\u6574\u6570\uff0cA \u53d6 48271\uff0cC \u53d6 0\uff0cM \u53d6 2147483647</li> </ul> </li> <li><code>random_device</code>\uff1a\u4e00\u4e2a\u57fa\u4e8e\u786c\u4ef6\u7684\u5747\u5300\u5206\u5e03\u968f\u673a\u6570\u751f\u6210\u5668\uff0c\u5728\u71b5\u6c60\u8017\u5c3d \u524d\u53ef\u4ee5\u9ad8\u901f\u751f\u6210\u968f\u673a\u6570<ul> <li>\u7531\u4e8e\u71b5\u6c60\u8017\u5c3d\u540e\u6027\u80fd\u6025\u5267\u4e0b\u964d\uff0c\u6240\u4ee5\u5efa\u8bae\u7528\u6b64\u65b9\u6cd5\u751f\u6210 mt19937 \u7b49\u4f2a\u968f\u673a\u6570\u7684\u79cd\u5b50\uff0c\u800c\u4e0d\u662f\u76f4\u63a5\u751f\u6210</li> <li>\u5982\uff1a<code>random_device rd</code>\uff0c\u7136\u540e <code>mt19937 rnd(rd())</code></li> </ul> </li> <li><code>uniform_int_distribution&lt;int&gt;</code>\uff1a\u5747\u5300\u5206\u5e03\u6574\u6570<ul> <li>\u5982 <code>uniform_int_distribution&lt;int&gt; r(0, 9)</code>\uff1a\u6bcf\u6b21\u53ea\u8f93\u51fa 0 \u6216 9 \u5176\u4e2d\u4e4b\u4e00\uff0c\u5e76\u4e14\u5747\u5300\u5206\u5e03</li> <li>\u5176\u4ed6\u5206\u5e03\u8be6\u89c1\u201c\u968f\u673a\u6570\u5206\u5e03\u201d</li> </ul> </li> </ul> </li> <li><code>&lt;algorithm&gt;</code>\uff1a<ul> <li><code>random_shuffle(&lt;left&gt;, &lt;right&gt;, &lt;rand&gt;)</code>\uff1a\u968f\u673a\u6253\u4e71\u6307\u5b9a\u5e8f\u5217<ul> <li><code>rand()</code>\u4e3a\u9ed8\u8ba4\u7684\u968f\u673a\u6570\u751f\u6210\u5668\uff0c\u5f53\u7136\u4e5f\u53ef\u4ee5\u81ea\u5b9a\u4e49\u968f\u673a\u6570\u751f\u6210\u5668</li> <li>\u968f\u673a\u6027\uff1a<code>random_shuffle</code>\u5728\u6240\u6709\u53ef\u80fd\u7684\u6392\u5217\u4e2d \u7b49\u6982\u7387 \u968f\u673a\u9009\u53d6\uff0c\u4f46 GCC4\u7f16\u8bd1\u5668 \u5e76\u672a \u4e25\u683c\u6267\u884c</li> <li><code>c++14</code> \u4e2d\u88ab\u5f03\u7528\uff0c <code>c++17</code>\u4e2d\u88ab\u79fb\u9664</li> </ul> </li> <li><code>shuffle(&lt;left&gt;, &lt;right&gt;, &lt;\u968f\u673a\u51fd\u6570\u6307\u9488\uff1f&gt;)</code>\uff1a\u6548\u7528\u540c <code>random_shuffle</code><ul> <li>\u5fc5\u987b\u4f7f\u7528\u81ea\u5b9a\u4e49\u7684\u968f\u673a\u6570\u751f\u6210\u5668</li> </ul> </li> </ul> </li> </ul>"},{"location":"%E5%88%B7%E9%A2%98/%E7%AE%97%E6%B3%95%E7%AB%9E%E8%B5%9B/#_10","title":"\u603b\u7ed3","text":"<ul> <li>\u5982\u679c\u6709\u4efb\u4f55\u60f3\u6cd5\uff0c\u53ef\u4ee5\u53d1\u90ae\u7bb1\u544a\u8bc9\u6211</li> <li>\u4ee5\u4e0a\u5173\u4e8e\u7b97\u6cd5\u7ade\u8d5b\u7684\u5185\u5bb9\u4ec5\u4ee3\u8868\u6211\u7684\u4e2a\u4eba\u601d\u8003\u548c\u603b\u7ed3\uff0c\u5e76\u4e0d\u4ee3\u8868\u7edd\u5bf9\u6b63\u786e\uff0c\u4efb\u4f55\u4eba\u90fd\u5177\u6709\u601d\u8003\u548c\u6000\u7591\u7684\u6743\u5229\uff0c\u5982\u679c\u53d1\u73b0\u4efb\u4f55\u9519\u8bef\u6b22\u8fce\u6307\u51fa</li> <li>\u6253\u7b97\u6cd5\u7ade\u8d5b\u662f\u4e00\u4e2a\u5f88\u70e7\u8111\u7684\u8fc7\u7a0b\uff0c\u540c\u65f6\u4f60\u4e5f\u4f1a\u611f\u53d7\u5230\u65f6\u95f4\u6d41\u901d\u5730\u5f02\u5e38\u5feb\uff08\u53ef\u80fd\u81ea\u5df1\u611f\u89c9\u624d\u521a\u4ece\u4e0d\u4f1a\u5230\u4e0d\u592a\u8fde\u8d2f\u5730\u5b9e\u73b0\u67d0\u4e2a\u7b97\u6cd5\uff0c\u518d\u56de\u8fc7\u5934\u81ea\u5df1\u5df2\u7ecf\u5b66\u4e86\u5c06\u8fd1\u534a\u4e2a\u6708\u5374\u5bf9\u8fd9\u4e2a\u7b97\u6cd5\u4e00\u77e5\u534a\u89e3\uff0c\u8fc7\u6bb5\u65f6\u95f4\u518d\u9047\u5230\u540c\u6837\u7684\u9898\u8fd8\u662f\u4e0d\u4f1a\uff09</li> <li>\u5408\u7406\u6743\u8861\u5b66\u4e60\u65f6\u95f4</li> </ul> <p>\u2014\u2014\u6076\u81ed\u5c0f\u5b50</p> <p>\u7591\u95ee</p> <ul> <li>\u7f51\u4e0a\u8bb2\u5230\u7684\u7b97\u6cd5\u8bc1\u660e\u96be\u4ee5\u7406\u89e3\u600e\u4e48\u529e\uff1f<ul> <li>\u65e0\u6cd5\u7406\u89e3\u8bc1\u660e\u8fc7\u7a0b\u7684\u539f\u56e0\u53ef\u80fd\u6709\u5f88\u591a\uff0c\u8fd9\u91cc\u53ef\u4ee5\u5217\u4e3e\u51e0\u4e2a\u65b9\u9762\u7684\u539f\u56e0\uff1a\u4f5c\u8005\u672c\u8eab\u7684\u7406\u89e3\u4e0d\u8fc7\u6df1\u523b\uff0c\u6587\u7ae0\u8bb0\u53f7\u7f3a\u4e4f\u5408\u7406\u6027\uff0c\u6587\u7ae0\u4ece\u4e00\u79cd \u201c\u53cd\u4eba\u7c7b\u201d \u7684\u65b9\u5f0f\u5f15\u5bfc\u8bfb\u8005\u601d\u8003\uff08   \u5148\u7b80\u5355\u63cf\u8ff0\u81ea\u5df1\u7684\u7406\u89e3\uff0c\u629b\u51fa\u5b9a\u7406\u6216\u7ed3\u8bba\uff0c\u7136\u540e\u7ed9\u51fa\u8bc1\u660e\u8fc7\u7a0b\uff0c\u6700\u540e\u7ed9\u51fa\u4f8b\u9898\uff09\uff0c\u6211\u4eec\u7684\u7406\u89e3\u6c34\u5e73\u4e0d\u591f \u6216 \u6b20\u7f3a\u67d0\u4e9b\u7684\u6570\u7406\u903b\u8f91\u80fd\u529b</li> <li>\u89e3\u51b3\u65b9\u6848\uff1a</li> </ul> </li> <li>\u4e3a\u4ec0\u4e48\u770b\u5b8c\u7f51\u4e0a\u70b9\u8d5e\u6570\u90a3\u4e48\u591a\u7684\u535a\u5ba2\u611f\u89c9\u53c8\u6ca1\u5b66\u5230\u4ec0\u4e48<ul> <li>\u6d41\u91cf\u6709\u4e00\u5b9a\u7684\u8ff7\u60d1\u6027\uff0c\u6d41\u91cf\u4e0d\u4e00\u5b9a\u597d\uff0c\u6d41\u91cf\u591a\u53ef\u80fd\u610f\u5473\u7740\u6587\u7ae0\u7684\u8bed\u8a00\u6709\u8da3\u5473 \u6216 \u8bfb\u8005\u5bb9\u6613\u76f4\u89c2\u7684\u7406\u89e3\u6587\u7ae0\u8868\u8fbe\u7684\u5185\u6db5\uff08\u76f4\u89c2\u5e76\u4e0d\u610f\u5473\u7740\u7406\u6027\uff09</li> </ul> </li> </ul>"},{"location":"%E5%88%B7%E9%A2%98/%E7%AE%97%E6%B3%95%E7%AB%9E%E8%B5%9B/#_11","title":"\u53c2\u8003","text":""},{"location":"%E5%88%B7%E9%A2%98/%E7%BA%BF%E6%80%A7dp/","title":"\u7ebf\u6027dp","text":"<p>1\u3001CWXU-\u6691\u671f\u96c6\u8bad-\u7ebf\u6027dp\uff08\u5e94\u7528\uff09 - Virtual Judge (csgrandeur.cn)</p> <pre><code>for(int i=1; i&lt;=n; ++i) scanf(\"%s\", a[i] + 1);\nint ans = 1;\nfor(int i=1; i&lt;=n; ++i){\nfor(int j=n; j&gt;=1; --j){\nf[i][j] = 1;\nif(i == 1 || j == n) continue;\nfor(int s = 1; s &lt;= f[i-1][j+1]; ++ s)\nif(a[i - s][j] == a[i][j + s]) ++ f[i][j];\nelse break;\nans = ans &gt; f[i][j] ? ans : f[i][j];\n}\n}\ncout &lt;&lt; ans &lt;&lt; '\\n';\n</code></pre> <p>6\u3001CWXU-\u6691\u671f\u96c6\u8bad-\u7ebf\u6027dp\uff08\u5e94\u7528\uff09 - Virtual Judge (csgrandeur.cn)</p> <p>\u5206\u6790\uff1a\\(a[]\u3001b[]\\)\u5747\u4e3a\u5355\u5c04\u51fd\u6570\uff0c\u6c42lcs</p> <p>\u6570\u636e\uff1a\\(n=6e4\\)</p> <p>\u590d\u6742\u5ea6\uff1a\\(O(N\\times logN)\\)</p> <pre><code>#include&lt;iostream&gt;\n#include&lt;algorithm&gt;\nusing namespace std;\nconst int N = 250*250+3;\nint a[N], b[N];\nint f[N];\nint main(){\nint T, TEST = 0;\ncin &gt;&gt; T;\nwhile(T--){\nint n, p, q;\ncin &gt;&gt; n &gt;&gt; p &gt;&gt; q;\nfor(int i=1, x; i&lt;=p+1; ++i) cin &gt;&gt; x, a[x] = i;\nfor(int i=1, x; i&lt;=q+1; ++i) cin &gt;&gt; x, b[i] = a[x];\nint ans = 0;\nfor(int i=1; i&lt;=q+1; ++i){\nif(!b[i]) continue;\nif(b[i] &gt; f[ans]) f[++ ans] = b[i];\nelse *lower_bound(f + 1, f + ans + 1, b[i]) = b[i];\n}\nprintf(\"Case %d: %d\\n\", ++TEST, ans);\n}\n}\n</code></pre> <p>\uff08\u535a\u5ba2\uff1a(5\u6761\u6d88\u606f) uva 10635 - Prince and Princess_GAUSS_CLB\u7684\u535a\u5ba2-CSDN\u535a\u5ba2\uff0cUVA10635 Prince and Princess - \u6d1b\u8c37 | \u8ba1\u7b97\u673a\u79d1\u5b66\u6559\u80b2\u65b0\u751f\u6001 (luogu.com.cn)\uff09</p> <p>7\u3001CWXU-\u6691\u671f\u96c6\u8bad-\u7ebf\u6027dp\uff08\u5e94\u7528\uff09 - Virtual Judge (csgrandeur.cn)</p> <p>\u5206\u6790\uff1a\u7ed9\u5b9an\u4e2a\u5b57\u7b26\u4e32\u6700\u5927\u5faa\u73af\u5b57\u7b26\u4e32\u957f\u5ea6\\(max\\{\\sum\\limits_{i\\in~ans}{ans_i.length}\\}\\)\uff08\\(ans[]\\)\u4e3a\u8fd9\u5b57\u7b26\u4e32\u6570\u7ec4\u7684\u5b50\u6570\u7ec4\u5e8f\u5217\uff0c\u5176\u4e2d\\(ans_i.end == ans_{i+1}.begin\\)\uff0c\\(ans_1.begin == ans_m.end\\)\uff09</p> <pre><code>#include&lt;iostream&gt;\n#include&lt;cstring&gt;\nusing namespace std;\nconst int N = 5e5+3;\nint n;\nchar s[13];\nint f[26][26];\nint main(){\ncin &gt;&gt; n;\nfor(int i=1; i&lt;=n; ++i){\nscanf(\"%s\", s + 1);\nint len = strlen(s + 1), lb = s[1] - 'a', ub = s[len] - 'a';\nfor(int j=0; j&lt;26; ++j)\nif(f[j][lb]) f[j][ub] = max(f[j][ub], f[j][lb] + len);    f[lb][ub] = max(f[lb][ub], len);\n}\nint ans = 0;\nfor(int i=0; i&lt;26; ++i) ans = max(ans, f[i][i]);\ncout &lt;&lt; ans &lt;&lt; '\\n';\n}\n</code></pre>"},{"location":"%E5%88%B7%E9%A2%98/%E8%83%8C%E5%8C%85dp/","title":"\u80cc\u5305dp","text":"<p>1\u3001CWXU-\u6691\u5047\u96c6\u8bad-\u80cc\u5305DP - Virtual Judge (csgrandeur.cn)</p> <p>\\(\\sum\\limits_{i=1}^m w_i \\le W_{max}, max\\{ \\ 1-\\prod\\limits_{i=1}^m(1-g_i) \\} \\implies min\\{ \\prod\\limits_{i=1}^m(1-g_i) \\}\\)</p> <p>2\u3001CWXU-\u6691\u5047\u96c6\u8bad-\u80cc\u5305DP - Virtual Judge (csgrandeur.cn)</p> <p>\u9898\u610f\uff1a\u4e0d\u8d85\u8fc7\u88ab\u6293\u6982\u7387\u7684\u60c5\u51b5\u4e0b\uff0c\u6240\u83b7\u53d6\u7684\u6700\u5927\u4ef7\u503c</p> <p>\u5206\u6790\uff1a\\(\\prod\\limits_{i=1}^m(1-w_i)\\ge 1-W_{max},~ max\\{ \\sum\\limits_{i=1}^m g_i \\}  \\\\   \\implies \\sum\\limits_{i=1}^m g_i \\le G_{max},~ max\\{ \\prod\\limits_{i=1}^m(1-w_i) \\}\\)</p> <p>3\u3001</p> <p>6\u3001CWXU-\u6691\u5047\u96c6\u8bad-\u80cc\u5305DP - Virtual Judge (csgrandeur.cn)</p> <p>\u6269\u5c55\u57df</p> <p>7\u3001CWXU-\u6691\u5047\u96c6\u8bad-\u80cc\u5305DP - Virtual Judge (csgrandeur.cn)</p> <p>\u6269\u5c55\u57df\uff0c\u591a\u91cd+\u5b8c\u5168</p> <p>8\u3001CWXU-\u6691\u5047\u96c6\u8bad-\u80cc\u5305DP - Virtual Judge (csgrandeur.cn)</p> <p>\u9006\u5411\u601d\u7ef4\uff0c\u8d2a\u5fc3</p>"},{"location":"%E5%88%B7%E9%A2%98/%E9%A2%98%E7%9B%AE%E6%A8%A1%E5%9E%8B/","title":"\u9898\u76ee\u6a21\u578b","text":""},{"location":"%E5%88%B7%E9%A2%98/%E9%A2%98%E7%9B%AE%E6%A8%A1%E5%9E%8B/#_1","title":"\u9898\u76ee\u6a21\u578b","text":"<p>idea</p> <ul> <li>\u8ba1\u7b97 1..n \u4ee5\u5185 lowbit \u64cd\u4f5c\u6784\u6210\u591a\u5c11\u6761\u8fb9\uff1f<ul> <li>\u53ef\u4ee5\u8bc1\u660e \\(1..2^n\\) \u4ee5\u5185\u6709 \\(2^{n+1} - \\frac {n(n+3)}2 - 2 + n = 2^{n+1} - \\frac {n(n+1)}2 - 2\\) \u6761\u8fb9\uff0c\u8fd9\u662f\u9519\u8bef\u7684\u7684</li> </ul> </li> <li>\u73c2\u6735\u8389\u6811</li> <li>Slope Trick\uff0cwqs \u4e8c\u5206</li> <li>\u6811\u5206\u6cbb</li> </ul> <p>\u5fcc\u8bb3</p> <ol> <li>\u6ca1\u8bfb\u5165\u5b8c\u6210\u5c31\u8f93\u51fa</li> </ol> <p>\u8d44\u6e90</p> <ul> <li>Algorithms for Competitive Programming\uff1a\u4e00\u4e2agithub\u9879\u76ee\uff0c\u7c7b\u4f3c\u4e8eoi-wiki</li> </ul>"},{"location":"%E5%88%B7%E9%A2%98/%E9%A2%98%E7%9B%AE%E6%A8%A1%E5%9E%8B/#_2","title":"\u4e8c\u5206","text":"<p>\u7406\u8bba</p> <ul> <li>\u82e5\u533a\u95f4\u4e24\u8fb9\u6ee1\u8db3\u5bf9\u7acb\u7684\u6761\u4ef6\uff0c\u90a3\u4e48\u53ef\u4ee5\u4e8c\u5206\u67e5\u627e\u6761\u4ef6\u4e4b\u95f4\u7684\u4e34\u754c\u70b9</li> <li> <p>\u6574\u6570\u6a21\u677f\uff08\u6ce8\u610f\u9519\u8bef\u5904\u7406\uff1blow-1 \u7528\u4e8e\u9519\u8bef\u5904\u7406\uff0c\u5f53\u7136 ok \u4e5f\u53ef\u4ee5\u5904\u7406\uff1b\u5982\u679c\u5047\u8bbe\u9519\u4e86\uff0c\u5219\u4f1a\u8fd4\u56de x=l \uff01\uff01\uff01\uff09     \u67e5\u627e\u89e3\u533a\u95f4\u7684\u5de6\u7aef\u70b9-1\uff0c\u5373 x<pre><code>int x, ok = false;\nfor(int l=low-1, r=up; x=l+r&gt;&gt;1, l+1&lt;r; ){\n    // int fx = ...\n    // ok |= fx is satisfied\n    if(\u5047\u8bbe x \u5728\u5de6\u8fb9) l = x;\n    else r = x;\n}\n// \u5982\u679c\u5c06 l=x \u6539\u6210 l=x+1\uff0cl+1&lt;r \u6539\u6210 l&lt;r\uff0c\u53ef\u80fd\u66f4\u52a0\u6b63\u786e\uff1f\n</code></pre></p> \u67e5\u627e\u89e3\u533a\u95f4\u7684\u53f3\u7aef\u70b9\uff0c\u5373 x-1<pre><code>int x, ok = false;\nfor(int l=low-1, r=up; x=l+r&gt;&gt;1, l+1&lt;r; ){\n    // int fx = ...\n    // ok |= fx is satisfied\n    if(\u5047\u8bbe x \u5728\u5de6\u8fb9 \u6216 \u6ee1\u8db3\u6761\u4ef6) l = x;\n    else r = x;\n}\n</code></pre> </li> <li> <p>\u6ce8\u610f\uff1a\u6d6e\u70b9\u6570\u6c42\u89e3\u533a\u95f4\u53f3\u7aef\u70b9\uff0c\u5219\u8fd4\u56de r\uff1b\u7cbe\u5ea6\u5e94\u8be5\u6bd4\u9898\u76ee\u5c11\u4e00\u4e2a\u6570\u91cf\u7ea7\uff1b\u8f93\u51fa\u65f6\u5e94\u9632\u6b62\u56db\u820d\u4e94\u5165 \uff08\u7531\u4e8e\u6d6e\u70b9\u6570\u4e0d\u80fd\u76f4\u63a5\u5411\u4e0b\u53d6\u6574\uff0c\u6240\u4ee5\u5f88\u591a\u884c\u4e3a\u548c\u6574\u6570\u4e0d\u540c\uff09</p> </li> </ul> <p>\u9898\u76ee</p> <ul> <li>A\uff1a \\(\\sum\\limits_{i=1}^n (h_i + a_i\\cdot x)[h_i + a_i\\cdot x\\ge L] == s, \\min\\{ x \\}\\)</li> <li>B\uff1a \u7ed9\u5b9a \\(n\\times m\\)(\\(le 500\\)) char \u77e9\u9635\uff0c\u627e\u51fa\u6ee1\u8db3\u91cd\u590d\u4e0d\u5c0f\u4e8e m(m=2)\u6b21\u7684\u65b9\u9635 (\u77e9\u5f62)\uff0c\u8f93\u51fa\u6700\u5927\u7684\u65b9\u9635\u8fb9\u957f<ul> <li>\u8003\u8651\u66b4\u529b\uff1a\u679a\u4e3e\u7ed9\u4e2a\u70b9\uff0c\u518d\u679a\u4e3e\u8fb9\u957f\uff0c\u7136\u540e\u5c06\u679a\u4e3e\u5230\u7684\u65b9\u9635\u653e\u5165map\u4e2d\u8fdb\u884c\u6bd4\u8f83\uff0c\u603b\u590d\u6742\u5ea6\u662f \\(O(n^3\\cdot \u65b9\u9635\u7684\u5904\u7406&amp;map)\\)</li> <li>\u53ef\u4ee5\u53d1\u73b0\u5149\u662f\u679a\u4e3e\u77e9\u9635\u5c31\u5f88\u5403\u529b\uff0c\u8003\u8651\u4f18\u5316\uff1a<ol> <li>\u6ce8\u610f\u5230 \u65b9\u9635\u8fb9\u957f \u548c \u8be5\u65b9\u9635\u91cd\u590d\u7684\u6b21\u6570 \u6210\u53cd\u6bd4\uff1a\u8003\u8651 \u201c\u5411\u5de6\u903c\u8fd1\u201d \u7684\u4e8c\u5206\uff08\u53d6\u89e3\u533a\u95f4\u7684\u53f3\u8fb9\u754c\uff09\uff0c\u6b64\u65f6 \\(O(n)\\to O(\\log n)\\)</li> <li>\u4f7f\u7528 \u54c8\u5e0c \u5904\u7406\u65b9\u9635\u7684\u6bd4\u8f83\u95ee\u9898\uff1a<ul> <li>\u89c4\u5b9a x \u548c y \u4e3a \"\u54c8\u5e0c\u7cfb\u6570\"\uff0c\u503c\u5206\u522b\u4e3a 3\uff0c7 \uff08\u5747\u662f\u8d28\u6570\uff09\uff1b\u8fd9\u4e9b\u6570\u5b9a\u4e49\u5728\u975e\u8d1f\u6574\u6570\u57df\u4e0a</li> <li>\u5b9a\u4e49\uff1a\\(P_{n,m} = P_{n, m-1}\\cdot y + a_{n, m} \\iff P_{n,m} = \\sum\\limits_{j=1}^m y^{m-j} a_{n, j}\\)</li> <li>\u4e8c\u7ef4\u54c8\u5e0c\u524d\u7f00\uff1a\\(Q_{n,m} = Q_{n-1, m}\\cdot x + P_{n, m} \\iff Q_{n,m} = \\sum\\limits_{i=1}^n x^{n-i} P_{i, m} = \\sum\\limits_{i=1}^n x^{n-i} \\sum\\limits_{j=1}^m y^{m-j} a_{i, j}\\)</li> <li>\u5e42\u7ea7\u6570\uff1a\\(X_n = X_{n-1} * x \\iff X_n = x^n\\)\uff0c\\(Y_n = Y_{n-1} * y \\iff Y_n = y^n\\)</li> <li>\u957f\u5ea6\u4e3a \\(a \\cdot b\\) \u7684\u5b50\u77e9\u9635\u7684\u54c8\u5e0c\u503c\uff1a \\(hash = P_{i, j} - P_{i-a+1, j} \\cdot X_{a-1} - P_{i, j-b+1}\\cdot Y_{b-1} + P_{i-a+1, j-b+1}\\cdot X_{a-1} \\cdot Y_{b-1}\\)<ul> <li>\u53c8\u6216\u8005\uff0c\u201c\u5de6\u5f00\u53f3\u95ed\u77e9\u9635\u201d\uff1a\u957f\u5ea6\u4e3a \\((a-1) \\cdot (b-1)\\) \u7684\u5b50\u77e9\u9635\u7684\u54c8\u5e0c\u503c\uff1a \\(hash = P_{i, j} - P_{i-a, j} \\cdot X_{a} - P_{i, j-b}\\cdot Y_{b} + P_{i-a, j-b}\\cdot X_{a} \\cdot Y_{b}\\)</li> </ul> </li> </ul> </li> </ol> </li> </ul> </li> </ul> <p>vjudge</p> <ul> <li>A\uff1a</li> <li>B</li> <li>C</li> <li>E\uff1a \\(\\max\\{ 100\\cdot \\frac {\\displaystyle \\sum\\limits_{i=1}^n a_i\\cdot c_i} {\\displaystyle \\sum\\limits_{i=1}^n b_i \\cdot c_i} \\}, c_i=0..1, \\sum c_i \\ge k\\), \u9690\u542b\u6761\u4ef6\uff1a\\(\\frac {a_i}{b_i}\\)<ul> <li>\u9700\u8981\u6700\u5927\u5316\u7684\u662f\u4e00\u4e2a\u5206\u6570\uff0c\u8bbe\u4efb\u610f\u4e00\u4e2a\u89e3 x \u6ee1\u8db3\uff1a \\(x \\le \\max\\{ {\\sum\\limits_{i=1}^n a_i\\cdot c_i} {\\sum\\limits_{i=1}^n b_i \\cdot c_i} \\} \\}\\) \uff08\u5148\u5ffd\u7565\u7cfb\u6570 100\uff09</li> <li>\u5c06\u4e0d\u7b49\u5f0f\u5316\u7b80\uff1a \\(\\sum\\limits_{i=1}^n (a_i - b_i\\cdot x)c_i \\ge 0\\) (\\(b_i \\ge 0\\)) \uff08\u8fd9\u91cc\u5ffd\u7565\u6389\u7b26\u53f7 max\uff0c\u5373\u6211\u4eec\u5047\u8bbe\u65b9\u6848 \\(\\{  c_i \\}\\) \u662f\u6700\u4f18\u65b9\u6848\uff09</li> <li>\u4e8c\u5206\u7b56\u7565\uff1a\u7531\u4e8e x \u548c \u7b49\u5f0f\u5de6\u8fb9 \u7684\u5173\u7cfb\u662f\u5355\u8c03\u4e0d\u589e\u7684\uff0c\u6240\u4ee5\u4e8c\u5206\u7b54\u6848 x</li> <li>\u5982\u4f55\u6c42 \u7b49\u5f0f\u5de6\u8fb9\uff1f\u5bf9\u4e0d\u7b49\u5f0f\u5de6\u8fb9\u6392\u5e8f\uff0c\u7136\u540e\u8d2a\u5fc3\u53d6\u6700\u5927 k \u4e2a\u503c\u8ba1\u7b97\u8d21\u732e\u5373\u53ef\uff08\u4e0d\u80fd\u9009\u591a\u4e8e k \u4e2a\u7269\u54c1\uff0c\u56e0\u4e3a\u9690\u542b\u6761\u4ef6\u6697\u793a\u53d6\u5f97\u66f4\u591a\u4e0d\u4f1a\u4f7f\u7b54\u6848\u66f4\u4f18\uff09</li> </ul> </li> <li>F\uff1a\\(\\max\\{ \\frac {\\displaystyle \\sum\\limits_{i=1}^n a_i\\cdot c_i} {\\displaystyle \\sum\\limits_{i=1}^n b_i \\cdot c_i} \\}, c_i=0..1, \\sum c_i == k\\)\uff0c\u6c42\u6700\u503c\u7684\u65b9\u6848\uff08k \u4e2a\u7269\u54c1\u7684 id\uff09<ul> <li>\u4e0e G \u7c7b\u4f3c</li> <li>\u6ce8\u610f\uff1a\u6392\u5e8f\u8d2a\u5fc3\u4e4b\u524d\uff0c\u5e94\u8be5\u8bb0\u5f55\u6bcf\u4e2a\u7269\u54c1\u7684 id</li> </ul> </li> <li>G\uff1a\\(\\sum\\limits_{i=1}^n\\sum\\limits_{j=1}^{i-1} [|a_i-a_j| \\le x] \\ge \\lceil \\frac {C_n^2}{2} \\rceil\\)\uff0c\u6c42 x \uff08\u5373 \u5e8f\u5217 \\(\\{ a_n \\}\\) \u4e2d \\(C_n^2\\) \u4e2a\u6570\u5bf9\u7684\u5dee\u503c\u6784\u6210\u7684\u96c6\u5408\u4e2d\uff0cx \u4e3a\u5b83\u4eec\u7684\u4e2d\u4f4d\u6570\uff09<ul> <li>\u6211\u4eec\u4e8c\u5206 x \uff0c\u6c42\u4e0d\u7b49\u5f0f\u5de6\u8fb9 (\u53ef\u4ee5\u89c2\u5bdf\u5230 x \u4e0e \u4e0d\u7b49\u5f0f\u5de6\u8fb9 \u662f\u5355\u8c03\u9012\u589e\u7684)</li> <li>\u8ba1\u7b97\u4e0d\u7b49\u5f0f\u5de6\u8fb9\uff1a\u6ce8\u610f\u5230\u5e8f\u5217 a[ ] \u7684\u524d\u540e\u987a\u5e8f\u4e0d\u4f1a\u5f71\u54cd\u7ed3\u679c\uff0c\u5bf9\u5176\u6392\u5e8f\u540e\u4e0d\u7b49\u5f0f\u5de6\u8fb9<ul> <li>\u4e00\u79cd\u65b9\u6cd5\u662f\u679a\u4e3e i\uff0clower_bound \u627e\u5230 \\(a_i-x\\) \u7684\u5de6\u8fb9\u754c low\uff0c\u6ee1\u8db3\u6761\u4ef6\u7684\u6570\u5bf9\u4e3a \\(i-low\\) \u4e2a\uff08\u7b49\u4ef7\u7684\u65b9\u6cd5\uff1aupper_bound \u627e\u5230 \\(a_i+x\\) \u7684\u53f3\u8fb9\u754c\u53f3\u4fa7 up\uff0c\u6ee1\u8db3\u6761\u4ef6\u7684\u6570\u5bf9\u4e3a \\(up-i-1\\) \u4e2a\uff09</li> <li>\u53e6\u4e00\u79cd\u65b9\u6cd5\uff1a\u6811\u72b6\u6570\u7ec4\uff08\u540c\u6837\u662f \\(n\\log n\\) \u7684\u590d\u6742\u5ea6\uff09</li> </ul> </li> </ul> </li> <li>H\uff1a\\(\\sum\\limits_{i=1}^n \\sum\\limits_{j=1}^n [a_{i, j} \\le x] &lt; m, a_{i, j} = i^2 + j^2 + 10^5(i-j) + i\\cdot j\\)<ul> <li>\u4e8c\u5206 x\uff0c\u679a\u4e3e j\uff0c\u518d \u4e8c\u5206 i</li> </ul> </li> </ul>"},{"location":"%E5%88%B7%E9%A2%98/%E9%A2%98%E7%9B%AE%E6%A8%A1%E5%9E%8B/#disjoint-set-union","title":"\u5e76\u67e5\u96c6(Disjoint Set Union)","text":"<p>Disjoint Set Union \u610f\u601d\u662f \u201c\u4e0d\u76f8\u4ea4\u96c6\u5408\u5408\u5e76\u201d</p> <p>\u7406\u8bba\uff1a</p> <ul> <li>\u7ef4\u62a4\u7684\u5c5e\u6027\uff1a<ul> <li>\u4f9d\u8d56\u5c5e\u6027\uff1a\uff08\u4f9d\u8d56\u4e8e\u7236\u8282\u70b9\u7684\u5c5e\u6027\uff09<ul> <li>ts[ ]\uff1a\u5e76\u67e5\u96c6\u7684\u57fa\u672c\u4fe1\u606f\uff0c\u5b58\u50a8 id=x \u7684\u7ed3\u70b9\u7684\u76f4\u63a5\u7236\u4eb2 \\(f_x\\) \uff08\\(f_x\\) \u4e0e \u6839\u7ed3\u70b9 \\(root_x\\) \u6709\u65f6\u5019\u5e76\u4e0d\u7b49\u4ef7\uff0c\u5982\u8def\u5f84\u538b\u7f29\u65f6\uff09</li> <li>w[ ]\uff1a\u5f53\u524d\u7ed3\u70b9\u5230\u6839\u7684\u8fd0\u7b97\u5173\u7cfb (\u6216 \u6743\u503c)<ul> <li>\u652f\u6301\u7684\u8fd0\u7b97\u6ee1\u8db3 \u53ef\u5dee\u5206 \u6027\u8d28\uff1a\u5982\uff1a\u52a0(+)\uff0c\u6a21 p \u7684\u52a0\u6cd5\u7fa4(+, %)</li> </ul> </li> </ul> </li> <li>\u513f\u5b50\u5c5e\u6027\uff1a\u4ec5\u6709\u6839\u7ed3\u70b9\u5177\u6709\u6b64\u5c5e\u6027\uff08\u4e5f\u53ef\u4ee5\u7ef4\u62a4\u6839\u7ed3\u70b9\u81ea\u5df1\u7684\u4fe1\u606f\uff09<ul> <li>size[ ]\uff1a\u5e76\u67e5\u96c6\u7ed3\u70b9\u6570\u91cf</li> <li>sum[ ]\uff1a\u5e76\u67e5\u96c6\u67d0\u79cd\u8fd0\u7b97\u7684\u7d2f\u52a0\u8d21\u732e </li> </ul> </li> </ul> </li> <li>\u57fa\u672c\u64cd\u4f5c\uff1a<ul> <li>\u67e5\u8be2\u6839\u7ed3\u70b9 \\(rt(x)\\)\uff1a\u5f53 \\(x=root_x\\) \u65f6\u8fd4\u56de x\uff0c\u5426\u5219\u9012\u5f52\u5f97\u5230 \\(f_x\\) \u7684\u6839\u7ed3\u70b9 \\(r_x\\)\uff0c\u5c06 \\(r_x\\) \u8d4b\u503c\u4e3a x \u7684\u7236\u8282\u70b9\uff0c\u66ff\u4ee3\u539f\u6709\u7684 \\(f_x\\) \u5373 \u8def\u5f84\u538b\u7f29\uff0c\u4f46\u662f\u4f1a\u7834\u574f\u5e76\u67e5\u96c6\u7684\u6811\u72b6\u7ed3\u6784)<ul> <li>\u5728\u8def\u5f84\u538b\u7f29\u4e4b\u524d\uff1a\u5e94\u8be5\u66f4\u65b0 x \u7684\u4f9d\u8d56\u5c5e\u6027(\u5982\uff1a\\(w_x = w_x \\circ w_{f_x}\\))</li> </ul> </li> <li>\u5408\u5e76\u4e24\u4e2a\u7ed3\u70b9 \\(unite(x, y[, val])\\)\uff1a\u67e5\u8be2 x \u548c y \u7684\u6839\u7ed3\u70b9 \\(r_x\\) \u548c \\(r_y\\)\uff0c\u4e24\u4e2a\u7ed3\u70b9\u540c\u5c5e\u4e00\u4e2a\u96c6\u5408\u5219\u65e0\u9700\u64cd\u4f5c\uff0c\u5426\u5219\u5c06 \\(r_x\\) \u63d2\u5165\u5230 \\(r_y\\) \u4e0a (\\(ts_{r_x} = r_y\\))<ul> <li>\u5728\u5408\u5e76\u4e4b\u540e\uff1a\u5e94\u8be5\u66f4\u65b0 \\(r_x\\) \u4f9d\u8d56\u5c5e\u6027 \uff08\u5982\uff1a\\(w_{r_x} = val \\circ w_y \\circ^{-1} w_x\\)\uff09 \u548c \\(r_y\\) \u7684\u513f\u5b50\u5c5e\u6027</li> </ul> </li> <li>\u9700\u8981\u6269\u5c55\u57df\u7684\u64cd\u4f5c\uff1a\uff08\u591a\u5f00\u4e24\u500d\u7684\u7ed3\u70b9\uff0c\u6bcf\u4e2a\u7ed3\u70b9 i \u7684\u4fe1\u606f\u5b58\u50a8\u5728\u7ed3\u70b9 i+n \u4e2d\uff0c\u5e76\u4e14\u521d\u59cb\u65f6\u7ed3\u70b9 i \u6307\u5411 i+n\uff0ci+n \u6210\u81ea\u73af\uff09<ul> <li>\u5220\u9664\u7ed3\u70b9 \\(delete(x)\\)\uff1a\\(ts_x = x\\)\uff0c\u6b64\u5916\u8fd8\u9700\u8981\u66f4\u65b0 \\(r_x\\) \u7684\u513f\u5b50\u5c5e\u6027\uff08\u5982\uff1a\\(size_{r_x} -= 1\\)\uff09</li> <li>\u79fb\u52a8\u7ed3\u70b9 \\(move(x, y)\\)\uff1a\u67e5\u8be2 x \u548c y \u7684\u6839\u7ed3\u70b9 \\(r_x\\) \u548c \\(r_y\\)\uff0c\u4e24\u4e2a\u7ed3\u70b9\u540c\u5c5e\u4e00\u4e2a\u96c6\u5408\u5219\u65e0\u9700\u64cd\u4f5c\uff0c\u5426\u5219\u5c06 \\(x\\) \u63d2\u5165\u5230 \\(r_y\\) \u4e0a (\\(ts_x = r_y\\))<ul> <li>\u6b64\u5916\u8fd8\u9700\u8981\u66f4\u65b0 \\(x\\) \u4f9d\u8d56\u5c5e\u6027 \u548c \\(r_x\\) / \\(r_y\\) \u7684\u513f\u5b50\u5c5e\u6027</li> </ul> </li> </ul> </li> </ul> </li> <li>\u7279\u6b8a\u64cd\u4f5c<ul> <li>\u5220\u9664\u7ed3\u70b9&amp;&amp;\u5173\u8054\u7684\u8fb9\uff1a\u9006\u5411\u5efa\u7acb \u5220\u9664\u4e86\u6240\u6709\u53ef\u5220\u9664\u7684\u7ed3\u70b9\uff08\u53ca\u5176 \u5173\u8054\u7684\u8fb9\uff09\u540e\u7684 \u5e76\u67e5\u96c6\u68ee\u6797\uff0c\u4ece\u540e\u5f80\u524d\u64cd\u4f5c\uff0c\u6b64\u65f6 \u5220\u70b9 \u5c31\u7b49\u4ef7\u4e8e \u6dfb\u52a0\u591a\u6761\u8fb9\uff0c\u9006\u5411\u8f93\u51fa\u67e5\u8be2\u7684\u7b54\u6848\u5373\u53ef  <ul> <li>\u5efa\u7acb\u6700\u7ec8\u72b6\u6001\u7684\u68ee\u6797\uff1a\u7528\u54c8\u5e0c\u6570\u7ec4\u6807\u8bb0\u5df2\u5220\u9664\u7684\u7ed3\u70b9\uff0c\u5efa\u56fe\u65f6\u7ed5\u8fc7\u4e0e\u8be5\u70b9\u6709\u5173\u7684\u8fb9</li> </ul> </li> <li>\u5220\u9664\u8fb9\uff1a\u540c\u6837\u662f\u9006\u5411\u5efa\u56fe\uff0c\u4ece\u540e\u5f80\u524d\u64cd\u4f5c<ul> <li>\u5efa\u7acb\u6700\u7ec8\u72b6\u6001\u7684\u68ee\u6797\uff1a\u7528 <code>vetor&lt;set&lt;int&gt;&gt;</code> \u5efa\u65e0\u5411\u56fe\uff0c\u4ee5\u65b9\u4fbf\u5220\u8fb9</li> </ul> </li> </ul> </li> <li>\u5e94\u7528\uff1a<ul> <li>\u7ef4\u62a4\u5177\u6709\u67d0\u4e9b\u76f8\u540c\u6027\u8d28\u7684\u7ed3\u70b9\u7684\u96c6\u5408</li> <li>\u7ef4\u62a4\u5e76\u67e5\u96c6\u6570\u91cf</li> <li>\u5e26\u6743\u5e76\u67e5\u96c6\u7684\u5e94\u7528\uff1a<ul> <li>\u63d2\u5165 / \u7ef4\u62a4 \u7ed3\u70b9\u4e4b\u95f4\u7684\u5173\u7cfb\uff1a(\u5047\u8bbe\u5c06 x \u6240\u5728\u96c6\u5408\u5408\u5e76\u5230 y \u6240\u5728\u7684\u96c6\u5408\u4e0a) \\(w_x \\circ w_{r_x} = val \\circ w_y\\) \\(\\implies\\) \\(w_{r_x} = val \\circ w_y \\circ^{-1} w_x\\)</li> <li>\u67e5\u8be2\u7ed3\u70b9\u4e4b\u95f4\u7684\u5173\u7cfb\uff1a\\(w_x \\circ^{-1} w_y\\)</li> <li>\u5224\u65ad\u67d0\u4e9b\u7ed3\u70b9\u5173\u7cfb\u7684 \u7edd\u5bf9\u975e\u6cd5\u6027\uff1a\u4e24\u4e2a\u7ed3\u70b9\u7684\u5173\u7cfb\u7edd\u5bf9\u975e\u6cd5 \\(\\iff\\) \\(root_x == root_y~~\\)  &amp;  \\(~~w_x \\circ^{-1} w_y \\ne \u65ad\u8a00\u7684\u6743\u503c\u5173\u7cfb\\) \uff08\u5b9e\u9645\u4e0a \u6bcf\u4e2a\u5e76\u67e5\u96c6\u90fd\u662f\u4e00\u68f5\u6811\uff0c\u5373\u5e76\u67e5\u96c6\u5185\u7684\u4efb\u4f55\u4e24\u4e2a\u5143\u7d20\u90fd\u4e0d\u6784\u6210\u73af\uff09</li> </ul> </li> <li>\u7ef4\u62a4\u5e8f\u5217\u8fde\u7eed\u533a\u95f4\uff08\u5982\uff1a\u7ef4\u62a4\u4ee5\u5de6\u7aef\u70b9\u4e3a\u6839\u7684\u533a\u95f4\uff0c\u5b9a\u4e49 \u6839\u7ed3\u70b9\u4e0a\u7684\u70b9\u53ef\u7528(\u4ec5\u5f53\u6839\u7ed3\u70b9\u5408\u6cd5)\uff0c\u800c\u6839\u7ed3\u70b9\u6709\u6bb5\u7684\u70b9\u4e0d\u53ef\u7528\uff09</li> <li>\u7ef4\u62a4\u96c6\u5408\u6700\u4f18\u70b9\uff1a\u5408\u5e76\u7ed3\u70b9\u65f6\u4ee5\u66f4\u4f18\u7684\u7ed3\u70b9\u4f5c\u4e3a\u6839</li> </ul> </li> <li>\u6ce8\u610f\uff1a<ul> <li>\u79bb\u6563\u5316\uff1a\u5305\u62ec\u4e00\u4e9b id \u672a\u4ee5 1..n \u7f16\u53f7\u7684\u60c5\u51b5\uff0c\u6216\u8005 \u7ef4\u62a4\u503c\u57df\u8f83\u957f\u76841\u7ef4\u5750\u6807</li> <li>\u521d\u59cb\u5316\uff1a\u5305\u62ec\u7ef4\u62a4\u533a\u95f4\u65f6\u5e94\u8be5\u5f00\u5230 id=n+1 \u5904</li> </ul> </li> </ul> <p>\u6d1b\u8c37</p> <ul> <li>A\uff1a\u7ed9\u5b9a\u591a\u4e2a\u53d8\u91cf\u7684 \u76f8\u7b49 / \u4e0d\u7b49 \u5173\u7cfb\uff0c\u5224\u65ad\u662f\u5426\u6ca1\u6709\u7edd\u5bf9\u7684\u903b\u8f91\u9519\u8bef<ul> <li>\u5176\u4e2d \u76f8\u7b49\u7684\u53d8\u91cf \u53ef\u4ee5\u89c6\u4f5c \u5177\u6709\u540c\u4e00\u5173\u7cfb \u7684\u96c6\u5408\uff0c\u800c\u4e0d\u540c\u96c6\u5408\u4e4b\u95f4\u53ef\u80fd \u5177\u6709\u540c\u4e00\u5173\u7cfb \u6216 \u76f8\u53cd\u5173\u7cfb</li> <li>\u6211\u4eec\u4e00\u6b21\u6027\u5c06\u5177\u6709\u540c\u7b49\u5173\u7cfb\u7684\u7ed3\u70b9\u5408\u5e76\u4e3a\u591a\u4e2a\u96c6\u5408\uff0c\u82e5\u67d0\u4e2a\u4e0d\u7b49\u5173\u7cfb\u4e24\u8fb9\u7684\u53d8\u91cf\u540c\u5c5e\u4e8e\u4e00\u4e2a\u96c6\u5408\uff0c\u7531\u4e8e\u8fdd\u53cd\u4e86\u5b9a\u4e49\uff0c\u6240\u4ee5\u8fd9\u79cd\u903b\u8f91\u6709\u7edd\u5bf9\u9519\u8bef</li> </ul> </li> <li>B\uff1a\u7ed9\u5b9a\u4e00\u5f20\u56fe\uff0c\u5220\u9664 k \u4e2a\u70b9\uff0c\u8f93\u51fa\u5220\u9664\u524d\u540e\u7684\u8fde\u901a\u5757\u6570\u91cf<ul> <li>\u5e76\u67e5\u96c6\u4e0d\u652f\u6301 (\u6709\u4f9d\u8d56\u7684)\u5220\u9664\u64cd\u4f5c\uff0c\u5373\u5220\u9664\u4e00\u4e2a\u70b9\u4e0d\u4f1a\u5f71\u54cd\u5176\u4ed6\u513f\u5b50\u5206\u88c2\u6210\u65b0\u7684\u8fde\u901a\u5757\uff0c\u800c\u53ea\u4f1a\u5f71\u54cd\u7236\u4eb2\u7684\u8d21\u732e</li> <li>\u4f46\u6211\u4eec\u53ef\u4ee5 \u4ece\u540e\u5f80\u524d \u6dfb\u52a0\u7ed3\u70b9 &amp; \u521b\u5efa\u76f8\u5173\u7684\u5408\u6cd5\u8fb9\uff0c\u5e76\u7edf\u8ba1\u8fde\u901a\u5757\u6570\u91cf</li> <li>\u6b64\u524d\uff0c\u6211\u4eec\u5e94\u8be5\u521b\u5efa\u4e00\u5f20\u56fe\uff0c\u8bb0\u5f55\u70b9\u548c\u8fb9\u7684\u5173\u7cfb \u53ca\u5176 \u5408\u6cd5\u6027</li> </ul> </li> <li>C\uff1a\u7ed9\u5b9a\u957f\u5ea6\u4e3a 3 \u7684\u5faa\u73af\u5173\u7cfb\uff0c\u4e3b\u8981\u95ee\u9898\u662f \u5904\u7406\u6bcf\u4e00\u5bf9\u903b\u8f91\u5173\u7cfb \u548c \u7d2f\u52a0\u7edd\u5bf9\u903b\u8f91\u9519\u8bef\u7684\u6570\u91cf<ol> <li>\\(root_x == root_y\\)\uff1ax \u548c y \u6709\u5177\u6709\u4e00\u5b9a\u7684\u8054\u7cfb\uff0c\u5373 \\(R_{x,y} = (w_x - w_y) \\% 3, R = 0..2\\)\uff0c\u82e5 \\(R=0\\) \u8868\u793a x \u548c y \u7b49\u4ef7\u7ed3\u70b9\uff0c\u5426\u5219\u6839\u636e\u9898\u610f\u8d4b\u4e88\u542b\u4e49\uff1b\u6b64\u65f6\u5fc5\u7136\u53ef\u4ee5\u5224\u65ad x \u548c y \u7684\u5173\u7cfb\u662f\u5426\u7b26\u5408\u7edd\u5bf9\u903b\u8f91</li> <li>\\(root_x \\ne root_y\\)\uff1ax \u548c y \u6ca1\u6709\u5fc5\u7136\u903b\u8f91\u5173\u7cfb\uff0c\u6211\u4eec\u9009\u62e9\u5408\u5e76\u4e24\u79cd\u5173\u7cfb\u6240\u5c5e\u7684\u96c6\u5408</li> </ol> </li> <li>D\uff1a</li> </ul> <p>vjudge</p> <ul> <li>A\uff1a</li> <li>B\uff1a</li> <li>C\uff1a</li> <li>D\uff1a\u7ef4\u62a4\u4e00\u7ef4\u6570\u7ec4\u7684\u4e00\u7ec4\u8fde\u7eed\u533a\u95f4 \\([l_i, r_i]\\) \u7684\u548c(+)\uff0c\u5e76\u5224\u65ad\u4e00\u4e2a\u533a\u95f4\u548c\u662f\u5426 \u7edd\u5bf9\u975e\u6cd5<ul> <li>\u8003\u8651\u5e76\u67e5\u96c6\u7ef4\u62a4\u95ed\u533a\u95f4\uff0c\u6ce8\u610f\u5230\u4efb\u610f\u4e24\u4e2a \u7ed3\u70b9 \u90fd\u80fd\u76f4\u63a5\u7ef4\u62a4\u4e00\u6bb5 \u95ed\u533a\u95f4 \\([l_i, r_i]\\)\uff0c\u4f46\u662f\u5355\u4e2a\u7ed3\u70b9\u7684\u521d\u503c\u662f\u4e0d\u786e\u5b9a\u7684\uff08\u5373 \\([i, i]\\) \u7684\u533a\u95f4\u548c\u672a\u5b9a\u4e49\uff09</li> <li>\u82e5\u6211\u4eec\u7ef4\u62a4\u7ef4\u62a4\u5f00\u533a\u95f4\uff0c\\([l_i, r_i+1)\\) \u548c \\([i, i)\\) \u5374\u53ef\u4ee5\u65b9\u4fbf\u5730\u7ef4\u62a4\uff0c\u5176\u4e2d\u540e\u8005\u7684\u521d\u59cb\u5316\u4e3a \u52a0\u6cd5\u8fd0\u7b97\u7684\u5355\u4f4d\u5143(0) \u5373\u53ef</li> <li>\u6839\u636e\u5e76\u67e5\u96c6\u7684\u6027\u8d28\uff0c\u4ec5\u5f53 \\(root_x == root_y\\) \u65f6\u53ef\u4ee5\u5224\u65ad\u533a\u95f4\u548c\u662f\u5426 \u7edd\u5bf9\u975e\u6cd5</li> </ul> </li> <li>E\uff1a</li> <li>F\uff1a\u7ed9\u5b9a n \u4e2a\u65ad\u8a00\uff0c\u597d\u4eba\u548c\u574f\u4eba\u7684\u6570\u91cf p\uff0cq\uff1b\u6bcf\u4e2a\u65ad\u8a00\u5f62\u5982\uff1a\u201cx \u8bf4 y \u662f \u597d\u4eba(yes) / \u574f\u4eba(no)\u201d\uff08\u597d\u4eba\u53ea\u8bf4\u771f\u8bdd\uff0c\u574f\u4eba\u53ea\u8bf4\u5047\u8bdd\uff1b\u4fdd\u8bc1\u6240\u6709\u65ad\u8a00\u90fd\u4e0d\u77db\u76fe\uff09\uff1b\u95ee\u662f\u5426\u6709\u552f\u4e00\u7684\u89e3\u786e\u5b9a\u8c01\u662f\u597d\u4eba\u8c01\u662f\u574f\u4eba\uff0c\u65b9\u6848\u552f\u4e00\u5219\u8f93\u51fa\u597d\u4ebaid         1.  \u679a\u4e3e\u6240\u67092*2=4\u79cd\u65ad\u8a00\u53ef\u4ee5\u53d1\u73b0\u6027\u8d28\uff1a\u201cx y yes\u201d \u8868\u793a x \u548c y \u662f\u201c\u540c\u7c7b\u201d\uff0c\u201cx y no\u201d \u8868\u793a x \u548c y \u662f\u5f02\u7c7b\uff1b\u6211\u4eec\u5b9a\u4e49 \u540c\u7c7b \u4e4b\u95f4\u7684\u6743\u503c\u5173\u7cfb\u4e3a 0\uff0c\u5f02\u7c7b \u4e4b\u95f4\u7684\u6743\u503c\u5173\u7cfb\u4e3a 1\uff0c\u6784\u6210\u6a21 2 \u52a0\u6cd5\u7fa4         2.  \u53e6\u5916\uff0c\u6a21 k \u7684\u52a0\u6cd5\u7fa4\u610f\u5473\u7740 \u6bcf\u4e2a\u5e76\u67e5\u96c6\u6700\u591a\u53ef\u4ee5\u5212\u5206\u4e3a k \u4e2a\u7fa4\uff0c\u56e0\u6b64\u6211\u4eec\u9009\u62e9\u5e76\u67e5\u96c6\u7684\u4e00\u4e2a\u7ed3\u70b9\u4f5c\u4e3a\u4ee3\u8868 \u5e76 \u5c06\u8fd9\u4e9b\u4ee3\u8868\u79bb\u6563\u5316\u4e3a\u8fde\u7eed\u7684\u65b0 id\uff08\u6bcf\u4e2a\u5e76\u67e5\u96c6\u7684\u6807\u8bc6\uff09\uff0c\u5e76\u4e14\u6bcf\u4e2a\u5e76\u67e5\u96c6\u90fd\u6709 k \u4e2a \u7fa4\u5c5e\u6027\uff08\u5e76\u67e5\u96c6\u4e2a\u6570\u8bb0\u4e3a m\uff09         3.  \u672c\u9898\u4e2d\u7fa4\u5c5e\u6027 (a[ ], b[ ]) \u5206\u522b\u8bbe\u4e3a\u5f53\u524d\u5e76\u67e5\u96c6\u7684 \u597d\u4eba\u6570\u91cf / \u574f\u4eba\u6570\u91cf         4.  \u6211\u4eec\u5bf9 \u597d\u4eba \u505a\u6cdb\u5316\u7684\u80cc\u5305\uff08\\(\\sum d_i == p, CNT\\{ c_i \\}\\)  &amp; \\(d_i = a_i \u6216 b_i, c_i=0..2\\)\uff09\uff0c\u82e5 \\(f_{m, p}=1\\)\uff0c\u5219\u610f\u5473\u7740\u65b9\u6848\u552f\u4e00\uff0c\u5f00\u4e00\u4e2a\u6570\u7ec4 g[ ] \u56de\u6eaf\u5bf9\u4e8e \u597d\u4eba\u7fa4\u4f53(gid=i) \u9009\u62e9\u7684\u65b9\u6848         5.  \u82e5\u67d0\u4e2a\u7ed3\u70b9(id=i)\u4e0e \u5f53\u524d\u5e76\u67e5\u96c6\u7684\u597d\u4eba\u7fa4\u4f53 \u7684\u9009\u62e9\u65b9\u6848\u76f8\u540c\uff0c\u8bf4\u660e\u8be5\u7ed3\u70b9\u662f\u597d\u4eba</li> <li>G\uff1a</li> <li>H\uff1a</li> <li>I\uff1a\u7ef4\u62a4\u4e24\u79cd\u64cd\u4f5c\uff1a\u63d2\u5165\u4e24\u4e2a\u4e8c\u7ef4\u70b9\u4e4b\u95f4\u7684\u76f8\u5bf9\u54c8\u5bc6\u987f\u957f\u5ea6\\((\\Delta_x, \\Delta_y)\\)</li> <li>J\uff1a\u7ed9\u5b9a \u6a21 2 \u52a0\u6cd5\u7fa4 \u7684\u591a\u4e2a\u903b\u8f91\u5173\u7cfb\uff0c\u5224\u65ad\u662f\u5426\u6709\u7edd\u5bf9\u975e\u6cd5\u903b\u8f91</li> <li>K\uff1a\u7ed9\u5b9a m \u4e2a\u6bd4\u8d5b\u7ed3\u679c\uff0c\u9664\u4e86 \u88c1\u5224 \u4ee5\u5916\u4e00\u4e2a\u4eba\u53ea\u6709 3 \u79cd\u72b6\u6001\u5176\u4e2d\u4e00\u79cd\uff0c\u5e76\u4e14\u53ea\u6709\u4e09\u79cd\u6bd4\u8d5b\u7ed3\u679c \u80dc/\u8d1f/\u5e73 (\u6a21 3 \u7684\u52a0\u6cd5\u7fa4)\uff1b\u5982\u679c\u88c1\u5224\u552f\u4e00\uff0c\u5224\u65ad\u88c1\u5224\u7684 id &amp; \u7b2c j \u573a\u6bd4\u8d5b\u540e\u53ef\u4ee5\u5224\u5b9a\u88c1\u5224\u662f\u8c01<ul> <li>\u7531\u4e8e\u88c1\u5224\u7684\u53c2\u4e0e\u4f1a\u5bfc\u81f4 \u65e0\u6cd5\u6784\u6210\u4e00\u9897\u6811 (\u6362\u53e5\u8bdd\u8bf4\uff0c\u6709\u88c1\u5224\u7684\u6bd4\u8d5b\u5c31\u4e0d\u80fd\u6784\u6210\u5e76\u67e5\u96c6)\uff0c\u6211\u4eec\u679a\u4e3e\u53ef\u80fd\u7684\u88c1\u5224 id=i\uff0c\u82e5 m \u573a\u6bd4\u8d5b\u6ca1\u6709\u7edd\u5bf9\u9519\u8bef\u903b\u8f91\uff0c\u53ea\u80fd\u8bf4\u660e\u8be5\u4eba \u53ef\u80fd\u662f\u88c1\u5224\uff0c\u5426\u5219\u6b64\u4eba \u4e00\u5b9a\u4e0d\u662f\u552f\u4e00\u7684\u88c1\u5224\uff08\u5373\u4fbf\u4ed6\u53ef\u80fd\u662f\u88c1\u5224\uff0c\u6211\u4eec\u8fd8\u662f\u53bb\u9664\u4ed6\u662f\u88c1\u5224\u7684\u5acc\u7591\uff0c\u4f7f\u5f97\u5acc\u7591\u7684\u88c1\u5224\u5c3d\u53ef\u80fd\u5c0f\uff09</li> <li>\u7edf\u8ba1\u53ef\u80fd\u662f\u552f\u4e00\u7684\u88c1\u5224\u7684\u4eba\u6570 tot\uff0c\u82e5 tot = 1\uff0c\u5219\u88c1\u5224(\u4e0d\u4e25\u683c\u5730)\u552f\u4e00</li> <li>\u82e5\u88c1\u5224\u552f\u4e00\uff0c\u53ef\u80fd\u5224\u65ad\u8be5\u547d\u9898\u4e00\u5b9a\u662f\u5728\u679a\u4e3e\u5176\u4ed6\u4eba\u8fc7\u7a0b\u4e2d\u51fa\u73b0\u77db\u76fe\u7684\u8f83\u540e\u7684\u4e00\u573a\u6bd4\u8d5b</li> </ul> </li> <li>L\uff1a\u7ef4\u62a4\u4e24\u79cd\u64cd\u4f5c\uff1a\u5220\u8fb9\uff0c\u67e5\u8be2\u96c6\u5408\u5185\u6700\u4f18\u7684\u70b9\uff08\u70b9\u6743\u6700\u5927 &amp;&amp; \u4e0b\u6807\u6700\u5c0f\uff09<ul> <li>\u67e5\u8be2\uff1a\u542f\u53d1\u5f0f\u5408\u5e76\u5373\u53ef</li> </ul> </li> <li>M\uff1a\u5224\u65ad\u4e00\u5f20\u56fe\u662f\u5426\u4e3a \u4e00\u9897\u65e0\u5411\u6811<ul> <li>\u4e00\u5f20\u56fe\u4e3a\u65e0\u5411\u6811 \\(\\iff\\) \u56fe\u4e3a\u7a7a  \u6216  \u6709\u4e14\u4ec5\u6709\u4e00\u5f20\u65e0\u5411\u65e0\u73af\u56fe</li> </ul> </li> <li>N\uff1a\u4e0e M \u76f8\u540c</li> </ul>"},{"location":"%E5%88%B7%E9%A2%98/%E9%A2%98%E7%9B%AE%E6%A8%A1%E5%9E%8B/#_3","title":"\u6811\u72b6\u6570\u7ec4","text":"<p>\u7406\u8bba</p> <ul> <li>\u57fa\u672c\u64cd\u4f5c\uff1a \u5355\u70b9\u4fee\u6539\uff0c\u533a\u95f4\u67e5\u8be2</li> <li>\u652f\u6301\u7684\u8fd0\u7b97\u6ee1\u8db3 \u7ed3\u5408\u5f8b \u548c \u4ea4\u6362\u5f8b<ul> <li>\u7ed3\u5408\u5f8b\uff1a \\((x \\circ y)\\circ z = x \\circ (y \\circ z)\\)</li> <li>\u53ef\u5dee\u5206\uff1a \\(x \\circ y \\circ^{-1} y = x\\) \uff08\\(\\circ^{-1}\\) \u4e3a \\(\\circ\\) \u7684\u9006\u8fd0\u7b97\uff09</li> </ul> </li> <li>\u652f\u6301\u7684\u8fd0\u7b97\uff1a<ul> <li>\u548c(+)\uff0c\u79ef(\\(\\times\\), \u4ec5\u5f53 \u6a21\u610f\u4e49\u4e0b\u7684\u79ef \u53ef\u5dee\u5206)</li> <li>\u5f02\u6216(\\(\\oplus\\), xor)</li> <li>\u6ce8\u610f\uff1agcd\uff0cmax\uff0cmin \u539f\u5219\u4e0a\u4e0d\u652f\u6301 \uff08\u4f46\u662f\u6700\u503c\u95ee\u9898\u53ef\u4ee5\u7279\u6b8a\u5904\u7406\uff1aEfficient Range Minimum Queries using Binary Indexed Trees\uff09</li> </ul> </li> <li>\u7ed9\u5b9a\u5e8f\u5217 \\(\\{ a_i \\}\\)\uff0c\u4e3a\u5176\u751f\u6210\u4e00\u4e2a\u5e8f\u5217 \\(\\{ c_i \\}\\)\uff0c\u4ee4 \\(c_i = \\displaystyle \\sum\\limits_{j=i-lowbit_i+1}^{\\circ, i} a_j\\)<ul> <li>\u5c06 lowbit(x) \u5b9a\u4e49\u4e3a\uff1a\\(lowbit(x) = x \\&amp; (~x+1) = x \\&amp; -x\\) \uff08\u5373 x \u7684\u6700\u540e\u4e00\u4e2a\u4e8c\u8fdb\u5236 \u63a9\u7801\uff09\uff0c\u7b80\u8bb0\u4e3a \\(lb_x\\)</li> <li>\u8ba1\u7b97\u524d\u7f00\u548c \\(s_n = \\sum\\limits_{i=1}^{\\circ, n}a_i\\)<ul> <li>\u9012\u5f52\u8ba1\u7b97\uff1a\\(s_n = c_n \\circ s_{\\displaystyle n-{lb}_n}\\)\uff0c\\(s_1 = c_1\\) </li> <li>\uff08\u6ce8\u610f\uff1a\u6839\u636e\u5b9a\u4e49\uff0c\\(c_0\\) \u7ba1\u8f96\u533a\u95f4 \\([0-lb_0+1, 0] = [1, 0] = \\emptyset\\)\uff0c\u6240\u4ee5 \\(c_0\\) \u6ca1\u6709\u610f\u4e49\uff09</li> <li>\u590d\u6742\u5ea6\uff1a\\(popcount(x)\\) (x \u7684\u63a9\u7801\u6570\u91cf)\uff0c\u5373 \\(O(\\log n)\\)</li> </ul> </li> <li>\u5355\u70b9\u4fee\u6539<ul> <li>\u5b9a\u4e49\uff1a\\(x = s\\cdot 2^{k+1} + 2^k\\) (\\(2^k\\) \u662f x \u7684\u6700\u5c0f\u63a9\u7801)\uff0c\\(l_x = x - lb_x + 1\\)(\u5373\u5176\u7ba1\u8f96\u7684\u5de6\u8fb9\u754c)\uff0c\\(c[x] = [l_x, x]\\) \uff08\u5373 x \u7ba1\u8f96\u7684\u8303\u56f4\uff09</li> <li>\u5b9a\u7406\uff1a<ol> <li>\u5bf9\u4e8e \\(x \\le y\\) \\(\\implies\\)  c[x] \u4e0e c[y] \u6ca1\u6709\u4ea4\u96c6 \u6216 \\(c[x] \\in c[y]\\)</li> <li>\\(c[x] \\subsetneq c[y], y = x + lb_x\\) (\u53ea\u9700\u8bc1\u660e\uff1a \\(l_y \\le l_x \\le x \\le y, x\\ne y\\))</li> <li>\\(x &lt; z &lt; y, y = x + lb_x\\) \\(\\implies\\) \\(c[x] \\cap c[z] = \\emptyset\\)</li> <li>\u7ed3\u8bba\uff1a\\(x\\) \u6709\u4e14\u4ec5\u6709\u4e00\u4e2a\u6700\u5c0f\u7684(\u771f)\u7236\u96c6\u5408 \\(x + lb_x\\) (\\(x \\ge 1\\))</li> </ol> </li> <li>\\(update(x, val)\\) \\(\\iff\\) \\(c_x \\leftarrow c_x \\circ val, update(x + lb_x, val)\\)  (\\(x \\le upper_bound\\))</li> <li>\u590d\u6742\u5ea6\uff1a\u7ea6\u4e3a \\(popcount(upper\\_bound)\\)\uff0c\u5373 \\(O(\\log n)\\)</li> </ul> </li> <li>\u521d\u59cb\u5316\u6811\u72b6\u6570\u7ec4<ol> <li>\u505a n \u6b21\u5355\u70b9\u4fee\u6539\uff0c\\(O(n\\log n)\\)</li> <li>\u7531\u4e8e\u6bcf\u4e2a \\(c_i\\) \u662f\u7531\u5176\u76f4\u63a5\u513f\u5b50\u7684\u8d21\u732e\u5f97\u5230\u7684\uff0c\u56e0\u6b64\u6bcf\u6b21\u8fed\u4ee3 i \u65f6\uff0c\u90fd\u5bf9\u7236\u4eb2 \\(i+lb_i\\) \u7d2f\u52a0\u8d21\u732e\uff0c\\(O(n)\\)</li> <li>\u9884\u5904\u7406 a[ ] \u7684\u524d\u7f00\u548c s[ ]\uff0c\u6839\u636e\u5b9a\u4e49 \\(c_i = s_i - s_{i-lb_i}\\)</li> </ol> </li> </ul> </li> <li>\u5b9e\u73b0 \u533a\u95f4\u4fee\u6539 / \u5355\u70b9\u67e5\u8be2\uff1a<ul> <li>\u5b9a\u4e49\u5dee\u5206\u6570\u7ec4 \\(d_i = a_i - a_{i-1}\\)\uff1b\u7528\u6811\u72b6\u6570\u7ec4\u7ef4\u62a4 \\(d_i\\)</li> <li>\u5355\u70b9\u67e5\u8be2\uff1a\\(s_i = \\sum\\limits_{j=1}^i d_j = a_i - a_0 = a_i\\) \uff08\u8fd9\u91cc\u5047\u8bbe \\(a_0 = 0\\)\uff09</li> <li>\u533a\u95f4\u4fee\u6539\uff1a\\(update(x, val), inv\\_update(x+1, val)\\) \uff08inv_update \u6307\u7684\u662f\u9006\u5411\u66f4\u6539\uff09<ul> <li>\u7b80\u5355\u8bc1\u660e\uff1a\u7531\u4e8e\u6211\u4eec\u53ea\u9700\u8981\u66f4\u6539 i = x \u5904\u7684\u70b9\uff0c\u800c update(x, val) \u5374\u4f1a\u5f71\u54cd \\(s_i, i\\ge x+1\\) \u7684\u7ed3\u679c\uff0c\u4e3a\u4e86\u6d88\u53bb\u8fd9\u79cd\u5f71\u54cd\uff0c\u6211\u4eec\u5e94\u8be5\u5bf9 i=x+1 \u5b9e\u884c\u9006\u66f4\u6539 inv_update(x, val)</li> </ul> </li> </ul> </li> <li>\u5b9e\u73b0 \u533a\u95f4\u4fee\u6539 / \u533a\u95f4\u67e5\u8be2\uff1a<ul> <li>\u533a\u95f4\u67e5\u8be2\uff1a<ul> <li>\\(s_x = \\sum\\limits_{i=1}^x a_i = \\sum\\limits_{i=1}^x \\sum\\limits_{j=1}^i d_j = \\sum\\limits_{j=1}^x \\sum\\limits_{i=j}^x d_j = \\sum\\limits_{j=1}^x (x-j+1)d_j = (x+1)\\sum\\limits_{j=1}^x d_j - \\sum\\limits_{j=1}^x j\\cdot d_j\\)</li> <li>\u56e0\u6b64\u6211\u4eec\u7ef4\u62a4 \\(\\{ d_i \\}\\) \u548c \\(\\{ i\\cdot d_i \\}\\) \u4e24\u4e2a\u6570\u7ec4</li> </ul> </li> <li>\u533a\u95f4\u4fee\u6539\uff1a\u5206\u522b\u5bf9 \\(\\{ d_i \\}\\) \u548c \\(\\{ i\\cdot d_i \\}\\) \u6267\u884c\u4e24\u79cd\u66f4\u65b0 \\(update(left, right+1, val)\\)\uff0c\\(inv\\_update(left, right+1, val)\\)</li> </ul> </li> <li>\u6269\u5c55\u5230\u4e8c\u7ef4\uff1a<ul> <li>\u5355\u70b9\u4fee\u6539 / \u5b50\u77e9\u9635\u67e5\u8be2\uff1a\\(update(x, y, val)\\) (\u4e24\u5c42\u5faa\u73af\u8fed\u4ee3\u66f4\u65b0)\uff0c\\(sum(x_1, y_1, x_2, y_2)\\) (\u5b9e\u73b0\u65b9\u6cd5\u53c2\u7167 \u4e8c\u7ef4\u524d\u7f00\u548c)</li> <li>\u5b50\u77e9\u9635\u4fee\u6539 / \u5355\u70b9\u67e5\u8be2\uff1a\u4f9d\u7136\u501f\u52a9\u5dee\u5206\u601d\u60f3<ul> <li>\u5b50\u77e9\u9635\u4fee\u6539\uff1a\\(\\sum\\limits_{i=1}\\)</li> </ul> </li> </ul> </li> <li>\u6743\u503c\u6811\u72b6\u6570\u7ec4\uff1a<ul> <li>\u6743\u503c\u6811\u72b6 \u7684\u5b9a\u4e49\uff1a\u5c06\u4e00\u4e2a\u6570\u7ec4 a[ ] \u6620\u5c04\u5230\u4e00\u4e2a\u5927\u5c0f\u4e3a \\(a_i\\)\u7684\u503c\u57df\uff0c\u8bb0\u5f55 a[ ] \u4e2d\u5143\u7d20\u51fa\u73b0\u6b21\u6570\u7684\u6570\u7ec4 \uff08\u6b64\u65f6\u5143\u7d20\u4e4b\u95f4 \u51fa\u73b0\u7684\u6b21\u5e8f\u65e0\u5173\uff09<ul> <li>\u6ce8\u610f\uff1a\u82e5 a[ ] \u7684 \u503c\u57df\u8fc7\u5927 \u6216 \\(a_i \\in Z\\) \u6216 \\(a_i \\in R\\)\uff0c\u53ef\u4ee5\u5148\u5c06 a[ ] \u8fdb\u884c \u6709\u5e8f\u79bb\u6563\u53d8\u6362 \u4e3a a'[ ] \uff08\u6b64\u65f6\uff0c\\(a_i'\\) \u4e4b\u95f4\u7684\u503c\u4e0e\u5176\u539f\u503c\u4e4b\u95f4\u7684\u76f8\u5bf9\u5927\u5c0f\u6709\u5173\uff09</li> </ul> </li> <li>\u5355\u70b9\u4fee\u6539\uff0c\u5168\u5c40\u7b2c k \u5c0f\uff08\u6570\u636e\u968f\u673a\uff09<ul> <li>\u7b2c k \u5c0f\u7684\u6570 w \u6ee1\u8db3\u4e00\u4e2a\u6027\u8d28\uff1a\\(k = sum(1, w-1) + 1\\)\uff0c\u56e0\u6b64\u6211\u4eec\u53ea\u9700\u627e\u5230\u4e00\u4e2a x = w-1\uff0c\u6ee1\u8db3 \\(sum(1, x) &lt; k, \\max\\{ x \\}\\)\uff0cx+1 \u5373\u4e3a\u6240\u6c42</li> <li>\u4e8c\u5206\uff1a\\(sum(1, x) &lt; k\\)\uff08\u5047\u8bbe x \u5728\u89e3\u7684\u5de6\u4fa7 \u5e76 \u6ca1\u6709\u627e\u5230\uff1b\uff09</li> <li>\u500d\u589e\uff1a<ul> <li>\u4ece\u9ad8\u4f4d\u5f80\u4f4e\u4f4d\u8d2a\u5fc3\u9009\u53d6\u63a9\u7801\u7d2f\u52a0\u5230 x \u4e2d\uff0c\u6b64\u65f6 \\(c_x\\) \u5bf9\u5e94\u533a\u95f4 \\([x-lb_x+1, x]\\) \u5185\u7684\u8d21\u732e\u548c\uff0c\u901a\u8fc7 \\(c_x\\) \u8ba1\u7b97\u548c\u66f4\u65b0\u4e0e\u9650\u5236\u6709\u5173\u7684\u51fd\u6570 \\(f_x\\)</li> <li>\u5982\u679c x \u8d85\u8fc7\u503c\u57df \u6216 \u65b0\u7684 \\(f_x\\) \u4e0d\u6ee1\u8db3\u6761\u4ef6\uff0c\u5219\u53cd\u6094 <pre><code>int x = 0;\nfor(int fx=0, ma=log2(N)+1; ma&gt;=0; --ma){\n    x += 1&lt;&lt;ma;\n    if(x &gt; N || fx+ta[x] &gt;= k) x -= 1&lt;&lt;ma;\n    else fx += ta[x];\n}\nreturn x + 1;\n</code></pre></li> </ul> </li> </ul> </li> </ul> </li> <li>\u4e0d\u53ef\u5dee\u5206\u8fd0\u7b97(\u6ee1\u8db3\u7ed3\u5408\u5f8b)\u7684\u5904\u7406\uff1a\u53ef\u4ee5\u53d1\u73b0 \u652f\u6301\u5dee\u5206\u7684\u8fd0\u7b97 \u90fd\u53ef\u4ee5\u4f7f\u7528\u5bb9\u65a5\u539f\u7406\u5904\u7406\u533a\u95f4\u67e5\u8be2\uff0c\u4f46\u8be5\u53cd\u547d\u9898\u4e0d\u6210\u7acb<ul> <li>\u6211\u4eec\u8003\u8651\u76f4\u63a5\u6c42\u89e3\u533a\u95f4\u95ee\u9898(\u4e0d\u501f\u52a9\u5bb9\u65a5)\uff1a<ul> <li>\u5982\u679c \\(l \\le r\\)\uff0c\u5219\u6267\u884c\u5982\u4e0b\u64cd\u4f5c\uff1a\uff08\u5426\u5219\u9000\u51fa\uff09</li> <li>\u82e5 \\(l\\le r_i-lb_{r_i}\\)\uff0c\u4e0d\u65ad\u5c06\u5f53\u524d\u7684\u533a\u95f4 \\([l, r_i]\\) \u62c6\u89e3\u4e3a \\([l, r_i-lb_{r_i}]\\) \u548c \\([r-lb_{r_i}+1, r_i]\\)\uff0c\u7d2f\u8ba1\u8d21\u732e</li> <li>\u82e5 \\(l &gt; r_i-lb_{r_i}\\)\uff0c\u5c06\u533a\u95f4 \\([l, r_i]\\) \u62c6\u89e3\u4e3a \\([l, r_i-1]\\) \u548c \\([r_i, r_i]\\)\uff0c\u7d2f\u8ba1\u8d21\u732e</li> </ul> </li> <li>\u6a21\u677f\uff1a     <pre><code>void assign(int x, int v){\n    a[x] = v;\n    for(int i=x; i&lt;N; i+=lb(i)){\n        ta[i] = operate(a[x], ta[i]);\n//      \u82e5\u6811\u72b6\u6570\u7ec4\u6ca1\u6709\u4f7f\u7528 \u5355\u4f4d\u5143 \u521d\u59cb\u5316\uff0c\u90a3\u4e48\u6709\u5fc5\u8981\u4f7f x \u7684\u7956\u5148\u91cd\u65b0\u901a\u8fc7\u4ed6\u4eec\u7684\u6240\u6709\u513f\u5b50\u6765\u66f4\u65b0\u81ea\u5df1\n//      ta[i] = a[i];\n//      for(int j=1; j&lt;lb(i); j+=lb(j)){\n//          ta[i] = max(ta[i], ta[i-j]);\n//      }\n    }\n}\nint query(int l, int r){\n    int ans = 0;\n    while(l &lt;= r){\n        ans = operate(ans, a[r]);\n        -- r;\n        for(; l&lt;=r-lb(r); r-=lb(r)){\n            ans = operate(ans, ta[r]);\n        }\n    }\n    return ans;\n}\n</code></pre></li> </ul> </li> </ul> <p>Note</p> <ul> <li>\u6811\u72b6\u6570\u7ec4\u80fd\u89e3\u51b3\u7684\u95ee\u9898 \u662f \u7ebf\u6bb5\u6811\u80fd\u89e3\u51b3\u7684\u95ee\u9898\u7684\u5b50\u96c6</li> <li>\u666e\u901a\u6570\u7ec4 \u501f\u52a9 \u524d\u7f00\u548c \u548c \u5dee\u5206 \u7684\u601d\u60f3\u4e5f\u53ef\u4ee5\u5b9e\u73b0 \u533a\u95f4\u67e5\u8be2 \u548c \u533a\u95f4\u4fee\u6539\uff0c\u53ea\u8981\u4e0d\u9891\u7e41\u4ece\u8fd9\u4e24\u79cd\u5207\u6362\u4e2d\u5207\u6362\uff08\u5373\u53ea\u652f\u6301 \u9759\u6001\u64cd\u4f5c\uff09\uff0c\u800c\u4e14\u6bcf\u6b21\u64cd\u4f5c\u90fd\u662f \\(O(1)\\) \u7684</li> <li>\u6811\u72b6\u6570\u7ec4 \u501f\u52a9 \u5dee\u5206\u7684\u601d\u60f3\u53ef\u4ee5\u5b9e\u73b0 \u533a\u95f4\u67e5\u8be2 \u548c \u533a\u95f4\u4fee\u6539\uff0c\u4e0e\u666e\u901a\u6570\u7ec4\u76f8\u6bd4\u4e0d\u8db3\u4e4b\u5904\u662f \u4e24\u79cd\u64cd\u4f5c\u72ec\u7acb\u65f6\u540e\u8005\u6548\u7387\u66f4\u9ad8\uff0c\u56e0\u4e3a\u6bcf\u6b21\u64cd\u4f5c\u90fd\u662f \\(O(\\log n)\\) \u7684</li> </ul> <p>\u9898\u94fe</p> <p>vj</p> <ul> <li>A\uff1a\u5feb\u901f\u6392\u5e8f\u4ea4\u6362\u6b21\u6570 = \u9006\u5e8f\u5bf9\u4e2a\u6570 = \\(\\sum\\limits_{i=1}^n \\sum\\limits_{j=1}^{i-1} [a_j &gt; a_i] = \\sum\\limits_{j=1}^n \\sum\\limits_{i=j+1}^n [a_i &gt; a_j]\\) (\u987a\u7740\u641e / \u9006\u7740\u641e \u90fd\u884c)<ul> <li>\u6743\u503c\u6811\u72b6\u6570\u7ec4\u8ba1\u7b97 \u4e8c\u7ef4\u504f\u5e8f</li> <li>\u6ce8\u610f\uff1a\u6709\u4e24\u5c42 sigma\uff0c\u6240\u4ee5\u8981\u5f00 long long</li> </ul> </li> <li>B\uff1a\\(\\sum\\limits_{j=1}^{i-1} [x_j \\le x_i, y_j \\le y_i, x_i \\ne x_j || y_i \\ne y_j], i=1..n\\)\uff0c\u7edf\u8ba1\u6bcf\u4e2a\u503c\u7684\u51fa\u73b0\u6b21\u6570\uff08\u53ef\u4ee5\u6ce8\u610f\u5230\u6bcf\u4e2a\u503c\u90fd\u5728 \\(0..n-1\\) \u4ee5\u5185\uff09<ul> <li>\u6ce8\u610f\uff1a\u672c\u9898\u4e2d\u4e0d\u5b58\u5728\u76f8\u540c\u7684\u70b9\uff0c\u5373 \\((x_i, y_i) = (x_{i-1}, y_{i-1})\\)</li> </ul> </li> <li>C\uff1a\u4e8c\u7ef4\u6811\u72b6\u6570\u7ec4\u6a21\u677f</li> <li>D\uff1a\\(\\sum\\limits_{j=1}^n [x_i \\le x_j, y_i \\ge y_j, y_i-x_i &lt; y_j-x_j], i = 1..n\\) \\(\\iff\\) \\(\\sum\\limits_{j=1}^n [x_i \\le x_j, y_i \\ge y_j, x_i\\ne x_j || y_i\\ne y_j], i = 1..n\\)<ul> <li>\u53ef\u4ee5\u770b\u5230\u4e09\u7ef4\u504f\u5e8f\u95ee\u9898\u8f6c\u5316\u4e3a\u4e86\u4e8c\u7ef4\u504f\u5e8f\u95ee\u9898</li> <li>\u4e24\u79cd\u505a\u6cd5<ul> <li>\u5bf9 x \u5347\u5e8f y \u964d\u5e8f\uff0c\u518d\u987a\u7740\u7edf\u8ba1 \\(\\sum\\limits_{j=1}^n [y_i \\ge y_j, x_i\\ne x_j || y_i\\ne y_j], i = 1..n\\)</li> </ul> </li> <li>\u6ce8\u610f\uff1a\u591a\u7ec4\u7684 1e5 \u6570\u636e\uff0c\u5efa\u8bae\u7528 scanf() / printf()</li> </ul> </li> <li>E\uff1a\\(\\sum\\limits_{j=1}^n [x_i &lt; x_j, y_i &gt; y_j]\\) \u6216 \\(\\sum\\limits_{j=1}^n [x_i &gt; x_j, y_i &lt; y_j]\\)<ul> <li>\u4e00\u79cd\u7b56\u7565(\u6700\u591a8\u79cd\u7b56\u7565)\uff1ax \u5347\u5e8f y \u5347\u5e8f\uff0c\u518d\u987a\u7740\u7edf\u8ba1 \\(\\sum\\limits_{j=1}^n [y_i &lt; y_j]\\) (\u5bf9\u4e8e\u76f8\u540c\u7684 x\uff0c\u4e00\u5b9a\u4e0d\u6ee1\u8db3\u6761\u4ef6)</li> </ul> </li> <li>F\uff1a\\(\\max \\{ sum(x_i, y_i, x_{i+w}, y_{i+h}) \\}\\)</li> <li>G\uff1a\u4e8c\u7ef4\u6811\u72b6\u6570\u7ec4\u6a21\u677f</li> <li>H\uff1a\u4e8c\u7ef4\u6811\u72b6\u6570\u7ec4 + \u5dee\u5206 (\u591a\u70b9\u4fee\u6539\uff0c\u5355\u70b9\u67e5\u8be2) \uff08\u5f02\u6216\u8fd0\u7b97\uff09</li> <li>I\uff1a\u6811\u4e0a \u5355\u70b9\u4fee\u6539\uff0c\u5b50\u6811\u67e5\u8be2<ul> <li>\u5229\u7528 bfs \u5e8f\u5c06\u6811 \"\u5e8f\u5217\u5316\"\uff0c\u5177\u4f53\u6765\u8bf4\u5c31\u662f\u7ed3\u70b9 i \u6620\u5c04\u5230\u8fde\u7eed\u533a\u95f4 \\([lower_i, upper_i]\\) \u4e0a</li> <li>\\(lower_i\\) \u8868\u793a \u6811\u4e0a\u7684\u7ed3\u70b9 i \u5728\u6811\u72b6\u6570\u7ec4\u4e0a\u7684\u7ed3\u70b9id\uff0c \\([lower_i+1, upper_i]\\) \u8868\u793a i \u5728\u6811\u4e0a\u7684\u5b50\u7ed3\u70b9\u5728 \u6811\u72b6\u6570\u7ec4\u4e0a\u7684\u533a\u95f4id</li> <li>\u5e8f\u5217\u5316\u540e\uff0c\u666e\u901a\u7684\u6811\u5c31\u5177\u6709\u4e86\u6811\u72b6\u6570\u7ec4\u64cd\u4f5c\u7684\u80fd\u529b</li> </ul> </li> <li>J\uff1a\\(\\sum\\limits_{i=1}^n \\sum\\limits_{j=1}^{i-1} \\max \\{ v_j, v_i \\} \\cdot | x_j - x_i |\\)<ul> <li></li> </ul> </li> </ul> <p>\u725b\u5ba2</p> <ul> <li>A\uff1a\u7ed9\u5b9a\u5e8f\u5217 a[ ]\uff0c\u7d2f\u52a0\u6bcf\u4e2a\u5b50\u533a\u95f4\u7684\u9006\u5e8f\u5bf9\u6570 \\(\\displaystyle \\sum\\limits_{l=1}^n \\sum\\limits_{r=l}^n \\sum\\limits_{i=l}^r \\sum\\limits_{j=l}^i [a_j &gt; a_i]\\)<ul> <li>\u89c2\u5bdf\u5f0f\u5b50\uff0c\u53d1\u73b0 \\(1\\le l \\le j &lt; i \\le r \\le n\\)\uff0c\u6211\u4eec\u8003\u8651\u5230\u5c06 i \u548c j \u63d0\u5230\u6700\u5916\u5c42\uff0c\u5c31\u6709</li> <li>\\(\\displaystyle \\sum\\limits_{i=1}^n \\sum\\limits_{j=1}^{i-1} \\sum\\limits_{l=1}^j \\sum\\limits_{r=i}^n [a_j &gt; a_i] = \\sum\\limits_{i=1}^n \\sum\\limits_{j=1}^{i-1} j\\cdot (n-i+1) [a_j &gt; a_i] = \\sum\\limits_{i=1}^n (n-i+1)\\sum\\limits_{j=1}^{i-1} j\\cdot [a_j &gt; a_i]\\)</li> <li>\u6ce8\u610f\u5230\u8fd9\u4e2a\u5f0f\u5b50\u53ef\u4ee5\u7528\u6743\u503c\u6811\u72b6\u6570\u7ec4\u7ef4\u62a4</li> </ul> </li> </ul> <p>Tip</p> <ul> <li>\u4e8c\u7ef4\u504f\u5e8f\u95ee\u9898\uff1a\uff08\u6839\u636e x \u548c y \u7b26\u53f7\u65b9\u5411\u7684\u4e0d\u540c\uff0c\u6bcf\u79cd\u504f\u5e8f\u67094\u79cd\u60c5\u51b5\uff09<ul> <li>\u666e\u901a\u504f\u5e8f\uff1a<ul> <li>\\(\\sum\\limits_{j=1}^n [x_j &gt; x_i, y_j &gt; y_i]\\)\uff1ax \u964d\u5e8f\uff0cy \u5347\u5e8f\uff0c\u7edf\u8ba1 \\(sum(y_i+1, +\u221e)\\)</li> <li>\\(\\sum\\limits_{j=1}^n [x_j &gt; x_i, y_j &lt; y_i]\\)\uff1ax \u964d\u5e8f\uff0cy \u964d\u5e8f\uff0c\u7edf\u8ba1 \\(sum(0, y_i-1)\\)</li> <li>\\(\\sum\\limits_{j=1}^n [x_j &lt; x_i, y_j &gt; y_i]\\)\uff1ax \u5347\u5e8f\uff0cy \u5347\u5e8f\uff0c\u7edf\u8ba1 \\(sum(y_i+1, +\u221e)\\)</li> <li>\\(\\sum\\limits_{j=1}^n [x_j &lt; x_i, y_j &lt; y_i]\\)\uff1ax \u5347\u5e8f\uff0cy \u964d\u5e8f\uff0c\u7edf\u8ba1 \\(sum(0, y_i-1)\\)</li> </ul> </li> <li>\u4e0d\u7b49\u504f\u5e8f\uff1a<ul> <li>\\(\\sum\\limits_{j=1}^n [x_j \\ge x_i, y_j \\ge y_i, x_j\\ne x_i || y_j\\ne y_i]\\)\uff1ax \u964d\u5e8f\uff0cy \u964d\u5e8f\uff0c\u7edf\u8ba1 \\(sum(0, y_i)\\)</li> <li>\u7279\u6b8a\u5904\u7406\uff1a\u82e5 \\((x_i, y_i) = (x_{i-1}, y_{i-1})\\)\uff0c\u5219 i \u7684\u7edf\u8ba1\u503c\u4e3a i-1 \u7684\u7edf\u8ba1\u503c</li> <li>\u5176\u4e2d\u8fd8\u6709\u5176\u4ed63\u79cd\u7c7b\u4f3c\u60c5\u51b5</li> </ul> </li> <li>\u53ef\u7b49\u504f\u5e8f\uff1a</li> </ul> </li> </ul> <p>\u7ea6\u5b9a</p> <ul> <li>\u4e8c\u7ef4\u504f\u5e8f\u95ee\u9898\u4e2d\uff1a\u53ea\u5bf9 x \u5148\u6392\u5e8f\uff0c\u5e76\u4e14\u987a\u7740\u7edf\u8ba1\u7b54\u6848 \uff08\u9632\u6b62\u548c \u7b49\u4ef7\u7684\u7b56\u7565 \u6df7\u6dc6\uff09<ul> <li>\u67d0\u4e9b\u60c5\u51b5\u4e0b\uff0c\u53ef\u4ee5\u8f6c\u6362\u6210\u7b49\u4ef7\u7684\u7b56\u7565</li> </ul> </li> </ul>"},{"location":"%E5%88%B7%E9%A2%98/%E9%A2%98%E7%9B%AE%E6%A8%A1%E5%9E%8B/#dp","title":"\u80cc\u5305dp","text":"<p>dp \u6a21\u578b</p> <ul> <li>\u6a21\u578b\u793a\u4f8b\uff1a \\(\u9650\u5236\\cdots\\)\uff0c\\(\u76ee\u6807\\cdots\\)</li> <li>A\uff1a \\(\\displaystyle \\sum w_i \\le w\\_upper\\)\uff0c\\(max\\{1-\\prod (1-v_i)\\}\\)\uff0c\\(v_i \\in R\\)<ul> <li>\\(v_i\\) \u8868\u793a \u67d0\u4e2a\u4e8b\u4ef6 \u6210\u529f(\u5f97\u5230offer) \u7684\u6982\u7387\uff0c\u6700\u5927\u5316 x \u4e2a\u4e8b\u4ef6\u4e2d \u6210\u529f\u4e0d\u5c11\u4e8e\u4e00\u6b21 (\u6210\u529f0\u6b21\u7684\u8865\u4e8b\u4ef6) \u7684\u6982\u7387</li> <li>\u4ee5 w \u4e3adp\u7684\u7b2c\u4e8c\u7ef4\uff0cdp\u51b3\u7b56\u4e3a\uff1a\\(f_{i,j} = max\\{f_{i-1, j}, 1-(1-f_{i-1, j-w_i})\\cdot (1-v_i) \\}\\) \uff08\u4e0d\u9009 / \u9009\uff09</li> </ul> </li> <li>B\uff1a \\(\\displaystyle \\prod (1-w_i) \\ge 1-w\\_upper\\)\uff0c\\(max\\{ \\sum v_i \\}\\)\uff0c\\(w_i \\in R\\)<ul> <li>\\(w_i\\) \u8868\u793a \u67d0\u4e2a\u4e8b\u4ef6 \u6210\u529f(\u88ab\u6293) \u7684\u6982\u7387\uff0c\u6700\u5927\u5316 x \u4e2a\u4e8b\u4ef6 \u6210\u529f0\u6b21 \u7684\u6982\u7387</li> <li>\u7531\u4e8e \\(w_i \\in R\\)\uff0c\u6240\u4ee5\u53ea\u80fd\u4ee5 v \u4e3adp\u7684\u7b2c\u4e8c\u7ef4\uff0c\u7136\u540e\u8d2a\u5fc3\u6c42\u6ee1\u8db3\u9650\u5236\u7684</li> <li>dp\u51b3\u7b56\uff1a \\(f_{i, j} = max\\{ f_{i-1, j}, f_{i-1, j-v_j} \\cdot (1-w_i) \\}\\)</li> </ul> </li> <li>C\uff1a \\(\\displaystyle \\sum w_i\\cdot a_i \\le w\\_upper\\)\uff0c\\(max\\{ \\sum v_i\\cdot a_i \\}\\)\uff0c\\(a_i = 0..A_i\\)<ul> <li>\u4f18\u5316\uff1a\u6bcf\u79cd\u4e1c\u897f\u90fd\u6709\u591a\u4e2a\uff0c\u4e00\u79cd\u7b56\u7565\u662f \u5c06\u6bcf\u79cd\u4e1c\u897f\u90fd \u5408\u7406\u5206\u5272 \u4e3a \\(A_i\\) \u4e2a\u4e1c\u897f\uff0c\u5373 \\(A_i = \\sum a_i\\) \uff08\u6b64\u5904\u7684 \\(a_i\\) \u5373\u5bf9\u5e94\u6a21\u578b\u4e2d\u7684 \\(a_i\\)\uff0c\u5373\u6bcf\u4e2a\u65b0\u7269\u54c1\u53ef\u4ee5\u8868\u793a\u4e3a \u9650\u5236\u5206\u91cf \\(w_i\\cdot a_i\\) \u548c \u76ee\u6807\u5206\u91cf \\(v_i\\cdot a_i\\)\uff09</li> <li>dp\u7b56\u7565\uff1a\u4f7f\u7528\u8be5\u65b9\u6cd5\u4f18\u5316\u540e\u4e0e 01 \u80cc\u5305\u4e00\u6837</li> </ul> </li> <li>D\uff1a \\(\\displaystyle \\sum w_i\\cdot a_i \\le w\\_upper\\)\uff0c\\(max\\{ \\sum v_i\\cdot a_i \\}\\)\uff0c\\(a_i = 0..+\u221e\\) (\u5b9e\u9645\u4e0a \\(a_i = 0..\\lfloor\\frac {w\\_upper}{w_i}\\rfloor~~\\&amp;~~w_i\\ne 0\\)\uff0c\u5373\u201c\u5b8c\u5168\u80cc\u5305\u201d\u53ef\u4ee5\u8f6c\u5316\u4e3a \u201c\u591a\u91cd\u80cc\u5305\u201d\uff0c\u4f46\u9006\u547d\u9898\u9700\u8981\u6ee1\u8db3\u4e00\u5b9a\u6761\u4ef6\u624d\u6210\u7acb)<ul> <li>dp\u7b56\u7565\u4f18\u5316\uff1a \\(\\begin{cases} f_{i, j} = \\max\\limits_{a=0..A_i} \\{ f_{i-1, j-a\\cdot w_i} + a\\cdot v_i \\} \\\\ f_{i, j-w_i} = \\max\\limits_{a=1..A_i} \\{ f_{i-1, j-a\\cdot w_i} + a\\cdot v_i \\} \\end{cases}\\)\uff0c\\(A_i = \\lfloor\\frac {w\\_upper}{w_i}\\rfloor-1\\) \\(\\implies\\) \\(f_{i, j} = \\max \\{ f_{i-1, j}, f_{i, j-w_i} + v_i \\}\\)</li> </ul> </li> <li>E\uff1a \\(\\sum\\limits_{i=1}^n v_i\\cdot a_i  \\le m\\)\uff0c\\(CNT \\{ \\sum\\limits_{i=1}^n v_i\\cdot a_i \\}\\)\uff0c\\(a_i=0..A_i\\)<ul> <li>\u4e00\u79cd\u7b56\u7565\uff1a\u4f7f\u7528\u5b8c\u5168\u80cc\u5305\u7684\u65b9\u5f0f\u8fed\u4ee3\uff0c\u5bf9\u4e8e\u7b2c i \u4e2a\u7269\u54c1\uff0c\u5f00\u4e00\u4e2a\u4e0d\u6eda\u52a8\u7684\u6570\u7ec4 \u8bb0\u5f55 \u7b2c\u4e00\u6b21\u8f6c\u79fb \u5230 j (\u5373 \u9650\u5236\u5206\u91cf\u7d2f\u52a0\\(\\sum v\\)) \u7684 \u5f53\u524d\u7269\u54c1\u6570\u91cf (\u524d\u63d0\uff1a\u8fd9\u6b21\u8f6c\u79fb\u540e\u4e0d\u4f1a\u8d85\u8fc7\u5f53\u524d\u7269\u54c1\u53ef\u7528\u6570\u91cf)</li> <li>\u4e0d\u6eda\u52a8\u7684\u6570\u7ec4\uff1a\u6307\u7684\u662f \u6bcf\u6b21\u8fed\u4ee3 \u7269\u54c1(ID = i) \u65f6\u90fd\u521d\u59cb\u5316\u4e00\u4e0b\u8be5\u6570\u7ec4 (\u8fd9\u79cd\u60c5\u51b5\u4e0b\u53ef\u4ee5\u4e0d\u5b58\u50a8\u7b2c\u4e00\u7ef4\u2014\u2014ID\u7ef4)</li> </ul> </li> <li>F\uff1a \\(\\sum a_i \\ge 0\\)\uff0c\\(\\sum b_i \\ge 0\\)\uff0c\\(\\max\\{ \\sum (a_i + b_i) \\}\\)  &amp;  \\(a_i \\in Z, b_i \\in Z\\)<ol> <li>\\(a_i\\) \u548c \\(b_i\\) \u90fd\u662f\u6574\u6570\u57df\u4e2d\u7684\u6570\uff0c\u5373\u4e24\u79cd \u9650\u5236\u5206\u91cf \u90fd\u53ef\u4ee5\u662f\u8d1f\u7684\uff0c\u4e00\u79cd\u7b56\u7565\u662f\u5c06 \\(a_i\\) \u4f5c\u4e3a \u9650\u5236\u5206\u91cf\uff0cf \u4e3a \\(b_i\\) \u7684\u590d\u5408\u51fd\u6570 \uff08\u5e76\u4e14 \u7531\u4e8e\\(\\sum b_i \\ge 0\\)\uff0c\u6211\u4eec\u5c06\u5176\u6700\u5927\u5316\uff09</li> <li>\u6ce8\u610f\u70b91\uff1a\u5982\u679c\u4f7f\u7528\u6eda\u52a8\u6570\u7ec4\uff0c\u505a 01 \u80cc\u5305\u64cd\u4f5c\u65f6\uff0c\u5206\u4e24\u79cd\u60c5\u51b5\uff1a<ul> <li>\\(a_i \\ge 0\\)\uff1a\u90a3\u4e48 \\(j-a_i \\le j\\)\uff0c\u7b2c\u4e8c\u7ef4\u7684\u904d\u5386\u65b9\u5411\u4e3a \u4ece\u53f3\u5230\u5de6 (\\(w\\_upper..a_i\\))</li> <li>\\(a_i &lt; 0\\)\uff1a\u90a3\u4e48 \\(j-a_i &gt; j\\)\uff0c\u7b2c\u4e8c\u7ef4\u7684\u904d\u5386\u65b9\u5411\u4e3a \u4ece\u5de6\u5230\u53f3 (\\(0..w\\_upper-|a_i|\\) \u800c\u975e \\(|a_i|..w\\_upper\\))</li> <li>\u56e0\u4e3a \u4ece\u5de6\u5230\u53f3 \u904d\u5386\u65f6\uff0c\u4ec5\u5f53 \\(x \\ge j\\) \u65f6\uff0cx \u5bf9\u5e94\u7684\u662f \u4e0a\u4e00\u4e2a\u7269\u54c1(ID = i-1) \u7684\u72b6\u6001\uff1b\u53cd\u4e4b\u4ea6\u7136</li> </ul> </li> <li>\u6ce8\u610f\u70b92\uff1a\u7531\u4e8e \\(a_i\\) \u53ef\u80fd\u4e3a\u8d1f\u6574\u6570\uff0c\u56e0\u800c \\(\\sum a_i\\) \u4e5f\u53ef\u80fd\u662f\u8d1f\u6570\uff0c\u5176\u4e0a\u9650\u662f \\(O = N \\cdot (-max\\{|a_i|\\})\\)<ul> <li>\u6211\u4eec\u5c06 O \u4f5c\u4e3a\u6570\u7ec4\u7684\u504f\u79fb\u91cf \u4ee5\u9632\u6b62\u6570\u7ec4\u4e0b\u6807\u8d8a\u754c\uff1b\u6b64\u65f6\u5750\u6807\u539f\u70b9\u5bf9\u5e94 \\(O + 0\\)\uff0cx \u70b9\u5bf9\u5e94 \\(O + x\\)</li> <li>\u8fd9\u79cd\u64cd\u4f5c\u53ea\u5e94\u7528\u4e8e dp\u6570\u7ec4\uff0c\u5982 \\(f \\cdot\\)</li> </ul> </li> </ol> </li> <li>G\uff1a \\(\\sum w_i\\cdot a_i \\ge w\\_upper, \\sum w_i\\cdot a_i - \\sum w_j\\cdot b_j = w\\_upper, \\min \\{ \\sum a_i + \\sum b_j \\}\\)    &amp;    \\(a_i \\le c_i, b_j &lt; +\u221e\\)<ul> <li>\u6ce8\u610f\u5230 \\(a_i\\) \u6709\u6570\u91cf\u9650\u5236\uff0c\u800c \\(b_j\\) \u6ca1\u6709</li> <li>\u5bf9 \\(\\sum w_i\\cdot a_i\\) \u548c \\(\\sum w_j\\cdot b_j\\) \u6700\u5c0f\u5316 \u6c42\u89e3 \u591a\u79cd\u80cc\u5305 \\(f\\) \u548c \u5b8c\u5168\u80cc\u5305 \\(g\\)\uff0c</li> <li>\u904d\u5386\u83b7\u53d6 \\(\\min \\{ f_i + g_{i-w\\_upper} \\}\\)\uff0c\u5176\u4e2d \\(i \\ge w\\_upper\\)</li> <li>\u6ce8\u610f\uff1a\u80cc\u5305\u5e94\u8be5\u8ba1\u7b97\u786e\u5207\u503c (f \u548c g \u5e94\u8be5\u521d\u59cb\u5316\u4e3a inf\uff0c\u96f6\u70b9\u5904\u521d\u59cb\u5316\u4e3a0)\uff1b\u65b9\u7a0b\u4e0d\u4e00\u5b9a\u6709\u89e3</li> </ul> </li> <li>H\uff1a \\(\\sum (j - w_i)\\cdot v_i \\cdot a_i \\ge L, \\min \\{ j \\}\\)  &amp;  \\(a_i &lt; +\u221e\\)\uff08\\(\\sum w_i\\cdot a_i \\le j\\)\uff09<ul> <li>\u5176\u5b9e\u8d28\u662f\u4e00\u4e2a \u5b8c\u5168\u80cc\u5305\uff0c \\((j - w_i)\\cdot v_i\\) \u4f5c\u4e3a\u76ee\u6807\u5206\u91cf\uff0c\\(w_i\\) \u4f5c\u4e3a\u9650\u5236\u5206\u91cf</li> <li>\u6ce8\u610f\uff1a\u4e0d\u7cbe\u786e\u8ba1\u7b97\u503c\uff08f \u521d\u59cb\u5316\u4e3a 0\uff09</li> </ul> </li> <li>I\uff1a \\(\\sum w_i\\cdot a_i == w\\_upper, \\max\\{ a_i \\}\\)  &amp;  \\(a_i &lt; +\u221e\\)<ul> <li>\u6ce8\u610f\uff1a\u53ef\u80fd\u6ca1\u6709\u89e3\uff0c\u4f46\u662f\u9898\u76ee\u6307\u660e\u81f3\u5c11\u6709\u4e00\u4e2a\u89e3</li> </ul> </li> </ul> <pre><code>graph LR\na(01\u80cc\u5305)\nb(\u591a\u91cd\u80cc\u5305)\nc(\u5b8c\u5168\u80cc\u5305)\nb --&gt; a\nc --&gt; b</code></pre> <p>Tip</p> <ul> <li>\u4ec5\u5f53 \u201c\u9650\u5236\u201d \u6216 \u201c\u76ee\u6807\u201d \u662f\u4e00\u4e2a\u6574\u6570\u65f6\uff0c\u53ef\u4ee5\u7528 01 \u80cc\u5305<ul> <li>\u901a\u5e38 \u201c\u9650\u5236\u201d \u4f5c\u4e3adp\u7684\u7b2c\u4e8c\u7ef4\uff0cdp \u662f \u201c\u76ee\u6807\u201d\u7684\u590d\u5408\u51fd\u6570  &amp;  \u4ec5\u5f53 \u201c\u9650\u5236\u201d \u662f\u6574\u6570</li> <li>\u6709\u65f6 \u201c\u76ee\u6807\u201d \u4f5c\u4e3adp\u7684\u7b2c\u4e8c\u7ef4\uff0cdp \u662f \u201c\u9650\u5236\u201d\u7684\u590d\u5408\u6849\u6811  &amp;  \u4ec5\u5f53 \u201c\u76ee\u6807\u201d \u662f\u6574\u6570\uff0c\u6700\u540e\u7528\u8d2a\u5fc3\u6c42\u6ee1\u8db3 \u201c\u9650\u5236\u201d \u4e0b\u7684 \u201c\u76ee\u6807\u201d \u503c</li> </ul> </li> <li>01\u80cc\u5305 \u662f\u79bb\u6563\u80cc\u5305\uff08\u4e00\u4e2a\u7269\u54c1\u53ea\u53d61\u6574\u4e2a\uff09\uff0c\u53ea\u80fd\u7528 dp\uff1b\u4e00\u822c\u80cc\u5305 \u662f\u8fde\u7eed\u80cc\u5305\uff0c\u53ea\u80fd\u7528\u8d2a\u5fc3</li> <li>\u6613\u9519<ol> <li>dp \u6570\u7ec4\u4e00\u5b9a\u8981\u521d\u59cb\u5316\uff1b\u666e\u901a\u7684\u6570\u7ec4\uff0c\u5982 <code>vector&lt;int&gt;</code> \u5728\u4f7f\u7528\u524d\u5e94\u8be5\u521d\u59cb\u5316</li> <li>\u6eda\u52a8\u6570\u7ec4\u65f6\uff0c\u7ecf\u5e38\u8981\u5b9a\u4e49 \\(f[0]\\) \u7684\u53d6\u503c\uff1b\u6b64\u5916\uff0c\u4e0d\u6eda\u52a8\u4e5f\u8981\u521d\u59cb\u5316<ul> <li>\u533a\u5206 \u6700\u5927\u5316 \u548c \u6700\u5c0f\u5316 \u65f6\u7684\u53d6\u503c\u884c\u4e3a\uff01\uff01\uff01</li> </ul> </li> <li>\u6709\u65f6\u628a \u9650\u5236\u5206\u91cf \u548c \u76ee\u6807\u5206\u91cf \u641e\u53cd</li> </ol> </li> <li>f \u5e94\u8be5\u5f00\u591a\u5927\uff1f<ul> <li>\u666e\u901a\u60c5\u51b5\u4e0b\uff0c\u7533\u660e\u65b9\u5f0f\u4e3a \\(f[N][N*W]\\)\uff0c\u5373\u9700\u8981 \\(N^2*\\cdot W\\) \u7684\u7a7a\u95f4 \uff08W \u6307\u7684\u662f \u9650\u5236\u5206\u91cf \u7684\u503c\u57df\uff09</li> <li>\u6eda\u52a8\u540e\uff0c\u58f0\u660e\u4e3a \\(f[N*W]\\)\uff0c\u5373\u9700\u8981 \\(N\\cdot W\\) \u7a7a\u95f4</li> </ul> </li> <li>\u5173\u4e8e \u9650\u5236\u5206\u91cf \\(a_i\\) \u7684\u503c\u57df\uff1a<ol> <li>\u82e5 \\(a_i \\in N\\)\uff1a \u90a3\u4e48 \\(a_i\\) \u53ef\u4ee5\u6c42\u89e3\u6ee1\u8db3 \\(\\sum a_i \\le X\\) \u7684\u95ee\u9898</li> <li>\u82e5 \\(a_i \\in Z\\)\uff1a \u90a3\u4e48 f \u7684\u7b2c\u4e8c\u7ef4\u7684\u7a7a\u95f4\u52a0\u4e0a\u504f\u79fb O\uff0c\u81f3\u5c11\u6ee1\u8db3 \\(O = N \\cdot |min\\{a_i\\}|\\)\uff0c\u5982\uff1a\u539f\u70b9\u53d8\u4e3a \\(O + 0\\)\uff0c\u70b9 \\(x\\) \u53d8\u4e3a \\(O + x\\)\uff0c\u90a3\u4e48\u95ee\u9898\u5c31\u8f6c\u5316\u4e3a \u201c1\u201d \u4e86</li> <li>\u82e5 \\(a_i \\in R\\)\uff1a<ul> <li>\u5982\u679c\u8981\u6c42\u76ee\u6807\u7684\u662f \u6700\u5927\u5316 \u6216 \u6700\u5c0f\u5316\uff0c\u5e76\u4e14 \u76ee\u6807\u5206\u91cf \\(b_i \\notin R\\)\uff0c\u90a3\u4e48\u53ef\u4ee5\u5c06\u5206\u91cf\u7684\u5173\u7cfb\u4e92\u6362</li> <li>\u5982\u679c \\(\\sum a_i\\) \u6709\u4e0b\u9650\uff0c\u90a3\u4e48\u6211\u4eec\u5c06\u5176 \u6700\u5927\u5316\uff1b\u5982\u679c \\(\\sum a_i\\) \u6709\u4e0a\u9650\uff0c\u90a3\u4e48\u6211\u4eec\u5c06\u5176 \u6700\u5c0f\u5316</li> <li>\u6700\u540e \u8d2a\u5fc3 \u6c42 \\(\\sum b_i\\)</li> </ul> </li> </ol> </li> </ul> <p>Question</p> <ul> <li>\u6eda\u52a8\u6570\u7ec4\u7684 \u8fed\u4ee3 \u505a\u6cd5\u600e\u4e48\u6620\u5c04\u5230 \u9012\u5f52 \u7684\u505a\u6cd5\u4e0a\uff1f</li> <li>\u4e3a\u4ec0\u4e48\u53ef\u4ee5\u9ed8\u8ba4\u8ba4\u4e3a \\(f_j\\) \u548c \\(f_{j-w_i}\\) \u5b58\u5728\uff1f</li> <li>\"\u6070\u597d\"\u7c7b\u578b\u7684\u95ee\u9898\uff1a\u521d\u59cb\u5316 \\(f\\) \u4e3a \\(inf\\) \u6216 \\(-inf\\)\uff0c\u5c06 \\(f[1..n][0]\\) \u521d\u59cb\u5316\u4e3a\u5408\u9002\u7684\u503c</li> </ul> <p>\u7ea6\u5b9a</p> <ul> <li>w / v - \u9650\u5236\u5206\u91cf / \u76ee\u6807\u5206\u91cf</li> <li>c - \u591a\u91cd\u80cc\u5305\u7684\u7269\u54c1\u6570</li> <li>mw / mv / mc - \u591a\u91cd\u80cc\u5305 \u4e8c\u8fdb\u5236\u4f18\u5316\uff0c\u4e00\u822c\u6bd4\u539f\u6570\u7ec4\u5927 20 \u500d\uff1b\u5206\u522b\u8868\u793a \u9650\u5236\u5206\u91cf / \u76ee\u6807\u5206\u91cf / \u7269\u54c1\u6570</li> <li>a / b - \u4e0d\u660e\u786e\u7684\u5206\u91cf (\u5173\u7cfb\u53ef\u4ee5\u4e92\u6362) \u6216 \u7528\u4e8e\u903b\u8f91\u4e0a\u8868\u793a\u7269\u54c1\u7684\u7cfb\u6570\uff08\u5373\u6240\u53d6\u7684\u7269\u54c1\u6570\uff09</li> </ul>"},{"location":"%E5%88%B7%E9%A2%98/%E9%A2%98%E7%9B%AE%E6%A8%A1%E5%9E%8B/#dp_1","title":"\u533a\u95f4dp","text":"<p>\u7406\u8bba</p> <ul> <li>\u7279\u70b9\uff1a\u5408\u5e76\uff08\u5c06\u591a\u4e2a\u90e8\u5206\u6574\u5408\uff0c\u4e5f\u53ef\u4ee5\u53cd\u8fc7\u6765\uff1f\uff09\uff1b\u80fd\u5c06\u95ee\u9898\u5206\u89e3\u4e3a\u4e24\u4e24\u5408\u5e76\u7684\u5f62\u5f0f\uff1b\u6c42\u89e3\uff1a</li> <li>\u5bf9\u4e8e\u95ed\u533a\u95f4\uff1a\u5408\u5e76\u7684\u65b9\u7a0b\u4e3a \\(f_{i, j} = \\max \\{ f_{i, x} \\circ f(x+1, j) \\circ g_{i, x, j} \\}\\)</li> <li>\u8bbe d \u4e3a\u533a\u95f4 [l, r] \u7684\u957f\u5ea6\uff0c\u5373 d = r-l+1</li> <li>\u8003\u8651\u4e24\u4ef6\u4e8b\uff1a\u7b54\u6848\u662f\u5426\u53ef\u4ee5\u5408\u5e76\uff1f\u533a\u95f4\u662f\u5426\u9700\u8981\u62d3\u5c55\u72b6\u6001\uff1f\u5408\u5e76\u54ea\u4e9b\u533a\u95f4\uff1f\u9898\u76ee\u662f\u5426\u7ed9\u5b9a\u4e86\u8f6c\u79fb\u7684\u9650\u5236\uff1f</li> <li>\u5212\u5206\u7c7b\u578b<ul> <li>\\([l, x] \\circ [x+1, r-1] \\circ [r], x\\in[l, r), a_x=a_r\\)</li> <li>\\([l, x] \\circ [x+1, r], x\\in [l, r)\\)</li> <li>\\([l, x] \\circ [x, r], x\\in (l, r)\\)</li> <li>\\([l] \\circ [l+1, x] \\circ [x+1, r], x\\in [l, r]\\)\uff0c\\([l, x] \\circ [x+1, r-1] \\circ [r], x\\in [l, r]\\)</li> <li>\\([l] \\circ [l+1, r]\\)\uff0c\\([l, r-1] + [r]\\)</li> <li>\u8ba1\u6570\uff1a\\([l, g_l] \\circ [g_l+1, r], g_l\\ne r\\) \u6216 \\([l, g_r-1] \\circ [g_r, r], g_r\\ne l\\)</li> </ul> </li> </ul> <p>\u6d1b\u8c37</p> <ul> <li>A\uff1a\u7ed9\u5b9a n \u5806\u7269\u54c1(\u6bcf\u5806\u521d\u59cb\u6570\u91cf\u4e3a 1)\uff0c\u8fd9\u4e9b\u7269\u54c1\u5faa\u73af\u6210\u94fe\uff0c\u76f8\u90bb\u7684\u4e24\u5806\u5408\u5e76\u7684\u8d21\u732e\u662f \u4e24\u5806\u7269\u54c1\u6743\u503c\u4e4b\u548c\uff0c\u8f93\u51fa\u6240\u6709\u5806\u5408\u5e76 \u6700\u5927/\u6700\u5c0f \u8d21\u732e\u4e4b\u548c</li> <li>B\uff1a\u7ed9\u5b9a n \u4e2a\u6743\u503c\uff0c\\(a_{i}\\) \u548c \\(a_{(i+1)\\%n}\\) \u6784\u6210\u7b2c i \u4e2a\u7269\u54c1 (\u5faa\u73af\u6210\u94fe)\uff0c\u5408\u5e76\u7269\u54c1 i-1 \u548c i\uff0c\u5f97\u5230\u8d21\u732e \\(a_{(i-1)\\%n} \\cdot a_i \\cdot a_{(i+1)\\%n}\\)\uff0c\u751f\u6210\u7684\u65b0\u7269\u54c1\u7531 \\(a_{i-1}\\) \u548c \\(a_{i+1}\\) \u6784\u6210<ul> <li>\u4e24\u4e2a\u7269\u54c1 i-1 \u548c i \u7684\u5408\u5e76\u53ef\u4ee5\u62bd\u8c61\u4e3a\uff1a[i-1, i+1] = [i-1, i] + [i, i+1] + \\(a_{(i-1)\\%n} \\cdot a_i \\cdot a_{(i+1)\\%n}\\)</li> </ul> </li> <li>C\uff1a\u7ed9\u5b9a\u4e00\u4e2a\u77e9\u9635\uff0c\u7b2c k \u6b21\u4ece\u77e9\u9635\u7684\u6bcf\u4e00\u884c\u7684\u5de6\u53f3\u4e24\u7aef\u53d6\u4e00\u4e2a\u6570 x\uff0c\u603b\u5171\u53d6 n \u6b21\uff0c\u6bcf\u6b21\u8d21\u732e \\(2^k \\cdot x\\)\uff0c\u6267\u884c m \u6b21\u540e\u5fc5\u5b9a\u521a\u597d\u53d6\u5b8c\uff0c\u6c42\u6700\u5927\u7684\u8d21\u732e\u4e4b\u548c<ul> <li>\u53ef\u4ee5\u5206\u6790\u51fa\u591a\u4e2a\u884c\u4e4b\u95f4\u53d6\u6570\u7684\u987a\u5e8f\u76f8\u4e92\u72ec\u7acb\uff0c\u6211\u4eec\u53ea\u8981\u91cd\u70b9\u5173\u6ce8\u7b2c i \u884c\u53d6\u6570 m \u6b21\u7684\u60c5\u51b5</li> <li>\\(d \\ge 2\\) \u65f6\uff0c\\([l, r] = max{ [l+1, r] + 2^{m-d+1}, [l, r-1] + 2^{m-d+1} }\\)</li> <li>d = 1 \u65f6\uff0c\\([l, r] = 2^m\\)</li> </ul> </li> <li>D\uff1a</li> </ul> <p>vjudge</p> <ul> <li>B\uff1a\u7ed9\u5b9a n \u4e2a\u6570 \u548c \u4e00\u4e2a\u6808\uff0c\u8981\u6c42\u4ece\u5de6\u5230\u53f3\u904d\u5386\u8fd9 n \u4e2a\u6570\uff0c\u904d\u5386\u5230\u7b2c i \u4e2a\u6570\u65f6\uff0c\u6808\u5fc5\u987b \u52a0\u5165\u4e00\u4e2a\u6570(\u8d21\u732e\u4e3a 1) \u6216 \u51fa\u6808 y \u4e2a\u6570(\u8d21\u732e\u4e3a 0) \u4f7f\u5f97 \\(\u6808\u9876 = a_i\\)\uff1b\u6700\u5c0f\u5316\u904d\u5386\u5b8c n \u4e2a\u6570\u540e\u7684\u8d21\u732e\u4e4b\u548c<ul> <li>\u9ed8\u8ba4\u4f7f\u7528\u533a\u95f4dp\uff08\u539f\u7406\u4e0d\u660e\uff09</li> <li>\u82e5 d = 1\uff0c \\(f_{l, r} = 1\\)</li> <li>\u82e5 d &gt; 1\uff0c$f_{l, r} $\u6709\u4e24\u79cd\u9009\u62e9\uff1a\uff08\u4ece\u201c\u5982\u4f55\u4f7f \\(\u6808\u9876=a_r\\)\u201d \u6765\u8003\u8651\u533a\u95f4\u600e\u4e48\u5212\u5206\uff09<ol> <li>\\(f_{l, r-1}\\) \u603b\u662f\u53ef\u4ee5\u5165\u6808\u4e00\u4e2a\u6570\uff0c\u5408\u5e76\u533a\u95f4 [l, r-1] \u548c [r, r]</li> <li>\u82e5 \\(a_x = a_r\\) (\\(l \\le x \\le r-1\\))\uff0c\u6211\u4eec\u9009\u62e9\u51fa\u6808 \\([x+1, r-1]\\) \u5185\u7684 r-x-1 \u4e2a\u6570 (\u8d21\u732e\u4e3a 0)\uff0c\u5408\u5e76\u533a\u95f4 [l, x] \u548c [x+1, r-1] \u4ee5\u53ca [r, r]</li> </ol> </li> </ul> </li> <li>C\uff1a\u7ed9\u5b9a\u4e00\u4e2a\u53ef\u80fd\u975e\u6cd5\u7684\u62ec\u53f7\u5e8f\u5217\uff0c\u6c42\u51fa \u6700\u957f\u7684\u5408\u6cd5\u62ec\u53f7\u5b50\u5e8f\u5217 \u7684\u957f\u5ea6<ul> <li>\u6027\u8d28\uff1a\u5b50\u5e8f\u5217\u7684\u8d21\u732e\u53ef\u4ee5\u5408\u5e76\uff1b</li> </ul> </li> <li>D\uff1a\u7ed9\u5b9a\u4e00\u4e2a\u5408\u6cd5\u7684\u62ec\u53f7\u5e8f\u5217\uff0c\u8ba1\u7b97\u7740\u8272\u65b9\u6848\u603b\u6570\uff1b\u9650\u5236\uff1a\u53ef\u4ee5\u4e0d\u67d3\u8272 / \u67d3\u7ea2\u8272 / \u67d3\u84dd\u8272\uff0c\u5339\u914d\u7684\u62ec\u53f7\u6709\u4e14\u4ec5\u6709\u4e00\u4e2a\u67d3\u8272(\u9650\u52362)\uff0c\u76f8\u90bb\u62ec\u53f7\u989c\u8272\u4e0d\u540c(\u9650\u52363)  (N = 700)<ul> <li>\u6ce8\u610f\u5230\u76f8\u90bb\u62ec\u53f7\u989c\u8272\u4e0d\u540c\u7684\u9650\u5236\uff0c\u82e5\u76f4\u63a5\u7528 \\(f_{l, r}\\) \u8868\u793a\u533a\u95f4\u5185\u7684\u65b9\u6848\u6570\uff0c\u90a3\u4e48\u5c31\u96be\u4ee5\u4ece\u5c0f\u7684\u533a\u95f4\u8f6c\u79fb\u5230 \\(f_{l, r}\\)</li> <li>\u4e00\u4e2a\u5408\u7406\u7684\u72b6\u6001\u662f \\(f_{l, r, x, y}\\) \u8868\u793a [l, r] \u533a\u95f4\u4e2d\uff0c\u5de6\u53f3\u62ec\u53f7\u989c\u8272\u5206\u522b\u4e3a x, y \u7684\u65b9\u6848 (\\(x, y \\in 0..2\\))<ul> <li>\u9650\u52362\u6784\u6210\u7684\u5408\u6cd5\u72b6\u6001\u6709\uff1a01, 02, 10, 20</li> <li>\u9650\u52363\u6392\u9664\u7684\u5408\u6cd5\u72b6\u6001\uff1a1-1, 2-2</li> </ul> </li> <li>\u82e5 d = 1\uff0c\u6ca1\u6709\u65b9\u6848</li> <li>\u82e5 d = 2\uff0c01, 02, 10, 20 \u5747\u6709 1 \u4e2a\u65b9\u6848</li> <li>\u82e5\u4e0e \\(s_l\\) \u5339\u914d\u7684\u662f \\(s_r\\)\uff1a\u8bf4\u660e \\(f_{l, r}\\) \u6ca1\u6709\u66f4\u65b0\u8fc7\u72b6\u6001\uff0c\u6b64\u65f6\u4ece \\(f_{l+1, r-1}\\) \u4e2d\u66f4\u65b0\u72b6\u6001</li> <li>\u82e5\u4e0e \\(s_l\\) \u5339\u914d\u7684\u4e0d\u662f \\(s_r\\)\uff1a\u5219 \\(f_{l, r}\\) \u4ece \\(f_{l, g_l}\\) \u548c \\(f_{g_l+1, r}\\) \u4e2d\u66f4\u65b0\u72b6\u6001</li> <li>\u6ce8\uff1a\u53e6\u5f00\u4e00\u4e2a\u6570\u7ec4\uff0c\u5b58\u50a8\u5bf9\u4e8e i\uff0c\u4e0e\u5176\u5339\u914d\u7684\u53f3\u62ec\u53f7 \uff08\u53cd\u7740\u6765\u4e5f\u53ef\u4ee5\uff09\uff0c\u5426\u5219\u4f1a TLE</li> </ul> </li> <li>E\uff1a</li> <li>F\uff1a\u5916\u5356\u9a91\u624b\u521d\u59cb\u4f4d\u4e8e\u4e00\u7ef4\u5750\u6807\u7684 p \u70b9\uff0c\u8f66\u5b50\u9a91\u884c\u6bcf\u7c73\u82b1\u8d39 v \u79d2\uff1bn \u4e2a\u70b9\u9910\u8005\u4f4d\u4e8e \\(x_i\\) \u5904\uff0c\u5e76\u540c\u65f6\u70b9\u9910\uff0c\u800c\u4e14\u6bcf\u8fc7 1 \u79d2\u8d21\u732e \\(a_i\\) \u7684\u4e0d\u6ee1\u5ea6\uff1b\u6700\u5c0f\u5316\u4e0d\u6ee1\u5ea6\u4e4b\u548c<ul> <li>\u5047\u8bbe\u9a91\u624b\u6bcf\u6b21\u9001\u5b8c\u5916\u5356\u540e(\u9664\u4e86\u521d\u59cb\u70b9\u5916)\uff0c\u603b\u662f\u505c\u5728\u533a\u95f4\u7aef\u70b9\u5904\uff08\u5982\u4f55\u8bc1\u660e\uff1f\uff09</li> <li>\u90a3\u4e48\uff0c\u5bb9\u6613\u5b9a\u4e49\u533a\u95f4 [l, r] \u7684\u72b6\u6001\u4e3a \\(f_{l, r, s}\\) (\\(s=0..1\\))\uff0cs \u6307\u9a91\u624b\u5728 \u5de6\u7aef\u70b9 \u6216 \u53f3\u7aef\u70b9 \u7684\u72b6\u6001</li> <li>\u82e5 d = 1\uff0c</li> </ul> </li> <li>G\uff1a\u7ed9\u5b9a n \u4e2a\u4eba\u7684\u961f\u5217\uff0c\u6bcf\u4e2a\u4eba(id=i) \u51fa\u961f\u90fd\u4f1a\u8d21\u732e \\(k\\cdot a_i\\)\uff08k \u4e3a\u5728\u6b64\u4eba\u4e4b\u524d\u51fa\u961f\u7684\u603b\u4eba\u6570\uff09\uff1b\u518d\u7ed9\u4e00\u4e2a\u6808\uff0c\u7528\u6765\u98a0\u5012\u961f\u5217\u67d0\u4e2a\u533a\u95f4\u5185\u7684\u51fa\u961f\u987a\u5e8f (\u7531\u4e8e\u6808\u7684 \u5148\u8fdb\u540e\u51fa \u539f\u7406)\uff0c\u6808\u53ef\u4ee5\u4f7f\u7528\u591a\u6b21\uff1b\u6700\u5c0f\u5316\u8d21\u732e\u4e4b\u548c<ul> <li>\u51b3\u7b56\uff1a\\([l]+[l+1,x]+[x+1,r] \\to [l+1,x]+[l]+[x+1,r]\\) (\\(x\\in [l, r]\\)) \uff08\u98a0\u5012 [l, x] \u7684\u987a\u5e8f\u8ba9 x \u6700\u5148\u51fa\u961f\uff09</li> <li>d = 1, \\(f_{l, r} = 0\\)</li> <li>d &gt; 1, \\(f_{l, r} = \\min\\{ f_{l+1, x} + a_l\\cdot(x-l) + f_{x+1, r}+\\sum\\limits_{i=l}^x a_i \\cdot(x-l+1) \\}\\)</li> </ul> </li> <li>H\uff1a\u7ed9\u5b9a\u4e24\u4e2a\u5b57\u7b26\u4e32 a \u548c b\uff0c\u6bcf\u6b21\u53ef\u4ee5\u5c06 a \u7684\u4e00\u6bb5\u8fde\u7eed\u7684\u5b50\u4e32\u4fee\u6539\u4e3a\u540c\u4e00\u4e2a\u5b57\u7b26\uff0c\u6c42\u5c06 a \u8f6c\u6362\u4e3a b \u7684\u6700\u5c0f\u4fee\u6539\u6b21\u6570<ol> <li>\\(f_{l, r}\\) \u4e3a\u5c06\u7a7a\u4e32\u8f6c\u5316\u4e3a b \u7684\u6700\u5c0f\u6b21\u6570</li> <li>\\(g_i\\) \u4e3a\u5c06 a \u7684\u67d0\u6bb5\u524d\u7f00\u8f6c\u5316\u4e3a b \u7684\u524d\u7f00\u7684\u6700\u5c0f\u6b21\u6570</li> </ol> </li> </ul>"},{"location":"%E5%88%B7%E9%A2%98/%E9%A2%98%E7%9B%AE%E6%A8%A1%E5%9E%8B/#dp_2","title":"dp\u4f18\u5316","text":"<p>1. \u6eda\u52a8\u6570\u7ec4</p> <ul> <li>\u82e5 \\(f_{i, j}\\) \u53ea\u7531 \\(f_{i-1, k}, k\\le j\\) \u6216 \\(f_{i-1, k}, k\\ge j\\) \u8f6c\u5316\u800c\u6765\uff0c\u90a3\u4e48\u53ef\u4ee5\u6eda\u52a8\u6210 \\(f_j\\) \uff08\u6b64\u65f6\u5e94\u6ce8\u610f\u904d\u5386\u987a\u5e8f\uff09</li> <li>\u82e5 \\(f_{i, j}\\) \u6709 \\(f_{i-x, y}, x\\ge 0, y\\in Z\\) \u8f6c\u5316\u800c\u6765\uff0c\u90a3\u4e48\u7b2c\u4e00\u7ef4\u53ef\u4ee5\u538b\u7f29\u4e3a r = max{x}+1 \u5c42\uff0c\u5373\u6eda\u52a8\u4e3a \\(f_{(i-x)\\% r, y}\\)</li> </ul> <p>2. \u5355\u8c03\u961f\u5217\u4f18\u5316</p> <ul> <li>\u89e3\u51b3\u7684\u95ee\u9898\uff0c\u5982\uff1a\\(f_i = \\max\\{ f_{i'} + g_{i} + h_{i'} \\}\\)</li> <li>\u9002\u7528\u4e8e \u524d\u7f00dp \u4e2d\uff0c\u4f18\u5316\u8ba1\u7b97\u4e0a\u4e00\u4e2a\u72b6\u6001\u7684\u67d0\u4e00\u8fde\u7eed\u533a\u95f4\u7684\u6700\u4f18\u503c\uff08\u5373 RMQ \u64cd\u4f5c\uff09\uff0cSTL\u4e2d\u4f7f\u7528 <code>deque</code> \u7ef4\u62a4</li> <li>\u5b9a\u4e49\uff1a<ul> <li>\u521d\u59cb\u5316\uff1al=1, r=0\uff1b\u961f\u5217\u4e3a\u7a7a\uff1al &gt; r</li> <li>\u5c3e\u90e8\u67e5\u8be2\uff1a\\(q_r\\)\uff1b\u5c3e\u90e8\u5165\u961f\uff1aq[++r] = val</li> <li>\u5934\u90e8\u67e5\u8be2\uff1a\\(q_l\\)</li> <li>\u7ef4\u62a4\u533a\u95f4\uff1a\\([q_l, pos]\\)\uff0c\u7ef4\u62a4\u7684\u533a\u95f4\u957f\u5ea6\uff1a\\(pos-q_l+1\\)\uff0c\u7ef4\u62a4\u7684\u5b50\u5e8f\u5217\u957f\u5ea6 = \\(q.size()\\)</li> <li>\u533a\u95f4\u7aef\u70b9\u4e00\u822c\u6ee1\u8db3\u9650\u5236\uff1a\\(q_l \\ge i-left\\_len\\)\uff0c\\(pos \\le i+right\\_len\\)</li> </ul> </li> <li>\u6a21\u677f(\u4f2a\u4ee3\u7801) \uff08\u7ef4\u62a4\u533a\u95f4 \\([i-left_len, i+right_len]\\) \u7684\u5b50\u5e8f\u5217\uff1b\u4ee5\u6c42 \u6700\u5927\u503c(\u5355\u8c03\u9012\u51cf) \u4e3a\u4f8b\uff09     <pre><code>for(int i=1; i&lt;=n; ++i){\n    for(; pos&lt;=min(n, i+right_len); ++pos){\n        for(;; --r) if(l&gt;r || f o q[r] &gt; f o pos) break; // \u7ef4\u62a4\u5355\u8c03\u6027\n        q[++r] = pos;\n    }\n    for(; q[l]&gt;=max(1, i-left_len); ++l);\n\n    output -&gt; f o q[l]\n}\n</code></pre></li> <li>\u4f18\u5316\u591a\u91cd\u80cc\u5305\uff1a\\(\\displaystyle f_{i, j} = \\max\\{ f_{i-1, j-k\\cdot w_i} + k\\cdot v_i \\}, k\\in[0,\\min\\{ c_i,\\frac {max\\_w}{v_i} \\}]\\)<ul> <li>\u4ee4 \\(j = d + K_0\\cdot w_i\\)\uff0c\u5176\u4e2d \\(K_0\\) \u4e3a \\(f_{i,j}\\) \u679a\u4e3e k \u540e\u5f97\u5230\u6700\u4f18\u89e3\uff0c\u5e76\u4e14\\(K\\in []\\)\uff0c\\(d\\in [0, w_i)\\)\uff0c</li> <li>\u90a3\u4e48 \\(\\displaystyle f_{i, d + K_0\\cdot w_i} = \\max\\{ f_{i-1,d+K_0\\cdot w_i-k\\cdot w_i} +k\\cdot v_i\\} = \\max\\{ f_{i-1,d+(K_0-k)w_i} -(K_0-k)\\cdot v_i\\} + K_0\\cdot v_i\\)</li> <li>\u4ee4 \\(x = K_0 - k\\)\uff0c\u5f97\u5230 \\(\\displaystyle \\max\\{ f_{i-1,d+x\\cdot w_i} -x\\cdot v_i\\} + K_0\\cdot v_i\\)\uff0c\u5176\u4e2d \\(d\\in[0, w_i)\\)\uff0c\\(d+K_0\\cdot w_i \\le max\\_w\\)</li> <li>\u6211\u4eec\u5206\u522b\u679a\u4e3e d \u548c \\(K_0\\)\uff0c\u4f7f\u7528\u5355\u8c03\u961f\u5217\u7ef4\u62a4 x (\u5373\\(q_l\\))\uff08\u9650\u5236\u4e3a \\(K_0-x = k \\le c_i\\)\uff09</li> </ul> </li> </ul> \u6a21\u677f<pre><code>for(int i=1; i&lt;=n; ++i){\n    int v, w, s;\n    cin &gt;&gt; v &gt;&gt; w &gt;&gt; s;\n    for(int d=0; d&lt;v; ++d){\n        int l=1,r=0;\n        for(int K0=0, j; j=K0*v+d, j&lt;=m; ++K0){\n            #define val(x) (g[d + x * v] - x * w)\n            for(;; --r) if(l&gt;r || val(q[r]) &gt; val(K0)) break;\n            q[++r] = K0;\n            for(;; ++l) if(l&gt;r || K0-q[l] &lt;= s) break;\n//              cout &lt;&lt; K0 &lt;&lt; ' ' &lt;&lt; q[l] &lt;&lt; '\\n';\n            f[j] = val(q[l]) + K0 * w;\n        }\n    }\n    memcpy(g, f, sizeof f);\n}\n</code></pre> <p>\u53c2\u8003\uff1aA</p> <p>\u7ec3\u4e60</p> <ul> <li>A\uff1a\u7ed9\u5b9a01\u77e9\u9635 \\(n \\times m\\)\uff0c\u521d\u59cb\u4f4d\u7f6e \\((s, t)\\)\uff0cK \u6b21\u53ef\u5411\u4e0a\u4e0b\u5de6\u53f3\u56db\u4e2a\u65b9\u5411(\u4ee5 1~4 \u6807\u8bc6)\u79fb\u52a8\u6700\u5927\u8ddd\u79bb \\(d_i\\)\uff0c\u6c42\u6700\u5927\u79fb\u52a8\u8ddd\u79bb\uff1b\u9650\u5236\uff1a\u5730\u56fe\u4e0a\u4e3a 0 \u7684\u70b9\u4e0d\u53ef\u8d70<ul> <li>\u5bb9\u6613\u5f97\u5230\u72b6\u6001\uff1a \\(f_{k, x, y}\\) \u4e3a\u524d k \u6b21\u79fb\u52a8\u540e\u8fbe\u5230 (x, y) \u7684\u6700\u5927\u79fb\u52a8\u8ddd\u79bb</li> <li>\u8f6c\u79fb\u65b9\u7a0b\uff1a \\(f_{k, x, y} = \\max \\{ f_{k-1, x', y'} \\}\\)\uff0c\\(|x-x'|\\le d_i, |y-y'|\\le d_i\\) \uff08\u5177\u4f53\u6709\u56db\u79cd\u53ef\u80fd\u7684\u8f6c\u79fb\u72b6\u6001\uff09</li> <li>\u5355\u8c03\u961f\u5217\u4f18\u5316\u540e\u7684\u590d\u6742\u5ea6\uff1a\\(O(K\\cdot N\\cdot M)\\)</li> </ul> </li> <li>B\uff1an \u5929\u4ee5\u5185\uff0c\u6700\u591a\u6301\u6709 m \u4e2a\u80a1\u7968\uff1b\u6bcf\u4e00\u5929\u90fd\u6709 \u4e70\u5165\u80a1\u7968\u4ef7\u683c \\(a_i\\) \u548c \u4e70\u5165\u9650\u5236\u6570\u91cf \\(la_i\\)\uff0c\u5356\u51fa\u80a1\u7968\u4ef7\u683c \\(b_i\\) \u548c \u5356\u51fa\u9650\u5236\u6570\u91cf \\(lb_i\\)\uff1b\u53e6\u5916\uff0c\u4ea4\u6613(\u4e70\u5165/\u5356\u51fa \u80a1\u7968)\u65f6\u95f4\u81f3\u5c11\u8981\u95f4\u9694 w \u5929\uff08\u5047\u8bbe\u6709\u4e24\u4e2a\u4ea4\u6613\u65e5 i \u548c j\uff0c\u5176\u4e2d \\(i\\le j-w-1\\)\uff09<ul> <li>\u51b3\u7b56\uff1a\u4e0d\u8f6c\u79fb / \u91cd\u65b0\u5f00\u59cb\uff0c\u8f6c\u79fb\u4f46\u4e0d\u4ea4\u6613 (\\(f_{i,j} = f_{i-1, j}\\))\uff0c\u8f6c\u79fb&amp;\u4ea4\u6613</li> <li>\\(f_{i, j} = \\max \\begin{cases} - j\\cdot a_i &amp; j\\le la_i \\\\ f_{i-1, j} \\\\ f_{i-w-1, j'} - |j-j'|\\cdot a_i &amp;  i &gt; w+1, j-j' \\le la_i \\\\ f_{i-w-1, j'} + |j-j'|\\cdot b_i &amp; i &gt; w+1, j'-j\\le lb_i \\end{cases}\\)\uff0c\\(f_{0,j}=-\u221e\\) (\u5373\u7b2c 0 \u5929\u4e0d\u53ef\u8f6c\u79fb)</li> <li>\u6ce8\u610f\uff1a\u7b2c\u4e00\u79cd\u60c5\u51b5\u7684 \\(j\\le la_i\\) \u5e76\u4e0d\u610f\u5473\u7740\u51b3\u7b56\u7684\u590d\u6742\u5ea6\u662f \\(O(1)\\)\uff0c\u76f8\u53cd\uff0c\u5b83\u662f\u5e38\u6570\u7684\uff1b\u6700\u540e\u4e24\u79cd\u51b3\u7b56\u590d\u6742\u5ea6\u662f \\(O(n)\\) \u7684\uff0c\u7528\u6839\u636e j-j' \u7684\u6b63\u8d1f\u53f7\u51b3\u5b9a\u5355\u8c03\u961f\u5217\u4f18\u5316\u7684\u904d\u5386\u65b9\u5411\u662f\u6b63\u8fd8\u662f\u8d1f</li> </ul> </li> </ul> <p>Warning</p> <ul> <li>\u591a\u91cd\u80cc\u5305\u7684\u6a21\u578b\u662f \\(f_{i,j} = \\max \\{ f_{i-1,j-k\\cdot w_i} + k\\cdot v_i \\}\\)\uff0c\u4e0d\u5c5e\u4e8e \\(f_{i,j} = \\max \\{ f_{i-1, j'} + g_{j} + h_{j'} \\}\\) \uff08\u5355\u8c03\u961f\u5217\u53ef\u4ee5\u4f18\u5316\u4e0e\u67d0\u4e00\u4e2a\u7ef4\u5ea6\u8026\u5408\u7684\u51b3\u7b56\u8fc7\u7a0b\uff09</li> </ul> <p>3. \u659c\u7387\u4f18\u5316</p> <ul> <li>\u89e3\u51b3\u7684dp\u95ee\u9898 (1D/2D)\uff0c\u5982\uff1a\\(f_i = \\max \\{ f_j + g_i + s_i\\cdot t_j \\}\\)\uff08\u8be5\u5f0f\u5b50\u9700\u8981\u901a\u8fc7\u4e00\u5b9a\u7684\u6570\u5b66\u4ee3\u6362\uff1b\u7531\u4e8e\u5b58\u5728 i \u4e0e j \u8026\u5408\u7684\u5f0f\u5b50\uff0c\u6240\u4ee5\u5355\u7eaf\u7684\u5355\u8c03\u961f\u5217\u65e0\u6cd5\u89e3\u51b3\uff09</li> <li>\u5f97\u5230\u7c7b\u4f3c \\(f_i - g_i = \\max \\{ f_j - t_i\\cdot s_j \\}\\) \u7684\u5f62\u5f0f\u540e\uff0c\u5f0f\u5b50\u7c7b\u4f3c\u4e8e \\(b_i = y_j - k_i\\cdot x_j\\)\uff08\u6ce8\u610f\uff1a\u5bf9\u4e8e\u5f53\u524d\u7684 i\uff0c\\(k_i\\) \u4e3a\u5b9a\u503c\uff0c\\(y_j\\) \u548c \\(x_j\\) \u4e3a\u5f53\u524d\u679a\u4e3e\u503c\uff0c\u7528\u4e8e\u8ba1\u7b97 \\(b_i\\)\uff09</li> </ul> <p>\u6a21\u677f(\u4ee5\u6700\u5927\u5316\u4e3a\u4f8b\uff0c\u6700\u5c0f\u5316)</p> <pre><code>double k(int i, int j){\n    #define Y(x) (...)\n    #define X(x) (...)\n    if(X(i)==X(j)) return 1e18;   // -1e18\n    return (Y(j)-Y(i))/(.0 + X(j)-X(i));\n}\n</code></pre> <pre><code>int l=1,r=0;\nfor(int i=1; i&lt;=n; ++i){\n    #define K(x) (...)\n    #define B'(x) (...)\n    for(;; ++l) if(l+1&gt;r || k(q[l], q[l+1]) &lt; K(i)) break;\n\n    // \u8bb0\u5f55 \u7b54\u6848 \u6216 \u5177\u4f53\u65b9\u6848\n    f[i] = Y(q[l]) - X(q[l]) * K(i) - B'(i); // \u6216\u8005\n\n    for(;; --r) if(l+1&gt;r || k(q[r-1], q[r]) &gt; k(q[r], i)) break;\n    q[++r] = i;\n}\n</code></pre> <p>\u7ec3\u4e60</p> <ul> <li>A\uff1a\\(f_{i,j} = \\max \\{ f_{i-1, j'} + s_{j'}(s_j - s_{j'}) \\}\\) \uff08s[ ] \u4e3a a[ ] \u7684\u524d\u7f00\u548c\uff09<ul> <li>\u6734\u7d20dp\u7684\u590d\u6742\u5ea6\u662f \\(O(N\\cdot M^2)\\)</li> </ul> </li> <li>B\uff1a</li> <li>C</li> <li>D</li> <li>E</li> <li>F</li> <li>G</li> <li>H</li> <li>I</li> <li>J</li> </ul> <p>4. \u5e73\u884c\u56db\u8fb9\u5f62\u4f18\u5316</p> <ul> <li>\u89e3\u51b3\u7684\u95ee\u9898\uff0c\u4f8b\u5982\uff1a\u77f3\u5b50\u5408\u5e76\u95ee\u9898 \\(f_{l, r} = \\max \\{ f_{l, x} + f_{x+1, r} \\} + w_{l, r}\\)\uff0c(\\(x\\in [l, r)\\))</li> <li>\u6027\u8d28<ol> <li>\u533a\u95f4\u5305\u542b\u5355\u8c03\u6027\uff1a\u5bf9\u4e8e \\(l \\le l' \\le r' \\le r\\)\uff0c\u5747\u6709 \\(w_{l', r'} \\le w_{l, r}\\) \u6210\u7acb\uff0c\u5219\u79f0\u51fd\u6570 <code>w</code> \u5bf9\u4e8e\u533a\u95f4\u5305\u542b\u5173\u7cfb</li> <li>\u56db\u8fb9\u5f62\u4e0d\u7b49\u5f0f\uff1a\u5bf9\u4e8e\u4efb\u610f \\(l_1 \\le l_2 \\le r_1 \\le r_2\\)\uff0c\u5747\u6709 \\(w_{l_1, r_1} + w_{l_2, r_2} \\le w_{l_1, r_2} + w_{l_2, r_1}\\) \uff08\u975e\u5f62\u5f0f\u5316\u5730\u63cf\u8ff0\u4e3a \u300c\u4ea4\u53c9\u4e0d\u5927\u4e8e\u5305\u542b\u300d\uff09</li> </ol> </li> <li>\u8bb0\u53f7\uff1a<ul> <li>\\(g_{x,l,r} = f_{l,x} + f_{x+1, r} + w_{l, r}\\) \u8868\u793a\u5f53\u51b3\u7b56\u4e3a k \u65f6\u7684\u72b6\u6001\u503c</li> <li>\u4efb\u53d6 \\(l_1\\le l_2 \\le r_1 \\le r_2\\)\uff0c\u8bb0 \\(u = \\arg \\min\\{ g_{x,l_1,r_2} \\}, v = \\arg \\min \\{ g_{x, l_2, r_1} \\}\\) \u5206\u522b\u8868\u793a\u72b6\u6001 \\(f_{l_1, r_2}\\) \u548c \\(f_{l_2, r_1}\\) \u7684\u6700\u5c0f\u6700\u4f18\u51b3\u7b56\u70b9</li> <li>\u8bb0 \\(m_{l,r} = \\min \\{ x: f_{l,r} = g_{x,l,r} \\}\\) \u4e3a f \u7684\u6700\u4f18\u51b3\u7b56\u70b9</li> </ul> </li> <li>\u5b9a\u7406<ol> <li>\u82e5 \\(w_{l, r}\\) \u6ee1\u8db3\u533a\u95f4\u5305\u542b \u5355\u8c03\u6027 \u548c \u56db\u8fb9\u5f62\u4e0d\u7b49\u5f0f\uff0c\u5219\u72b6\u6001 \\(f_{l,r}\\) \u6ee1\u8db3\u56db\u8fb9\u5f62\u4e0d\u7b49\u5f0f \uff08\u8bc1\u660e\uff09</li> <li>\u5047\u8bbe f \u6ee1\u8db3\u56db\u8fb9\u5f62\u4e0d\u7b49\u5f0f\uff0c\u82e5 \\(m_{l, r} = \\min \\{ x: f_{l,r} = g_{x,l,r} \\}\\) \u4e3a\u6700\u4f18\u51b3\u7b56\u70b9\uff0c\u5219\u6709 \\(m_{l, r-1} \\le m_{l,r} \\le m_{l+1,r}\\)  (l + 1 &lt; r)</li> </ol> </li> </ul> <p>\u7ec3\u4e60</p> <ul> <li>A</li> <li>B</li> <li>C</li> <li>D</li> <li>E</li> <li>F</li> </ul> <p>\u53c2\u8003</p> <ul> <li>\u9898\u5355</li> <li>dp\u5404\u79cd\u4f18\u5316</li> <li>Garsia-Wachs\uff0cGarsia-Wachs</li> </ul> <p>Else</p> <ul> <li>\u5e26\u6743\u4e8c\u5206\u3001FFT\u5206\u6cbb\u3001CDQ\u5206\u6cbb\u4f18\u5316\u3001FFT\u5206\u6cbb\u4f18\u5316\u3001CDQ\u5206\u6cbb\u4f18\u5316\uff0c\u5e73\u8861\u6811\u4f18\u5316\u3001wqs\u4e8c\u5206\uff0c\u5e26\u6743\u4e8c\u5206\u3001Garsia-Wachs</li> </ul>"},{"location":"%E5%88%B7%E9%A2%98/%E9%A2%98%E7%9B%AE%E6%A8%A1%E5%9E%8B/#st","title":"ST\u8868","text":"<ul> <li>\u7406\u8bba\uff1a<ul> <li>\u7528\u4e8e\u9759\u6001\u7ef4\u62a4 \u53ef\u91cd\u590d\u8d21\u732e\u8fd0\u7b97 \u533a\u95f4\u4fe1\u606f</li> <li>\u652f\u6301\u7684\u8fd0\u7b97\u5e94\u6ee1\u8db3\uff1a\u53ef\u91cd\u590d\u8d21\u732e\uff0c\u7ed3\u5408\u5f8b<ul> <li>\u5982\uff1a\u6309\u4f4d\u4e0e(&amp;)\uff0c\u6309\u4f4d\u6216(|)\uff0cgcd</li> </ul> </li> <li>\u5b9a\u4e49 \\(f_{i, j}\\) \u4e3a\u533a\u95f4 \\([i, i+2^{j})\\) \u7684\u4fe1\u606f\uff0coperate(-, -) \u4e3a\u53ef\u91cd\u590d\u8d21\u732e\u7684\u4e8c\u5143\u8fd0\u7b97<ul> <li>\u50cf \\([x, x+f_{x}]\\) \u5b9a\u4e49\u533a\u95f4\u7684\u65b9\u5f0f\u53ef\u4ee5\u7406\u89e3\u4e3a \"\u589e\u91cf\u5b9a\u4e49\u533a\u95f4\" \u6216 \"\u500d\u589e\u5212\u5206\u533a\u95f4\"</li> <li>\u72b6\u6001\u65b9\u7a0b\uff1a\\(f_{i, j} = operate(f_{i, j-1}, f_{i+2^{j-1}, j-1}), f_{i, 0} = a_i\\)</li> <li>\u67e5\u8be2\u533a\u95f4\u4fe1\u606f\uff1a\\(query(l, r) = operate(f_{l, \\lfloor \\log2(r-l+1)\\rfloor}, f_{r-2^{\\lfloor \\log2(r-l+1)\\rfloor}, \\lfloor \\log2(r-l+1)\\rfloor})\\)<ul> <li>\u7b80\u8bb0\u4e3a \\(query(l, r) = operate(f_{l, \\Delta}, f_{r-2^{\\Delta}, \\Delta}), \\Delta = \\lfloor \\log2(r-l+1)\\rfloor\\)</li> </ul> </li> </ul> </li> </ul> </li> </ul>"},{"location":"%E5%88%B7%E9%A2%98/%E9%A2%98%E7%9B%AE%E6%A8%A1%E5%9E%8B/#_4","title":"\u53cc\u6307\u9488","text":""},{"location":"%E5%9F%BA%E7%A1%80/%E5%89%8D%E7%BC%80%E5%92%8C%26%E5%B7%AE%E5%88%86/","title":"\u524d\u7f00\u548c&\u5dee\u5206","text":""},{"location":"%E5%9F%BA%E7%A1%80/%E5%89%8D%E7%BC%80%E5%92%8C%26%E5%B7%AE%E5%88%86/#_1","title":"\u524d\u7f00\u548c&\u5dee\u5206","text":""},{"location":"%E5%9F%BA%E7%A1%80/%E5%89%8D%E7%BC%80%E5%92%8C%26%E5%B7%AE%E5%88%86/#1","title":"1.\u524d\u7f00\u548c","text":"<p>\u524d\u7f00\u548c\u662f\u4e00\u79cd\u9884\u5904\u7406\u65b9\u5f0f\uff0c\u53ef\u4ee5\u5e94\u7528\u4e8e \u591a\u6b21 \u9759\u6001 \u5feb\u901f\u67e5\u8be2 (O(1)) \u533a\u95f4\u548c</p> <p>Tip</p> <ul> <li>\u6570\u7ec4\u524d\u7f00\u53d8\u6362\u540e \u4e0d\u652f\u6301\u4fee\u6539</li> </ul> <p>Note</p> <p>c++\u6807\u51c6\u5e93 <code>&lt;numeric&gt;</code> \u662f\u5b9e\u73b0\u4e86\u524d\u7f00\u548c <code>std::partial_sum(bg, ed, &lt;\u8f93\u51fa\u8fed\u4ee3\u5668&gt;)</code></p> <p>\u4e00\u7ef4\u524d\u7f00\u548c</p> <p>\u7ed9\u5b9a\u4e00\u7ef4\u6570\u7ec4 a[ ]\uff0c\u4ee4 s[ ] \u4e3a\u524d\u7f00\u548c</p> <p>\\(s_i = \\sum\\limits_{j=1}^{i} a_i\\)  &amp;  \\(i=2..n\\)</p> <ol> <li> <p>\u9884\u5904\u7406</p> <p>\u663e\u7136 \\(s_i = s_{i-1} + a_i\\)</p> <pre><code>// 1. \u8986\u76d6\u539f\u6709\u6570\u7ec4\nfor i=1..n\n     a[i] += a[i-1];\n\n// 2. \u72ec\u7acb\u5b58\u50a8 \u524d\u7f00\u548c\u6570\u7ec4\nfor i=1..n\n    s[i] = s[i-1] + a[i];\n</code></pre> </li> <li> <p>\u67e5\u8be2</p> </li> </ol> <p>\u533a\u95f4 [l, r] \u4ee5\u5185\u7684\u548c \\(\\sum\\limits_{i=l}^r s_i = s_r - s_{l-1}\\)</p> <p>\u4e8c\u7ef4\u524d\u7f00\u548c</p> <p>\u7ed9\u5b9a\u4e8c\u7ef4\u6570\u7ec4 a[ ][ ]\uff0c\u4ee4 s[ ][ ] \u4e3a\u524d\u7f00\u548c  \uff08\\(a_{0,*} = a_{*, 0} = 0\\)\uff09</p> <p>\\(s_{i, j} = \\sum\\limits_{k=1}^{i}\\sum\\limits_{l=1}^{j} a_{k, l}\\)   &amp;   \\(i=1..n, j=1..m\\)</p> <ol> <li> <p>\u9884\u5904\u7406</p> <p>\u6839\u636e\u5bb9\u65a5\u539f\u7406 \\(S_{i, j} = a_{i, j} + S_{i-1, j} + S_{i, j-1} - S_{i-1, j-1}\\)</p> </li> <li> <p>\u67e5\u8be2</p> <p>\u4e24\u70b9 \\((x_0, y_0), (x_1, y_1)\\) \uff08\\(x_0\\le x_1, y_0\\le y_1\\)\uff09\u4e4b\u5185\u7684\u548c</p> <p>\\(\\sum\\limits_{i=x_0}^{x_1}\\sum\\limits_{j=y_0}^{y_1} a_{i, j} = s_{x_1, y_1} - s_{x_0-1, y_1} - s_{x_1, y_0-1} + s_{x_0-1, y_0-1}\\)</p> </li> </ol> <p>\u4f8b\u9898</p> <ul> <li>bool\u77e9\u9635\u4e2d\u5bfb\u627e\u6700\u5927\u7684\u53ea\u542btrue\u7684\u5b50\u77e9\u9635</li> </ul> <p>\u9ad8\u7ef4\u524d\u7f00\u548c</p> <p>\u4f20\u7edf\u524d\u7f00\u548c\u590d\u6742\u5ea6\uff1a \\(O(n^k \\cdot 2^k)\\)</p> <p>\u679a\u4e3e\u6bcf\u4e00\u7ef4\uff0c\u5206\u522b\u53ea\u5bf9\u5f53\u524d\u7ef4\u6c42\u524d\u7f00\uff0c\u5c06\u5f97\u5230 k \u7ef4\u7684\u524d\u7f00\u548c \uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u4f18\u5316\u81f3 \\(O(n^k \\cdot k)\\)</p>"},{"location":"%E5%9F%BA%E7%A1%80/%E5%89%8D%E7%BC%80%E5%92%8C%26%E5%B7%AE%E5%88%86/#2","title":"2.\u5dee\u5206","text":"<p>\u5dee\u5206 \u53ef\u4ee5\u7406\u89e3\u4e3a \u524d\u7f00\u548c \u7684\u9006\u8fd0\u7b97\uff0c\u53ef\u4ee5\u5e94\u7528\u4e8e \u591a\u6b21 \u5feb\u901f\u4fee\u6539(\u52a0 / \u51cf) (O(1)) \u533a\u95f4\u53d6\u503c</p> <p>Tip</p> <ul> <li>\u6570\u7ec4\u524d\u7f00\u53d8\u6362\u540e \u4e0d\u652f\u6301\u533a\u95f4\u67e5\u8be2</li> </ul> <p>\u4e00\u7ef4\u5dee\u5206</p> <p>\\(b_i = a_{i} - a_{i-1}\\)</p>"},{"location":"%E6%90%9C%E7%B4%A2/DFS/","title":"DFS","text":""},{"location":"%E6%90%9C%E7%B4%A2/DFS/#_1","title":"DFS","text":""},{"location":"%E6%A6%82%E8%AE%BA/%E8%87%AA%E7%94%B1%E6%8E%A2%E7%B4%A2/","title":"\u81ea\u7531\u63a2\u7d22","text":"<p>\u6982\u5ff5</p> <ul> <li>\u751f\u6210\u51fd\u6570 \uff1a \\(\\{a\\}\\) \u6620\u5c04\u5230\u591a\u9879\u5f0f\u7cfb\u6570\u4e0a\u5f97\u5230\u7684\u51fd\u6570 \\(\\sum\\limits_{i=0}^n a_ix^i\\)</li> <li>\u5377\u79ef \uff1a \u751f\u6210\u51fd\u6570\u7684\u4e58\u79ef\u5728\u5bf9\u5e94\u5e8f\u5217\u7684\u53d8\u6362\u4e0a\u7684\u62bd\u8c61 \uff1f<ul> <li>{a} \u548c {b} \u6ee1\u8db3 \u5377\u79ef\u5e8f\u5217 \\(\\{c\\} = a \\otimes b\\)\uff0c\u5176\u4e2d \\(c_i = \\sum\\limits_{j=0}^i a_j \\times b_{i-j} = \\sum\\limits_{j+k=i} a_j \\times b_k\\)  (\u5176\u4e2d k = i-j)</li> <li>FFT \u662f\u5faa\u73af\u5377\u79ef\uff0c\u5373 \\(c_i = \\sum\\limits_{j=0}^i a_i \\times b_{i-j} = \\sum\\limits_{j+k\\equiv i \\pmod n} a_j \\times b_k\\)  (n \u4e3a\u5e8f\u5217\u957f\u5ea6)</li> </ul> </li> <li>\u5377\u79ef\u6027\u8d28\uff1a<ul> <li>\\(a\\otimes b = b\\otimes a\\)</li> <li>\\((a\\otimes b)\\otimes c=a\\otimes (b\\otimes c)\\)</li> <li>\\((a\\oplus b)\\otimes c = (a\\otimes c) \\oplus (b\\otimes c)\\)</li> </ul> </li> <li>\u5377\u79ef\u7c7b\u578b\uff1a +, and, or, xor, max</li> </ul> <p>\\(\\sum\\limits_{i=0}^n\\)</p> <p>\\(\\oplus, \\otimes, \\odot\\)</p>"}]}